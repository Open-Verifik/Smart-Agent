import{Z as A,_ as N}from"./chunk-RMO4OYE5.js";import{Cb as b,Da as f,Db as w,Eb as a,Fb as s,Ga as C,Gb as g,Kb as D,Mb as j,Nb as p,Sa as I,Wa as o,Xb as u,Yb as y,Z as v,Zb as $,aa as S,ad as z,fa as T,fb as E,id as M,lb as h,nd as c,q as _,qa as k,ra as R,sb as F,tb as d,ub as U,zb as m}from"./chunk-QTVKNRSK.js";var pt=(()=>{class i{constructor(t){this._httpClient=t,this.templates=C([]),this.reports=C([]),this.isLoading=C(!1)}getTemplates(t){let e={};return t&&(e={batchConfiguration:t}),this._httpClient.get(`${c.apiUrl}/v2/smart-report-templates`,{params:e}).pipe(_(n=>n.data),v(n=>this.templates.set(n)))}getTemplate(t){return this._httpClient.get(`${c.apiUrl}/v2/smart-report-templates/${t}`).pipe(_(e=>e.data))}createTemplate(t){return this._httpClient.post(`${c.apiUrl}/v2/smart-report-templates`,t).pipe(_(e=>e.data),v(e=>{this.templates.update(n=>[e,...n])}))}updateTemplate(t,e){return this._httpClient.put(`${c.apiUrl}/v2/smart-report-templates/${t}`,e).pipe(_(n=>n.data),v(n=>{this.templates.update(l=>l.map(x=>x._id===t?n:x))}))}deleteTemplate(t){return this._httpClient.delete(`${c.apiUrl}/v2/smart-report-templates/${t}`).pipe(v(()=>{this.templates.update(e=>e.filter(n=>n._id!==t))}))}sendTemplateSample(t,e){return this._httpClient.post(`${c.apiUrl}/v2/smart-report-templates/${t}/send-sample`,e)}getReports(t){let e={};return t&&(e={smartBatch:t}),this._httpClient.get(`${c.apiUrl}/v2/smart-reports`,{params:e}).pipe(_(n=>n.data),v(n=>this.reports.set(n)))}getReport(t){return this._httpClient.get(`${c.apiUrl}/v2/smart-reports/${t}`).pipe(_(e=>e.data))}createReport(t){return this._httpClient.post(`${c.apiUrl}/v2/smart-reports`,t).pipe(_(e=>e.data),v(e=>{this.reports.update(n=>[e,...n])}))}generateReport(t,e){let n={};return e?.engine&&(n.engine=e.engine),e?.rowIndex!=null&&(n.rowIndex=e.rowIndex),this._httpClient.post(`${c.apiUrl}/v2/smart-reports/${t}/generate`,Object.keys(n).length?n:{})}sendReportEmail(t,e){return this._httpClient.post(`${c.apiUrl}/v2/smart-reports/${t}/send-email`,e)}getReportDownloadUrl(t){return`${c.apiUrl}/v2/smart-reports/${t}/download`}static{this.\u0275fac=function(e){return new(e||i)(T(M))}}static{this.\u0275prov=S({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var V=(i,r)=>r.id,q=(i,r)=>r.key;function B(i,r){i&1&&(a(0,"div",2)(1,"mat-icon",4),u(2,"description"),s(),a(3,"p",5),u(4,"No sections to preview"),s()())}function W(i,r){if(i&1&&(a(0,"div",10)(1,"h2",13),u(2),s()()),i&2){let t=p().$implicit,e=p();d("text-align",(t.style==null?null:t.style.textAlign)||"left"),o(),d("font-size",(t.style==null?null:t.style.fontSize)||22,"px")("font-weight",(t.style==null?null:t.style.fontWeight)||"bold")("color",(t.style==null?null:t.style.color)||e.primaryColor()),o(),$(" ",t.staticContent||t.label||"Untitled"," ")}}function H(i,r){if(i&1&&(a(0,"div",8)(1,"p",14),u(2),s()()),i&2){let t=p().$implicit;o(),d("font-size",(t.style==null?null:t.style.fontSize)||12,"px")("font-weight",(t.style==null?null:t.style.fontWeight)||"normal")("text-align",(t.style==null?null:t.style.textAlign)||"left")("color",(t.style==null?null:t.style.color)||"#374151"),o(),y(t.staticContent||"Text content...")}}function J(i,r){if(i&1&&(a(0,"div",15)(1,"span",16),u(2),s(),a(3,"span",17),u(4),s()()),i&2){let t=p().$implicit,e=p();d("text-align",(t.style==null?null:t.style.textAlign)||"left"),o(),d("font-size",(t.style==null?null:t.style.fontSize)||12,"px"),o(),y(t.label||"Field"),o(),d("font-size",(t.style==null?null:t.style.fontSize)||12,"px")("color",(t.style==null?null:t.style.color)||"#111827"),o(),y(e.resolveDataPath(t.dataPath)||"---")}}function L(i,r){if(i&1&&(a(0,"h4",21),u(1),s()),i&2){let t=p(2).$implicit,e=p();d("color",e.primaryColor()),o(),y(t.label)}}function Z(i,r){if(i&1&&(a(0,"tr",20)(1,"td",22),u(2),s(),a(3,"td",23),u(4),s()()),i&2){let t=r.$implicit;o(2),y(t.key),o(2),y(t.value)}}function G(i,r){if(i&1&&(a(0,"tr")(1,"td",24),u(2),s()()),i&2){let t=p(2).$implicit;o(2),$(' No data at path "',t.dataPath,'" ')}}function K(i,r){if(i&1&&(a(0,"div",10),h(1,L,2,3,"h4",18),a(2,"table",19)(3,"tbody"),b(4,Z,5,2,"tr",20,q),h(6,G,3,1,"tr"),s()()()),i&2){let t=p().$implicit,e=p();o(),m(t.label?1:-1),o(3),w(e.resolveTableData(t.dataPath)),o(2),m(e.resolveTableData(t.dataPath).length===0?6:-1)}}function Q(i,r){if(i&1&&g(0,"img",25),i&2){let t=p(2).$implicit;F("src",t.staticContent,I)("alt",t.label||"Image")}}function X(i,r){i&1&&(a(0,"div",26)(1,"mat-icon",27),u(2,"image"),s()())}function Y(i,r){if(i&1&&(a(0,"div",10),h(1,Q,1,2,"img",25)(2,X,3,0,"div",26),s()),i&2){let t=p().$implicit;d("text-align",(t.style==null?null:t.style.textAlign)||"center"),o(),m(t.staticContent?1:2)}}function tt(i,r){if(i&1&&g(0,"hr",28),i&2){let t=p().$implicit;d("border-color",(t.style==null?null:t.style.color)||"#E5E7EB")}}function et(i,r){if(i&1&&g(0,"div"),i&2){let t=p().$implicit;d("height",(t.style==null?null:t.style.padding)||16,"px")}}function it(i,r){if(i&1){let t=D();a(0,"div",6),j("click",function(){let n=k(t).$implicit,l=p();return R(l.clickable()&&l.sectionClick()?l.sectionClick()(n):null)}),h(1,W,3,9,"div",7)(2,H,3,9,"div",8)(3,J,5,10,"div",9)(4,K,7,2,"div",10)(5,Y,3,3,"div",7)(6,tt,1,2,"hr",11)(7,et,1,2,"div",12),s()}if(i&2){let t=r.$implicit,e=p();U("cursor-pointer",e.clickable())("ring-2",e.clickable()&&e.selectedSectionId()===t.id)("ring-indigo-400",e.clickable()&&e.selectedSectionId()===t.id)("rounded-md",e.clickable()&&e.selectedSectionId()===t.id),o(),m(t.type==="header"?1:-1),o(),m(t.type==="text"?2:-1),o(),m(t.type==="field"?3:-1),o(),m(t.type==="table"?4:-1),o(),m(t.type==="image"?5:-1),o(),m(t.type==="divider"?6:-1),o(),m(t.type==="spacer"?7:-1)}}var _t=(()=>{class i{constructor(){this.template=f.required(),this.previewData=f.required(),this.primaryColor=f("#4F46E5"),this.orientation=f("portrait"),this.clickable=f(!1),this.selectedSectionId=f(null),this.sectionClick=f(null)}resolveDataPath(t){if(!t)return"";let e=this.previewData(),n=t.split("."),l=e;for(let x of n){if(l==null||typeof l!="object")return"";l=l[x]}return l==null?"":typeof l=="object"?JSON.stringify(l):String(l)}resolveTableData(t){if(!t)return[];let e=this.previewData(),n=t.split("."),l=e;for(let x of n){if(l==null||typeof l!="object")return[];l=l[x]}return l==null||typeof l!="object"?[]:Object.entries(l).map(([x,P])=>({key:this._humanize(x),value:P!=null?String(P):""}))}_humanize(t){return t.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/^./,e=>e.toUpperCase()).trim()}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=E({type:i,selectors:[["report-preview"]],inputs:{template:[1,"template"],previewData:[1,"previewData"],primaryColor:[1,"primaryColor"],orientation:[1,"orientation"],clickable:[1,"clickable"],selectedSectionId:[1,"selectedSectionId"],sectionClick:[1,"sectionClick"]},decls:5,vars:5,consts:[[1,"bg-white","rounded-lg","shadow-lg","mx-auto","overflow-hidden",2,"border","1px solid #e5e7eb"],[1,"p-8","sm:p-10","lg:p-12"],[1,"flex","flex-col","items-center","justify-center","h-64","text-gray-300"],[1,"transition-all","duration-200",3,"cursor-pointer","ring-2","ring-indigo-400","rounded-md"],[1,"!text-5xl","!w-14","!h-14","mb-3"],[1,"text-sm"],[1,"transition-all","duration-200",3,"click"],[1,"mb-4",3,"text-align"],[1,"mb-3"],[1,"flex","gap-3","py-2.5","border-b","border-gray-100",3,"text-align"],[1,"mb-4"],[1,"my-4",2,"border-width","1px",3,"border-color"],[3,"height"],[1,"leading-tight"],[1,"leading-relaxed","whitespace-pre-wrap"],[1,"flex","gap-3","py-2.5","border-b","border-gray-100"],[1,"text-gray-500","min-w-[140px]","shrink-0"],[1,"text-gray-900","font-medium"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wide","mb-2",3,"color"],[1,"w-full","text-sm"],[1,"border-b","border-gray-100"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wide","mb-2"],[1,"py-2","pr-4","text-gray-500","w-1/3"],[1,"py-2","text-gray-900","font-medium"],["colspan","2",1,"py-4","text-center","text-gray-300","text-xs"],[1,"max-h-32","inline-block","rounded",2,"max-width","100%",3,"src","alt"],[1,"inline-flex","items-center","justify-center","w-48","h-24","bg-gray-100","rounded-lg","text-gray-300"],[1,"!text-3xl"],[1,"my-4",2,"border-width","1px"]],template:function(e,n){if(e&1&&(a(0,"div",0)(1,"div",1),h(2,B,5,0,"div",2),b(3,it,8,15,"div",3,V),s()()),e&2){let l;d("max-width",n.orientation()==="landscape"?"297mm":"210mm")("min-height",n.orientation()==="landscape"?"210mm":"297mm"),o(2),m(((l=n.template().sections)==null?null:l.length)===0?2:-1),o(),w(n.template().sections)}},dependencies:[z,N,A],encapsulation:2})}}return i})();export{pt as a,_t as b};
