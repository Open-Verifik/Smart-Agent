import{a as be,b as ge,c as Ce,d as we}from"./chunk-Y64TR6OC.js";import{a as _e,b as ue,c as xe,d as fe,e as he}from"./chunk-WYCCYY5Z.js";import{a as me}from"./chunk-CE5WN7WZ.js";import{j as ae}from"./chunk-M2EUSKUB.js";import"./chunk-NJIOGT5G.js";import"./chunk-3RK6DDJD.js";import{b as ce}from"./chunk-EA7553OK.js";import"./chunk-5EMO6V7L.js";import{a as le,b as se}from"./chunk-O7BLLMPM.js";import"./chunk-7RWCIHFI.js";import"./chunk-KZVB35JW.js";import{a as pe,b as de}from"./chunk-X2B33RZ7.js";import{c as W,f as Y}from"./chunk-NCGURMCY.js";import{a as re,b as oe}from"./chunk-QAYTNEMP.js";import{a as te,c as ie,d as ne}from"./chunk-AR6BYMPL.js";import{b as J,d as z,i as H}from"./chunk-5HIRALMD.js";import"./chunk-YQHVOEV4.js";import"./chunk-QQUVC3UU.js";import"./chunk-ELGVYL4R.js";import{U as K,V as Q,X,Z,_ as ee}from"./chunk-RMO4OYE5.js";import{$b as A,Bc as k,Cb as B,Db as E,Eb as a,Fb as o,Ga as h,Gb as V,Kb as y,Mb as w,Nb as x,Wa as l,Xb as s,Yb as C,Yc as q,Zb as f,_b as L,ad as G,fb as U,ga as v,gc as D,lb as b,mc as m,md as N,nc as _,oc as P,qa as R,ra as S,sb as I,tb as F,ub as j,zb as g}from"./chunk-QTVKNRSK.js";import{a as $,h as T}from"./chunk-MG3ERZGY.js";function Te(t,p){if(!t||!p)return;let e=t.split("."),i=p;for(let n of e){if(i==null||typeof i!="object")return;i=i[n]}return i}function ke(t,p){return t==null?!1:p?typeof t=="object"&&!Array.isArray(t):!0}function Be(t){let p=[],e=i=>{i?.dataPath&&(i.type==="field"?p.push({path:i.dataPath,label:i.label,isTable:!1}):i.type==="table"&&p.push({path:i.dataPath,label:i.label,isTable:!0}))};t.header?.dataPath&&e(t.header),t.footer?.dataPath&&e(t.footer);for(let i of t.sections??[])e(i);return p}function ve(t){return{inputData:t.inputData??{},results:t.results??{}}}function Re(t,p){let e=Be(t),i=[],n=[];for(let{path:r,label:d,isTable:c}of e){let u=Te(r,p);ke(u,c)?i.push(r):n.push({path:r,label:d})}return{matches:n.length===0,matchedPaths:i,missingPaths:n}}var Se=t=>({count:t}),Ee=t=>({index:t}),Ve=(t,p)=>p._id,De=(t,p)=>p.sequence,Pe=(t,p)=>p.rowIndex;function Me(t,p){t&1&&(a(0,"div",11),V(1,"mat-spinner",13),o())}function Fe(t,p){if(t&1){let e=y();a(0,"div",18)(1,"mat-icon",31),s(2,"description"),o(),a(3,"p",32),s(4),m(5,"transloco"),o(),a(6,"button",33),w("click",function(){R(e);let n=x(2);return S(n.openReportBuilder(!0))}),s(7),m(8,"transloco"),o()()}t&2&&(l(4),C(_(5,2,"smartReport.noTemplatesFound")),l(3),f(" ",_(8,4,"smartReport.createTemplate")," "))}function je(t,p){t&1&&(a(0,"span",41)(1,"mat-icon",43),s(2,"check_circle"),o(),s(3),m(4,"transloco"),o()),t&2&&(l(3),f(" ",_(4,1,"smartReport.templateMatchesData")," "))}function Le(t,p){if(t&1&&(a(0,"span",42),m(1,"transloco"),a(2,"mat-icon",43),s(3,"warning"),o(),s(4),m(5,"transloco"),o()),t&2){let e=x(),i=x(4);I("matTooltip",_(1,2,"smartReport.paths")+": "+i.formatMissingPaths(e.missingPaths)),l(4),f(" ",P(5,4,"smartReport.missingFields",D(7,Se,e.missingPaths.length))," ")}}function Oe(t,p){if(t&1&&b(0,je,5,3,"span",41)(1,Le,6,9,"span",42),t&2){let e=p;g(e.matches?0:e.missingPaths.length>0?1:-1)}}function $e(t,p){if(t&1){let e=y();a(0,"div",35),w("click",function(){let n=R(e).$implicit,r=x(3);return S(r.selectTemplate(n))}),a(1,"div",36)(2,"div",37)(3,"mat-icon"),s(4," description "),o()(),a(5,"div",38)(6,"p",39),s(7),o(),a(8,"p",40),s(9),m(10,"transloco"),o(),b(11,Oe,2,1),o()()()}if(t&2){let e,i,n,r,d,c=p.$implicit,u=x(3);j("border-indigo-500",((e=u.selectedTemplate())==null?null:e._id)===c._id)("bg-indigo-50",((i=u.selectedTemplate())==null?null:i._id)===c._id)("border-gray-200",((n=u.selectedTemplate())==null?null:n._id)!==c._id)("hover:border-indigo-300",((r=u.selectedTemplate())==null?null:r._id)!==c._id),l(2),F("background",(c.primaryColor||"#4F46E5")+"20"),l(),F("color",c.primaryColor||"#4F46E5"),l(4),f(" ",c.name," "),l(2),A(" ",(c.sections==null?null:c.sections.length)||0," ",_(10,17,"smartReport.sections")," \u2022 ",c.pdfEngine||"puppeteer"," "),l(2),g((d=((d=u.selectedTemplate())==null?null:d._id)===c._id&&u.templateMatch())?11:-1,d)}}function Ue(t,p){if(t&1&&(a(0,"div",19),B(1,$e,12,19,"div",34,Ve),o()),t&2){let e=x(2);l(),E(e.templates())}}function Ae(t,p){if(t&1){let e=y();a(0,"p",45)(1,"mat-icon",46),s(2,"check_circle"),o(),a(3,"span"),s(4),m(5,"transloco"),o()(),a(6,"button",47),w("click",function(){R(e);let n=x(3);return S(n.openReportBuilder())}),a(7,"mat-icon",48),s(8,"edit"),o(),s(9),m(10,"transloco"),o()}t&2&&(l(4),C(_(5,2,"smartReport.templateReadyToUse")),l(5),f(" ",_(10,4,"smartReport.editInBuilder")," "))}function qe(t,p){if(t&1){let e=y();a(0,"p",49)(1,"mat-icon",46),s(2,"warning"),o(),a(3,"span"),s(4),m(5,"transloco"),o()(),a(6,"p",50),s(7),m(8,"transloco"),o(),a(9,"button",51),w("click",function(){R(e);let n=x(3);return S(n.openReportBuilder())}),a(10,"mat-icon",48),s(11,"edit"),o(),s(12),m(13,"transloco"),o()}if(t&2){let e=x(),i=x(2);l(4),C(P(5,4,"smartReport.missingFieldsEditInBuilder",D(11,Se,e.missingPaths.length))),l(3),L(" ",_(8,7,"smartReport.paths"),": ",i.formatMissingPaths(e.missingPaths)," "),l(5),f(" ",_(13,9,"smartReport.editInBuilder")," ")}}function Ge(t,p){if(t&1&&(a(0,"div",44),b(1,Ae,11,6)(2,qe,14,13),o()),t&2){let e=p;j("bg-emerald-50",e.matches)("bg-amber-50",!e.matches),l(),g(e.matches?1:2)}}function Ne(t,p){t&1&&(a(0,"mat-icon",54),s(1,"refresh"),o(),s(2),m(3,"transloco")),t&2&&(l(2),f(" ",_(3,1,"smartReport.generating")," "))}function Je(t,p){t&1&&(s(0),m(1,"transloco")),t&2&&f(" ",_(1,1,"smartReport.generatePdf")," ")}function ze(t,p){t&1&&(a(0,"mat-icon",54),s(1,"refresh"),o(),s(2),m(3,"transloco")),t&2&&(l(2),f(" ",_(3,1,"smartReport.sending")," "))}function He(t,p){t&1&&(s(0),m(1,"transloco")),t&2&&f(" ",_(1,1,"smartReport.sendViaEmail")," ")}function We(t,p){if(t&1){let e=y();a(0,"button",55),w("click",function(){R(e);let n=x(3);return S(n.downloadReport())}),a(1,"mat-icon",56),s(2,"download"),o(),s(3),m(4,"transloco"),o(),a(5,"button",57),w("click",function(){R(e);let n=x(3);return S(n.sendEmail())}),b(6,ze,4,3)(7,He,2,3),o()}if(t&2){let e=x(3);l(3),f(" ",_(4,3,"smartReport.downloadPdf")," "),l(2),I("disabled",e.isSending()),l(),g(e.isSending()?6:7)}}function Ye(t,p){if(t&1){let e=y();a(0,"div",21)(1,"h3",17),s(2),m(3,"transloco"),o(),a(4,"div",52)(5,"button",53),w("click",function(){R(e);let n=x(2);return S(n.generateReport())}),b(6,Ne,4,3)(7,Je,2,3),o(),b(8,We,8,5),o()()}if(t&2){let e=x(2);l(2),C(_(3,4,"smartReport.actions")),l(3),I("disabled",e.isGenerating()),l(),g(e.isGenerating()?6:7),l(2),g(e.report()?8:-1)}}function Ke(t,p){if(t&1&&(s(0),m(1,"transloco")),t&2){let e=x(2);f(" ",P(1,1,"smartReport.reportForRecord",D(4,Ee,e.selectedRowIndex()+1))," ")}}function Qe(t,p){t&1&&(s(0),m(1,"transloco")),t&2&&f(" ",_(1,1,"smartReport.dragSectionsReorder")," ")}function Xe(t,p){t&1&&(a(0,"div",26)(1,"mat-icon",58),s(2,"table_chart"),o(),a(3,"p",59),s(4),m(5,"transloco"),o(),a(6,"p",60),s(7),m(8,"transloco"),o()()),t&2&&(l(4),C(_(5,2,"smartReport.noStepResultsYet")),l(3),f(" ",_(8,4,"smartReport.processBatchToSeeResults")," "))}function Ze(t,p){if(t&1&&(a(0,"tr",70)(1,"td",71),s(2),o(),a(3,"td",72),m(4,"json"),s(5),o()()),t&2){let e=p.$implicit,i=x(4);l(2),f(" #",e.rowIndex+1," "),l(),I("matTooltip",e.data!=null?_(4,3,e.data):"\u2014"),l(2),f(" ",i.getResultSummary(e.data)," ")}}function et(t,p){if(t&1&&(a(0,"div",62)(1,"div",63)(2,"div",64)(3,"mat-icon",65),s(4,"drag_indicator"),o()(),a(5,"span",39),s(6),o(),a(7,"span",40),s(8),m(9,"transloco"),o()(),a(10,"div",66)(11,"table",67)(12,"thead")(13,"tr",68)(14,"th",69),s(15),m(16,"transloco"),o(),a(17,"th",69),s(18),m(19,"transloco"),o()()(),a(20,"tbody"),B(21,Ze,6,5,"tr",70,Pe),o()()()()),t&2){let e=p.$implicit;l(6),C(e.label),l(2),L("",_(9,5,"smartReport.step")," ",e.sequence,""),l(7),f(" ",_(16,7,"smartReport.row")," "),l(3),f(" ",_(19,9,"smartReport.result")," "),l(3),E(e.rowResults)}}function tt(t,p){if(t&1){let e=y();a(0,"div",27)(1,"div",61),w("cdkDropListDropped",function(n){R(e);let r=x(2);return S(r.onStepBlocksDrop(n))}),B(2,et,23,11,"div",62,De),o()()}if(t&2){let e=x(2);l(2),E(e.stepResultBlocks())}}function it(t,p){t&1&&(a(0,"div",29),V(1,"mat-spinner",73),a(2,"p"),s(3),m(4,"transloco"),o()()),t&2&&(l(3),C(_(4,1,"smartReport.generatingPdf")))}function nt(t,p){if(t&1&&V(0,"report-preview",30),t&2){let e=x(2);I("template",e.selectedTemplate())("previewData",e.previewData())("primaryColor",e.selectedTemplate().primaryColor||"#4F46E5")("orientation","portrait")("clickable",!1)}}function rt(t,p){t&1&&(a(0,"div",29)(1,"mat-icon",74),s(2,"description"),o(),a(3,"p",75),s(4),m(5,"transloco"),o(),a(6,"p",32),s(7),m(8,"transloco"),o()()),t&2&&(l(4),C(_(5,2,"smartReport.noPreviewAvailable")),l(3),f(" ",_(8,4,"smartReport.selectTemplateAndBatch")," "))}function ot(t,p){if(t&1&&(a(0,"div",12)(1,"div",14)(2,"div",15)(3,"div",16)(4,"h3",17),s(5),m(6,"transloco"),o(),b(7,Fe,9,6,"div",18)(8,Ue,3,0,"div",19),o(),b(9,Ge,3,5,"div",20),o(),b(10,Ye,9,6,"div",21),o(),a(11,"div",22)(12,"div",15)(13,"div",23)(14,"h3",24),s(15),m(16,"transloco"),o(),a(17,"p",25),b(18,Ke,2,6)(19,Qe,2,3),o()(),a(20,"div",16),b(21,Xe,9,6,"div",26)(22,tt,4,0,"div",27),o()(),a(23,"div",15)(24,"div",23)(25,"h3",24),s(26),m(27,"transloco"),o(),a(28,"p",25),s(29),m(30,"transloco"),o()(),a(31,"div",28),b(32,it,5,3,"div",29)(33,nt,1,5,"report-preview",30)(34,rt,9,6,"div",29),o()()()()),t&2){let e,i,n=x();l(5),C(_(6,10,"smartReport.selectTemplate")),l(2),g(n.templates().length===0?7:8),l(2),g((e=n.selectedTemplate()&&n.templateMatch())?9:-1,e),l(),g(n.selectedTemplate()?10:-1),l(5),C(_(16,12,"smartReport.stepResultsLayout")),l(3),g(n.selectedRowIndex()!=null?18:19),l(3),g(n.stepResultBlocks().length===0?21:22),l(5),C(_(27,14,"smartReport.preview")),l(3),f(" ",_(30,16,"smartReport.previewSameAsBuilder")," "),l(3),g(n.isGenerating()?32:n.selectedTemplate()&&(!((i=n.batch())==null||i.rows==null)&&i.rows.length)?33:34)}}var jt=(()=>{class t{constructor(){this._route=v(J),this._router=v(z),this._snack=v(le),this._reportService=v(be),this._batchService=v(me),this._previewDataService=v(ge),this._sanitizer=v(N),this._dialog=v(W),this._transloco=v(te),this.configId=h(null),this.batchId=h(null),this.selectedRowIndex=h(null),this.batch=h(null),this.configuration=h(null),this.templates=h([]),this.selectedTemplate=h(null),this.report=h(null),this.stepBlocksOrder=h([]),this.isLoading=h(!1),this.isGenerating=h(!1),this.isSending=h(!1),this.pdfDataUrl=h(null),this.pdfSafeUrl=h(null),this.stepResultBlocks=k(()=>{let e=this.stepBlocksOrder(),n=this.batch()?.rows??[],r=this.selectedRowIndex();return r!=null&&(n=n.filter(d=>d.rowIndex===r)),e.map(d=>({sequence:d.sequence,label:d.label,rowResults:n.map(c=>({rowIndex:c.rowIndex,data:c.results?.[d.sequence]??null}))}))}),this.hasStepResults=k(()=>(this.batch()?.rows??[]).some(n=>n.results&&Object.keys(n.results).length>0)),this.previewData=k(()=>{let e=this.batch(),i=e?.rows??[],n=this.selectedRowIndex(),r=n!=null?i.find(d=>d.rowIndex===n):i[0];return r?{batchName:e?.name??"Batch",rowIndex:r.rowIndex,inputData:r.inputData??{},results:r.results??{}}:{inputData:{},results:{}}}),this.templateMatch=k(()=>{let e=this.selectedTemplate(),i=this.batch();if(!e?.sections?.length||!i?.rows?.length)return null;let n=i.rows,r=this.selectedRowIndex(),d=r!=null?n.find(u=>u.rowIndex===r):n[0];if(!d)return null;let c=ve(d);return Re(e,c)})}ngOnInit(){this._route.params.subscribe(e=>{this.configId.set(e.configId),this.batchId.set(e.batchId),this._loadData()}),this._route.queryParams.subscribe(e=>{let i=e.rowIndex;if(i!=null&&i!==""){let n=parseInt(i,10);this.selectedRowIndex.set(Number.isNaN(n)?null:n)}else this.selectedRowIndex.set(null)})}_loadData(){this.isLoading.set(!0);let e=this.configId(),i=this.batchId(),n=r=>{this._reportService.getTemplates(e||void 0).subscribe({next:d=>{if(this.templates.set(d),d.length>0){let c=r?typeof r.preferredReportTemplate=="string"?r.preferredReportTemplate:r.preferredReportTemplate?._id:null,u=c?d.find(M=>M._id===c):null;this.selectedTemplate.set(u??d[0])}this.isLoading.set(!1)},error:()=>{this.isLoading.set(!1)}})};e?this._batchService.getConfiguration(e).subscribe({next:r=>{this.configuration.set(r.data),this._initStepBlocksOrderFromConfig(r.data),i?this._batchService.getSmartBatch(i).subscribe({next:d=>{this.batch.set(d.data),n(r.data)},error:()=>n(r.data)}):n(r.data)},error:()=>{i&&this._batchService.getSmartBatch(i).subscribe({next:r=>this.batch.set(r.data),error:()=>{}}),n(null)}}):(i&&this._batchService.getSmartBatch(i).subscribe({next:r=>this.batch.set(r.data),error:()=>{}}),n(null))}_initStepBlocksOrderFromConfig(e){if(!e?.steps?.length)return;let i=e.steps.filter(n=>n.enabled).sort((n,r)=>n.sequence-r.sequence).map(n=>({sequence:n.sequence,label:this._getStepLabel(n)}));i.length>0&&this.stepBlocksOrder.set(i)}_getStepLabel(e){let i=e.appFeature;return i?.name||i?.code||`Step ${e.sequence}`}onStepBlocksDrop(e){let i=[...this.stepBlocksOrder()];_e(i,e.previousIndex,e.currentIndex),this.stepBlocksOrder.set(i)}getResultSummary(e){if(e==null)return"\u2014";if(typeof e=="string")return e.length>60?e.slice(0,60)+"\u2026":e;if(typeof e!="object")return String(e);let i=Object.keys(e);return i.length===0?"\u2014":i.slice(0,3).map(r=>`${r}: ${this._valuePreview(e[r])}`).join(" \xB7 ")+(i.length>3?" \u2026":"")}_valuePreview(e){return e==null?"\u2014":typeof e=="string"?e.length>20?e.slice(0,20)+"\u2026":e:typeof e=="object"?"\u2026":String(e)}_isPdfBlob(e){return T(this,null,function*(){let n=yield e.slice(0,5).arrayBuffer(),r=new Uint8Array(n);return r[0]===37&&r[1]===80&&r[2]===68&&r[3]===70})}_blobFromJsonBytes(e){return T(this,null,function*(){try{let i=yield e.text(),n=JSON.parse(i),r=Object.keys(n).filter(c=>/^\d+$/.test(c));if(r.length===0)return null;r.sort((c,u)=>Number(c)-Number(u));let d=new Uint8Array(r.length);return r.forEach((c,u)=>d[u]=n[c]&255),d[0]!==37||d[1]!==80||d[2]!==68||d[3]!==70?null:new Blob([d],{type:"application/pdf"})}catch{return null}})}_parseBlobError(e){return T(this,null,function*(){try{let i=yield e.text(),n=JSON.parse(i);return typeof n.error=="string"?n.error:typeof n.message=="string"?n.message:Object.keys(n).some(r=>/^\d+$/.test(r))?"Server returned PDF in unexpected format":i.slice(0,80)}catch{return e.type==="application/json"||e.type==="text/plain"?"Server returned an error":"Invalid PDF content"}})}formatMissingPaths(e){return e.map(i=>i.path).join(", ")}selectTemplate(e){this.selectedTemplate.set(e),this.pdfDataUrl.set(null),this.pdfSafeUrl.set(null),this.report.set(null);let i=this.configId();i&&e._id&&this._batchService.updateConfiguration(i,{preferredReportTemplate:e._id}).subscribe({next:n=>this.configuration.set(n.data),error:()=>this._snack.open(this._transloco.translate("smartReport.failedToSaveTemplatePreference"),"Close",{duration:3e3})})}generateReport(){let e=this.selectedTemplate(),i=this.batchId();if(!e||!i){this._snack.open(this._transloco.translate("smartReport.pleaseSelectTemplate"),"Close",{duration:3e3});return}this.isGenerating.set(!0),this._reportService.createReport({template:e._id,smartBatch:i,name:`Report - ${this.batch()?.name||"Batch"}`}).subscribe({next:n=>{this.report.set(n);let r=this.selectedRowIndex();this._reportService.generateReport(n._id,$({},r!=null?{rowIndex:r}:{})).subscribe({next:d=>{if(this.report.set(d.data),d.pdf?.buffer){let c=`data:application/pdf;base64,${d.pdf.buffer}`;this.pdfDataUrl.set(c),this.pdfSafeUrl.set(this._sanitizer.bypassSecurityTrustResourceUrl(c))}this.isGenerating.set(!1),this._snack.open(this._transloco.translate("smartReport.reportGenerated"),"Close",{duration:3e3})},error:d=>{console.error("Failed to generate PDF:",d),this.isGenerating.set(!1),this._snack.open(this._transloco.translate("smartReport.failedToGenerateReport"),"Close",{duration:3e3})}})},error:n=>{console.error("Failed to create report:",n),this.isGenerating.set(!1),this._snack.open(this._transloco.translate("smartReport.failedToCreateReport"),"Close",{duration:3e3})}})}sendEmail(){let e=this.report();if(!e?._id){this._snack.open(this._transloco.translate("smartReport.generateReportFirst"),"Close",{duration:3e3});return}let i=`Report - ${this.batch()?.name??"Batch"}`;this._dialog.open(we,{panelClass:"send-sample-dialog",maxWidth:"560px",width:"95vw",disableClose:!1,autoFocus:!0,data:{defaultSubject:i,isSample:!1}}).afterClosed().subscribe(r=>{r?.recipients?.length&&(this.isSending.set(!0),this._reportService.sendReportEmail(e._id,{recipients:r.recipients,subject:r.subject,language:"es"}).subscribe({next:d=>{this.isSending.set(!1),d.success?this._snack.open(this._transloco.translate("smartReport.emailSent"),"Close",{duration:3e3}):this._snack.open(d.error||this._transloco.translate("smartReport.failedToSendEmail"),"Close",{duration:3e3})},error:()=>{this.isSending.set(!1),this._snack.open(this._transloco.translate("smartReport.failedToSendEmail"),"Close",{duration:3e3})}}))})}downloadReport(){let e=this.report();if(!e?._id){this._snack.open(this._transloco.translate("smartReport.generateReportFirst"),"Close",{duration:3e3});return}this.isSending.set(!0),this._reportService.downloadReport(e._id).subscribe({next:i=>T(this,null,function*(){let n=i;if(!(yield this._isPdfBlob(i))&&(n=yield this._blobFromJsonBytes(i),!n)){let u=yield this._parseBlobError(i);this._snack.open(u||this._transloco.translate("smartReport.invalidPdfReceived"),"Close",{duration:4e3});return}let d=URL.createObjectURL(n),c=document.createElement("a");c.href=d,c.download=`SmartReport_${e._id}.pdf`,c.click(),URL.revokeObjectURL(d),this._snack.open(this._transloco.translate("smartReport.pdfDownloaded"),"Close",{duration:2e3})}),error:()=>{this._snack.open(this._transloco.translate("smartReport.failedToDownloadPdf"),"Close",{duration:3e3})},complete:()=>{this.isSending.set(!1)}})}goBack(){let e=this.configId(),i=this.batchId();e&&i?this._router.navigate(["/smart-batch",e,"batch",i]):e&&this._router.navigate(["/smart-batch",e])}openReportBuilder(e=!1){let i=this.configId();if(!i)return;let n=this.batch(),r=n?.rows??[],d=this.selectedRowIndex(),c=d!=null?r.find(Ie=>Ie.rowIndex===d):r[0],u=c?{batchName:n?.name??"Batch",rowIndex:c.rowIndex,inputData:c.inputData??{},results:c.results??{}}:null;u&&this._previewDataService.setPendingPreviewData(u);let M=u?{state:{previewData:u}}:{},O=e?null:this.selectedTemplate()?._id,ye=O?["/smart-batch",i,"report-builder",O]:["/smart-batch",i,"report-builder"];this._router.navigate(ye,M)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=U({type:t,selectors:[["report-viewer"]],decls:24,vars:13,consts:[[1,"min-h-screen","w-full","bg-gray-50"],[1,"bg-white","border-b","border-gray-200","sticky","top-0","z-10"],[1,"w-full","px-4","sm:px-6","lg:px-8","py-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],["mat-icon-button","",3,"click","matTooltip"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500"],["mat-stroked-button","",1,"!rounded-xl",3,"click"],[1,"mr-2"],[1,"w-full","px-4","sm:px-6","lg:px-8","py-6"],[1,"flex","items-center","justify-center","h-64"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],["diameter","48"],[1,"lg:col-span-1"],[1,"bg-white","rounded-2xl","border","border-gray-200","overflow-hidden"],[1,"p-6"],[1,"font-semibold","text-gray-900","mb-4"],[1,"text-center","py-8","text-gray-400"],[1,"space-y-2","max-h-[320px]","overflow-y-auto","pr-1"],[1,"border-t","border-gray-100","px-6","py-4",3,"bg-emerald-50","bg-amber-50"],[1,"bg-white","rounded-2xl","border","border-gray-200","p-6","mt-6"],[1,"lg:col-span-2","space-y-6"],[1,"bg-gray-50","border-b","border-gray-200","px-6","py-4"],[1,"font-semibold","text-gray-900"],[1,"text-xs","text-gray-500","mt-0.5"],[1,"flex","flex-col","items-center","justify-center","py-12","text-gray-400"],[1,"mx-auto","bg-[#fafafa]","rounded-lg","border","border-gray-200","shadow-sm","p-6","min-h-[400px]",2,"max-width","210mm"],[1,"min-h-[600px]","p-6","overflow-auto"],[1,"flex","flex-col","items-center","justify-center","h-64","text-gray-400"],[3,"template","previewData","primaryColor","orientation","clickable"],[1,"!text-4xl","!w-10","!h-10","mb-2"],[1,"text-sm"],["mat-flat-button","","color","primary",1,"mt-4","!rounded-xl","!bg-indigo-600",3,"click"],[1,"p-4","rounded-xl","border","cursor-pointer","transition-all",3,"border-indigo-500","bg-indigo-50","border-gray-200","hover:border-indigo-300"],[1,"p-4","rounded-xl","border","cursor-pointer","transition-all",3,"click"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-xl","flex","items-center","justify-center","shrink-0"],[1,"flex-1","min-w-0"],[1,"font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"inline-flex","items-center","gap-1","mt-1","text-xs","text-emerald-600"],[1,"inline-flex","items-center","gap-1","mt-1","text-xs","text-amber-600",3,"matTooltip"],[1,"!text-sm","!w-3.5","!h-3.5"],[1,"border-t","border-gray-100","px-6","py-4"],[1,"text-sm","text-emerald-700","mb-3","flex","items-start","gap-2"],[1,"!text-lg","!w-5","!h-5","shrink-0","mt-0.5"],["mat-stroked-button","",1,"!rounded-xl","!text-emerald-700","!border-emerald-300","!inline-flex","!items-center","!justify-center",3,"click"],[1,"mr-2","!text-lg","!align-middle"],[1,"text-sm","text-amber-700","mb-2","flex","items-start","gap-2"],[1,"text-xs","text-amber-600/80","mb-3","pl-7"],["mat-stroked-button","",1,"!rounded-xl","!text-amber-700","!border-amber-300","!inline-flex","!items-center","!justify-center",3,"click"],[1,"space-y-3"],["mat-flat-button","","color","primary",1,"w-full","!rounded-xl","!bg-indigo-600","!inline-flex","!items-center","!justify-center",3,"click","disabled"],[1,"animate-spin","mr-2","!align-middle"],["mat-stroked-button","",1,"w-full","!rounded-xl","!inline-flex","!items-center","!justify-center",3,"click"],[1,"mr-2","!align-middle"],["mat-stroked-button","",1,"w-full","!rounded-xl","!inline-flex","!items-center","!justify-center",3,"click","disabled"],[1,"!text-5xl","!w-12","!h-12","mb-3"],[1,"text-sm","font-medium"],[1,"text-xs","mt-1"],["cdkDropList","",1,"space-y-4",3,"cdkDropListDropped"],["cdkDrag","",1,"bg-white","border","border-gray-200","rounded-lg","overflow-hidden","shadow-sm"],[1,"flex","items-center","gap-3","px-4","py-2.5","border-b","border-gray-100","bg-gray-50"],["cdkDragHandle","",1,"w-8","h-8","rounded","flex","items-center","justify-center","cursor-grab","text-gray-400","hover:bg-gray-200","transition-colors"],[1,"!text-base"],[1,"overflow-x-auto"],[1,"w-full","text-sm"],[1,"border-b","border-gray-200","bg-gray-50"],[1,"text-left","py-2","px-3","font-medium","text-gray-700"],[1,"border-b","border-gray-100","last:border-0"],[1,"py-2","px-3","text-gray-600"],[1,"py-2","px-3","text-gray-800","max-w-md","truncate",3,"matTooltip"],["diameter","48",1,"mb-4"],[1,"!text-6xl","!w-16","!h-16","mb-4"],[1,"text-lg","mb-2"]],template:function(i,n){if(i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),m(6,"transloco"),w("click",function(){return n.goBack()}),a(7,"mat-icon"),s(8,"arrow_back"),o()(),a(9,"div")(10,"h1",6),s(11),m(12,"transloco"),o(),a(13,"p",7),s(14),m(15,"transloco"),o()()(),a(16,"button",8),w("click",function(){return n.openReportBuilder(!0)}),a(17,"mat-icon",9),s(18,"design_services"),o(),s(19),m(20,"transloco"),o()()()(),a(21,"div",10),b(22,Me,2,0,"div",11)(23,ot,35,18,"div",12),o()()),i&2){let r;l(5),I("matTooltip",_(6,5,"smartReport.back")),l(6),C(_(12,7,"smartReport.generateReport")),l(3),C(((r=n.batch())==null?null:r.name)||_(15,9,"smartReport.batchReport")),l(5),f(" ",_(20,11,"smartReport.createTemplate")," "),l(3),g(n.isLoading()?22:23)}},dependencies:[G,q,H,he,fe,xe,ue,X,Q,K,Y,ee,Z,de,pe,ce,oe,re,se,ne,ie,Ce],encapsulation:2,data:{animation:[ae]}})}}return t})();export{jt as ReportViewerComponent};
