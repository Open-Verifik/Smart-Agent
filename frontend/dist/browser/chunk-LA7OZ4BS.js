import{a as DC,b as PC,c as NC}from"./chunk-Y4AEEAWU.js";import{a as MC,e as FC}from"./chunk-JQW3TAJI.js";import{a as RC,b as OC,c as AC}from"./chunk-BPOXHGVG.js";import{a as IC}from"./chunk-GP2FCC55.js";import{a as kC}from"./chunk-2BYOOQLX.js";import{a as Nm,c as US,d as jS,e as GS,f as zS,g as YS,i as qS}from"./chunk-LC44RJ6Q.js";import{j as CC}from"./chunk-KA7WHGUA.js";import"./chunk-NJIOGT5G.js";import"./chunk-3RK6DDJD.js";import{b as bC}from"./chunk-EHFGO5L2.js";import"./chunk-FRNVT4AA.js";import{a as yC,b as _C}from"./chunk-AQRZ2FME.js";import"./chunk-7RWCIHFI.js";import"./chunk-JCQ5HMSW.js";import{a as EC,b as TC}from"./chunk-URLEWDFQ.js";import{c as cC,f as uC}from"./chunk-6725JZD2.js";import{a as xC,b as SC}from"./chunk-3NF2Z5WI.js";import{a as gC,c as vC,d as wC}from"./chunk-WWC66BHZ.js";import{b as oC,d as aC,i as lC}from"./chunk-RNDOSEN7.js";import"./chunk-JW3TPNFN.js";import"./chunk-MBOJE2UO.js";import"./chunk-6YUO6TGL.js";import"./chunk-HXRSGQBN.js";import"./chunk-WMLHEEES.js";import{U as fC,V as hC,X as dC,Z as mC,_ as pC}from"./chunk-WXW7J5FA.js";import{$b as QS,Aa as me,Ba as na,Cb as tl,Cc as ci,Db as rl,Dc as nC,Ea as ZS,Eb as ye,Ec as Lf,Fb as Ee,Ga as Lr,Gb as po,H as Hm,Kb as Ai,Mb as hn,Nb as at,Rb as Wm,Sb as Um,Tb as jm,Wa as Ae,Xb as Me,Yb as ia,Zb as ct,_a as Fs,_b as _c,aa as ra,ab as el,ac as eC,ba as Lm,bd as iC,da as XS,fa as mo,fb as Ds,fc as Pf,g as $S,ga as ai,gb as Vm,gc as tC,hc as Nf,lb as tr,ma as Bm,nc as Ve,nd as sC,oc as Ge,pa as Ff,pc as Hf,qa as kn,qb as JS,ra as Mn,sb as li,sc as rC,tb as yc,ua as KS,ub as Df,zb as dr,zc as re}from"./chunk-VI5TFD4T.js";import{a as De,b as At,c as WS,d as Hr,e as Y,f as pL,g as T,i as Cc}from"./chunk-66YHNWRR.js";var rr=Y((Ym,UC)=>{"use strict";var Ec=function(t){return t&&t.Math===Math&&t};UC.exports=Ec(typeof globalThis=="object"&&globalThis)||Ec(typeof window=="object"&&window)||Ec(typeof self=="object"&&self)||Ec(typeof global=="object"&&global)||Ec(typeof Ym=="object"&&Ym)||function(){return this}()||Function("return this")()});var nr=Y((Hre,jC)=>{"use strict";jC.exports=function(t){try{return!!t()}catch{return!0}}});var $n=Y((Lre,GC)=>{"use strict";var CL=nr();GC.exports=!CL(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var Tc=Y((Bre,zC)=>{"use strict";var yL=nr();zC.exports=!yL(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")})});var Fr=Y((Vre,YC)=>{"use strict";var _L=Tc(),Vf=Function.prototype.call;YC.exports=_L?Vf.bind(Vf):function(){return Vf.apply(Vf,arguments)}});var KC=Y(XC=>{"use strict";var qC={}.propertyIsEnumerable,$C=Object.getOwnPropertyDescriptor,EL=$C&&!qC.call({1:2},1);XC.f=EL?function(e){var r=$C(this,e);return!!r&&r.enumerable}:qC});var bc=Y((Ure,ZC)=>{"use strict";ZC.exports=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}});var ir=Y((jre,ey)=>{"use strict";var JC=Tc(),QC=Function.prototype,qm=QC.call,TL=JC&&QC.bind.bind(qm,qm);ey.exports=JC?TL:function(t){return function(){return qm.apply(t,arguments)}}});var go=Y((Gre,ry)=>{"use strict";var ty=ir(),bL=ty({}.toString),RL=ty("".slice);ry.exports=function(t){return RL(bL(t),8,-1)}});var iy=Y((zre,ny)=>{"use strict";var OL=ir(),AL=nr(),IL=go(),$m=Object,kL=OL("".split);ny.exports=AL(function(){return!$m("z").propertyIsEnumerable(0)})?function(t){return IL(t)==="String"?kL(t,""):$m(t)}:$m});var Wf=Y((Yre,sy)=>{"use strict";sy.exports=function(t){return t==null}});var nl=Y((qre,oy)=>{"use strict";var ML=Wf(),FL=TypeError;oy.exports=function(t){if(ML(t))throw new FL("Can't call method on "+t);return t}});var il=Y(($re,ay)=>{"use strict";var DL=iy(),PL=nl();ay.exports=function(t){return DL(PL(t))}});var Er=Y((Xre,ly)=>{"use strict";var Xm=typeof document=="object"&&document.all;ly.exports=typeof Xm>"u"&&Xm!==void 0?function(t){return typeof t=="function"||t===Xm}:function(t){return typeof t=="function"}});var Fn=Y((Kre,cy)=>{"use strict";var NL=Er();cy.exports=function(t){return typeof t=="object"?t!==null:NL(t)}});var sa=Y((Zre,uy)=>{"use strict";var Km=rr(),HL=Er(),LL=function(t){return HL(t)?t:void 0};uy.exports=function(t,e){return arguments.length<2?LL(Km[t]):Km[t]&&Km[t][e]}});var sl=Y((Jre,fy)=>{"use strict";var BL=ir();fy.exports=BL({}.isPrototypeOf)});var Rc=Y((Qre,my)=>{"use strict";var VL=rr(),hy=VL.navigator,dy=hy&&hy.userAgent;my.exports=dy?String(dy):""});var Cy=Y((ene,Sy)=>{"use strict";var xy=rr(),Zm=Rc(),py=xy.process,gy=xy.Deno,vy=py&&py.versions||gy&&gy.version,wy=vy&&vy.v8,Ii,Uf;wy&&(Ii=wy.split("."),Uf=Ii[0]>0&&Ii[0]<4?1:+(Ii[0]+Ii[1]));!Uf&&Zm&&(Ii=Zm.match(/Edge\/(\d+)/),(!Ii||Ii[1]>=74)&&(Ii=Zm.match(/Chrome\/(\d+)/),Ii&&(Uf=+Ii[1])));Sy.exports=Uf});var jf=Y((tne,_y)=>{"use strict";var yy=Cy(),WL=nr(),UL=rr(),jL=UL.String;_y.exports=!!Object.getOwnPropertySymbols&&!WL(function(){var t=Symbol("symbol detection");return!jL(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&yy&&yy<41})});var Jm=Y((rne,Ey)=>{"use strict";var GL=jf();Ey.exports=GL&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var Gf=Y((nne,Ty)=>{"use strict";var zL=sa(),YL=Er(),qL=sl(),$L=Jm(),XL=Object;Ty.exports=$L?function(t){return typeof t=="symbol"}:function(t){var e=zL("Symbol");return YL(e)&&qL(e.prototype,XL(t))}});var Oc=Y((ine,by)=>{"use strict";var KL=String;by.exports=function(t){try{return KL(t)}catch{return"Object"}}});var Dn=Y((sne,Ry)=>{"use strict";var ZL=Er(),JL=Oc(),QL=TypeError;Ry.exports=function(t){if(ZL(t))return t;throw new QL(JL(t)+" is not a function")}});var ol=Y((one,Oy)=>{"use strict";var e4=Dn(),t4=Wf();Oy.exports=function(t,e){var r=t[e];return t4(r)?void 0:e4(r)}});var Iy=Y((ane,Ay)=>{"use strict";var Qm=Fr(),ep=Er(),tp=Fn(),r4=TypeError;Ay.exports=function(t,e){var r,n;if(e==="string"&&ep(r=t.toString)&&!tp(n=Qm(r,t))||ep(r=t.valueOf)&&!tp(n=Qm(r,t))||e!=="string"&&ep(r=t.toString)&&!tp(n=Qm(r,t)))return n;throw new r4("Can't convert object to primitive value")}});var vo=Y((lne,ky)=>{"use strict";ky.exports=!1});var zf=Y((cne,Fy)=>{"use strict";var My=rr(),n4=Object.defineProperty;Fy.exports=function(t,e){try{n4(My,t,{value:e,configurable:!0,writable:!0})}catch{My[t]=e}return e}});var Yf=Y((une,Ny)=>{"use strict";var i4=vo(),s4=rr(),o4=zf(),Dy="__core-js_shared__",Py=Ny.exports=s4[Dy]||o4(Dy,{});(Py.versions||(Py.versions=[])).push({version:"3.48.0",mode:i4?"pure":"global",copyright:"\xA9 2013\u20132025 Denis Pushkarev (zloirock.ru), 2025\u20132026 CoreJS Company (core-js.io). All rights reserved.",license:"https://github.com/zloirock/core-js/blob/v3.48.0/LICENSE",source:"https://github.com/zloirock/core-js"})});var rp=Y((fne,Ly)=>{"use strict";var Hy=Yf();Ly.exports=function(t,e){return Hy[t]||(Hy[t]=e||{})}});var oa=Y((hne,By)=>{"use strict";var a4=nl(),l4=Object;By.exports=function(t){return l4(a4(t))}});var Pn=Y((dne,Vy)=>{"use strict";var c4=ir(),u4=oa(),f4=c4({}.hasOwnProperty);Vy.exports=Object.hasOwn||function(e,r){return f4(u4(e),r)}});var qf=Y((mne,Wy)=>{"use strict";var h4=ir(),d4=0,m4=Math.random(),p4=h4(1.1.toString);Wy.exports=function(t){return"Symbol("+(t===void 0?"":t)+")_"+p4(++d4+m4,36)}});var ui=Y((pne,jy)=>{"use strict";var g4=rr(),v4=rp(),Uy=Pn(),w4=qf(),x4=jf(),S4=Jm(),al=g4.Symbol,np=v4("wks"),C4=S4?al.for||al:al&&al.withoutSetter||w4;jy.exports=function(t){return Uy(np,t)||(np[t]=x4&&Uy(al,t)?al[t]:C4("Symbol."+t)),np[t]}});var qy=Y((gne,Yy)=>{"use strict";var y4=Fr(),Gy=Fn(),zy=Gf(),_4=ol(),E4=Iy(),T4=ui(),b4=TypeError,R4=T4("toPrimitive");Yy.exports=function(t,e){if(!Gy(t)||zy(t))return t;var r=_4(t,R4),n;if(r){if(e===void 0&&(e="default"),n=y4(r,t,e),!Gy(n)||zy(n))return n;throw new b4("Can't convert object to primitive value")}return e===void 0&&(e="number"),E4(t,e)}});var ip=Y((vne,$y)=>{"use strict";var O4=qy(),A4=Gf();$y.exports=function(t){var e=O4(t,"string");return A4(e)?e:e+""}});var $f=Y((wne,Ky)=>{"use strict";var I4=rr(),Xy=Fn(),sp=I4.document,k4=Xy(sp)&&Xy(sp.createElement);Ky.exports=function(t){return k4?sp.createElement(t):{}}});var op=Y((xne,Zy)=>{"use strict";var M4=$n(),F4=nr(),D4=$f();Zy.exports=!M4&&!F4(function(){return Object.defineProperty(D4("div"),"a",{get:function(){return 7}}).a!==7})});var ap=Y(Qy=>{"use strict";var P4=$n(),N4=Fr(),H4=KC(),L4=bc(),B4=il(),V4=ip(),W4=Pn(),U4=op(),Jy=Object.getOwnPropertyDescriptor;Qy.f=P4?Jy:function(e,r){if(e=B4(e),r=V4(r),U4)try{return Jy(e,r)}catch{}if(W4(e,r))return L4(!N4(H4.f,e,r),e[r])}});var lp=Y((Cne,e_)=>{"use strict";var j4=$n(),G4=nr();e_.exports=j4&&G4(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var Dr=Y((yne,t_)=>{"use strict";var z4=Fn(),Y4=String,q4=TypeError;t_.exports=function(t){if(z4(t))return t;throw new q4(Y4(t)+" is not an object")}});var Ps=Y(n_=>{"use strict";var $4=$n(),X4=op(),K4=lp(),Xf=Dr(),r_=ip(),Z4=TypeError,cp=Object.defineProperty,J4=Object.getOwnPropertyDescriptor,up="enumerable",fp="configurable",hp="writable";n_.f=$4?K4?function(e,r,n){if(Xf(e),r=r_(r),Xf(n),typeof e=="function"&&r==="prototype"&&"value"in n&&hp in n&&!n[hp]){var i=J4(e,r);i&&i[hp]&&(e[r]=n.value,n={configurable:fp in n?n[fp]:i[fp],enumerable:up in n?n[up]:i[up],writable:!1})}return cp(e,r,n)}:cp:function(e,r,n){if(Xf(e),r=r_(r),Xf(n),X4)try{return cp(e,r,n)}catch{}if("get"in n||"set"in n)throw new Z4("Accessors not supported");return"value"in n&&(e[r]=n.value),e}});var aa=Y((Ene,i_)=>{"use strict";var Q4=$n(),e3=Ps(),t3=bc();i_.exports=Q4?function(t,e,r){return e3.f(t,e,t3(1,r))}:function(t,e,r){return t[e]=r,t}});var a_=Y((Tne,o_)=>{"use strict";var dp=$n(),r3=Pn(),s_=Function.prototype,n3=dp&&Object.getOwnPropertyDescriptor,mp=r3(s_,"name"),i3=mp&&function(){}.name==="something",s3=mp&&(!dp||dp&&n3(s_,"name").configurable);o_.exports={EXISTS:mp,PROPER:i3,CONFIGURABLE:s3}});var c_=Y((bne,l_)=>{"use strict";var o3=ir(),a3=Er(),pp=Yf(),l3=o3(Function.toString);a3(pp.inspectSource)||(pp.inspectSource=function(t){return l3(t)});l_.exports=pp.inspectSource});var h_=Y((Rne,f_)=>{"use strict";var c3=rr(),u3=Er(),u_=c3.WeakMap;f_.exports=u3(u_)&&/native code/.test(String(u_))});var Kf=Y((One,m_)=>{"use strict";var f3=rp(),h3=qf(),d_=f3("keys");m_.exports=function(t){return d_[t]||(d_[t]=h3(t))}});var Zf=Y((Ane,p_)=>{"use strict";p_.exports={}});var eh=Y((Ine,w_)=>{"use strict";var d3=h_(),v_=rr(),m3=Fn(),p3=aa(),gp=Pn(),vp=Yf(),g3=Kf(),v3=Zf(),g_="Object already initialized",wp=v_.TypeError,w3=v_.WeakMap,Jf,Ac,Qf,x3=function(t){return Qf(t)?Ac(t):Jf(t,{})},S3=function(t){return function(e){var r;if(!m3(e)||(r=Ac(e)).type!==t)throw new wp("Incompatible receiver, "+t+" required");return r}};d3||vp.state?(ki=vp.state||(vp.state=new w3),ki.get=ki.get,ki.has=ki.has,ki.set=ki.set,Jf=function(t,e){if(ki.has(t))throw new wp(g_);return e.facade=t,ki.set(t,e),e},Ac=function(t){return ki.get(t)||{}},Qf=function(t){return ki.has(t)}):(la=g3("state"),v3[la]=!0,Jf=function(t,e){if(gp(t,la))throw new wp(g_);return e.facade=t,p3(t,la,e),e},Ac=function(t){return gp(t,la)?t[la]:{}},Qf=function(t){return gp(t,la)});var ki,la;w_.exports={set:Jf,get:Ac,has:Qf,enforce:x3,getterFor:S3}});var Cp=Y((kne,C_)=>{"use strict";var Sp=ir(),C3=nr(),y3=Er(),th=Pn(),xp=$n(),_3=a_().CONFIGURABLE,E3=c_(),S_=eh(),T3=S_.enforce,b3=S_.get,x_=String,rh=Object.defineProperty,R3=Sp("".slice),O3=Sp("".replace),A3=Sp([].join),I3=xp&&!C3(function(){return rh(function(){},"length",{value:8}).length!==8}),k3=String(String).split("String"),M3=C_.exports=function(t,e,r){R3(x_(e),0,7)==="Symbol("&&(e="["+O3(x_(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!th(t,"name")||_3&&t.name!==e)&&(xp?rh(t,"name",{value:e,configurable:!0}):t.name=e),I3&&r&&th(r,"arity")&&t.length!==r.arity&&rh(t,"length",{value:r.arity});try{r&&th(r,"constructor")&&r.constructor?xp&&rh(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=T3(t);return th(n,"source")||(n.source=A3(k3,typeof e=="string"?e:"")),t};Function.prototype.toString=M3(function(){return y3(this)&&b3(this).source||E3(this)},"toString")});var nh=Y((Mne,y_)=>{"use strict";var F3=Er(),D3=Ps(),P3=Cp(),N3=zf();y_.exports=function(t,e,r,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:e;if(F3(r)&&P3(r,s,n),n.global)i?t[e]=r:N3(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:D3.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t}});var E_=Y((Fne,__)=>{"use strict";var H3=Math.ceil,L3=Math.floor;__.exports=Math.trunc||function(e){var r=+e;return(r>0?L3:H3)(r)}});var ll=Y((Dne,T_)=>{"use strict";var B3=E_();T_.exports=function(t){var e=+t;return e!==e||e===0?0:B3(e)}});var R_=Y((Pne,b_)=>{"use strict";var V3=ll(),W3=Math.max,U3=Math.min;b_.exports=function(t,e){var r=V3(t);return r<0?W3(r+e,0):U3(r,e)}});var A_=Y((Nne,O_)=>{"use strict";var j3=ll(),G3=Math.min;O_.exports=function(t){var e=j3(t);return e>0?G3(e,9007199254740991):0}});var ca=Y((Hne,I_)=>{"use strict";var z3=A_();I_.exports=function(t){return z3(t.length)}});var F_=Y((Lne,M_)=>{"use strict";var Y3=il(),q3=R_(),$3=ca(),k_=function(t){return function(e,r,n){var i=Y3(e),s=$3(i);if(s===0)return!t&&-1;var o=q3(n,s),a;if(t&&r!==r){for(;s>o;)if(a=i[o++],a!==a)return!0}else for(;s>o;o++)if((t||o in i)&&i[o]===r)return t||o||0;return!t&&-1}};M_.exports={includes:k_(!0),indexOf:k_(!1)}});var _p=Y((Bne,P_)=>{"use strict";var X3=ir(),yp=Pn(),K3=il(),Z3=F_().indexOf,J3=Zf(),D_=X3([].push);P_.exports=function(t,e){var r=K3(t),n=0,i=[],s;for(s in r)!yp(J3,s)&&yp(r,s)&&D_(i,s);for(;e.length>n;)yp(r,s=e[n++])&&(~Z3(i,s)||D_(i,s));return i}});var ih=Y((Vne,N_)=>{"use strict";N_.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var L_=Y(H_=>{"use strict";var Q3=_p(),eB=ih(),tB=eB.concat("length","prototype");H_.f=Object.getOwnPropertyNames||function(e){return Q3(e,tB)}});var V_=Y(B_=>{"use strict";B_.f=Object.getOwnPropertySymbols});var U_=Y((jne,W_)=>{"use strict";var rB=sa(),nB=ir(),iB=L_(),sB=V_(),oB=Dr(),aB=nB([].concat);W_.exports=rB("Reflect","ownKeys")||function(e){var r=iB.f(oB(e)),n=sB.f;return n?aB(r,n(e)):r}});var Ep=Y((Gne,G_)=>{"use strict";var j_=Pn(),lB=U_(),cB=ap(),uB=Ps();G_.exports=function(t,e,r){for(var n=lB(e),i=uB.f,s=cB.f,o=0;o<n.length;o++){var a=n[o];!j_(t,a)&&!(r&&j_(r,a))&&i(t,a,s(e,a))}}});var Y_=Y((zne,z_)=>{"use strict";var fB=nr(),hB=Er(),dB=/#|\.prototype\./,Ic=function(t,e){var r=pB[mB(t)];return r===vB?!0:r===gB?!1:hB(e)?fB(e):!!e},mB=Ic.normalize=function(t){return String(t).replace(dB,".").toLowerCase()},pB=Ic.data={},gB=Ic.NATIVE="N",vB=Ic.POLYFILL="P";z_.exports=Ic});var Nt=Y((Yne,q_)=>{"use strict";var sh=rr(),wB=ap().f,xB=aa(),SB=nh(),CB=zf(),yB=Ep(),_B=Y_();q_.exports=function(t,e){var r=t.target,n=t.global,i=t.stat,s,o,a,l,u,f;if(n?o=sh:i?o=sh[r]||CB(r,{}):o=sh[r]&&sh[r].prototype,o)for(a in e){if(u=e[a],t.dontCallGetSet?(f=wB(o,a),l=f&&f.value):l=o[a],s=_B(n?a:r+(i?".":"#")+a,t.forced),!s&&l!==void 0){if(typeof u==typeof l)continue;yB(u,l)}(t.sham||l&&l.sham)&&xB(u,"sham",!0),SB(o,a,u,t)}}});var cl=Y((qne,Z_)=>{"use strict";var EB=Tc(),K_=Function.prototype,$_=K_.apply,X_=K_.call;Z_.exports=typeof Reflect=="object"&&Reflect.apply||(EB?X_.bind($_):function(){return X_.apply($_,arguments)})});var Tp=Y(($ne,J_)=>{"use strict";var TB=ir(),bB=Dn();J_.exports=function(t,e,r){try{return TB(bB(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}}});var eE=Y((Xne,Q_)=>{"use strict";var RB=Fn();Q_.exports=function(t){return RB(t)||t===null}});var rE=Y((Kne,tE)=>{"use strict";var OB=eE(),AB=String,IB=TypeError;tE.exports=function(t){if(OB(t))return t;throw new IB("Can't set "+AB(t)+" as a prototype")}});var bp=Y((Zne,nE)=>{"use strict";var kB=Tp(),MB=Fn(),FB=nl(),DB=rE();nE.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=kB(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,s){return FB(i),DB(s),MB(i)&&(t?r(i,s):i.__proto__=s),i}}():void 0)});var sE=Y((Jne,iE)=>{"use strict";var PB=Ps().f;iE.exports=function(t,e,r){r in t||PB(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})}});var lE=Y((Qne,aE)=>{"use strict";var NB=Er(),HB=Fn(),oE=bp();aE.exports=function(t,e,r){var n,i;return oE&&NB(n=e.constructor)&&n!==r&&HB(i=n.prototype)&&i!==r.prototype&&oE(t,i),t}});var fE=Y((eie,uE)=>{"use strict";var LB=ui(),BB=LB("toStringTag"),cE={};cE[BB]="z";uE.exports=String(cE)==="[object z]"});var Rp=Y((tie,hE)=>{"use strict";var VB=fE(),WB=Er(),oh=go(),UB=ui(),jB=UB("toStringTag"),GB=Object,zB=oh(function(){return arguments}())==="Arguments",YB=function(t,e){try{return t[e]}catch{}};hE.exports=VB?oh:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=YB(e=GB(t),jB))=="string"?r:zB?oh(e):(n=oh(e))==="Object"&&WB(e.callee)?"Arguments":n}});var kc=Y((rie,dE)=>{"use strict";var qB=Rp(),$B=String;dE.exports=function(t){if(qB(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return $B(t)}});var pE=Y((nie,mE)=>{"use strict";var XB=kc();mE.exports=function(t,e){return t===void 0?arguments.length<2?"":e:XB(t)}});var vE=Y((iie,gE)=>{"use strict";var KB=Fn(),ZB=aa();gE.exports=function(t,e){KB(e)&&"cause"in e&&ZB(t,"cause",e.cause)}});var CE=Y((sie,SE)=>{"use strict";var JB=ir(),wE=Error,QB=JB("".replace),e8=function(t){return String(new wE(t).stack)}("zxcasd"),xE=/\n\s*at [^:]*:[^\n]*/,t8=xE.test(e8);SE.exports=function(t,e){if(t8&&typeof t=="string"&&!wE.prepareStackTrace)for(;e--;)t=QB(t,xE,"");return t}});var _E=Y((oie,yE)=>{"use strict";var r8=nr(),n8=bc();yE.exports=!r8(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",n8(1,7)),t.stack!==7):!0})});var bE=Y((aie,TE)=>{"use strict";var i8=aa(),s8=CE(),o8=_E(),EE=Error.captureStackTrace;TE.exports=function(t,e,r,n){o8&&(EE?EE(t,e):i8(t,"stack",s8(r,n)))}});var DE=Y((lie,FE)=>{"use strict";var RE=sa(),a8=Pn(),OE=aa(),l8=sl(),AE=bp(),IE=Ep(),kE=sE(),c8=lE(),u8=pE(),f8=vE(),h8=bE(),d8=$n(),ME=vo();FE.exports=function(t,e,r,n){var i="stackTraceLimit",s=n?2:1,o=t.split("."),a=o[o.length-1],l=RE.apply(null,o);if(l){var u=l.prototype;if(!ME&&a8(u,"cause")&&delete u.cause,!r)return l;var f=RE("Error"),d=e(function(p,g){var x=u8(n?g:p,void 0),w=n?new l(p):new l;return x!==void 0&&OE(w,"message",x),h8(w,d,w.stack,2),this&&l8(u,this)&&c8(w,this,d),arguments.length>s&&f8(w,arguments[s]),w});if(d.prototype=u,a!=="Error"?AE?AE(d,f):IE(d,f,{name:!0}):d8&&i in l&&(kE(d,l,i),kE(d,l,"prepareStackTrace")),IE(d,l),!ME)try{u.name!==a&&OE(u,"name",a),u.constructor=d}catch{}return d}}});var xe=Y(()=>{"use strict";var NE=Nt(),m8=rr(),ss=cl(),HE=DE(),Op="WebAssembly",PE=m8[Op],ah=new Error("e",{cause:7}).cause!==7,ua=function(t,e){var r={};r[t]=HE(t,e,ah),NE({global:!0,constructor:!0,arity:1,forced:ah},r)},Ap=function(t,e){if(PE&&PE[t]){var r={};r[t]=HE(Op+"."+t,e,ah),NE({target:Op,stat:!0,constructor:!0,arity:1,forced:ah},r)}};ua("Error",function(t){return function(r){return ss(t,this,arguments)}});ua("EvalError",function(t){return function(r){return ss(t,this,arguments)}});ua("RangeError",function(t){return function(r){return ss(t,this,arguments)}});ua("ReferenceError",function(t){return function(r){return ss(t,this,arguments)}});ua("SyntaxError",function(t){return function(r){return ss(t,this,arguments)}});ua("TypeError",function(t){return function(r){return ss(t,this,arguments)}});ua("URIError",function(t){return function(r){return ss(t,this,arguments)}});Ap("CompileError",function(t){return function(r){return ss(t,this,arguments)}});Ap("LinkError",function(t){return function(r){return ss(t,this,arguments)}});Ap("RuntimeError",function(t){return function(r){return ss(t,this,arguments)}})});var Ip=Y((fie,LE)=>{"use strict";var p8=go();LE.exports=Array.isArray||function(e){return p8(e)==="Array"}});var kp=Y((hie,BE)=>{"use strict";var g8=$n(),v8=Ip(),w8=TypeError,x8=Object.getOwnPropertyDescriptor,S8=g8&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();BE.exports=S8?function(t,e){if(v8(t)&&!x8(t,"length").writable)throw new w8("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}});var Mp=Y((die,VE)=>{"use strict";var C8=TypeError,y8=9007199254740991;VE.exports=function(t){if(t>y8)throw C8("Maximum allowed index exceeded");return t}});var Qe=Y(()=>{"use strict";var _8=Nt(),E8=oa(),T8=ca(),b8=kp(),R8=Mp(),O8=nr(),A8=O8(function(){return[].push.call({length:4294967296},1)!==4294967297}),I8=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},k8=A8||!I8();_8({target:"Array",proto:!0,arity:1,forced:k8},{push:function(e){var r=E8(this),n=T8(r),i=arguments.length;R8(n+i);for(var s=0;s<i;s++)r[n]=arguments[s],n++;return b8(r,n),n}})});var UE=Y((gie,WE)=>{"use strict";var M8=go(),F8=ir();WE.exports=function(t){if(M8(t)==="Function")return F8(t)}});var Fp=Y((vie,GE)=>{"use strict";var jE=UE(),D8=Dn(),P8=Tc(),N8=jE(jE.bind);GE.exports=function(t,e){return D8(t),e===void 0?t:P8?N8(t,e):function(){return t.apply(e,arguments)}}});var Dp=Y((wie,zE)=>{"use strict";zE.exports={}});var qE=Y((xie,YE)=>{"use strict";var H8=ui(),L8=Dp(),B8=H8("iterator"),V8=Array.prototype;YE.exports=function(t){return t!==void 0&&(L8.Array===t||V8[B8]===t)}});var Pp=Y((Sie,XE)=>{"use strict";var W8=Rp(),$E=ol(),U8=Wf(),j8=Dp(),G8=ui(),z8=G8("iterator");XE.exports=function(t){if(!U8(t))return $E(t,z8)||$E(t,"@@iterator")||j8[W8(t)]}});var ZE=Y((Cie,KE)=>{"use strict";var Y8=Fr(),q8=Dn(),$8=Dr(),X8=Oc(),K8=Pp(),Z8=TypeError;KE.exports=function(t,e){var r=arguments.length<2?K8(t):e;if(q8(r))return $8(Y8(r,t));throw new Z8(X8(t)+" is not iterable")}});var Nn=Y((yie,QE)=>{"use strict";var J8=Fr(),JE=Dr(),Q8=ol();QE.exports=function(t,e,r){var n,i;JE(t);try{if(n=Q8(t,"return"),!n){if(e==="throw")throw r;return r}n=J8(n,t)}catch(s){i=!0,n=s}if(e==="throw")throw r;if(i)throw n;return JE(n),r}});var fa=Y((_ie,nT)=>{"use strict";var eV=Fp(),tV=Fr(),rV=Dr(),nV=Oc(),iV=qE(),sV=ca(),eT=sl(),oV=ZE(),aV=Pp(),tT=Nn(),lV=TypeError,lh=function(t,e){this.stopped=t,this.result=e},rT=lh.prototype;nT.exports=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),s=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),l=eV(e,n),u,f,d,p,g,x,w,y=function(N){return u&&tT(u,"normal"),new lh(!0,N)},P=function(N){return i?(rV(N),a?l(N[0],N[1],y):l(N[0],N[1])):a?l(N,y):l(N)};if(s)u=t.iterator;else if(o)u=t;else{if(f=aV(t),!f)throw new lV(nV(t)+" is not iterable");if(iV(f)){for(d=0,p=sV(t);p>d;d++)if(g=P(t[d]),g&&eT(rT,g))return g;return new lh(!1)}u=oV(t,f)}for(x=s?t.next:u.next;!(w=tV(x,u)).done;){try{g=P(w.value)}catch(N){tT(u,"throw",N)}if(typeof g=="object"&&g&&eT(rT,g))return g}return new lh(!1)}});var Np=Y((Eie,iT)=>{"use strict";var cV=$n(),uV=Ps(),fV=bc();iT.exports=function(t,e,r){cV?uV.f(t,e,fV(0,r)):t[e]=r}});var sT=Y(()=>{"use strict";var hV=Nt(),dV=fa(),mV=Np();hV({target:"Object",stat:!0},{fromEntries:function(e){var r={};return dV(e,function(n,i){mV(r,n,i)},{AS_ENTRIES:!0}),r}})});var Mi=Y((Rie,oT)=>{"use strict";var Hp=ir(),ch=Set.prototype;oT.exports={Set,add:Hp(ch.add),has:Hp(ch.has),remove:Hp(ch.delete),proto:ch}});var wo=Y((Oie,aT)=>{"use strict";var pV=Mi().has;aT.exports=function(t){return pV(t),t}});var xo=Y((Aie,lT)=>{"use strict";var gV=Fr();lT.exports=function(t,e,r){for(var n=r?t:t.iterator,i=t.next,s,o;!(s=gV(i,n)).done;)if(o=e(s.value),o!==void 0)return o}});var ul=Y((Iie,dT)=>{"use strict";var cT=ir(),vV=xo(),uT=Mi(),wV=uT.Set,fT=uT.proto,xV=cT(fT.forEach),hT=cT(fT.keys),SV=hT(new wV).next;dT.exports=function(t,e,r){return r?vV({iterator:hT(t),next:SV},e):xV(t,e)}});var uh=Y((kie,pT)=>{"use strict";var mT=Mi(),CV=ul(),yV=mT.Set,_V=mT.add;pT.exports=function(t){var e=new yV;return CV(t,function(r){_V(e,r)}),e}});var fl=Y((Mie,gT)=>{"use strict";var EV=Tp(),TV=Mi();gT.exports=EV(TV.proto,"size","get")||function(t){return t.size}});var Ns=Y((Fie,vT)=>{"use strict";vT.exports=function(t){return{iterator:t,next:t.next,done:!1}}});var So=Y((Die,_T)=>{"use strict";var wT=Dn(),CT=Dr(),xT=Fr(),bV=ll(),RV=Ns(),ST="Invalid size",OV=RangeError,AV=TypeError,IV=Math.max,yT=function(t,e){this.set=t,this.size=IV(e,0),this.has=wT(t.has),this.keys=wT(t.keys)};yT.prototype={getIterator:function(){return RV(CT(xT(this.keys,this.set)))},includes:function(t){return xT(this.has,this.set,t)}};_T.exports=function(t){CT(t);var e=+t.size;if(e!==e)throw new AV(ST);var r=bV(e);if(r<0)throw new OV(ST);return new yT(t,r)}});var RT=Y((Pie,bT)=>{"use strict";var kV=wo(),TT=Mi(),MV=uh(),FV=fl(),DV=So(),PV=ul(),NV=xo(),HV=TT.has,ET=TT.remove;bT.exports=function(e){var r=kV(this),n=DV(e),i=MV(r);return FV(r)<=n.size?PV(r,function(s){n.includes(s)&&ET(i,s)}):NV(n.getIterator(),function(s){HV(i,s)&&ET(i,s)}),i}});var Co=Y((Nie,IT)=>{"use strict";var LV=sa(),OT=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},AT=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}};IT.exports=function(t,e){var r=LV("Set");try{new r()[t](OT(0));try{return new r()[t](OT(-1)),!1}catch{if(!e)return!0;try{return new r()[t](AT(-1/0)),!1}catch{var n=new r([1,2]);return e(n[t](AT(1/0)))}}}catch{return!1}}});var $r=Y(()=>{"use strict";var BV=Nt(),VV=RT(),WV=nr(),UV=Co(),jV=!UV("difference",function(t){return t.size===0}),GV=jV||WV(function(){var t={size:1,has:function(){return!0},keys:function(){var r=0;return{next:function(){var n=r++>1;return e.has(1)&&e.clear(),{done:n,value:2}}}}},e=new Set([1,2,3,4]);return e.difference(t).size!==3});BV({target:"Set",proto:!0,real:!0,forced:GV},{difference:VV})});var FT=Y((Bie,MT)=>{"use strict";var zV=wo(),Lp=Mi(),YV=fl(),qV=So(),$V=ul(),XV=xo(),KV=Lp.Set,kT=Lp.add,ZV=Lp.has;MT.exports=function(e){var r=zV(this),n=qV(e),i=new KV;return YV(r)>n.size?XV(n.getIterator(),function(s){ZV(r,s)&&kT(i,s)}):$V(r,function(s){n.includes(s)&&kT(i,s)}),i}});var Xr=Y(()=>{"use strict";var JV=Nt(),QV=nr(),e6=FT(),t6=Co(),r6=!t6("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||QV(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});JV({target:"Set",proto:!0,real:!0,forced:r6},{intersection:e6})});var PT=Y((Uie,DT)=>{"use strict";var n6=wo(),i6=Mi().has,s6=fl(),o6=So(),a6=ul(),l6=xo(),c6=Nn();DT.exports=function(e){var r=n6(this),n=o6(e);if(s6(r)<=n.size)return a6(r,function(s){if(n.includes(s))return!1},!0)!==!1;var i=n.getIterator();return l6(i,function(s){if(i6(r,s))return c6(i,"normal",!1)})!==!1}});var Kr=Y(()=>{"use strict";var u6=Nt(),f6=PT(),h6=Co(),d6=!h6("isDisjointFrom",function(t){return!t});u6({target:"Set",proto:!0,real:!0,forced:d6},{isDisjointFrom:f6})});var HT=Y((zie,NT)=>{"use strict";var m6=wo(),p6=fl(),g6=ul(),v6=So();NT.exports=function(e){var r=m6(this),n=v6(e);return p6(r)>n.size?!1:g6(r,function(i){if(!n.includes(i))return!1},!0)!==!1}});var Zr=Y(()=>{"use strict";var w6=Nt(),x6=HT(),S6=Co(),C6=!S6("isSubsetOf",function(t){return t});w6({target:"Set",proto:!0,real:!0,forced:C6},{isSubsetOf:x6})});var BT=Y(($ie,LT)=>{"use strict";var y6=wo(),_6=Mi().has,E6=fl(),T6=So(),b6=xo(),R6=Nn();LT.exports=function(e){var r=y6(this),n=T6(e);if(E6(r)<n.size)return!1;var i=n.getIterator();return b6(i,function(s){if(!_6(r,s))return R6(i,"normal",!1)})!==!1}});var Jr=Y(()=>{"use strict";var O6=Nt(),A6=BT(),I6=Co(),k6=!I6("isSupersetOf",function(t){return!t});O6({target:"Set",proto:!0,real:!0,forced:k6},{isSupersetOf:A6})});var WT=Y((Zie,VT)=>{"use strict";var M6=wo(),Bp=Mi(),F6=uh(),D6=So(),P6=xo(),N6=Bp.add,H6=Bp.has,L6=Bp.remove;VT.exports=function(e){var r=M6(this),n=D6(e).getIterator(),i=F6(r);return P6(n,function(s){H6(r,s)?L6(i,s):N6(i,s)}),i}});var Vp=Y((Jie,UT)=>{"use strict";UT.exports=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size===1&&n.values().next().value===4}catch{return!1}}});var Qr=Y(()=>{"use strict";var B6=Nt(),V6=WT(),W6=Vp(),U6=Co(),j6=!U6("symmetricDifference")||!W6("symmetricDifference");B6({target:"Set",proto:!0,real:!0,forced:j6},{symmetricDifference:V6})});var GT=Y((tse,jT)=>{"use strict";var G6=wo(),z6=Mi().add,Y6=uh(),q6=So(),$6=xo();jT.exports=function(e){var r=G6(this),n=q6(e).getIterator(),i=Y6(r);return $6(n,function(s){z6(i,s)}),i}});var en=Y(()=>{"use strict";var X6=Nt(),K6=GT(),Z6=Vp(),J6=Co(),Q6=!J6("union")||!Z6("union");X6({target:"Set",proto:!0,real:!0,forced:Q6},{union:K6})});var YT=Y((ise,zT)=>{"use strict";var eW=sl(),tW=TypeError;zT.exports=function(t,e){if(eW(e,t))return t;throw new tW("Incorrect invocation")}});var $T=Y((sse,qT)=>{"use strict";var rW=nr();qT.exports=!rW(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})});var Up=Y((ose,KT)=>{"use strict";var nW=Pn(),iW=Er(),sW=oa(),oW=Kf(),aW=$T(),XT=oW("IE_PROTO"),Wp=Object,lW=Wp.prototype;KT.exports=aW?Wp.getPrototypeOf:function(t){var e=sW(t);if(nW(e,XT))return e[XT];var r=e.constructor;return iW(r)&&e instanceof r?r.prototype:e instanceof Wp?lW:null}});var QT=Y((ase,JT)=>{"use strict";var ZT=Cp(),cW=Ps();JT.exports=function(t,e,r){return r.get&&ZT(r.get,e,{getter:!0}),r.set&&ZT(r.set,e,{setter:!0}),cW.f(t,e,r)}});var tb=Y((lse,eb)=>{"use strict";var uW=_p(),fW=ih();eb.exports=Object.keys||function(e){return uW(e,fW)}});var nb=Y(rb=>{"use strict";var hW=$n(),dW=lp(),mW=Ps(),pW=Dr(),gW=il(),vW=tb();rb.f=hW&&!dW?Object.defineProperties:function(e,r){pW(e);for(var n=gW(r),i=vW(r),s=i.length,o=0,a;s>o;)mW.f(e,a=i[o++],n[a]);return e}});var jp=Y((use,ib)=>{"use strict";var wW=sa();ib.exports=wW("document","documentElement")});var dh=Y((fse,fb)=>{"use strict";var xW=Dr(),SW=nb(),sb=ih(),CW=Zf(),yW=jp(),_W=$f(),EW=Kf(),ob=">",ab="<",zp="prototype",Yp="script",cb=EW("IE_PROTO"),Gp=function(){},ub=function(t){return ab+Yp+ob+t+ab+"/"+Yp+ob},lb=function(t){t.write(ub("")),t.close();var e=t.parentWindow.Object;return t=null,e},TW=function(){var t=_W("iframe"),e="java"+Yp+":",r;return t.style.display="none",yW.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(ub("document.F=Object")),r.close(),r.F},fh,hh=function(){try{fh=new ActiveXObject("htmlfile")}catch{}hh=typeof document<"u"?document.domain&&fh?lb(fh):TW():lb(fh);for(var t=sb.length;t--;)delete hh[zp][sb[t]];return hh()};CW[cb]=!0;fb.exports=Object.create||function(e,r){var n;return e!==null?(Gp[zp]=xW(e),n=new Gp,Gp[zp]=null,n[cb]=e):n=hh(),r===void 0?n:SW.f(n,r)}});var Kp=Y((hse,mb)=>{"use strict";var bW=nr(),RW=Er(),OW=Fn(),AW=dh(),hb=Up(),IW=nh(),kW=ui(),MW=vo(),Xp=kW("iterator"),db=!1,Hs,qp,$p;[].keys&&($p=[].keys(),"next"in $p?(qp=hb(hb($p)),qp!==Object.prototype&&(Hs=qp)):db=!0);var FW=!OW(Hs)||bW(function(){var t={};return Hs[Xp].call(t)!==t});FW?Hs={}:MW&&(Hs=AW(Hs));RW(Hs[Xp])||IW(Hs,Xp,function(){return this});mb.exports={IteratorPrototype:Hs,BUGGY_SAFARI_ITERATORS:db}});var Sb=Y(()=>{"use strict";var DW=Nt(),PW=rr(),NW=YT(),HW=Dr(),LW=Er(),BW=Up(),VW=QT(),WW=Np(),UW=nr(),Qp=Pn(),jW=ui(),os=Kp().IteratorPrototype,GW=$n(),zW=vo(),Zp="constructor",gb="Iterator",pb=jW("toStringTag"),vb=TypeError,Jp=PW[gb],wb=zW||!LW(Jp)||Jp.prototype!==os||!UW(function(){Jp({})}),eg=function(){if(NW(this,os),BW(this)===os)throw new vb("Abstract class Iterator not directly constructable")},xb=function(t,e){GW?VW(os,t,{configurable:!0,get:function(){return e},set:function(r){if(HW(this),this===os)throw new vb("You can't redefine this property");Qp(this,t)?this[t]=r:WW(this,t,r)}}):os[t]=e};Qp(os,pb)||xb(pb,gb);(wb||!Qp(os,Zp)||os[Zp]===Object)&&xb(Zp,eg);eg.prototype=os;DW({global:!0,constructor:!0,forced:wb},{Iterator:eg})});var tt=Y(()=>{"use strict";Sb()});var yb=Y((vse,Cb)=>{"use strict";var YW=nh();Cb.exports=function(t,e,r){for(var n in e)YW(t,n,e[n],r);return t}});var Eb=Y((wse,_b)=>{"use strict";_b.exports=function(t,e){return{value:t,done:e}}});var bb=Y((xse,Tb)=>{"use strict";var qW=Nn();Tb.exports=function(t,e,r){for(var n=t.length-1;n>=0;n--)if(t[n]!==void 0)try{r=qW(t[n].iterator,e,r)}catch(i){e="throw",r=i}if(e==="throw")throw r;return r}});var rg=Y((Sse,Fb)=>{"use strict";var $W=Fr(),XW=dh(),KW=aa(),ZW=yb(),JW=ui(),Ob=eh(),QW=ol(),e5=Kp().IteratorPrototype,mh=Eb(),ph=Nn(),t5=bb(),r5=JW("toStringTag"),Ab="IteratorHelper",Ib="WrapForValidIterator",tg="normal",Rb="throw",n5=Ob.set,kb=function(t){var e=Ob.getterFor(t?Ib:Ab);return ZW(XW(e5),{next:function(){var n=e(this);if(t)return n.nextHandler();if(n.done)return mh(void 0,!0);try{var i=n.nextHandler();return n.returnHandlerResult?i:mh(i,n.done)}catch(s){throw n.done=!0,s}},return:function(){var r=e(this),n=r.iterator;if(r.done=!0,t){var i=QW(n,"return");return i?$W(i,n):mh(void 0,!0)}if(r.inner)try{ph(r.inner.iterator,tg)}catch(s){return ph(n,Rb,s)}if(r.openIters)try{t5(r.openIters,tg)}catch(s){return ph(n,Rb,s)}return n&&ph(n,tg),mh(void 0,!0)}})},i5=kb(!0),Mb=kb(!1);KW(Mb,r5,"Iterator Helper");Fb.exports=function(t,e,r){var n=function(s,o){o?(o.iterator=s.iterator,o.next=s.next):o=s,o.type=e?Ib:Ab,o.returnHandlerResult=!!r,o.nextHandler=t,o.counter=0,o.done=!1,n5(this,o)};return n.prototype=e?i5:Mb,n}});var ng=Y((Cse,Db)=>{"use strict";var s5=Dr(),o5=Nn();Db.exports=function(t,e,r,n){try{return n?e(s5(r)[0],r[1]):e(r)}catch(i){o5(t,"throw",i)}}});var ig=Y((yse,Pb)=>{"use strict";Pb.exports=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}});var yo=Y((_se,Nb)=>{"use strict";var a5=rr();Nb.exports=function(t,e){var r=a5.Iterator,n=r&&r.prototype,i=n&&n[t],s=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(o){o instanceof e||(s=!1)}if(!s)return i}});var Vb=Y(()=>{"use strict";var l5=Nt(),Hb=Fr(),c5=Dn(),Lb=Dr(),u5=Ns(),f5=rg(),h5=ng(),og=vo(),d5=Nn(),m5=ig(),p5=yo(),Bb=!og&&!m5("filter",function(){}),sg=!og&&!Bb&&p5("filter",TypeError),g5=og||Bb||sg,v5=f5(function(){for(var t=this.iterator,e=this.predicate,r=this.next,n,i,s;;){if(n=Lb(Hb(r,t)),i=this.done=!!n.done,i)return;if(s=n.value,h5(t,e,[s,this.counter++],!0))return s}});l5({target:"Iterator",proto:!0,real:!0,forced:g5},{filter:function(e){Lb(this);try{c5(e)}catch(r){d5(this,"throw",r)}return sg?Hb(sg,this,e):new v5(u5(this),{predicate:e})}})});var Xn=Y(()=>{"use strict";Vb()});var Wb=Y(()=>{"use strict";var w5=Nt(),x5=Fr(),S5=fa(),C5=Dn(),y5=Dr(),_5=Ns(),E5=Nn(),T5=yo(),ag=T5("forEach",TypeError);w5({target:"Iterator",proto:!0,real:!0,forced:ag},{forEach:function(e){y5(this);try{C5(e)}catch(i){E5(this,"throw",i)}if(ag)return x5(ag,this,e);var r=_5(this),n=0;S5(r,function(i){e(i,n++)},{IS_RECORD:!0})}})});var sr=Y(()=>{"use strict";Wb()});var zb=Y(()=>{"use strict";var b5=Nt(),Ub=Fr(),R5=Dn(),jb=Dr(),O5=Ns(),A5=rg(),I5=ng(),k5=Nn(),M5=ig(),F5=yo(),cg=vo(),Gb=!cg&&!M5("map",function(){}),lg=!cg&&!Gb&&F5("map",TypeError),D5=cg||Gb||lg,P5=A5(function(){var t=this.iterator,e=jb(Ub(this.next,t)),r=this.done=!!e.done;if(!r)return I5(t,this.mapper,[e.value,this.counter++],!0)});b5({target:"Iterator",proto:!0,real:!0,forced:D5},{map:function(e){jb(this);try{R5(e)}catch(r){k5(this,"throw",r)}return lg?Ub(lg,this,e):new P5(O5(this),{mapper:e})}})});var Cn=Y(()=>{"use strict";zb()});var gh=Y((Nse,Yb)=>{"use strict";var N5=ir();Yb.exports=N5([].slice)});var ug=Y((Hse,qb)=>{"use strict";var H5=TypeError;qb.exports=function(t,e){if(t<e)throw new H5("Not enough arguments");return t}});var Xb=Y((Lse,$b)=>{"use strict";var L5=Rc();$b.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(L5)});var fg=Y((Bse,Kb)=>{"use strict";var Mc=rr(),B5=Rc(),V5=go(),vh=function(t){return B5.slice(0,t.length)===t};Kb.exports=function(){return vh("Bun/")?"BUN":vh("Cloudflare-Workers")?"CLOUDFLARE":vh("Deno/")?"DENO":vh("Node.js/")?"NODE":Mc.Bun&&typeof Bun.version=="string"?"BUN":Mc.Deno&&typeof Deno.version=="object"?"DENO":V5(Mc.process)==="process"?"NODE":Mc.window&&Mc.document?"BROWSER":"REST"}()});var Jb=Y((Vse,Zb)=>{"use strict";var W5=fg();Zb.exports=W5==="NODE"});var Sg=Y((Wse,aR)=>{"use strict";var Kn=rr(),U5=cl(),j5=Fp(),Qb=Er(),G5=Pn(),oR=nr(),eR=jp(),z5=gh(),tR=$f(),Y5=ug(),q5=Xb(),$5=Jb(),vg=Kn.setImmediate,wg=Kn.clearImmediate,X5=Kn.process,hg=Kn.Dispatch,K5=Kn.Function,rR=Kn.MessageChannel,Z5=Kn.String,dg=0,Fc={},nR="onreadystatechange",Dc,ha,mg,pg;oR(function(){Dc=Kn.location});var xg=function(t){if(G5(Fc,t)){var e=Fc[t];delete Fc[t],e()}},gg=function(t){return function(){xg(t)}},iR=function(t){xg(t.data)},sR=function(t){Kn.postMessage(Z5(t),Dc.protocol+"//"+Dc.host)};(!vg||!wg)&&(vg=function(e){Y5(arguments.length,1);var r=Qb(e)?e:K5(e),n=z5(arguments,1);return Fc[++dg]=function(){U5(r,void 0,n)},ha(dg),dg},wg=function(e){delete Fc[e]},$5?ha=function(t){X5.nextTick(gg(t))}:hg&&hg.now?ha=function(t){hg.now(gg(t))}:rR&&!q5?(mg=new rR,pg=mg.port2,mg.port1.onmessage=iR,ha=j5(pg.postMessage,pg)):Kn.addEventListener&&Qb(Kn.postMessage)&&!Kn.importScripts&&Dc&&Dc.protocol!=="file:"&&!oR(sR)?(ha=sR,Kn.addEventListener("message",iR,!1)):nR in tR("script")?ha=function(t){eR.appendChild(tR("script"))[nR]=function(){eR.removeChild(this),xg(t)}}:ha=function(t){setTimeout(gg(t),0)});aR.exports={set:vg,clear:wg}});var cR=Y(()=>{"use strict";var J5=Nt(),Q5=rr(),lR=Sg().clear;J5({global:!0,bind:!0,enumerable:!0,forced:Q5.clearImmediate!==lR},{clearImmediate:lR})});var hR=Y((Gse,fR)=>{"use strict";var uR=rr(),eU=cl(),tU=Er(),rU=fg(),nU=Rc(),iU=gh(),sU=ug(),oU=uR.Function,aU=/MSIE .\./.test(nU)||rU==="BUN"&&function(){var t=uR.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}();fR.exports=function(t,e){var r=e?2:1;return aU?function(n,i){var s=sU(arguments.length,1)>r,o=tU(n)?n:oU(n),a=s?iU(arguments,r):[],l=s?function(){eU(o,this,a)}:o;return e?t(l,i):t(l)}:t}});var gR=Y(()=>{"use strict";var lU=Nt(),pR=rr(),dR=Sg().set,cU=hR(),mR=pR.setImmediate?cU(dR,!1):dR;lU({global:!0,bind:!0,enumerable:!0,forced:pR.setImmediate!==mR},{setImmediate:mR})});var vR=Y(()=>{"use strict";cR();gR()});var kR=Y((Ig,hl)=>{(function(t,e){typeof Ig=="object"&&typeof hl<"u"?hl.exports=e():typeof define=="function"&&define.amd?define(e):t.moment=e()})(Ig,function(){"use strict";var t;function e(){return t.apply(null,arguments)}function r(c){t=c}function n(c){return c instanceof Array||Object.prototype.toString.call(c)==="[object Array]"}function i(c){return c!=null&&Object.prototype.toString.call(c)==="[object Object]"}function s(c,h){return Object.prototype.hasOwnProperty.call(c,h)}function o(c){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(c).length===0;var h;for(h in c)if(s(c,h))return!1;return!0}function a(c){return c===void 0}function l(c){return typeof c=="number"||Object.prototype.toString.call(c)==="[object Number]"}function u(c){return c instanceof Date||Object.prototype.toString.call(c)==="[object Date]"}function f(c,h){var v=[],C,b=c.length;for(C=0;C<b;++C)v.push(h(c[C],C));return v}function d(c,h){for(var v in h)s(h,v)&&(c[v]=h[v]);return s(h,"toString")&&(c.toString=h.toString),s(h,"valueOf")&&(c.valueOf=h.valueOf),c}function p(c,h,v,C){return wS(c,h,v,C,!0).utc()}function g(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function x(c){return c._pf==null&&(c._pf=g()),c._pf}var w;Array.prototype.some?w=Array.prototype.some:w=function(c){var h=Object(this),v=h.length>>>0,C;for(C=0;C<v;C++)if(C in h&&c.call(this,h[C],C,h))return!0;return!1};function y(c){var h=null,v=!1,C=c._d&&!isNaN(c._d.getTime());if(C&&(h=x(c),v=w.call(h.parsedDateParts,function(b){return b!=null}),C=h.overflow<0&&!h.empty&&!h.invalidEra&&!h.invalidMonth&&!h.invalidWeekday&&!h.weekdayMismatch&&!h.nullInput&&!h.invalidFormat&&!h.userInvalidated&&(!h.meridiem||h.meridiem&&v),c._strict&&(C=C&&h.charsLeftOver===0&&h.unusedTokens.length===0&&h.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(c))c._isValid=C;else return C;return c._isValid}function P(c){var h=p(NaN);return c!=null?d(x(h),c):x(h).userInvalidated=!0,h}var N=e.momentProperties=[],B=!1;function F(c,h){var v,C,b,W=N.length;if(a(h._isAMomentObject)||(c._isAMomentObject=h._isAMomentObject),a(h._i)||(c._i=h._i),a(h._f)||(c._f=h._f),a(h._l)||(c._l=h._l),a(h._strict)||(c._strict=h._strict),a(h._tzm)||(c._tzm=h._tzm),a(h._isUTC)||(c._isUTC=h._isUTC),a(h._offset)||(c._offset=h._offset),a(h._pf)||(c._pf=x(h)),a(h._locale)||(c._locale=h._locale),W>0)for(v=0;v<W;v++)C=N[v],b=h[C],a(b)||(c[C]=b);return c}function Q(c){F(this,c),this._d=new Date(c._d!=null?c._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),B===!1&&(B=!0,e.updateOffset(this),B=!1)}function he(c){return c instanceof Q||c!=null&&c._isAMomentObject!=null}function U(c){e.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+c)}function X(c,h){var v=!0;return d(function(){if(e.deprecationHandler!=null&&e.deprecationHandler(null,c),v){var C=[],b,W,ae,Fe=arguments.length;for(W=0;W<Fe;W++){if(b="",typeof arguments[W]=="object"){b+=`
[`+W+"] ";for(ae in arguments[0])s(arguments[0],ae)&&(b+=ae+": "+arguments[0][ae]+", ");b=b.slice(0,-2)}else b=arguments[W];C.push(b)}U(c+`
Arguments: `+Array.prototype.slice.call(C).join("")+`
`+new Error().stack),v=!1}return h.apply(this,arguments)},h)}var K={};function ne(c,h){e.deprecationHandler!=null&&e.deprecationHandler(c,h),K[c]||(U(h),K[c]=!0)}e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;function ie(c){return typeof Function<"u"&&c instanceof Function||Object.prototype.toString.call(c)==="[object Function]"}function te(c){var h,v;for(v in c)s(c,v)&&(h=c[v],ie(h)?this[v]=h:this["_"+v]=h);this._config=c,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Re(c,h){var v=d({},c),C;for(C in h)s(h,C)&&(i(c[C])&&i(h[C])?(v[C]={},d(v[C],c[C]),d(v[C],h[C])):h[C]!=null?v[C]=h[C]:delete v[C]);for(C in c)s(c,C)&&!s(h,C)&&i(c[C])&&(v[C]=d({},v[C]));return v}function We(c){c!=null&&this.set(c)}var ke;Object.keys?ke=Object.keys:ke=function(c){var h,v=[];for(h in c)s(c,h)&&v.push(h);return v};var wt={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function ut(c,h,v){var C=this._calendar[c]||this._calendar.sameElse;return ie(C)?C.call(h,v):C}function ze(c,h,v){var C=""+Math.abs(c),b=h-C.length,W=c>=0;return(W?v?"+":"":"-")+Math.pow(10,Math.max(0,b)).toString().substr(1)+C}var rt=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,$e=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ye={},V={};function G(c,h,v,C){var b=C;typeof C=="string"&&(b=function(){return this[C]()}),c&&(V[c]=b),h&&(V[h[0]]=function(){return ze(b.apply(this,arguments),h[1],h[2])}),v&&(V[v]=function(){return this.localeData().ordinal(b.apply(this,arguments),c)})}function z(c){return c.match(/\[[\s\S]/)?c.replace(/^\[|\]$/g,""):c.replace(/\\/g,"")}function m(c){var h=c.match(rt),v,C;for(v=0,C=h.length;v<C;v++)V[h[v]]?h[v]=V[h[v]]:h[v]=z(h[v]);return function(b){var W="",ae;for(ae=0;ae<C;ae++)W+=ie(h[ae])?h[ae].call(b,c):h[ae];return W}}function S(c,h){return c.isValid()?(h=_(h,c.localeData()),Ye[h]=Ye[h]||m(h),Ye[h](c)):c.localeData().invalidDate()}function _(c,h){var v=5;function C(b){return h.longDateFormat(b)||b}for($e.lastIndex=0;v>=0&&$e.test(c);)c=c.replace($e,C),$e.lastIndex=0,v-=1;return c}var D={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function L(c){var h=this._longDateFormat[c],v=this._longDateFormat[c.toUpperCase()];return h||!v?h:(this._longDateFormat[c]=v.match(rt).map(function(C){return C==="MMMM"||C==="MM"||C==="DD"||C==="dddd"?C.slice(1):C}).join(""),this._longDateFormat[c])}var H="Invalid date";function oe(){return this._invalidDate}var fe="%d",Oe=/\d{1,2}/;function ve(c){return this._ordinal.replace("%d",c)}var ue={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Ie(c,h,v,C){var b=this._relativeTime[v];return ie(b)?b(c,h,v,C):b.replace(/%d/i,c)}function pe(c,h){var v=this._relativeTime[c>0?"future":"past"];return ie(v)?v(h):v.replace(/%s/i,h)}var He={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Xe(c){return typeof c=="string"?He[c]||He[c.toLowerCase()]:void 0}function Tt(c){var h={},v,C;for(C in c)s(c,C)&&(v=Xe(C),v&&(h[v]=c[C]));return h}var Lt={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function ur(c){var h=[],v;for(v in c)s(c,v)&&h.push({unit:v,priority:Lt[v]});return h.sort(function(C,b){return C.priority-b.priority}),h}var xt=/\d/,qe=/\d\d/,zt=/\d{3}/,Kt=/\d{4}/,Bt=/[+-]?\d{6}/,Ke=/\d\d?/,xr=/\d\d\d\d?/,Zt=/\d\d\d\d\d\d?/,fr=/\d{1,3}/,xn=/\d{1,4}/,Ir=/[+-]?\d{1,6}/,Yr=/\d+/,Sr=/[+-]?\d+/,An=/Z|[+-]\d\d:?\d\d/gi,Cr=/Z|[+-]\d\d(?::?\d\d)?/gi,qn=/[+-]?\d+(\.\d{1,3})?/,qr=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,yr=/^[1-9]\d?/,In=/^([1-9]\d|\d)/,kr;kr={};function Ce(c,h,v){kr[c]=ie(h)?h:function(C,b){return C&&v?v:h}}function so(c,h){return s(kr,c)?kr[c](h._strict,h._locale):new RegExp(oo(c))}function oo(c){return yt(c.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(h,v,C,b,W){return v||C||b||W}))}function yt(c){return c.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function hr(c){return c<0?Math.ceil(c)||0:Math.floor(c)}function nt(c){var h=+c,v=0;return h!==0&&isFinite(h)&&(v=hr(h)),v}var ao={};function gt(c,h){var v,C=h,b;for(typeof c=="string"&&(c=[c]),l(h)&&(C=function(W,ae){ae[h]=nt(W)}),b=c.length,v=0;v<b;v++)ao[c[v]]=C}function ns(c,h){gt(c,function(v,C,b,W){b._w=b._w||{},h(v,b._w,b,W)})}function lo(c,h,v){h!=null&&s(ao,c)&&ao[c](h,v._a,v,c)}function co(c){return c%4===0&&c%100!==0||c%400===0}var Ot=0,Mr=1,E=2,I=3,R=4,A=5,k=6,M=7,Z=8;G("Y",0,0,function(){var c=this.year();return c<=9999?ze(c,4):"+"+c}),G(0,["YY",2],0,function(){return this.year()%100}),G(0,["YYYY",4],0,"year"),G(0,["YYYYY",5],0,"year"),G(0,["YYYYYY",6,!0],0,"year"),Ce("Y",Sr),Ce("YY",Ke,qe),Ce("YYYY",xn,Kt),Ce("YYYYY",Ir,Bt),Ce("YYYYYY",Ir,Bt),gt(["YYYYY","YYYYYY"],Ot),gt("YYYY",function(c,h){h[Ot]=c.length===2?e.parseTwoDigitYear(c):nt(c)}),gt("YY",function(c,h){h[Ot]=e.parseTwoDigitYear(c)}),gt("Y",function(c,h){h[Ot]=parseInt(c,10)});function se(c){return co(c)?366:365}e.parseTwoDigitYear=function(c){return nt(c)+(nt(c)>68?1900:2e3)};var J=j("FullYear",!0);function ee(){return co(this.year())}function j(c,h){return function(v){return v!=null?(q(this,c,v),e.updateOffset(this,h),this):O(this,c)}}function O(c,h){if(!c.isValid())return NaN;var v=c._d,C=c._isUTC;switch(h){case"Milliseconds":return C?v.getUTCMilliseconds():v.getMilliseconds();case"Seconds":return C?v.getUTCSeconds():v.getSeconds();case"Minutes":return C?v.getUTCMinutes():v.getMinutes();case"Hours":return C?v.getUTCHours():v.getHours();case"Date":return C?v.getUTCDate():v.getDate();case"Day":return C?v.getUTCDay():v.getDay();case"Month":return C?v.getUTCMonth():v.getMonth();case"FullYear":return C?v.getUTCFullYear():v.getFullYear();default:return NaN}}function q(c,h,v){var C,b,W,ae,Fe;if(!(!c.isValid()||isNaN(v))){switch(C=c._d,b=c._isUTC,h){case"Milliseconds":return void(b?C.setUTCMilliseconds(v):C.setMilliseconds(v));case"Seconds":return void(b?C.setUTCSeconds(v):C.setSeconds(v));case"Minutes":return void(b?C.setUTCMinutes(v):C.setMinutes(v));case"Hours":return void(b?C.setUTCHours(v):C.setHours(v));case"Date":return void(b?C.setUTCDate(v):C.setDate(v));case"FullYear":break;default:return}W=v,ae=c.month(),Fe=c.date(),Fe=Fe===29&&ae===1&&!co(W)?28:Fe,b?C.setUTCFullYear(W,ae,Fe):C.setFullYear(W,ae,Fe)}}function ce(c){return c=Xe(c),ie(this[c])?this[c]():this}function de(c,h){if(typeof c=="object"){c=Tt(c);var v=ur(c),C,b=v.length;for(C=0;C<b;C++)this[v[C].unit](c[v[C].unit])}else if(c=Xe(c),ie(this[c]))return this[c](h);return this}function we(c,h){return(c%h+h)%h}var _e;Array.prototype.indexOf?_e=Array.prototype.indexOf:_e=function(c){var h;for(h=0;h<this.length;++h)if(this[h]===c)return h;return-1};function Ze(c,h){if(isNaN(c)||isNaN(h))return NaN;var v=we(h,12);return c+=(h-v)/12,v===1?co(c)?29:28:31-v%7%2}G("M",["MM",2],"Mo",function(){return this.month()+1}),G("MMM",0,0,function(c){return this.localeData().monthsShort(this,c)}),G("MMMM",0,0,function(c){return this.localeData().months(this,c)}),Ce("M",Ke,yr),Ce("MM",Ke,qe),Ce("MMM",function(c,h){return h.monthsShortRegex(c)}),Ce("MMMM",function(c,h){return h.monthsRegex(c)}),gt(["M","MM"],function(c,h){h[Mr]=nt(c)-1}),gt(["MMM","MMMM"],function(c,h,v,C){var b=v._locale.monthsParse(c,C,v._strict);b!=null?h[Mr]=b:x(v).invalidMonth=c});var Vt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),bt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),_r=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ut=qr,is=qr;function oi(c,h){return c?n(this._months)?this._months[c.month()]:this._months[(this._months.isFormat||_r).test(h)?"format":"standalone"][c.month()]:n(this._months)?this._months:this._months.standalone}function pc(c,h){return c?n(this._monthsShort)?this._monthsShort[c.month()]:this._monthsShort[_r.test(h)?"format":"standalone"][c.month()]:n(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Ri(c,h,v){var C,b,W,ae=c.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],C=0;C<12;++C)W=p([2e3,C]),this._shortMonthsParse[C]=this.monthsShort(W,"").toLocaleLowerCase(),this._longMonthsParse[C]=this.months(W,"").toLocaleLowerCase();return v?h==="MMM"?(b=_e.call(this._shortMonthsParse,ae),b!==-1?b:null):(b=_e.call(this._longMonthsParse,ae),b!==-1?b:null):h==="MMM"?(b=_e.call(this._shortMonthsParse,ae),b!==-1?b:(b=_e.call(this._longMonthsParse,ae),b!==-1?b:null)):(b=_e.call(this._longMonthsParse,ae),b!==-1?b:(b=_e.call(this._shortMonthsParse,ae),b!==-1?b:null))}function ZD(c,h,v){var C,b,W;if(this._monthsParseExact)return Ri.call(this,c,h,v);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),C=0;C<12;C++){if(b=p([2e3,C]),v&&!this._longMonthsParse[C]&&(this._longMonthsParse[C]=new RegExp("^"+this.months(b,"").replace(".","")+"$","i"),this._shortMonthsParse[C]=new RegExp("^"+this.monthsShort(b,"").replace(".","")+"$","i")),!v&&!this._monthsParse[C]&&(W="^"+this.months(b,"")+"|^"+this.monthsShort(b,""),this._monthsParse[C]=new RegExp(W.replace(".",""),"i")),v&&h==="MMMM"&&this._longMonthsParse[C].test(c))return C;if(v&&h==="MMM"&&this._shortMonthsParse[C].test(c))return C;if(!v&&this._monthsParse[C].test(c))return C}}function oS(c,h){if(!c.isValid())return c;if(typeof h=="string"){if(/^\d+$/.test(h))h=nt(h);else if(h=c.localeData().monthsParse(h),!l(h))return c}var v=h,C=c.date();return C=C<29?C:Math.min(C,Ze(c.year(),v)),c._isUTC?c._d.setUTCMonth(v,C):c._d.setMonth(v,C),c}function aS(c){return c!=null?(oS(this,c),e.updateOffset(this,!0),this):O(this,"Month")}function JD(){return Ze(this.year(),this.month())}function QD(c){return this._monthsParseExact?(s(this,"_monthsRegex")||lS.call(this),c?this._monthsShortStrictRegex:this._monthsShortRegex):(s(this,"_monthsShortRegex")||(this._monthsShortRegex=Ut),this._monthsShortStrictRegex&&c?this._monthsShortStrictRegex:this._monthsShortRegex)}function eP(c){return this._monthsParseExact?(s(this,"_monthsRegex")||lS.call(this),c?this._monthsStrictRegex:this._monthsRegex):(s(this,"_monthsRegex")||(this._monthsRegex=is),this._monthsStrictRegex&&c?this._monthsStrictRegex:this._monthsRegex)}function lS(){function c(je,mt){return mt.length-je.length}var h=[],v=[],C=[],b,W,ae,Fe;for(b=0;b<12;b++)W=p([2e3,b]),ae=yt(this.monthsShort(W,"")),Fe=yt(this.months(W,"")),h.push(ae),v.push(Fe),C.push(Fe),C.push(ae);h.sort(c),v.sort(c),C.sort(c),this._monthsRegex=new RegExp("^("+C.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+v.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+h.join("|")+")","i")}function tP(c,h,v,C,b,W,ae){var Fe;return c<100&&c>=0?(Fe=new Date(c+400,h,v,C,b,W,ae),isFinite(Fe.getFullYear())&&Fe.setFullYear(c)):Fe=new Date(c,h,v,C,b,W,ae),Fe}function gc(c){var h,v;return c<100&&c>=0?(v=Array.prototype.slice.call(arguments),v[0]=c+400,h=new Date(Date.UTC.apply(null,v)),isFinite(h.getUTCFullYear())&&h.setUTCFullYear(c)):h=new Date(Date.UTC.apply(null,arguments)),h}function yf(c,h,v){var C=7+h-v,b=(7+gc(c,0,C).getUTCDay()-h)%7;return-b+C-1}function cS(c,h,v,C,b){var W=(7+v-C)%7,ae=yf(c,C,b),Fe=1+7*(h-1)+W+ae,je,mt;return Fe<=0?(je=c-1,mt=se(je)+Fe):Fe>se(c)?(je=c+1,mt=Fe-se(c)):(je=c,mt=Fe),{year:je,dayOfYear:mt}}function vc(c,h,v){var C=yf(c.year(),h,v),b=Math.floor((c.dayOfYear()-C-1)/7)+1,W,ae;return b<1?(ae=c.year()-1,W=b+Rs(ae,h,v)):b>Rs(c.year(),h,v)?(W=b-Rs(c.year(),h,v),ae=c.year()+1):(ae=c.year(),W=b),{week:W,year:ae}}function Rs(c,h,v){var C=yf(c,h,v),b=yf(c+1,h,v);return(se(c)-C+b)/7}G("w",["ww",2],"wo","week"),G("W",["WW",2],"Wo","isoWeek"),Ce("w",Ke,yr),Ce("ww",Ke,qe),Ce("W",Ke,yr),Ce("WW",Ke,qe),ns(["w","ww","W","WW"],function(c,h,v,C){h[C.substr(0,1)]=nt(c)});function rP(c){return vc(c,this._week.dow,this._week.doy).week}var nP={dow:0,doy:6};function iP(){return this._week.dow}function sP(){return this._week.doy}function oP(c){var h=this.localeData().week(this);return c==null?h:this.add((c-h)*7,"d")}function aP(c){var h=vc(this,1,4).week;return c==null?h:this.add((c-h)*7,"d")}G("d",0,"do","day"),G("dd",0,0,function(c){return this.localeData().weekdaysMin(this,c)}),G("ddd",0,0,function(c){return this.localeData().weekdaysShort(this,c)}),G("dddd",0,0,function(c){return this.localeData().weekdays(this,c)}),G("e",0,0,"weekday"),G("E",0,0,"isoWeekday"),Ce("d",Ke),Ce("e",Ke),Ce("E",Ke),Ce("dd",function(c,h){return h.weekdaysMinRegex(c)}),Ce("ddd",function(c,h){return h.weekdaysShortRegex(c)}),Ce("dddd",function(c,h){return h.weekdaysRegex(c)}),ns(["dd","ddd","dddd"],function(c,h,v,C){var b=v._locale.weekdaysParse(c,C,v._strict);b!=null?h.d=b:x(v).invalidWeekday=c}),ns(["d","e","E"],function(c,h,v,C){h[C]=nt(c)});function lP(c,h){return typeof c!="string"?c:isNaN(c)?(c=h.weekdaysParse(c),typeof c=="number"?c:null):parseInt(c,10)}function cP(c,h){return typeof c=="string"?h.weekdaysParse(c)%7||7:isNaN(c)?null:c}function xm(c,h){return c.slice(h,7).concat(c.slice(0,h))}var uP="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),uS="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),fP="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),hP=qr,dP=qr,mP=qr;function pP(c,h){var v=n(this._weekdays)?this._weekdays:this._weekdays[c&&c!==!0&&this._weekdays.isFormat.test(h)?"format":"standalone"];return c===!0?xm(v,this._week.dow):c?v[c.day()]:v}function gP(c){return c===!0?xm(this._weekdaysShort,this._week.dow):c?this._weekdaysShort[c.day()]:this._weekdaysShort}function vP(c){return c===!0?xm(this._weekdaysMin,this._week.dow):c?this._weekdaysMin[c.day()]:this._weekdaysMin}function wP(c,h,v){var C,b,W,ae=c.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],C=0;C<7;++C)W=p([2e3,1]).day(C),this._minWeekdaysParse[C]=this.weekdaysMin(W,"").toLocaleLowerCase(),this._shortWeekdaysParse[C]=this.weekdaysShort(W,"").toLocaleLowerCase(),this._weekdaysParse[C]=this.weekdays(W,"").toLocaleLowerCase();return v?h==="dddd"?(b=_e.call(this._weekdaysParse,ae),b!==-1?b:null):h==="ddd"?(b=_e.call(this._shortWeekdaysParse,ae),b!==-1?b:null):(b=_e.call(this._minWeekdaysParse,ae),b!==-1?b:null):h==="dddd"?(b=_e.call(this._weekdaysParse,ae),b!==-1||(b=_e.call(this._shortWeekdaysParse,ae),b!==-1)?b:(b=_e.call(this._minWeekdaysParse,ae),b!==-1?b:null)):h==="ddd"?(b=_e.call(this._shortWeekdaysParse,ae),b!==-1||(b=_e.call(this._weekdaysParse,ae),b!==-1)?b:(b=_e.call(this._minWeekdaysParse,ae),b!==-1?b:null)):(b=_e.call(this._minWeekdaysParse,ae),b!==-1||(b=_e.call(this._weekdaysParse,ae),b!==-1)?b:(b=_e.call(this._shortWeekdaysParse,ae),b!==-1?b:null))}function xP(c,h,v){var C,b,W;if(this._weekdaysParseExact)return wP.call(this,c,h,v);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),C=0;C<7;C++){if(b=p([2e3,1]).day(C),v&&!this._fullWeekdaysParse[C]&&(this._fullWeekdaysParse[C]=new RegExp("^"+this.weekdays(b,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[C]=new RegExp("^"+this.weekdaysShort(b,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[C]=new RegExp("^"+this.weekdaysMin(b,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[C]||(W="^"+this.weekdays(b,"")+"|^"+this.weekdaysShort(b,"")+"|^"+this.weekdaysMin(b,""),this._weekdaysParse[C]=new RegExp(W.replace(".",""),"i")),v&&h==="dddd"&&this._fullWeekdaysParse[C].test(c))return C;if(v&&h==="ddd"&&this._shortWeekdaysParse[C].test(c))return C;if(v&&h==="dd"&&this._minWeekdaysParse[C].test(c))return C;if(!v&&this._weekdaysParse[C].test(c))return C}}function SP(c){if(!this.isValid())return c!=null?this:NaN;var h=O(this,"Day");return c!=null?(c=lP(c,this.localeData()),this.add(c-h,"d")):h}function CP(c){if(!this.isValid())return c!=null?this:NaN;var h=(this.day()+7-this.localeData()._week.dow)%7;return c==null?h:this.add(c-h,"d")}function yP(c){if(!this.isValid())return c!=null?this:NaN;if(c!=null){var h=cP(c,this.localeData());return this.day(this.day()%7?h:h-7)}else return this.day()||7}function _P(c){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Sm.call(this),c?this._weekdaysStrictRegex:this._weekdaysRegex):(s(this,"_weekdaysRegex")||(this._weekdaysRegex=hP),this._weekdaysStrictRegex&&c?this._weekdaysStrictRegex:this._weekdaysRegex)}function EP(c){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Sm.call(this),c?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(s(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=dP),this._weekdaysShortStrictRegex&&c?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function TP(c){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Sm.call(this),c?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(s(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=mP),this._weekdaysMinStrictRegex&&c?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Sm(){function c(Sn,Ms){return Ms.length-Sn.length}var h=[],v=[],C=[],b=[],W,ae,Fe,je,mt;for(W=0;W<7;W++)ae=p([2e3,1]).day(W),Fe=yt(this.weekdaysMin(ae,"")),je=yt(this.weekdaysShort(ae,"")),mt=yt(this.weekdays(ae,"")),h.push(Fe),v.push(je),C.push(mt),b.push(Fe),b.push(je),b.push(mt);h.sort(c),v.sort(c),C.sort(c),b.sort(c),this._weekdaysRegex=new RegExp("^("+b.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+C.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+v.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+h.join("|")+")","i")}function Cm(){return this.hours()%12||12}function bP(){return this.hours()||24}G("H",["HH",2],0,"hour"),G("h",["hh",2],0,Cm),G("k",["kk",2],0,bP),G("hmm",0,0,function(){return""+Cm.apply(this)+ze(this.minutes(),2)}),G("hmmss",0,0,function(){return""+Cm.apply(this)+ze(this.minutes(),2)+ze(this.seconds(),2)}),G("Hmm",0,0,function(){return""+this.hours()+ze(this.minutes(),2)}),G("Hmmss",0,0,function(){return""+this.hours()+ze(this.minutes(),2)+ze(this.seconds(),2)});function fS(c,h){G(c,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),h)})}fS("a",!0),fS("A",!1);function hS(c,h){return h._meridiemParse}Ce("a",hS),Ce("A",hS),Ce("H",Ke,In),Ce("h",Ke,yr),Ce("k",Ke,yr),Ce("HH",Ke,qe),Ce("hh",Ke,qe),Ce("kk",Ke,qe),Ce("hmm",xr),Ce("hmmss",Zt),Ce("Hmm",xr),Ce("Hmmss",Zt),gt(["H","HH"],I),gt(["k","kk"],function(c,h,v){var C=nt(c);h[I]=C===24?0:C}),gt(["a","A"],function(c,h,v){v._isPm=v._locale.isPM(c),v._meridiem=c}),gt(["h","hh"],function(c,h,v){h[I]=nt(c),x(v).bigHour=!0}),gt("hmm",function(c,h,v){var C=c.length-2;h[I]=nt(c.substr(0,C)),h[R]=nt(c.substr(C)),x(v).bigHour=!0}),gt("hmmss",function(c,h,v){var C=c.length-4,b=c.length-2;h[I]=nt(c.substr(0,C)),h[R]=nt(c.substr(C,2)),h[A]=nt(c.substr(b)),x(v).bigHour=!0}),gt("Hmm",function(c,h,v){var C=c.length-2;h[I]=nt(c.substr(0,C)),h[R]=nt(c.substr(C))}),gt("Hmmss",function(c,h,v){var C=c.length-4,b=c.length-2;h[I]=nt(c.substr(0,C)),h[R]=nt(c.substr(C,2)),h[A]=nt(c.substr(b))});function RP(c){return(c+"").toLowerCase().charAt(0)==="p"}var OP=/[ap]\.?m?\.?/i,AP=j("Hours",!0);function IP(c,h,v){return c>11?v?"pm":"PM":v?"am":"AM"}var dS={calendar:wt,longDateFormat:D,invalidDate:H,ordinal:fe,dayOfMonthOrdinalParse:Oe,relativeTime:ue,months:Vt,monthsShort:bt,week:nP,weekdays:uP,weekdaysMin:fP,weekdaysShort:uS,meridiemParse:OP},Yt={},wc={},xc;function kP(c,h){var v,C=Math.min(c.length,h.length);for(v=0;v<C;v+=1)if(c[v]!==h[v])return v;return C}function mS(c){return c&&c.toLowerCase().replace("_","-")}function MP(c){for(var h=0,v,C,b,W;h<c.length;){for(W=mS(c[h]).split("-"),v=W.length,C=mS(c[h+1]),C=C?C.split("-"):null;v>0;){if(b=_f(W.slice(0,v).join("-")),b)return b;if(C&&C.length>=v&&kP(W,C)>=v-1)break;v--}h++}return xc}function FP(c){return!!(c&&c.match("^[^/\\\\]*$"))}function _f(c){var h=null,v;if(Yt[c]===void 0&&typeof hl<"u"&&hl&&hl.exports&&FP(c))try{h=xc._abbr,v=WS,v("./locale/"+c),uo(h)}catch{Yt[c]=null}return Yt[c]}function uo(c,h){var v;return c&&(a(h)?v=Os(c):v=ym(c,h),v?xc=v:typeof console<"u"&&console.warn&&console.warn("Locale "+c+" not found. Did you forget to load it?")),xc._abbr}function ym(c,h){if(h!==null){var v,C=dS;if(h.abbr=c,Yt[c]!=null)ne("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),C=Yt[c]._config;else if(h.parentLocale!=null)if(Yt[h.parentLocale]!=null)C=Yt[h.parentLocale]._config;else if(v=_f(h.parentLocale),v!=null)C=v._config;else return wc[h.parentLocale]||(wc[h.parentLocale]=[]),wc[h.parentLocale].push({name:c,config:h}),null;return Yt[c]=new We(Re(C,h)),wc[c]&&wc[c].forEach(function(b){ym(b.name,b.config)}),uo(c),Yt[c]}else return delete Yt[c],null}function DP(c,h){if(h!=null){var v,C,b=dS;Yt[c]!=null&&Yt[c].parentLocale!=null?Yt[c].set(Re(Yt[c]._config,h)):(C=_f(c),C!=null&&(b=C._config),h=Re(b,h),C==null&&(h.abbr=c),v=new We(h),v.parentLocale=Yt[c],Yt[c]=v),uo(c)}else Yt[c]!=null&&(Yt[c].parentLocale!=null?(Yt[c]=Yt[c].parentLocale,c===uo()&&uo(c)):Yt[c]!=null&&delete Yt[c]);return Yt[c]}function Os(c){var h;if(c&&c._locale&&c._locale._abbr&&(c=c._locale._abbr),!c)return xc;if(!n(c)){if(h=_f(c),h)return h;c=[c]}return MP(c)}function PP(){return ke(Yt)}function _m(c){var h,v=c._a;return v&&x(c).overflow===-2&&(h=v[Mr]<0||v[Mr]>11?Mr:v[E]<1||v[E]>Ze(v[Ot],v[Mr])?E:v[I]<0||v[I]>24||v[I]===24&&(v[R]!==0||v[A]!==0||v[k]!==0)?I:v[R]<0||v[R]>59?R:v[A]<0||v[A]>59?A:v[k]<0||v[k]>999?k:-1,x(c)._overflowDayOfYear&&(h<Ot||h>E)&&(h=E),x(c)._overflowWeeks&&h===-1&&(h=M),x(c)._overflowWeekday&&h===-1&&(h=Z),x(c).overflow=h),c}var NP=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,HP=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,LP=/Z|[+-]\d\d(?::?\d\d)?/,Ef=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Em=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],BP=/^\/?Date\((-?\d+)/i,VP=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,WP={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function pS(c){var h,v,C=c._i,b=NP.exec(C)||HP.exec(C),W,ae,Fe,je,mt=Ef.length,Sn=Em.length;if(b){for(x(c).iso=!0,h=0,v=mt;h<v;h++)if(Ef[h][1].exec(b[1])){ae=Ef[h][0],W=Ef[h][2]!==!1;break}if(ae==null){c._isValid=!1;return}if(b[3]){for(h=0,v=Sn;h<v;h++)if(Em[h][1].exec(b[3])){Fe=(b[2]||" ")+Em[h][0];break}if(Fe==null){c._isValid=!1;return}}if(!W&&Fe!=null){c._isValid=!1;return}if(b[4])if(LP.exec(b[4]))je="Z";else{c._isValid=!1;return}c._f=ae+(Fe||"")+(je||""),bm(c)}else c._isValid=!1}function UP(c,h,v,C,b,W){var ae=[jP(c),bt.indexOf(h),parseInt(v,10),parseInt(C,10),parseInt(b,10)];return W&&ae.push(parseInt(W,10)),ae}function jP(c){var h=parseInt(c,10);return h<=49?2e3+h:h<=999?1900+h:h}function GP(c){return c.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function zP(c,h,v){if(c){var C=uS.indexOf(c),b=new Date(h[0],h[1],h[2]).getDay();if(C!==b)return x(v).weekdayMismatch=!0,v._isValid=!1,!1}return!0}function YP(c,h,v){if(c)return WP[c];if(h)return 0;var C=parseInt(v,10),b=C%100,W=(C-b)/100;return W*60+b}function gS(c){var h=VP.exec(GP(c._i)),v;if(h){if(v=UP(h[4],h[3],h[2],h[5],h[6],h[7]),!zP(h[1],v,c))return;c._a=v,c._tzm=YP(h[8],h[9],h[10]),c._d=gc.apply(null,c._a),c._d.setUTCMinutes(c._d.getUTCMinutes()-c._tzm),x(c).rfc2822=!0}else c._isValid=!1}function qP(c){var h=BP.exec(c._i);if(h!==null){c._d=new Date(+h[1]);return}if(pS(c),c._isValid===!1)delete c._isValid;else return;if(gS(c),c._isValid===!1)delete c._isValid;else return;c._strict?c._isValid=!1:e.createFromInputFallback(c)}e.createFromInputFallback=X("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(c){c._d=new Date(c._i+(c._useUTC?" UTC":""))});function Xa(c,h,v){return c??h??v}function $P(c){var h=new Date(e.now());return c._useUTC?[h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()]:[h.getFullYear(),h.getMonth(),h.getDate()]}function Tm(c){var h,v,C=[],b,W,ae;if(!c._d){for(b=$P(c),c._w&&c._a[E]==null&&c._a[Mr]==null&&XP(c),c._dayOfYear!=null&&(ae=Xa(c._a[Ot],b[Ot]),(c._dayOfYear>se(ae)||c._dayOfYear===0)&&(x(c)._overflowDayOfYear=!0),v=gc(ae,0,c._dayOfYear),c._a[Mr]=v.getUTCMonth(),c._a[E]=v.getUTCDate()),h=0;h<3&&c._a[h]==null;++h)c._a[h]=C[h]=b[h];for(;h<7;h++)c._a[h]=C[h]=c._a[h]==null?h===2?1:0:c._a[h];c._a[I]===24&&c._a[R]===0&&c._a[A]===0&&c._a[k]===0&&(c._nextDay=!0,c._a[I]=0),c._d=(c._useUTC?gc:tP).apply(null,C),W=c._useUTC?c._d.getUTCDay():c._d.getDay(),c._tzm!=null&&c._d.setUTCMinutes(c._d.getUTCMinutes()-c._tzm),c._nextDay&&(c._a[I]=24),c._w&&typeof c._w.d<"u"&&c._w.d!==W&&(x(c).weekdayMismatch=!0)}}function XP(c){var h,v,C,b,W,ae,Fe,je,mt;h=c._w,h.GG!=null||h.W!=null||h.E!=null?(W=1,ae=4,v=Xa(h.GG,c._a[Ot],vc(jt(),1,4).year),C=Xa(h.W,1),b=Xa(h.E,1),(b<1||b>7)&&(je=!0)):(W=c._locale._week.dow,ae=c._locale._week.doy,mt=vc(jt(),W,ae),v=Xa(h.gg,c._a[Ot],mt.year),C=Xa(h.w,mt.week),h.d!=null?(b=h.d,(b<0||b>6)&&(je=!0)):h.e!=null?(b=h.e+W,(h.e<0||h.e>6)&&(je=!0)):b=W),C<1||C>Rs(v,W,ae)?x(c)._overflowWeeks=!0:je!=null?x(c)._overflowWeekday=!0:(Fe=cS(v,C,b,W,ae),c._a[Ot]=Fe.year,c._dayOfYear=Fe.dayOfYear)}e.ISO_8601=function(){},e.RFC_2822=function(){};function bm(c){if(c._f===e.ISO_8601){pS(c);return}if(c._f===e.RFC_2822){gS(c);return}c._a=[],x(c).empty=!0;var h=""+c._i,v,C,b,W,ae,Fe=h.length,je=0,mt,Sn;for(b=_(c._f,c._locale).match(rt)||[],Sn=b.length,v=0;v<Sn;v++)W=b[v],C=(h.match(so(W,c))||[])[0],C&&(ae=h.substr(0,h.indexOf(C)),ae.length>0&&x(c).unusedInput.push(ae),h=h.slice(h.indexOf(C)+C.length),je+=C.length),V[W]?(C?x(c).empty=!1:x(c).unusedTokens.push(W),lo(W,C,c)):c._strict&&!C&&x(c).unusedTokens.push(W);x(c).charsLeftOver=Fe-je,h.length>0&&x(c).unusedInput.push(h),c._a[I]<=12&&x(c).bigHour===!0&&c._a[I]>0&&(x(c).bigHour=void 0),x(c).parsedDateParts=c._a.slice(0),x(c).meridiem=c._meridiem,c._a[I]=KP(c._locale,c._a[I],c._meridiem),mt=x(c).era,mt!==null&&(c._a[Ot]=c._locale.erasConvertYear(mt,c._a[Ot])),Tm(c),_m(c)}function KP(c,h,v){var C;return v==null?h:c.meridiemHour!=null?c.meridiemHour(h,v):(c.isPM!=null&&(C=c.isPM(v),C&&h<12&&(h+=12),!C&&h===12&&(h=0)),h)}function ZP(c){var h,v,C,b,W,ae,Fe=!1,je=c._f.length;if(je===0){x(c).invalidFormat=!0,c._d=new Date(NaN);return}for(b=0;b<je;b++)W=0,ae=!1,h=F({},c),c._useUTC!=null&&(h._useUTC=c._useUTC),h._f=c._f[b],bm(h),y(h)&&(ae=!0),W+=x(h).charsLeftOver,W+=x(h).unusedTokens.length*10,x(h).score=W,Fe?W<C&&(C=W,v=h):(C==null||W<C||ae)&&(C=W,v=h,ae&&(Fe=!0));d(c,v||h)}function JP(c){if(!c._d){var h=Tt(c._i),v=h.day===void 0?h.date:h.day;c._a=f([h.year,h.month,v,h.hour,h.minute,h.second,h.millisecond],function(C){return C&&parseInt(C,10)}),Tm(c)}}function QP(c){var h=new Q(_m(vS(c)));return h._nextDay&&(h.add(1,"d"),h._nextDay=void 0),h}function vS(c){var h=c._i,v=c._f;return c._locale=c._locale||Os(c._l),h===null||v===void 0&&h===""?P({nullInput:!0}):(typeof h=="string"&&(c._i=h=c._locale.preparse(h)),he(h)?new Q(_m(h)):(u(h)?c._d=h:n(v)?ZP(c):v?bm(c):eN(c),y(c)||(c._d=null),c))}function eN(c){var h=c._i;a(h)?c._d=new Date(e.now()):u(h)?c._d=new Date(h.valueOf()):typeof h=="string"?qP(c):n(h)?(c._a=f(h.slice(0),function(v){return parseInt(v,10)}),Tm(c)):i(h)?JP(c):l(h)?c._d=new Date(h):e.createFromInputFallback(c)}function wS(c,h,v,C,b){var W={};return(h===!0||h===!1)&&(C=h,h=void 0),(v===!0||v===!1)&&(C=v,v=void 0),(i(c)&&o(c)||n(c)&&c.length===0)&&(c=void 0),W._isAMomentObject=!0,W._useUTC=W._isUTC=b,W._l=v,W._i=c,W._f=h,W._strict=C,QP(W)}function jt(c,h,v,C){return wS(c,h,v,C,!1)}var tN=X("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var c=jt.apply(null,arguments);return this.isValid()&&c.isValid()?c<this?this:c:P()}),rN=X("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var c=jt.apply(null,arguments);return this.isValid()&&c.isValid()?c>this?this:c:P()});function xS(c,h){var v,C;if(h.length===1&&n(h[0])&&(h=h[0]),!h.length)return jt();for(v=h[0],C=1;C<h.length;++C)(!h[C].isValid()||h[C][c](v))&&(v=h[C]);return v}function nN(){var c=[].slice.call(arguments,0);return xS("isBefore",c)}function iN(){var c=[].slice.call(arguments,0);return xS("isAfter",c)}var sN=function(){return Date.now?Date.now():+new Date},Sc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function oN(c){var h,v=!1,C,b=Sc.length;for(h in c)if(s(c,h)&&!(_e.call(Sc,h)!==-1&&(c[h]==null||!isNaN(c[h]))))return!1;for(C=0;C<b;++C)if(c[Sc[C]]){if(v)return!1;parseFloat(c[Sc[C]])!==nt(c[Sc[C]])&&(v=!0)}return!0}function aN(){return this._isValid}function lN(){return Oi(NaN)}function Tf(c){var h=Tt(c),v=h.year||0,C=h.quarter||0,b=h.month||0,W=h.week||h.isoWeek||0,ae=h.day||0,Fe=h.hour||0,je=h.minute||0,mt=h.second||0,Sn=h.millisecond||0;this._isValid=oN(h),this._milliseconds=+Sn+mt*1e3+je*6e4+Fe*1e3*60*60,this._days=+ae+W*7,this._months=+b+C*3+v*12,this._data={},this._locale=Os(),this._bubble()}function bf(c){return c instanceof Tf}function Rm(c){return c<0?Math.round(-1*c)*-1:Math.round(c)}function cN(c,h,v){var C=Math.min(c.length,h.length),b=Math.abs(c.length-h.length),W=0,ae;for(ae=0;ae<C;ae++)(v&&c[ae]!==h[ae]||!v&&nt(c[ae])!==nt(h[ae]))&&W++;return W+b}function SS(c,h){G(c,0,0,function(){var v=this.utcOffset(),C="+";return v<0&&(v=-v,C="-"),C+ze(~~(v/60),2)+h+ze(~~v%60,2)})}SS("Z",":"),SS("ZZ",""),Ce("Z",Cr),Ce("ZZ",Cr),gt(["Z","ZZ"],function(c,h,v){v._useUTC=!0,v._tzm=Om(Cr,c)});var uN=/([\+\-]|\d\d)/gi;function Om(c,h){var v=(h||"").match(c),C,b,W;return v===null?null:(C=v[v.length-1]||[],b=(C+"").match(uN)||["-",0,0],W=+(b[1]*60)+nt(b[2]),W===0?0:b[0]==="+"?W:-W)}function Am(c,h){var v,C;return h._isUTC?(v=h.clone(),C=(he(c)||u(c)?c.valueOf():jt(c).valueOf())-v.valueOf(),v._d.setTime(v._d.valueOf()+C),e.updateOffset(v,!1),v):jt(c).local()}function Im(c){return-Math.round(c._d.getTimezoneOffset())}e.updateOffset=function(){};function fN(c,h,v){var C=this._offset||0,b;if(!this.isValid())return c!=null?this:NaN;if(c!=null){if(typeof c=="string"){if(c=Om(Cr,c),c===null)return this}else Math.abs(c)<16&&!v&&(c=c*60);return!this._isUTC&&h&&(b=Im(this)),this._offset=c,this._isUTC=!0,b!=null&&this.add(b,"m"),C!==c&&(!h||this._changeInProgress?ES(this,Oi(c-C,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?C:Im(this)}function hN(c,h){return c!=null?(typeof c!="string"&&(c=-c),this.utcOffset(c,h),this):-this.utcOffset()}function dN(c){return this.utcOffset(0,c)}function mN(c){return this._isUTC&&(this.utcOffset(0,c),this._isUTC=!1,c&&this.subtract(Im(this),"m")),this}function pN(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var c=Om(An,this._i);c!=null?this.utcOffset(c):this.utcOffset(0,!0)}return this}function gN(c){return this.isValid()?(c=c?jt(c).utcOffset():0,(this.utcOffset()-c)%60===0):!1}function vN(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function wN(){if(!a(this._isDSTShifted))return this._isDSTShifted;var c={},h;return F(c,this),c=vS(c),c._a?(h=c._isUTC?p(c._a):jt(c._a),this._isDSTShifted=this.isValid()&&cN(c._a,h.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function xN(){return this.isValid()?!this._isUTC:!1}function SN(){return this.isValid()?this._isUTC:!1}function CS(){return this.isValid()?this._isUTC&&this._offset===0:!1}var CN=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,yN=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Oi(c,h){var v=c,C=null,b,W,ae;return bf(c)?v={ms:c._milliseconds,d:c._days,M:c._months}:l(c)||!isNaN(+c)?(v={},h?v[h]=+c:v.milliseconds=+c):(C=CN.exec(c))?(b=C[1]==="-"?-1:1,v={y:0,d:nt(C[E])*b,h:nt(C[I])*b,m:nt(C[R])*b,s:nt(C[A])*b,ms:nt(Rm(C[k]*1e3))*b}):(C=yN.exec(c))?(b=C[1]==="-"?-1:1,v={y:ea(C[2],b),M:ea(C[3],b),w:ea(C[4],b),d:ea(C[5],b),h:ea(C[6],b),m:ea(C[7],b),s:ea(C[8],b)}):v==null?v={}:typeof v=="object"&&("from"in v||"to"in v)&&(ae=_N(jt(v.from),jt(v.to)),v={},v.ms=ae.milliseconds,v.M=ae.months),W=new Tf(v),bf(c)&&s(c,"_locale")&&(W._locale=c._locale),bf(c)&&s(c,"_isValid")&&(W._isValid=c._isValid),W}Oi.fn=Tf.prototype,Oi.invalid=lN;function ea(c,h){var v=c&&parseFloat(c.replace(",","."));return(isNaN(v)?0:v)*h}function yS(c,h){var v={};return v.months=h.month()-c.month()+(h.year()-c.year())*12,c.clone().add(v.months,"M").isAfter(h)&&--v.months,v.milliseconds=+h-+c.clone().add(v.months,"M"),v}function _N(c,h){var v;return c.isValid()&&h.isValid()?(h=Am(h,c),c.isBefore(h)?v=yS(c,h):(v=yS(h,c),v.milliseconds=-v.milliseconds,v.months=-v.months),v):{milliseconds:0,months:0}}function _S(c,h){return function(v,C){var b,W;return C!==null&&!isNaN(+C)&&(ne(h,"moment()."+h+"(period, number) is deprecated. Please use moment()."+h+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),W=v,v=C,C=W),b=Oi(v,C),ES(this,b,c),this}}function ES(c,h,v,C){var b=h._milliseconds,W=Rm(h._days),ae=Rm(h._months);c.isValid()&&(C=C??!0,ae&&oS(c,O(c,"Month")+ae*v),W&&q(c,"Date",O(c,"Date")+W*v),b&&c._d.setTime(c._d.valueOf()+b*v),C&&e.updateOffset(c,W||ae))}var EN=_S(1,"add"),TN=_S(-1,"subtract");function TS(c){return typeof c=="string"||c instanceof String}function bN(c){return he(c)||u(c)||TS(c)||l(c)||ON(c)||RN(c)||c===null||c===void 0}function RN(c){var h=i(c)&&!o(c),v=!1,C=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],b,W,ae=C.length;for(b=0;b<ae;b+=1)W=C[b],v=v||s(c,W);return h&&v}function ON(c){var h=n(c),v=!1;return h&&(v=c.filter(function(C){return!l(C)&&TS(c)}).length===0),h&&v}function AN(c){var h=i(c)&&!o(c),v=!1,C=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],b,W;for(b=0;b<C.length;b+=1)W=C[b],v=v||s(c,W);return h&&v}function IN(c,h){var v=c.diff(h,"days",!0);return v<-6?"sameElse":v<-1?"lastWeek":v<0?"lastDay":v<1?"sameDay":v<2?"nextDay":v<7?"nextWeek":"sameElse"}function kN(c,h){arguments.length===1&&(arguments[0]?bN(arguments[0])?(c=arguments[0],h=void 0):AN(arguments[0])&&(h=arguments[0],c=void 0):(c=void 0,h=void 0));var v=c||jt(),C=Am(v,this).startOf("day"),b=e.calendarFormat(this,C)||"sameElse",W=h&&(ie(h[b])?h[b].call(this,v):h[b]);return this.format(W||this.localeData().calendar(b,this,jt(v)))}function MN(){return new Q(this)}function FN(c,h){var v=he(c)?c:jt(c);return this.isValid()&&v.isValid()?(h=Xe(h)||"millisecond",h==="millisecond"?this.valueOf()>v.valueOf():v.valueOf()<this.clone().startOf(h).valueOf()):!1}function DN(c,h){var v=he(c)?c:jt(c);return this.isValid()&&v.isValid()?(h=Xe(h)||"millisecond",h==="millisecond"?this.valueOf()<v.valueOf():this.clone().endOf(h).valueOf()<v.valueOf()):!1}function PN(c,h,v,C){var b=he(c)?c:jt(c),W=he(h)?h:jt(h);return this.isValid()&&b.isValid()&&W.isValid()?(C=C||"()",(C[0]==="("?this.isAfter(b,v):!this.isBefore(b,v))&&(C[1]===")"?this.isBefore(W,v):!this.isAfter(W,v))):!1}function NN(c,h){var v=he(c)?c:jt(c),C;return this.isValid()&&v.isValid()?(h=Xe(h)||"millisecond",h==="millisecond"?this.valueOf()===v.valueOf():(C=v.valueOf(),this.clone().startOf(h).valueOf()<=C&&C<=this.clone().endOf(h).valueOf())):!1}function HN(c,h){return this.isSame(c,h)||this.isAfter(c,h)}function LN(c,h){return this.isSame(c,h)||this.isBefore(c,h)}function BN(c,h,v){var C,b,W;if(!this.isValid())return NaN;if(C=Am(c,this),!C.isValid())return NaN;switch(b=(C.utcOffset()-this.utcOffset())*6e4,h=Xe(h),h){case"year":W=Rf(this,C)/12;break;case"month":W=Rf(this,C);break;case"quarter":W=Rf(this,C)/3;break;case"second":W=(this-C)/1e3;break;case"minute":W=(this-C)/6e4;break;case"hour":W=(this-C)/36e5;break;case"day":W=(this-C-b)/864e5;break;case"week":W=(this-C-b)/6048e5;break;default:W=this-C}return v?W:hr(W)}function Rf(c,h){if(c.date()<h.date())return-Rf(h,c);var v=(h.year()-c.year())*12+(h.month()-c.month()),C=c.clone().add(v,"months"),b,W;return h-C<0?(b=c.clone().add(v-1,"months"),W=(h-C)/(C-b)):(b=c.clone().add(v+1,"months"),W=(h-C)/(b-C)),-(v+W)||0}e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function VN(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function WN(c){if(!this.isValid())return null;var h=c!==!0,v=h?this.clone().utc():this;return v.year()<0||v.year()>9999?S(v,h?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ie(Date.prototype.toISOString)?h?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",S(v,"Z")):S(v,h?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function UN(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var c="moment",h="",v,C,b,W;return this.isLocal()||(c=this.utcOffset()===0?"moment.utc":"moment.parseZone",h="Z"),v="["+c+'("]',C=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",b="-MM-DD[T]HH:mm:ss.SSS",W=h+'[")]',this.format(v+C+b+W)}function jN(c){c||(c=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var h=S(this,c);return this.localeData().postformat(h)}function GN(c,h){return this.isValid()&&(he(c)&&c.isValid()||jt(c).isValid())?Oi({to:this,from:c}).locale(this.locale()).humanize(!h):this.localeData().invalidDate()}function zN(c){return this.from(jt(),c)}function YN(c,h){return this.isValid()&&(he(c)&&c.isValid()||jt(c).isValid())?Oi({from:this,to:c}).locale(this.locale()).humanize(!h):this.localeData().invalidDate()}function qN(c){return this.to(jt(),c)}function bS(c){var h;return c===void 0?this._locale._abbr:(h=Os(c),h!=null&&(this._locale=h),this)}var RS=X("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(c){return c===void 0?this.localeData():this.locale(c)});function OS(){return this._locale}var Of=1e3,Ka=60*Of,Af=60*Ka,AS=(365*400+97)*24*Af;function Za(c,h){return(c%h+h)%h}function IS(c,h,v){return c<100&&c>=0?new Date(c+400,h,v)-AS:new Date(c,h,v).valueOf()}function kS(c,h,v){return c<100&&c>=0?Date.UTC(c+400,h,v)-AS:Date.UTC(c,h,v)}function $N(c){var h,v;if(c=Xe(c),c===void 0||c==="millisecond"||!this.isValid())return this;switch(v=this._isUTC?kS:IS,c){case"year":h=v(this.year(),0,1);break;case"quarter":h=v(this.year(),this.month()-this.month()%3,1);break;case"month":h=v(this.year(),this.month(),1);break;case"week":h=v(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":h=v(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":h=v(this.year(),this.month(),this.date());break;case"hour":h=this._d.valueOf(),h-=Za(h+(this._isUTC?0:this.utcOffset()*Ka),Af);break;case"minute":h=this._d.valueOf(),h-=Za(h,Ka);break;case"second":h=this._d.valueOf(),h-=Za(h,Of);break}return this._d.setTime(h),e.updateOffset(this,!0),this}function XN(c){var h,v;if(c=Xe(c),c===void 0||c==="millisecond"||!this.isValid())return this;switch(v=this._isUTC?kS:IS,c){case"year":h=v(this.year()+1,0,1)-1;break;case"quarter":h=v(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":h=v(this.year(),this.month()+1,1)-1;break;case"week":h=v(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":h=v(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":h=v(this.year(),this.month(),this.date()+1)-1;break;case"hour":h=this._d.valueOf(),h+=Af-Za(h+(this._isUTC?0:this.utcOffset()*Ka),Af)-1;break;case"minute":h=this._d.valueOf(),h+=Ka-Za(h,Ka)-1;break;case"second":h=this._d.valueOf(),h+=Of-Za(h,Of)-1;break}return this._d.setTime(h),e.updateOffset(this,!0),this}function KN(){return this._d.valueOf()-(this._offset||0)*6e4}function ZN(){return Math.floor(this.valueOf()/1e3)}function JN(){return new Date(this.valueOf())}function QN(){var c=this;return[c.year(),c.month(),c.date(),c.hour(),c.minute(),c.second(),c.millisecond()]}function eH(){var c=this;return{years:c.year(),months:c.month(),date:c.date(),hours:c.hours(),minutes:c.minutes(),seconds:c.seconds(),milliseconds:c.milliseconds()}}function tH(){return this.isValid()?this.toISOString():null}function rH(){return y(this)}function nH(){return d({},x(this))}function iH(){return x(this).overflow}function sH(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}G("N",0,0,"eraAbbr"),G("NN",0,0,"eraAbbr"),G("NNN",0,0,"eraAbbr"),G("NNNN",0,0,"eraName"),G("NNNNN",0,0,"eraNarrow"),G("y",["y",1],"yo","eraYear"),G("y",["yy",2],0,"eraYear"),G("y",["yyy",3],0,"eraYear"),G("y",["yyyy",4],0,"eraYear"),Ce("N",km),Ce("NN",km),Ce("NNN",km),Ce("NNNN",gH),Ce("NNNNN",vH),gt(["N","NN","NNN","NNNN","NNNNN"],function(c,h,v,C){var b=v._locale.erasParse(c,C,v._strict);b?x(v).era=b:x(v).invalidEra=c}),Ce("y",Yr),Ce("yy",Yr),Ce("yyy",Yr),Ce("yyyy",Yr),Ce("yo",wH),gt(["y","yy","yyy","yyyy"],Ot),gt(["yo"],function(c,h,v,C){var b;v._locale._eraYearOrdinalRegex&&(b=c.match(v._locale._eraYearOrdinalRegex)),v._locale.eraYearOrdinalParse?h[Ot]=v._locale.eraYearOrdinalParse(c,b):h[Ot]=parseInt(c,10)});function oH(c,h){var v,C,b,W=this._eras||Os("en")._eras;for(v=0,C=W.length;v<C;++v){switch(typeof W[v].since){case"string":b=e(W[v].since).startOf("day"),W[v].since=b.valueOf();break}switch(typeof W[v].until){case"undefined":W[v].until=1/0;break;case"string":b=e(W[v].until).startOf("day").valueOf(),W[v].until=b.valueOf();break}}return W}function aH(c,h,v){var C,b,W=this.eras(),ae,Fe,je;for(c=c.toUpperCase(),C=0,b=W.length;C<b;++C)if(ae=W[C].name.toUpperCase(),Fe=W[C].abbr.toUpperCase(),je=W[C].narrow.toUpperCase(),v)switch(h){case"N":case"NN":case"NNN":if(Fe===c)return W[C];break;case"NNNN":if(ae===c)return W[C];break;case"NNNNN":if(je===c)return W[C];break}else if([ae,Fe,je].indexOf(c)>=0)return W[C]}function lH(c,h){var v=c.since<=c.until?1:-1;return h===void 0?e(c.since).year():e(c.since).year()+(h-c.offset)*v}function cH(){var c,h,v,C=this.localeData().eras();for(c=0,h=C.length;c<h;++c)if(v=this.clone().startOf("day").valueOf(),C[c].since<=v&&v<=C[c].until||C[c].until<=v&&v<=C[c].since)return C[c].name;return""}function uH(){var c,h,v,C=this.localeData().eras();for(c=0,h=C.length;c<h;++c)if(v=this.clone().startOf("day").valueOf(),C[c].since<=v&&v<=C[c].until||C[c].until<=v&&v<=C[c].since)return C[c].narrow;return""}function fH(){var c,h,v,C=this.localeData().eras();for(c=0,h=C.length;c<h;++c)if(v=this.clone().startOf("day").valueOf(),C[c].since<=v&&v<=C[c].until||C[c].until<=v&&v<=C[c].since)return C[c].abbr;return""}function hH(){var c,h,v,C,b=this.localeData().eras();for(c=0,h=b.length;c<h;++c)if(v=b[c].since<=b[c].until?1:-1,C=this.clone().startOf("day").valueOf(),b[c].since<=C&&C<=b[c].until||b[c].until<=C&&C<=b[c].since)return(this.year()-e(b[c].since).year())*v+b[c].offset;return this.year()}function dH(c){return s(this,"_erasNameRegex")||Mm.call(this),c?this._erasNameRegex:this._erasRegex}function mH(c){return s(this,"_erasAbbrRegex")||Mm.call(this),c?this._erasAbbrRegex:this._erasRegex}function pH(c){return s(this,"_erasNarrowRegex")||Mm.call(this),c?this._erasNarrowRegex:this._erasRegex}function km(c,h){return h.erasAbbrRegex(c)}function gH(c,h){return h.erasNameRegex(c)}function vH(c,h){return h.erasNarrowRegex(c)}function wH(c,h){return h._eraYearOrdinalRegex||Yr}function Mm(){var c=[],h=[],v=[],C=[],b,W,ae,Fe,je,mt=this.eras();for(b=0,W=mt.length;b<W;++b)ae=yt(mt[b].name),Fe=yt(mt[b].abbr),je=yt(mt[b].narrow),h.push(ae),c.push(Fe),v.push(je),C.push(ae),C.push(Fe),C.push(je);this._erasRegex=new RegExp("^("+C.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+h.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+c.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+v.join("|")+")","i")}G(0,["gg",2],0,function(){return this.weekYear()%100}),G(0,["GG",2],0,function(){return this.isoWeekYear()%100});function If(c,h){G(0,[c,c.length],0,h)}If("gggg","weekYear"),If("ggggg","weekYear"),If("GGGG","isoWeekYear"),If("GGGGG","isoWeekYear"),Ce("G",Sr),Ce("g",Sr),Ce("GG",Ke,qe),Ce("gg",Ke,qe),Ce("GGGG",xn,Kt),Ce("gggg",xn,Kt),Ce("GGGGG",Ir,Bt),Ce("ggggg",Ir,Bt),ns(["gggg","ggggg","GGGG","GGGGG"],function(c,h,v,C){h[C.substr(0,2)]=nt(c)}),ns(["gg","GG"],function(c,h,v,C){h[C]=e.parseTwoDigitYear(c)});function xH(c){return MS.call(this,c,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function SH(c){return MS.call(this,c,this.isoWeek(),this.isoWeekday(),1,4)}function CH(){return Rs(this.year(),1,4)}function yH(){return Rs(this.isoWeekYear(),1,4)}function _H(){var c=this.localeData()._week;return Rs(this.year(),c.dow,c.doy)}function EH(){var c=this.localeData()._week;return Rs(this.weekYear(),c.dow,c.doy)}function MS(c,h,v,C,b){var W;return c==null?vc(this,C,b).year:(W=Rs(c,C,b),h>W&&(h=W),TH.call(this,c,h,v,C,b))}function TH(c,h,v,C,b){var W=cS(c,h,v,C,b),ae=gc(W.year,0,W.dayOfYear);return this.year(ae.getUTCFullYear()),this.month(ae.getUTCMonth()),this.date(ae.getUTCDate()),this}G("Q",0,"Qo","quarter"),Ce("Q",xt),gt("Q",function(c,h){h[Mr]=(nt(c)-1)*3});function bH(c){return c==null?Math.ceil((this.month()+1)/3):this.month((c-1)*3+this.month()%3)}G("D",["DD",2],"Do","date"),Ce("D",Ke,yr),Ce("DD",Ke,qe),Ce("Do",function(c,h){return c?h._dayOfMonthOrdinalParse||h._ordinalParse:h._dayOfMonthOrdinalParseLenient}),gt(["D","DD"],E),gt("Do",function(c,h){h[E]=nt(c.match(Ke)[0])});var FS=j("Date",!0);G("DDD",["DDDD",3],"DDDo","dayOfYear"),Ce("DDD",fr),Ce("DDDD",zt),gt(["DDD","DDDD"],function(c,h,v){v._dayOfYear=nt(c)});function RH(c){var h=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return c==null?h:this.add(c-h,"d")}G("m",["mm",2],0,"minute"),Ce("m",Ke,In),Ce("mm",Ke,qe),gt(["m","mm"],R);var OH=j("Minutes",!1);G("s",["ss",2],0,"second"),Ce("s",Ke,In),Ce("ss",Ke,qe),gt(["s","ss"],A);var AH=j("Seconds",!1);G("S",0,0,function(){return~~(this.millisecond()/100)}),G(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),G(0,["SSS",3],0,"millisecond"),G(0,["SSSS",4],0,function(){return this.millisecond()*10}),G(0,["SSSSS",5],0,function(){return this.millisecond()*100}),G(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),G(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),G(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),G(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Ce("S",fr,xt),Ce("SS",fr,qe),Ce("SSS",fr,zt);var fo,DS;for(fo="SSSS";fo.length<=9;fo+="S")Ce(fo,Yr);function IH(c,h){h[k]=nt(("0."+c)*1e3)}for(fo="S";fo.length<=9;fo+="S")gt(fo,IH);DS=j("Milliseconds",!1),G("z",0,0,"zoneAbbr"),G("zz",0,0,"zoneName");function kH(){return this._isUTC?"UTC":""}function MH(){return this._isUTC?"Coordinated Universal Time":""}var Se=Q.prototype;Se.add=EN,Se.calendar=kN,Se.clone=MN,Se.diff=BN,Se.endOf=XN,Se.format=jN,Se.from=GN,Se.fromNow=zN,Se.to=YN,Se.toNow=qN,Se.get=ce,Se.invalidAt=iH,Se.isAfter=FN,Se.isBefore=DN,Se.isBetween=PN,Se.isSame=NN,Se.isSameOrAfter=HN,Se.isSameOrBefore=LN,Se.isValid=rH,Se.lang=RS,Se.locale=bS,Se.localeData=OS,Se.max=rN,Se.min=tN,Se.parsingFlags=nH,Se.set=de,Se.startOf=$N,Se.subtract=TN,Se.toArray=QN,Se.toObject=eH,Se.toDate=JN,Se.toISOString=WN,Se.inspect=UN,typeof Symbol<"u"&&Symbol.for!=null&&(Se[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Se.toJSON=tH,Se.toString=VN,Se.unix=ZN,Se.valueOf=KN,Se.creationData=sH,Se.eraName=cH,Se.eraNarrow=uH,Se.eraAbbr=fH,Se.eraYear=hH,Se.year=J,Se.isLeapYear=ee,Se.weekYear=xH,Se.isoWeekYear=SH,Se.quarter=Se.quarters=bH,Se.month=aS,Se.daysInMonth=JD,Se.week=Se.weeks=oP,Se.isoWeek=Se.isoWeeks=aP,Se.weeksInYear=_H,Se.weeksInWeekYear=EH,Se.isoWeeksInYear=CH,Se.isoWeeksInISOWeekYear=yH,Se.date=FS,Se.day=Se.days=SP,Se.weekday=CP,Se.isoWeekday=yP,Se.dayOfYear=RH,Se.hour=Se.hours=AP,Se.minute=Se.minutes=OH,Se.second=Se.seconds=AH,Se.millisecond=Se.milliseconds=DS,Se.utcOffset=fN,Se.utc=dN,Se.local=mN,Se.parseZone=pN,Se.hasAlignedHourOffset=gN,Se.isDST=vN,Se.isLocal=xN,Se.isUtcOffset=SN,Se.isUtc=CS,Se.isUTC=CS,Se.zoneAbbr=kH,Se.zoneName=MH,Se.dates=X("dates accessor is deprecated. Use date instead.",FS),Se.months=X("months accessor is deprecated. Use month instead",aS),Se.years=X("years accessor is deprecated. Use year instead",J),Se.zone=X("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",hN),Se.isDSTShifted=X("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",wN);function FH(c){return jt(c*1e3)}function DH(){return jt.apply(null,arguments).parseZone()}function PS(c){return c}var St=We.prototype;St.calendar=ut,St.longDateFormat=L,St.invalidDate=oe,St.ordinal=ve,St.preparse=PS,St.postformat=PS,St.relativeTime=Ie,St.pastFuture=pe,St.set=te,St.eras=oH,St.erasParse=aH,St.erasConvertYear=lH,St.erasAbbrRegex=mH,St.erasNameRegex=dH,St.erasNarrowRegex=pH,St.months=oi,St.monthsShort=pc,St.monthsParse=ZD,St.monthsRegex=eP,St.monthsShortRegex=QD,St.week=rP,St.firstDayOfYear=sP,St.firstDayOfWeek=iP,St.weekdays=pP,St.weekdaysMin=vP,St.weekdaysShort=gP,St.weekdaysParse=xP,St.weekdaysRegex=_P,St.weekdaysShortRegex=EP,St.weekdaysMinRegex=TP,St.isPM=RP,St.meridiem=IP;function kf(c,h,v,C){var b=Os(),W=p().set(C,h);return b[v](W,c)}function NS(c,h,v){if(l(c)&&(h=c,c=void 0),c=c||"",h!=null)return kf(c,h,v,"month");var C,b=[];for(C=0;C<12;C++)b[C]=kf(c,C,v,"month");return b}function Fm(c,h,v,C){typeof c=="boolean"?(l(h)&&(v=h,h=void 0),h=h||""):(h=c,v=h,c=!1,l(h)&&(v=h,h=void 0),h=h||"");var b=Os(),W=c?b._week.dow:0,ae,Fe=[];if(v!=null)return kf(h,(v+W)%7,C,"day");for(ae=0;ae<7;ae++)Fe[ae]=kf(h,(ae+W)%7,C,"day");return Fe}function PH(c,h){return NS(c,h,"months")}function NH(c,h){return NS(c,h,"monthsShort")}function HH(c,h,v){return Fm(c,h,v,"weekdays")}function LH(c,h,v){return Fm(c,h,v,"weekdaysShort")}function BH(c,h,v){return Fm(c,h,v,"weekdaysMin")}uo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(c){var h=c%10,v=nt(c%100/10)===1?"th":h===1?"st":h===2?"nd":h===3?"rd":"th";return c+v}}),e.lang=X("moment.lang is deprecated. Use moment.locale instead.",uo),e.langData=X("moment.langData is deprecated. Use moment.localeData instead.",Os);var As=Math.abs;function VH(){var c=this._data;return this._milliseconds=As(this._milliseconds),this._days=As(this._days),this._months=As(this._months),c.milliseconds=As(c.milliseconds),c.seconds=As(c.seconds),c.minutes=As(c.minutes),c.hours=As(c.hours),c.months=As(c.months),c.years=As(c.years),this}function HS(c,h,v,C){var b=Oi(h,v);return c._milliseconds+=C*b._milliseconds,c._days+=C*b._days,c._months+=C*b._months,c._bubble()}function WH(c,h){return HS(this,c,h,1)}function UH(c,h){return HS(this,c,h,-1)}function LS(c){return c<0?Math.floor(c):Math.ceil(c)}function jH(){var c=this._milliseconds,h=this._days,v=this._months,C=this._data,b,W,ae,Fe,je;return c>=0&&h>=0&&v>=0||c<=0&&h<=0&&v<=0||(c+=LS(Dm(v)+h)*864e5,h=0,v=0),C.milliseconds=c%1e3,b=hr(c/1e3),C.seconds=b%60,W=hr(b/60),C.minutes=W%60,ae=hr(W/60),C.hours=ae%24,h+=hr(ae/24),je=hr(BS(h)),v+=je,h-=LS(Dm(je)),Fe=hr(v/12),v%=12,C.days=h,C.months=v,C.years=Fe,this}function BS(c){return c*4800/146097}function Dm(c){return c*146097/4800}function GH(c){if(!this.isValid())return NaN;var h,v,C=this._milliseconds;if(c=Xe(c),c==="month"||c==="quarter"||c==="year")switch(h=this._days+C/864e5,v=this._months+BS(h),c){case"month":return v;case"quarter":return v/3;case"year":return v/12}else switch(h=this._days+Math.round(Dm(this._months)),c){case"week":return h/7+C/6048e5;case"day":return h+C/864e5;case"hour":return h*24+C/36e5;case"minute":return h*1440+C/6e4;case"second":return h*86400+C/1e3;case"millisecond":return Math.floor(h*864e5)+C;default:throw new Error("Unknown unit "+c)}}function Is(c){return function(){return this.as(c)}}var VS=Is("ms"),zH=Is("s"),YH=Is("m"),qH=Is("h"),$H=Is("d"),XH=Is("w"),KH=Is("M"),ZH=Is("Q"),JH=Is("y"),QH=VS;function eL(){return Oi(this)}function tL(c){return c=Xe(c),this.isValid()?this[c+"s"]():NaN}function ta(c){return function(){return this.isValid()?this._data[c]:NaN}}var rL=ta("milliseconds"),nL=ta("seconds"),iL=ta("minutes"),sL=ta("hours"),oL=ta("days"),aL=ta("months"),lL=ta("years");function cL(){return hr(this.days()/7)}var ks=Math.round,Ja={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function uL(c,h,v,C,b){return b.relativeTime(h||1,!!v,c,C)}function fL(c,h,v,C){var b=Oi(c).abs(),W=ks(b.as("s")),ae=ks(b.as("m")),Fe=ks(b.as("h")),je=ks(b.as("d")),mt=ks(b.as("M")),Sn=ks(b.as("w")),Ms=ks(b.as("y")),ho=W<=v.ss&&["s",W]||W<v.s&&["ss",W]||ae<=1&&["m"]||ae<v.m&&["mm",ae]||Fe<=1&&["h"]||Fe<v.h&&["hh",Fe]||je<=1&&["d"]||je<v.d&&["dd",je];return v.w!=null&&(ho=ho||Sn<=1&&["w"]||Sn<v.w&&["ww",Sn]),ho=ho||mt<=1&&["M"]||mt<v.M&&["MM",mt]||Ms<=1&&["y"]||["yy",Ms],ho[2]=h,ho[3]=+c>0,ho[4]=C,uL.apply(null,ho)}function hL(c){return c===void 0?ks:typeof c=="function"?(ks=c,!0):!1}function dL(c,h){return Ja[c]===void 0?!1:h===void 0?Ja[c]:(Ja[c]=h,c==="s"&&(Ja.ss=h-1),!0)}function mL(c,h){if(!this.isValid())return this.localeData().invalidDate();var v=!1,C=Ja,b,W;return typeof c=="object"&&(h=c,c=!1),typeof c=="boolean"&&(v=c),typeof h=="object"&&(C=Object.assign({},Ja,h),h.s!=null&&h.ss==null&&(C.ss=h.s-1)),b=this.localeData(),W=fL(this,!v,C,b),v&&(W=b.pastFuture(+this,W)),b.postformat(W)}var Pm=Math.abs;function Qa(c){return(c>0)-(c<0)||+c}function Mf(){if(!this.isValid())return this.localeData().invalidDate();var c=Pm(this._milliseconds)/1e3,h=Pm(this._days),v=Pm(this._months),C,b,W,ae,Fe=this.asSeconds(),je,mt,Sn,Ms;return Fe?(C=hr(c/60),b=hr(C/60),c%=60,C%=60,W=hr(v/12),v%=12,ae=c?c.toFixed(3).replace(/\.?0+$/,""):"",je=Fe<0?"-":"",mt=Qa(this._months)!==Qa(Fe)?"-":"",Sn=Qa(this._days)!==Qa(Fe)?"-":"",Ms=Qa(this._milliseconds)!==Qa(Fe)?"-":"",je+"P"+(W?mt+W+"Y":"")+(v?mt+v+"M":"")+(h?Sn+h+"D":"")+(b||C||c?"T":"")+(b?Ms+b+"H":"")+(C?Ms+C+"M":"")+(c?Ms+ae+"S":"")):"P0D"}var vt=Tf.prototype;vt.isValid=aN,vt.abs=VH,vt.add=WH,vt.subtract=UH,vt.as=GH,vt.asMilliseconds=VS,vt.asSeconds=zH,vt.asMinutes=YH,vt.asHours=qH,vt.asDays=$H,vt.asWeeks=XH,vt.asMonths=KH,vt.asQuarters=ZH,vt.asYears=JH,vt.valueOf=QH,vt._bubble=jH,vt.clone=eL,vt.get=tL,vt.milliseconds=rL,vt.seconds=nL,vt.minutes=iL,vt.hours=sL,vt.days=oL,vt.weeks=cL,vt.months=aL,vt.years=lL,vt.humanize=mL,vt.toISOString=Mf,vt.toString=Mf,vt.toJSON=Mf,vt.locale=bS,vt.localeData=OS,vt.toIsoString=X("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Mf),vt.lang=RS,G("X",0,0,"unix"),G("x",0,0,"valueOf"),Ce("x",Sr),Ce("X",qn),gt("X",function(c,h,v){v._d=new Date(parseFloat(c)*1e3)}),gt("x",function(c,h,v){v._d=new Date(nt(c))});return e.version="2.30.1",r(jt),e.fn=Se,e.min=nN,e.max=iN,e.now=sN,e.utc=p,e.unix=FH,e.months=PH,e.isDate=u,e.locale=uo,e.invalid=P,e.duration=Oi,e.isMoment=he,e.weekdays=HH,e.parseZone=DH,e.localeData=Os,e.isDuration=bf,e.monthsShort=NH,e.weekdaysMin=BH,e.defineLocale=ym,e.updateLocale=DP,e.locales=PP,e.weekdaysShort=LH,e.normalizeUnits=Xe,e.relativeTimeRounding=hL,e.relativeTimeThreshold=dL,e.calendarFormat=IN,e.prototype=Se,e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},e})});var DR=Y(()=>{"use strict";var kU=Nt(),MU=fa(),FU=Dn(),DU=Dr(),PU=Ns(),NU=Nn(),HU=yo(),LU=cl(),BU=nr(),MR=TypeError,FR=BU(function(){[].keys().reduce(function(){},void 0)}),kg=!FR&&HU("reduce",MR);kU({target:"Iterator",proto:!0,real:!0,forced:FR||kg},{reduce:function(e){DU(this);try{FU(e)}catch(o){NU(this,"throw",o)}var r=arguments.length<2,n=r?void 0:arguments[1];if(kg)return LU(kg,this,r?[e]:[e,n]);var i=PU(this),s=0;if(MU(i,function(o){r?(r=!1,n=o):n=e(n,o,s),s++},{IS_RECORD:!0}),r)throw new MR("Reduce of empty iterator with no initial value");return n}})});var Vc=Y(()=>{"use strict";DR()});var JR=Y((_oe,ZR)=>{"use strict";var jU=Fn(),GU=eh().get;ZR.exports=function(e){if(!jU(e))return!1;var r=GU(e);return!!r&&r.type==="RawJSON"}});var n2=Y((Eoe,r2)=>{"use strict";var Bg=ir(),zU=Pn(),Fh=SyntaxError,YU=parseInt,qU=String.fromCharCode,$U=Bg("".charAt),QR=Bg("".slice),e2=Bg(/./.exec),t2={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},XU=/^[\da-f]{4}$/i,KU=/^[\u0000-\u001F]$/;r2.exports=function(t,e){for(var r=!0,n="";e<t.length;){var i=$U(t,e);if(i==="\\"){var s=QR(t,e,e+2);if(zU(t2,s))n+=t2[s],e+=2;else if(s==="\\u"){e+=2;var o=QR(t,e,e+4);if(!e2(XU,o))throw new Fh("Bad Unicode escape at: "+e);n+=qU(YU(o,16)),e+=4}else throw new Fh('Unknown escape sequence: "'+s+'"')}else if(i==='"'){r=!1,e++;break}else{if(e2(KU,i))throw new Fh("Bad control character in string literal at: "+e);n+=i,e++}}if(r)throw new Fh("Unterminated string at: "+e);return{value:n,end:e}}});var s2=Y((Toe,i2)=>{"use strict";var ZU=nr();i2.exports=!ZU(function(){var t="9007199254740993",e=JSON.rawJSON(t);return!JSON.isRawJSON(e)||JSON.stringify(e)!==t})});var x2=Y(()=>{"use strict";var JU=Nt(),d2=sa(),QU=cl(),m2=Fr(),da=ir(),p2=nr(),o2=Ip(),Ph=Er(),e9=JR(),a2=Gf(),l2=go(),t9=kc(),r9=gh(),n9=n2(),i9=qf(),s9=jf(),Vg=s2(),g2=String,Eo=d2("JSON","stringify"),Dh=da(/./.exec),Ug=da("".charAt),o9=da("".charCodeAt),a9=da("".replace),Wg=da("".slice),jg=da([].push),l9=da(1.1.toString),c9=/[\uD800-\uDFFF]/g,c2=/^[\uD800-\uDBFF]$/,u2=/^[\uDC00-\uDFFF]$/,Gg=i9(),f2=Gg.length,v2=!s9||p2(function(){var t=d2("Symbol")("stringify detection");return Eo([t])!=="[null]"||Eo({a:t})!=="{}"||Eo(Object(t))!=="{}"}),h2=p2(function(){return Eo("\uDF06\uD834")!=='"\\udf06\\ud834"'||Eo("\uDEAD")!=='"\\udead"'}),u9=v2?function(t,e){var r=r9(arguments),n=w2(e);if(!(!Ph(n)&&(t===void 0||a2(t))))return r[1]=function(i,s){if(Ph(n)&&(s=m2(n,this,g2(i),s)),!a2(s))return s},QU(Eo,null,r)}:Eo,f9=function(t,e,r){var n=Ug(r,e-1),i=Ug(r,e+1);return Dh(c2,t)&&!Dh(u2,i)||Dh(u2,t)&&!Dh(c2,n)?"\\u"+l9(o9(t,0),16):t},w2=function(t){if(Ph(t))return t;if(o2(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?jg(r,i):(typeof i=="number"||l2(i)==="Number"||l2(i)==="String")&&jg(r,t9(i))}var s=r.length,o=!0;return function(a,l){if(o)return o=!1,l;if(o2(this))return l;for(var u=0;u<s;u++)if(r[u]===a)return l}}};Eo&&JU({target:"JSON",stat:!0,arity:3,forced:v2||h2||!Vg},{stringify:function(e,r,n){var i=w2(r),s=[],o=u9(e,function(g,x){var w=Ph(i)?m2(i,this,g2(g),x):x;return!Vg&&e9(w)?Gg+(jg(s,w.rawJSON)-1):w},n);if(typeof o!="string"||(h2&&(o=a9(o,c9,f9)),Vg))return o;for(var a="",l=o.length,u=0;u<l;u++){var f=Ug(o,u);if(f==='"'){var d=n9(o,++u).end-1,p=Wg(o,u,d);a+=Wg(p,0,f2)===Gg?s[Wg(p,f2)]:'"'+p+'"',u=d}else a+=f}return a}})});var Z2=Y((iae,K2)=>{"use strict";var w9=ca();K2.exports=function(t,e,r){for(var n=0,i=arguments.length>2?r:w9(e),s=new t(i);i>n;)s[n]=e[n++];return s}});var Q2=Y((sae,J2)=>{"use strict";var x9=rr();J2.exports=function(t,e){var r=x9[t],n=r&&r.prototype;return n&&n[e]}});var Kh=Y((oae,eO)=>{"use strict";var S9=ui(),C9=dh(),y9=Ps().f,Qg=S9("unscopables"),ev=Array.prototype;ev[Qg]===void 0&&y9(ev,Qg,{configurable:!0,value:C9(null)});eO.exports=function(t){ev[Qg][t]=!0}});var tO=Y(()=>{"use strict";var _9=Nt(),E9=ir(),T9=Dn(),b9=il(),R9=Z2(),O9=Q2(),A9=Kh(),I9=Array,k9=E9(O9("Array","sort"));_9({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&T9(e);var r=b9(this),n=R9(I9,r);return k9(n,e)}});A9("toSorted")});var rO=Y(()=>{"use strict";var M9=Nt(),F9=Fr(),D9=fa(),P9=Dn(),N9=Dr(),H9=Ns(),L9=Nn(),B9=yo(),tv=B9("find",TypeError);M9({target:"Iterator",proto:!0,real:!0,forced:tv},{find:function(e){N9(this);try{P9(e)}catch(i){L9(this,"throw",i)}if(tv)return F9(tv,this,e);var r=H9(this),n=0;return D9(r,function(i,s){if(e(i,n++))return s(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})});var rv=Y(()=>{"use strict";rO()});var dO=Y((nle,hO)=>{"use strict";var o7=Fn(),a7=go(),l7=ui(),c7=l7("match");hO.exports=function(t){var e;return o7(t)&&((e=t[c7])!==void 0?!!e:a7(t)==="RegExp")}});var gO=Y((ile,pO)=>{"use strict";var u7=rr(),f7=nr(),mO=u7.RegExp,h7=!f7(function(){var t=!0;try{mO(".","d")}catch{t=!1}var e={},r="",n=t?"dgimsy":"gimsy",i=function(l,u){Object.defineProperty(e,l,{get:function(){return r+=u,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};t&&(s.hasIndices="d");for(var o in s)i(o,s[o]);var a=Object.getOwnPropertyDescriptor(mO.prototype,"flags").get.call(e);return a!==n||r!==n});pO.exports={correct:h7}});var wO=Y((sle,vO)=>{"use strict";var d7=Dr();vO.exports=function(){var t=d7(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}});var CO=Y((ole,SO)=>{"use strict";var m7=Fr(),p7=Pn(),g7=sl(),xO=gO(),v7=wO(),w7=RegExp.prototype;SO.exports=xO.correct?function(t){return t.flags}:function(t){return!xO.correct&&g7(w7,t)&&!p7(t,"flags")?m7(v7,t):t.flags}});var _O=Y((ale,yO)=>{"use strict";var mv=ir(),x7=oa(),S7=Math.floor,hv=mv("".charAt),C7=mv("".replace),dv=mv("".slice),y7=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,_7=/\$([$&'`]|\d{1,2})/g;yO.exports=function(t,e,r,n,i,s){var o=r+t.length,a=n.length,l=_7;return i!==void 0&&(i=x7(i),l=y7),C7(s,l,function(u,f){var d;switch(hv(f,0)){case"$":return"$";case"&":return t;case"`":return dv(e,0,r);case"'":return dv(e,o);case"<":d=i[dv(f,1,-1)];break;default:var p=+f;if(p===0)return u;if(p>a){var g=S7(p/10);return g===0?u:g<=a?n[g-1]===void 0?hv(f,1):n[g-1]+hv(f,1):u}d=n[p-1]}return d===void 0?"":d})}});var bO=Y(()=>{"use strict";var E7=Nt(),T7=Fr(),gv=ir(),EO=nl(),b7=Er(),R7=Fn(),O7=dO(),Cl=kc(),A7=ol(),I7=CO(),k7=_O(),M7=ui(),F7=vo(),D7=M7("replace"),P7=TypeError,pv=gv("".indexOf),N7=gv("".replace),TO=gv("".slice),H7=Math.max;E7({target:"String",proto:!0},{replaceAll:function(e,r){var n=EO(this),i,s,o,a,l,u,f,d,p,g,x=0,w="";if(R7(e)){if(i=O7(e),i&&(s=Cl(EO(I7(e))),!~pv(s,"g")))throw new P7("`.replaceAll` does not allow non-global regexes");if(o=A7(e,D7),o)return T7(o,e,n,r);if(F7&&i)return N7(Cl(n),e,r)}for(a=Cl(n),l=Cl(e),u=b7(r),u||(r=Cl(r)),f=l.length,d=H7(1,f),p=pv(a,l);p!==-1;)g=u?Cl(r(l,p,a)):k7(l,a,p,[],void 0,r),w+=TO(a,x,p)+g,x=p+f,p=p+d>a.length?-1:pv(a,l,p+d);return x<a.length&&(w+=TO(a,x)),w}})});var Jc=Y(()=>{"use strict";var tj=Nt(),rj=oa(),nj=ca(),ij=ll(),sj=Kh();tj({target:"Array",proto:!0},{at:function(e){var r=rj(this),n=nj(r),i=ij(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:r[s]}});sj("at")});var Qc=Y(()=>{"use strict";var oj=Nt(),aj=ir(),lj=nl(),cj=ll(),uj=kc(),fj=nr(),hj=aj("".charAt),dj=fj(function(){return"\u{20BB7}".at(-2)!=="\uD842"});oj({target:"String",proto:!0,forced:dj},{at:function(e){var r=uj(lj(this)),n=r.length,i=cj(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:hj(r,s)}})});var KO=Y((Pue,XO)=>{"use strict";var $O=Oc(),tG=TypeError;XO.exports=function(t,e){if(!delete t[e])throw new tG("Cannot delete property "+$O(e)+" of "+$O(t))}});var ZO=Y(()=>{"use strict";var rG=Nt(),nG=oa(),iG=ca(),sG=kp(),oG=KO(),aG=Mp(),lG=[].unshift(0)!==1,cG=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},uG=lG||!cG();rG({target:"Array",proto:!0,arity:1,forced:uG},{unshift:function(e){var r=nG(this),n=iG(r),i=arguments.length;if(i){aG(n+i);for(var s=n;s--;){var o=s+i;s in r?r[o]=r[s]:oG(r,o)}for(var a=0;a<i;a++)r[a]=arguments[a]}return sG(r,n+i)}})});var vA=Y(()=>{"use strict";var iz=Kh();iz("flat")});var jA=Y(()=>{"use strict";var Az=Nt(),Iz=Fr(),kz=fa(),Mz=Dn(),Fz=Dr(),Dz=Ns(),Pz=Nn(),Nz=yo(),Yv=Nz("every",TypeError);Az({target:"Iterator",proto:!0,real:!0,forced:Yv},{every:function(e){Fz(this);try{Mz(e)}catch(i){Pz(this,"throw",i)}if(Yv)return Iz(Yv,this,e);var r=Dz(this),n=0;return!kz(r,function(i,s){if(!e(i,n++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})});var GA=Y(()=>{"use strict";jA()});var $A=Y(()=>{"use strict";var Vz=Nt(),Wz=Fr(),Uz=fa(),jz=Dn(),Gz=Dr(),zz=Ns(),Yz=Nn(),qz=yo(),$v=qz("some",TypeError);Vz({target:"Iterator",proto:!0,real:!0,forced:$v},{some:function(e){Gz(this);try{jz(e)}catch(i){Yz(this,"throw",i)}if($v)return Wz($v,this,e);var r=zz(this),n=0;return Uz(r,function(i,s){if(e(i,n++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})});var Bo=Y(()=>{"use strict";$A()});var gL=(()=>{class t{constructor(){this.vcr=ai(el)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=Ds({type:t,selectors:[["ag-component-container"]],standalone:!1,decls:0,vars:0,template:function(n,i){},encapsulation:2})}}return t})(),VC=16,Gm=0;function vL(t){let e=new Map;for(let r=0;r<VC;r++){let n=t.createComponent(gL);e.set(r,n),Nm(n.location.nativeElement)}return e}var wL=new Set(["doesFilterPass","isFilterActive"]),HC=(()=>{class t extends qS{setViewContainerRef(r,n){this.viewContainerRef=r,this.angularFrameworkOverrides=n}createWrapper(r){let n=this.angularFrameworkOverrides,i=this;i.compShards??=vL(this.viewContainerRef);class s extends zm{init(l){n.runInsideAngular(()=>{super.init(l),this._componentRef.changeDetectorRef.detectChanges()})}createComponent(){return i.createComponent(r)}hasMethod(l){return o.getFrameworkComponentInstance()[l]!=null}callMethod(l,u){let f=this.getFrameworkComponentInstance(),d=f[l];return wL.has(l)?d.apply(f,u):n.runInsideAngular(()=>d.apply(f,u))}addMethod(l,u){o[l]=u}}let o=new s;return o}createComponent(r){return Gm=(Gm+1)%VC,this.compShards.get(Gm).instance.vcr.createComponent(r)}static{this.\u0275fac=(()=>{let r;return function(i){return(r||(r=KS(t)))(i||t)}})()}static{this.\u0275prov=ra({token:t,factory:t.\u0275fac})}}return t})(),zm=class{init(e){this._params=e,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,Nm(this._eGui),this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}getRootElement(){return this._eGui.firstChild}destroy(){this._frameworkComponentInstance&&typeof this._frameworkComponentInstance.destroy=="function"&&this._frameworkComponentInstance.destroy(),this._componentRef?.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}},Bf=class{constructor(e){this.frameworkOverrides=e,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(e,r){let{frameworkOverrides:n,wrappedListeners:i}=this,s=r;if(n.shouldWrapOutgoing){s=a=>{n.wrapOutgoing(()=>r(a))};let o=i.get(e);o||(o=new Map,i.set(e,o)),o.set(r,s)}return s}wrapGlobal(e){let{frameworkOverrides:r,wrappedGlobalListeners:n}=this,i=e;return r.shouldWrapOutgoing&&(i=(s,o)=>{r.wrapOutgoing(()=>e(s,o))},n.set(e,i)),i}unwrap(e,r){let{wrappedListeners:n}=this,i=n.get(e);if(i){let s=i.get(r);if(s)return i.delete(r),i.size===0&&n.delete(e),s}return r}unwrapGlobal(e){let{wrappedGlobalListeners:r}=this,n=r.get(e);return n?(r.delete(e),n):e}},LC=(()=>{class t extends zS{constructor(r){super("angular"),this._ngZone=r,this.batchFrameworkComps=!0,this.isRunningWithinTestZone=!1,this.wrapIncoming=(n,i)=>this.runOutside(n,i),this.wrapOutgoing=n=>this.runInsideAngular(n),this.isRunningWithinTestZone=window?.AG_GRID_UNDER_TEST??!!window?.Zone?.AsyncTestZoneSpec,this._ngZone?this.isRunningWithinTestZone?this.runOutside=(n,i)=>i==="resize-observer"||i==="popupPositioning"?this._ngZone.runOutsideAngular(n):n():this.runOutside=n=>this._ngZone.runOutsideAngular(n):this.runOutside=n=>n()}get shouldWrapOutgoing(){return this._ngZone&&na.isInAngularZone()}createLocalEventListenerWrapper(r,n){if(this.shouldWrapOutgoing)return r??(n.setFrameworkOverrides(this),new Bf(this))}createGlobalEventListenerWrapper(){return new Bf(this)}isFrameworkComponent(r){if(!r)return!1;let n=r.prototype;return n&&"agInit"in n}runInsideAngular(r){return!this._ngZone||na.isInAngularZone()?r():this._ngZone.run(r)}runOutsideAngular(r,n){return this.runOutside(r,n)}static{this.\u0275fac=function(n){return new(n||t)(mo(na))}}static{this.\u0275prov=ra({token:t,factory:t.\u0275fac})}}return t})(),WC=(()=>{class t{constructor(r,n,i,s){this._viewContainerRef=n,this._angularFrameworkOverrides=i,this._frameworkCompWrapper=s,this._initialised=!1,this._destroyed=!1,this._holdEvents=!0,this._fullyReady=new Promise(o=>{this._resolveFullyReady=o}),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.columnMenu=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipTrigger=void 0,this.tooltipShowDelay=void 0,this.tooltipSwitchShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.tooltipShowMode=void 0,this.tooltipInteraction=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressCopySingleCellRanges=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.suppressCutToClipboard=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.dataTypeDefinitions=void 0,this.maintainColumnOrder=void 0,this.enableStrictPivotColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.hidePaddedHeaderRows=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressMoveWhenColumnDragging=void 0,this.suppressDragLeaveHidesColumns=void 0,this.suppressGroupChangesColumnVisibility=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.suppressRowGroupHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.autoSizeStrategy=void 0,this.animateColumnResizing=void 0,this.components=void 0,this.editType=void 0,this.suppressStartEditOnTab=void 0,this.getFullRowEditValidationErrors=void 0,this.invalidEditValueMode=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterNavigatesVertically=void 0,this.enterNavigatesVerticallyAfterEdit=void 0,this.enableCellEditingOnBackspace=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.findSearchValue=void 0,this.findOptions=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.includeHiddenColumnsInQuickFilter=void 0,this.quickFilterParser=void 0,this.quickFilterMatcher=void 0,this.applyQuickFilterBeforePivotOrAgg=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableAdvancedFilter=void 0,this.alwaysPassFilter=void 0,this.includeHiddenColumnsInAdvancedFilter=void 0,this.advancedFilterParent=void 0,this.advancedFilterBuilderParams=void 0,this.advancedFilterParams=void 0,this.suppressAdvancedFilterEval=void 0,this.suppressSetFilterByDefault=void 0,this.enableFilterHandlers=void 0,this.filterHandlers=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.chartToolPanelsDef=void 0,this.chartMenuItems=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.loading=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.suppressOverlays=void 0,this.overlayComponent=void 0,this.overlayComponentParams=void 0,this.overlayComponentSelector=void 0,this.activeOverlay=void 0,this.activeOverlayParams=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationPageSizeSelector=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotMaxGeneratedColumns=void 0,this.pivotDefaultExpanded=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.formulaDataSource=void 0,this.formulaFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.alwaysAggregateAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.removePivotHeaderRowWhenSingleValueColumn=void 0,this.animateRows=void 0,this.cellFlashDuration=void 0,this.cellFadeDuration=void 0,this.allowShowChangeAfterFilter=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableCellSpan=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.refreshAfterGroupEdit=void 0,this.rowDragInsertDelay=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.rowDragText=void 0,this.dragAndDropImageComponent=void 0,this.dragAndDropImageComponentParams=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupLockGroupColumns=void 0,this.groupAggFiltering=void 0,this.groupTotalRow=void 0,this.grandTotalRow=void 0,this.suppressStickyTotalRow=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupHideParentOfSingleChild=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.groupAllowUnbalanced=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererParams=void 0,this.treeData=void 0,this.treeDataChildrenField=void 0,this.treeDataParentIdField=void 0,this.rowGroupPanelSuppressSort=void 0,this.suppressGroupRowsSticky=void 0,this.groupHierarchyConfig=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.enableRowPinning=void 0,this.isRowPinnable=void 0,this.isRowPinned=void 0,this.rowModelType=void 0,this.rowData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideInitialRowCount=void 0,this.suppressServerSideFullWidthLoadingRow=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortAllLevels=void 0,this.serverSideEnableClientSideSort=void 0,this.serverSideOnlyRefreshFilteredGroups=void 0,this.serverSidePivotResultFieldSeparator=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.cellSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellFocus=void 0,this.suppressHeaderFocus=void 0,this.selectionColumnDef=void 0,this.rowNumbers=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.alwaysMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.gridId=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.enableGroupEdit=void 0,this.initialState=void 0,this.theme=void 0,this.loadThemeGoogleFonts=void 0,this.themeCssLayer=void 0,this.styleNonce=void 0,this.themeStyleContainer=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processUnpinnedColumns=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.focusGridInnerElement=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.getLocaleText=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.getGroupRowAgg=void 0,this.isGroupOpenByDefault=void 0,this.ssrmExpandAllAffectsAllRows=void 0,this.initialGroupOrderComparator=void 0,this.processPivotResultColDef=void 0,this.processPivotResultColGroupDef=void 0,this.getDataPath=void 0,this.getChildCount=void 0,this.getServerSideGroupLevelParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowId=void 0,this.resetRowDataOnUpdate=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSortRows=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthRow=void 0,this.isRowValidDropPosition=void 0,this.toolPanelVisibleChanged=new me,this.toolPanelSizeChanged=new me,this.columnMenuVisibleChanged=new me,this.contextMenuVisibleChanged=new me,this.cutStart=new me,this.cutEnd=new me,this.pasteStart=new me,this.pasteEnd=new me,this.columnVisible=new me,this.columnPinned=new me,this.columnResized=new me,this.columnMoved=new me,this.columnValueChanged=new me,this.columnPivotModeChanged=new me,this.columnPivotChanged=new me,this.columnGroupOpened=new me,this.newColumnsLoaded=new me,this.gridColumnsChanged=new me,this.displayedColumnsChanged=new me,this.virtualColumnsChanged=new me,this.columnEverythingChanged=new me,this.columnsReset=new me,this.columnHeaderMouseOver=new me,this.columnHeaderMouseLeave=new me,this.columnHeaderClicked=new me,this.columnHeaderContextMenu=new me,this.componentStateChanged=new me,this.cellValueChanged=new me,this.cellEditRequest=new me,this.rowValueChanged=new me,this.cellEditingStarted=new me,this.cellEditingStopped=new me,this.rowEditingStarted=new me,this.rowEditingStopped=new me,this.bulkEditingStarted=new me,this.bulkEditingStopped=new me,this.batchEditingStarted=new me,this.batchEditingStopped=new me,this.undoStarted=new me,this.undoEnded=new me,this.redoStarted=new me,this.redoEnded=new me,this.cellSelectionDeleteStart=new me,this.cellSelectionDeleteEnd=new me,this.rangeDeleteStart=new me,this.rangeDeleteEnd=new me,this.fillStart=new me,this.fillEnd=new me,this.filterOpened=new me,this.filterChanged=new me,this.filterModified=new me,this.filterUiChanged=new me,this.floatingFilterUiChanged=new me,this.advancedFilterBuilderVisibleChanged=new me,this.findChanged=new me,this.chartCreated=new me,this.chartRangeSelectionChanged=new me,this.chartOptionsChanged=new me,this.chartDestroyed=new me,this.cellKeyDown=new me,this.gridReady=new me,this.firstDataRendered=new me,this.gridSizeChanged=new me,this.modelUpdated=new me,this.virtualRowRemoved=new me,this.viewportChanged=new me,this.bodyScroll=new me,this.bodyScrollEnd=new me,this.dragStarted=new me,this.dragStopped=new me,this.dragCancelled=new me,this.stateUpdated=new me,this.paginationChanged=new me,this.rowDragEnter=new me,this.rowDragMove=new me,this.rowDragLeave=new me,this.rowDragEnd=new me,this.rowDragCancel=new me,this.rowResizeStarted=new me,this.rowResizeEnded=new me,this.columnRowGroupChanged=new me,this.rowGroupOpened=new me,this.expandOrCollapseAll=new me,this.pivotMaxColumnsExceeded=new me,this.pinnedRowDataChanged=new me,this.pinnedRowsChanged=new me,this.rowDataUpdated=new me,this.asyncTransactionsFlushed=new me,this.storeRefreshed=new me,this.headerFocused=new me,this.cellClicked=new me,this.cellDoubleClicked=new me,this.cellFocused=new me,this.cellMouseOver=new me,this.cellMouseOut=new me,this.cellMouseDown=new me,this.rowClicked=new me,this.rowDoubleClicked=new me,this.rowSelected=new me,this.selectionChanged=new me,this.cellContextMenu=new me,this.rangeSelectionChanged=new me,this.cellSelectionChanged=new me,this.tooltipShow=new me,this.tooltipHide=new me,this.sortChanged=new me,this._nativeElement=r.nativeElement,this._fullyReady.then(()=>{this._holdEvents=!1})}ngAfterViewInit(){this._angularFrameworkOverrides.runOutsideAngular(()=>{this._frameworkCompWrapper.setViewContainerRef(this._viewContainerRef,this._angularFrameworkOverrides);let r=Object.keys(this).filter(a=>!(a.startsWith("_")||a=="gridOptions"||a=="modules"||this[a]instanceof me)),n={};for(let a of r){let l=SL(a,this[a]);n[a]=l}let i=US(this.gridOptions,n,r),s={globalListener:this.globalListener.bind(this),frameworkOverrides:this._angularFrameworkOverrides,providedBeanInstances:{frameworkCompWrapper:this._frameworkCompWrapper},modules:this.modules||[],setThemeOnGridDiv:!0},o=YS(this._nativeElement,i,s);o&&(this.api=o),this._initialised=!0,this._resolveFullyReady()})}ngOnChanges(r){this._initialised&&this._angularFrameworkOverrides.runOutsideAngular(()=>{let n={};for(let i of Object.keys(r)){let s=r[i];n[i]=s.currentValue}jS(n,this.api)})}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api?.destroy())}isEmitterUsed(r){let i=this[r],s=i?.observed??i?.observers?.length>0,o=`on${r.charAt(0).toUpperCase()}${r.substring(1)}`,a=!!this.gridOptions&&!!this.gridOptions[o];return s||a}globalListener(r,n){if(this._destroyed)return;let i=this[r];if(i&&this.isEmitterUsed(r)){let s=()=>this._angularFrameworkOverrides.runInsideAngular(()=>i.emit(n));this._holdEvents?this._fullyReady.then(()=>s()):s()}}static{this.\u0275fac=function(n){return new(n||t)(Fs(ZS),Fs(el),Fs(LC),Fs(HC))}}static{this.\u0275cmp=Ds({type:t,selectors:[["ag-grid-angular"]],inputs:{gridOptions:"gridOptions",modules:"modules",statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:[2,"suppressContextMenu","suppressContextMenu",re],preventDefaultOnContextMenu:[2,"preventDefaultOnContextMenu","preventDefaultOnContextMenu",re],allowContextMenuWithControlKey:[2,"allowContextMenuWithControlKey","allowContextMenuWithControlKey",re],columnMenu:"columnMenu",suppressMenuHide:[2,"suppressMenuHide","suppressMenuHide",re],enableBrowserTooltips:[2,"enableBrowserTooltips","enableBrowserTooltips",re],tooltipTrigger:"tooltipTrigger",tooltipShowDelay:"tooltipShowDelay",tooltipSwitchShowDelay:"tooltipSwitchShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:[2,"tooltipMouseTrack","tooltipMouseTrack",re],tooltipShowMode:"tooltipShowMode",tooltipInteraction:[2,"tooltipInteraction","tooltipInteraction",re],popupParent:"popupParent",copyHeadersToClipboard:[2,"copyHeadersToClipboard","copyHeadersToClipboard",re],copyGroupHeadersToClipboard:[2,"copyGroupHeadersToClipboard","copyGroupHeadersToClipboard",re],clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:[2,"suppressCopyRowsToClipboard","suppressCopyRowsToClipboard",re],suppressCopySingleCellRanges:[2,"suppressCopySingleCellRanges","suppressCopySingleCellRanges",re],suppressLastEmptyLineOnPaste:[2,"suppressLastEmptyLineOnPaste","suppressLastEmptyLineOnPaste",re],suppressClipboardPaste:[2,"suppressClipboardPaste","suppressClipboardPaste",re],suppressClipboardApi:[2,"suppressClipboardApi","suppressClipboardApi",re],suppressCutToClipboard:[2,"suppressCutToClipboard","suppressCutToClipboard",re],columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",dataTypeDefinitions:"dataTypeDefinitions",maintainColumnOrder:[2,"maintainColumnOrder","maintainColumnOrder",re],enableStrictPivotColumnOrder:[2,"enableStrictPivotColumnOrder","enableStrictPivotColumnOrder",re],suppressFieldDotNotation:[2,"suppressFieldDotNotation","suppressFieldDotNotation",re],headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",hidePaddedHeaderRows:[2,"hidePaddedHeaderRows","hidePaddedHeaderRows",re],allowDragFromColumnsToolPanel:[2,"allowDragFromColumnsToolPanel","allowDragFromColumnsToolPanel",re],suppressMovableColumns:[2,"suppressMovableColumns","suppressMovableColumns",re],suppressColumnMoveAnimation:[2,"suppressColumnMoveAnimation","suppressColumnMoveAnimation",re],suppressMoveWhenColumnDragging:[2,"suppressMoveWhenColumnDragging","suppressMoveWhenColumnDragging",re],suppressDragLeaveHidesColumns:[2,"suppressDragLeaveHidesColumns","suppressDragLeaveHidesColumns",re],suppressGroupChangesColumnVisibility:"suppressGroupChangesColumnVisibility",suppressMakeColumnVisibleAfterUnGroup:[2,"suppressMakeColumnVisibleAfterUnGroup","suppressMakeColumnVisibleAfterUnGroup",re],suppressRowGroupHidesColumns:[2,"suppressRowGroupHidesColumns","suppressRowGroupHidesColumns",re],colResizeDefault:"colResizeDefault",suppressAutoSize:[2,"suppressAutoSize","suppressAutoSize",re],autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:[2,"skipHeaderOnAutoSize","skipHeaderOnAutoSize",re],autoSizeStrategy:"autoSizeStrategy",animateColumnResizing:[2,"animateColumnResizing","animateColumnResizing",re],components:"components",editType:"editType",suppressStartEditOnTab:[2,"suppressStartEditOnTab","suppressStartEditOnTab",re],getFullRowEditValidationErrors:"getFullRowEditValidationErrors",invalidEditValueMode:"invalidEditValueMode",singleClickEdit:[2,"singleClickEdit","singleClickEdit",re],suppressClickEdit:[2,"suppressClickEdit","suppressClickEdit",re],readOnlyEdit:[2,"readOnlyEdit","readOnlyEdit",re],stopEditingWhenCellsLoseFocus:[2,"stopEditingWhenCellsLoseFocus","stopEditingWhenCellsLoseFocus",re],enterNavigatesVertically:[2,"enterNavigatesVertically","enterNavigatesVertically",re],enterNavigatesVerticallyAfterEdit:[2,"enterNavigatesVerticallyAfterEdit","enterNavigatesVerticallyAfterEdit",re],enableCellEditingOnBackspace:[2,"enableCellEditingOnBackspace","enableCellEditingOnBackspace",re],undoRedoCellEditing:[2,"undoRedoCellEditing","undoRedoCellEditing",re],undoRedoCellEditingLimit:"undoRedoCellEditingLimit",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:[2,"suppressCsvExport","suppressCsvExport",re],defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:[2,"suppressExcelExport","suppressExcelExport",re],excelStyles:"excelStyles",findSearchValue:"findSearchValue",findOptions:"findOptions",quickFilterText:"quickFilterText",cacheQuickFilter:[2,"cacheQuickFilter","cacheQuickFilter",re],includeHiddenColumnsInQuickFilter:[2,"includeHiddenColumnsInQuickFilter","includeHiddenColumnsInQuickFilter",re],quickFilterParser:"quickFilterParser",quickFilterMatcher:"quickFilterMatcher",applyQuickFilterBeforePivotOrAgg:[2,"applyQuickFilterBeforePivotOrAgg","applyQuickFilterBeforePivotOrAgg",re],excludeChildrenWhenTreeDataFiltering:[2,"excludeChildrenWhenTreeDataFiltering","excludeChildrenWhenTreeDataFiltering",re],enableAdvancedFilter:[2,"enableAdvancedFilter","enableAdvancedFilter",re],alwaysPassFilter:"alwaysPassFilter",includeHiddenColumnsInAdvancedFilter:[2,"includeHiddenColumnsInAdvancedFilter","includeHiddenColumnsInAdvancedFilter",re],advancedFilterParent:"advancedFilterParent",advancedFilterBuilderParams:"advancedFilterBuilderParams",advancedFilterParams:"advancedFilterParams",suppressAdvancedFilterEval:[2,"suppressAdvancedFilterEval","suppressAdvancedFilterEval",re],suppressSetFilterByDefault:[2,"suppressSetFilterByDefault","suppressSetFilterByDefault",re],enableFilterHandlers:[2,"enableFilterHandlers","enableFilterHandlers",re],filterHandlers:"filterHandlers",enableCharts:[2,"enableCharts","enableCharts",re],chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",chartToolPanelsDef:"chartToolPanelsDef",chartMenuItems:"chartMenuItems",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:[2,"masterDetail","masterDetail",re],keepDetailRows:[2,"keepDetailRows","keepDetailRows",re],keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:[2,"detailRowAutoHeight","detailRowAutoHeight",re],context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:[2,"valueCache","valueCache",re],valueCacheNeverExpires:[2,"valueCacheNeverExpires","valueCacheNeverExpires",re],enableCellExpressions:[2,"enableCellExpressions","enableCellExpressions",re],suppressTouch:[2,"suppressTouch","suppressTouch",re],suppressFocusAfterRefresh:[2,"suppressFocusAfterRefresh","suppressFocusAfterRefresh",re],suppressBrowserResizeObserver:[2,"suppressBrowserResizeObserver","suppressBrowserResizeObserver",re],suppressPropertyNamesCheck:[2,"suppressPropertyNamesCheck","suppressPropertyNamesCheck",re],suppressChangeDetection:[2,"suppressChangeDetection","suppressChangeDetection",re],debug:[2,"debug","debug",re],loading:[2,"loading","loading",re],overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:[2,"suppressLoadingOverlay","suppressLoadingOverlay",re],overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:[2,"suppressNoRowsOverlay","suppressNoRowsOverlay",re],suppressOverlays:"suppressOverlays",overlayComponent:"overlayComponent",overlayComponentParams:"overlayComponentParams",overlayComponentSelector:"overlayComponentSelector",activeOverlay:"activeOverlay",activeOverlayParams:"activeOverlayParams",pagination:[2,"pagination","pagination",re],paginationPageSize:"paginationPageSize",paginationPageSizeSelector:"paginationPageSizeSelector",paginationAutoPageSize:[2,"paginationAutoPageSize","paginationAutoPageSize",re],paginateChildRows:[2,"paginateChildRows","paginateChildRows",re],suppressPaginationPanel:[2,"suppressPaginationPanel","suppressPaginationPanel",re],pivotMode:[2,"pivotMode","pivotMode",re],pivotPanelShow:"pivotPanelShow",pivotMaxGeneratedColumns:"pivotMaxGeneratedColumns",pivotDefaultExpanded:"pivotDefaultExpanded",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:[2,"pivotSuppressAutoColumn","pivotSuppressAutoColumn",re],suppressExpandablePivotGroups:[2,"suppressExpandablePivotGroups","suppressExpandablePivotGroups",re],functionsReadOnly:[2,"functionsReadOnly","functionsReadOnly",re],aggFuncs:"aggFuncs",formulaDataSource:"formulaDataSource",formulaFuncs:"formulaFuncs",suppressAggFuncInHeader:[2,"suppressAggFuncInHeader","suppressAggFuncInHeader",re],alwaysAggregateAtRootLevel:[2,"alwaysAggregateAtRootLevel","alwaysAggregateAtRootLevel",re],aggregateOnlyChangedColumns:[2,"aggregateOnlyChangedColumns","aggregateOnlyChangedColumns",re],suppressAggFilteredOnly:[2,"suppressAggFilteredOnly","suppressAggFilteredOnly",re],removePivotHeaderRowWhenSingleValueColumn:[2,"removePivotHeaderRowWhenSingleValueColumn","removePivotHeaderRowWhenSingleValueColumn",re],animateRows:[2,"animateRows","animateRows",re],cellFlashDuration:"cellFlashDuration",cellFadeDuration:"cellFadeDuration",allowShowChangeAfterFilter:[2,"allowShowChangeAfterFilter","allowShowChangeAfterFilter",re],domLayout:"domLayout",ensureDomOrder:[2,"ensureDomOrder","ensureDomOrder",re],enableCellSpan:[2,"enableCellSpan","enableCellSpan",re],enableRtl:[2,"enableRtl","enableRtl",re],suppressColumnVirtualisation:[2,"suppressColumnVirtualisation","suppressColumnVirtualisation",re],suppressMaxRenderedRowRestriction:[2,"suppressMaxRenderedRowRestriction","suppressMaxRenderedRowRestriction",re],suppressRowVirtualisation:[2,"suppressRowVirtualisation","suppressRowVirtualisation",re],rowDragManaged:[2,"rowDragManaged","rowDragManaged",re],refreshAfterGroupEdit:[2,"refreshAfterGroupEdit","refreshAfterGroupEdit",re],rowDragInsertDelay:"rowDragInsertDelay",suppressRowDrag:[2,"suppressRowDrag","suppressRowDrag",re],suppressMoveWhenRowDragging:[2,"suppressMoveWhenRowDragging","suppressMoveWhenRowDragging",re],rowDragEntireRow:[2,"rowDragEntireRow","rowDragEntireRow",re],rowDragMultiRow:[2,"rowDragMultiRow","rowDragMultiRow",re],rowDragText:"rowDragText",dragAndDropImageComponent:"dragAndDropImageComponent",dragAndDropImageComponentParams:"dragAndDropImageComponentParams",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:[2,"embedFullWidthRows","embedFullWidthRows",re],groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:[2,"groupMaintainOrder","groupMaintainOrder",re],groupSelectsChildren:[2,"groupSelectsChildren","groupSelectsChildren",re],groupLockGroupColumns:"groupLockGroupColumns",groupAggFiltering:"groupAggFiltering",groupTotalRow:"groupTotalRow",grandTotalRow:"grandTotalRow",suppressStickyTotalRow:"suppressStickyTotalRow",groupSuppressBlankHeader:[2,"groupSuppressBlankHeader","groupSuppressBlankHeader",re],groupSelectsFiltered:[2,"groupSelectsFiltered","groupSelectsFiltered",re],showOpenedGroup:[2,"showOpenedGroup","showOpenedGroup",re],groupHideParentOfSingleChild:"groupHideParentOfSingleChild",groupRemoveSingleChildren:[2,"groupRemoveSingleChildren","groupRemoveSingleChildren",re],groupRemoveLowestSingleChildren:[2,"groupRemoveLowestSingleChildren","groupRemoveLowestSingleChildren",re],groupHideOpenParents:[2,"groupHideOpenParents","groupHideOpenParents",re],groupAllowUnbalanced:[2,"groupAllowUnbalanced","groupAllowUnbalanced",re],rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererParams:"groupRowRendererParams",treeData:[2,"treeData","treeData",re],treeDataChildrenField:"treeDataChildrenField",treeDataParentIdField:"treeDataParentIdField",rowGroupPanelSuppressSort:[2,"rowGroupPanelSuppressSort","rowGroupPanelSuppressSort",re],suppressGroupRowsSticky:[2,"suppressGroupRowsSticky","suppressGroupRowsSticky",re],groupHierarchyConfig:"groupHierarchyConfig",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",enableRowPinning:"enableRowPinning",isRowPinnable:"isRowPinnable",isRowPinned:"isRowPinned",rowModelType:"rowModelType",rowData:"rowData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:[2,"suppressModelUpdateAfterUpdateTransaction","suppressModelUpdateAfterUpdateTransaction",re],datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideInitialRowCount:"serverSideInitialRowCount",suppressServerSideFullWidthLoadingRow:[2,"suppressServerSideFullWidthLoadingRow","suppressServerSideFullWidthLoadingRow",re],cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:[2,"purgeClosedRowNodes","purgeClosedRowNodes",re],serverSideDatasource:"serverSideDatasource",serverSideSortAllLevels:[2,"serverSideSortAllLevels","serverSideSortAllLevels",re],serverSideEnableClientSideSort:[2,"serverSideEnableClientSideSort","serverSideEnableClientSideSort",re],serverSideOnlyRefreshFilteredGroups:[2,"serverSideOnlyRefreshFilteredGroups","serverSideOnlyRefreshFilteredGroups",re],serverSidePivotResultFieldSeparator:"serverSidePivotResultFieldSeparator",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:[2,"alwaysShowHorizontalScroll","alwaysShowHorizontalScroll",re],alwaysShowVerticalScroll:[2,"alwaysShowVerticalScroll","alwaysShowVerticalScroll",re],debounceVerticalScrollbar:[2,"debounceVerticalScrollbar","debounceVerticalScrollbar",re],suppressHorizontalScroll:[2,"suppressHorizontalScroll","suppressHorizontalScroll",re],suppressScrollOnNewData:[2,"suppressScrollOnNewData","suppressScrollOnNewData",re],suppressScrollWhenPopupsAreOpen:[2,"suppressScrollWhenPopupsAreOpen","suppressScrollWhenPopupsAreOpen",re],suppressAnimationFrame:[2,"suppressAnimationFrame","suppressAnimationFrame",re],suppressMiddleClickScrolls:[2,"suppressMiddleClickScrolls","suppressMiddleClickScrolls",re],suppressPreventDefaultOnMouseWheel:[2,"suppressPreventDefaultOnMouseWheel","suppressPreventDefaultOnMouseWheel",re],scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",cellSelection:"cellSelection",rowMultiSelectWithClick:[2,"rowMultiSelectWithClick","rowMultiSelectWithClick",re],suppressRowDeselection:[2,"suppressRowDeselection","suppressRowDeselection",re],suppressRowClickSelection:[2,"suppressRowClickSelection","suppressRowClickSelection",re],suppressCellFocus:[2,"suppressCellFocus","suppressCellFocus",re],suppressHeaderFocus:[2,"suppressHeaderFocus","suppressHeaderFocus",re],selectionColumnDef:"selectionColumnDef",rowNumbers:"rowNumbers",suppressMultiRangeSelection:[2,"suppressMultiRangeSelection","suppressMultiRangeSelection",re],enableCellTextSelection:[2,"enableCellTextSelection","enableCellTextSelection",re],enableRangeSelection:[2,"enableRangeSelection","enableRangeSelection",re],enableRangeHandle:[2,"enableRangeHandle","enableRangeHandle",re],enableFillHandle:[2,"enableFillHandle","enableFillHandle",re],fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:[2,"suppressClearOnFillReduction","suppressClearOnFillReduction",re],sortingOrder:"sortingOrder",accentedSort:[2,"accentedSort","accentedSort",re],unSortIcon:[2,"unSortIcon","unSortIcon",re],suppressMultiSort:[2,"suppressMultiSort","suppressMultiSort",re],alwaysMultiSort:[2,"alwaysMultiSort","alwaysMultiSort",re],multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:[2,"suppressMaintainUnsortedOrder","suppressMaintainUnsortedOrder",re],icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:[2,"suppressRowHoverHighlight","suppressRowHoverHighlight",re],suppressRowTransform:[2,"suppressRowTransform","suppressRowTransform",re],columnHoverHighlight:[2,"columnHoverHighlight","columnHoverHighlight",re],gridId:"gridId",deltaSort:[2,"deltaSort","deltaSort",re],treeDataDisplayType:"treeDataDisplayType",enableGroupEdit:[2,"enableGroupEdit","enableGroupEdit",re],initialState:"initialState",theme:"theme",loadThemeGoogleFonts:[2,"loadThemeGoogleFonts","loadThemeGoogleFonts",re],themeCssLayer:"themeCssLayer",styleNonce:"styleNonce",themeStyleContainer:"themeStyleContainer",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processUnpinnedColumns:"processUnpinnedColumns",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",focusGridInnerElement:"focusGridInnerElement",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",getLocaleText:"getLocaleText",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",getGroupRowAgg:"getGroupRowAgg",isGroupOpenByDefault:"isGroupOpenByDefault",ssrmExpandAllAffectsAllRows:[2,"ssrmExpandAllAffectsAllRows","ssrmExpandAllAffectsAllRows",re],initialGroupOrderComparator:"initialGroupOrderComparator",processPivotResultColDef:"processPivotResultColDef",processPivotResultColGroupDef:"processPivotResultColGroupDef",getDataPath:"getDataPath",getChildCount:"getChildCount",getServerSideGroupLevelParams:"getServerSideGroupLevelParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowId:"getRowId",resetRowDataOnUpdate:[2,"resetRowDataOnUpdate","resetRowDataOnUpdate",re],processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSortRows:"postSortRows",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthRow:"isFullWidthRow",isRowValidDropPosition:"isRowValidDropPosition"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",toolPanelSizeChanged:"toolPanelSizeChanged",columnMenuVisibleChanged:"columnMenuVisibleChanged",contextMenuVisibleChanged:"contextMenuVisibleChanged",cutStart:"cutStart",cutEnd:"cutEnd",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",columnsReset:"columnsReset",columnHeaderMouseOver:"columnHeaderMouseOver",columnHeaderMouseLeave:"columnHeaderMouseLeave",columnHeaderClicked:"columnHeaderClicked",columnHeaderContextMenu:"columnHeaderContextMenu",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",bulkEditingStarted:"bulkEditingStarted",bulkEditingStopped:"bulkEditingStopped",batchEditingStarted:"batchEditingStarted",batchEditingStopped:"batchEditingStopped",undoStarted:"undoStarted",undoEnded:"undoEnded",redoStarted:"redoStarted",redoEnded:"redoEnded",cellSelectionDeleteStart:"cellSelectionDeleteStart",cellSelectionDeleteEnd:"cellSelectionDeleteEnd",rangeDeleteStart:"rangeDeleteStart",rangeDeleteEnd:"rangeDeleteEnd",fillStart:"fillStart",fillEnd:"fillEnd",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",filterUiChanged:"filterUiChanged",floatingFilterUiChanged:"floatingFilterUiChanged",advancedFilterBuilderVisibleChanged:"advancedFilterBuilderVisibleChanged",findChanged:"findChanged",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",dragCancelled:"dragCancelled",stateUpdated:"stateUpdated",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",rowDragCancel:"rowDragCancel",rowResizeStarted:"rowResizeStarted",rowResizeEnded:"rowResizeEnded",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pivotMaxColumnsExceeded:"pivotMaxColumnsExceeded",pinnedRowDataChanged:"pinnedRowDataChanged",pinnedRowsChanged:"pinnedRowsChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",storeRefreshed:"storeRefreshed",headerFocused:"headerFocused",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",cellSelectionChanged:"cellSelectionChanged",tooltipShow:"tooltipShow",tooltipHide:"tooltipHide",sortChanged:"sortChanged"},features:[Pf([LC,HC]),Ff],decls:0,vars:0,template:function(n,i){},encapsulation:2})}}return t})(),xL=new Set(GS);function SL(t,e){return xL.has(t)?e===""?!0:e==="false"?!1:e:e}var tbe=T(xe(),1),rbe=T(Qe(),1),nbe=T(sT(),1),ibe=T($r(),1),sbe=T(Xr(),1),obe=T(Kr(),1),abe=T(Zr(),1),lbe=T(Jr(),1),cbe=T(Qr(),1),ube=T(en(),1),fbe=T(tt(),1),hbe=T(Xn(),1),dbe=T(sr(),1),mbe=T(Cn(),1),pbe=T(vR(),1);var Voe=T(xe(),1),Woe=T(Qe(),1),Uoe=T(tt(),1),joe=T(Xn(),1),Goe=T(sr(),1);var xoe=T(Qe(),1);var{entries:bR,setPrototypeOf:wR,isFrozen:uU,getPrototypeOf:fU,getOwnPropertyDescriptor:hU}=Object,{freeze:_n,seal:fi,create:Rg}=Object,{apply:Og,construct:Ag}=typeof Reflect<"u"&&Reflect;_n||(_n=function(e){return e});fi||(fi=function(e){return e});Og||(Og=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return e.apply(r,i)});Ag||(Ag=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return new e(...n)});var wh=En(Array.prototype.forEach),dU=En(Array.prototype.lastIndexOf),xR=En(Array.prototype.pop),Pc=En(Array.prototype.push),mU=En(Array.prototype.splice),Sh=En(String.prototype.toLowerCase),Cg=En(String.prototype.toString),yg=En(String.prototype.match),Nc=En(String.prototype.replace),pU=En(String.prototype.indexOf),gU=En(String.prototype.trim),Fi=En(Object.prototype.hasOwnProperty),yn=En(RegExp.prototype.test),Hc=vU(TypeError);function En(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Og(t,e,n)}}function vU(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Ag(t,r)}}function lt(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sh;wR&&wR(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){let s=r(i);s!==i&&(uU(e)||(e[n]=s),i=s)}t[i]=!0}return t}function wU(t){for(let e=0;e<t.length;e++)Fi(t,e)||(t[e]=null);return t}function as(t){let e=Rg(null);for(let[r,n]of bR(t))Fi(t,r)&&(Array.isArray(n)?e[r]=wU(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=as(n):e[r]=n);return e}function Lc(t,e){for(;t!==null;){let n=hU(t,e);if(n){if(n.get)return En(n.get);if(typeof n.value=="function")return En(n.value)}t=fU(t)}function r(){return null}return r}var SR=_n(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_g=_n(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Eg=_n(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),xU=_n(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Tg=_n(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),SU=_n(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),CR=_n(["#text"]),yR=_n(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),bg=_n(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),_R=_n(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xh=_n(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),CU=fi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),yU=fi(/<%[\w\W]*|[\w\W]*%>/gm),_U=fi(/\$\{[\w\W]*/gm),EU=fi(/^data-[\-\w.\u00B7-\uFFFF]+$/),TU=fi(/^aria-[\-\w]+$/),RR=fi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bU=fi(/^(?:\w+script|data):/i),RU=fi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),OR=fi(/^html$/i),OU=fi(/^[a-z][.\w]*(-[.\w]+)+$/i),ER=Object.freeze({__proto__:null,ARIA_ATTR:TU,ATTR_WHITESPACE:RU,CUSTOM_ELEMENT:OU,DATA_ATTR:EU,DOCTYPE_NAME:OR,ERB_EXPR:yU,IS_ALLOWED_URI:RR,IS_SCRIPT_OR_DATA:bU,MUSTACHE_EXPR:CU,TMPLIT_EXPR:_U}),Bc={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},AU=function(){return typeof window>"u"?null:window},IU=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null,i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));let s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},TR=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function AR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:AU(),e=j=>AR(j);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==Bc.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t,n=r,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:u,NamedNodeMap:f=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:p,trustedTypes:g}=t,x=l.prototype,w=Lc(x,"cloneNode"),y=Lc(x,"remove"),P=Lc(x,"nextSibling"),N=Lc(x,"childNodes"),B=Lc(x,"parentNode");if(typeof o=="function"){let j=r.createElement("template");j.content&&j.content.ownerDocument&&(r=j.content.ownerDocument)}let F,Q="",{implementation:he,createNodeIterator:U,createDocumentFragment:X,getElementsByTagName:K}=r,{importNode:ne}=n,ie=TR();e.isSupported=typeof bR=="function"&&typeof B=="function"&&he&&he.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:te,ERB_EXPR:Re,TMPLIT_EXPR:We,DATA_ATTR:ke,ARIA_ATTR:wt,IS_SCRIPT_OR_DATA:ut,ATTR_WHITESPACE:ze,CUSTOM_ELEMENT:rt}=ER,{IS_ALLOWED_URI:$e}=ER,Ye=null,V=lt({},[...SR,..._g,...Eg,...Tg,...CR]),G=null,z=lt({},[...yR,...bg,..._R,...xh]),m=Object.seal(Rg(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),S=null,_=null,D=Object.seal(Rg(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}})),L=!0,H=!0,oe=!1,fe=!0,Oe=!1,ve=!0,ue=!1,Ie=!1,pe=!1,He=!1,Xe=!1,Tt=!1,Lt=!0,ur=!1,xt="user-content-",qe=!0,zt=!1,Kt={},Bt=null,Ke=lt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),xr=null,Zt=lt({},["audio","video","img","source","image","track"]),fr=null,xn=lt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ir="http://www.w3.org/1998/Math/MathML",Yr="http://www.w3.org/2000/svg",Sr="http://www.w3.org/1999/xhtml",An=Sr,Cr=!1,qn=null,qr=lt({},[Ir,Yr,Sr],Cg),yr=lt({},["mi","mo","mn","ms","mtext"]),In=lt({},["annotation-xml"]),kr=lt({},["title","style","font","a","script"]),Ce=null,so=["application/xhtml+xml","text/html"],oo="text/html",yt=null,hr=null,nt=r.createElement("form"),ao=function(O){return O instanceof RegExp||O instanceof Function},gt=function(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(hr&&hr===O)){if((!O||typeof O!="object")&&(O={}),O=as(O),Ce=so.indexOf(O.PARSER_MEDIA_TYPE)===-1?oo:O.PARSER_MEDIA_TYPE,yt=Ce==="application/xhtml+xml"?Cg:Sh,Ye=Fi(O,"ALLOWED_TAGS")?lt({},O.ALLOWED_TAGS,yt):V,G=Fi(O,"ALLOWED_ATTR")?lt({},O.ALLOWED_ATTR,yt):z,qn=Fi(O,"ALLOWED_NAMESPACES")?lt({},O.ALLOWED_NAMESPACES,Cg):qr,fr=Fi(O,"ADD_URI_SAFE_ATTR")?lt(as(xn),O.ADD_URI_SAFE_ATTR,yt):xn,xr=Fi(O,"ADD_DATA_URI_TAGS")?lt(as(Zt),O.ADD_DATA_URI_TAGS,yt):Zt,Bt=Fi(O,"FORBID_CONTENTS")?lt({},O.FORBID_CONTENTS,yt):Ke,S=Fi(O,"FORBID_TAGS")?lt({},O.FORBID_TAGS,yt):as({}),_=Fi(O,"FORBID_ATTR")?lt({},O.FORBID_ATTR,yt):as({}),Kt=Fi(O,"USE_PROFILES")?O.USE_PROFILES:!1,L=O.ALLOW_ARIA_ATTR!==!1,H=O.ALLOW_DATA_ATTR!==!1,oe=O.ALLOW_UNKNOWN_PROTOCOLS||!1,fe=O.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Oe=O.SAFE_FOR_TEMPLATES||!1,ve=O.SAFE_FOR_XML!==!1,ue=O.WHOLE_DOCUMENT||!1,He=O.RETURN_DOM||!1,Xe=O.RETURN_DOM_FRAGMENT||!1,Tt=O.RETURN_TRUSTED_TYPE||!1,pe=O.FORCE_BODY||!1,Lt=O.SANITIZE_DOM!==!1,ur=O.SANITIZE_NAMED_PROPS||!1,qe=O.KEEP_CONTENT!==!1,zt=O.IN_PLACE||!1,$e=O.ALLOWED_URI_REGEXP||RR,An=O.NAMESPACE||Sr,yr=O.MATHML_TEXT_INTEGRATION_POINTS||yr,In=O.HTML_INTEGRATION_POINTS||In,m=O.CUSTOM_ELEMENT_HANDLING||{},O.CUSTOM_ELEMENT_HANDLING&&ao(O.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(m.tagNameCheck=O.CUSTOM_ELEMENT_HANDLING.tagNameCheck),O.CUSTOM_ELEMENT_HANDLING&&ao(O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(m.attributeNameCheck=O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),O.CUSTOM_ELEMENT_HANDLING&&typeof O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(m.allowCustomizedBuiltInElements=O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&(H=!1),Xe&&(He=!0),Kt&&(Ye=lt({},CR),G=[],Kt.html===!0&&(lt(Ye,SR),lt(G,yR)),Kt.svg===!0&&(lt(Ye,_g),lt(G,bg),lt(G,xh)),Kt.svgFilters===!0&&(lt(Ye,Eg),lt(G,bg),lt(G,xh)),Kt.mathMl===!0&&(lt(Ye,Tg),lt(G,_R),lt(G,xh))),O.ADD_TAGS&&(typeof O.ADD_TAGS=="function"?D.tagCheck=O.ADD_TAGS:(Ye===V&&(Ye=as(Ye)),lt(Ye,O.ADD_TAGS,yt))),O.ADD_ATTR&&(typeof O.ADD_ATTR=="function"?D.attributeCheck=O.ADD_ATTR:(G===z&&(G=as(G)),lt(G,O.ADD_ATTR,yt))),O.ADD_URI_SAFE_ATTR&&lt(fr,O.ADD_URI_SAFE_ATTR,yt),O.FORBID_CONTENTS&&(Bt===Ke&&(Bt=as(Bt)),lt(Bt,O.FORBID_CONTENTS,yt)),O.ADD_FORBID_CONTENTS&&(Bt===Ke&&(Bt=as(Bt)),lt(Bt,O.ADD_FORBID_CONTENTS,yt)),qe&&(Ye["#text"]=!0),ue&&lt(Ye,["html","head","body"]),Ye.table&&(lt(Ye,["tbody"]),delete S.tbody),O.TRUSTED_TYPES_POLICY){if(typeof O.TRUSTED_TYPES_POLICY.createHTML!="function")throw Hc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof O.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Hc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');F=O.TRUSTED_TYPES_POLICY,Q=F.createHTML("")}else F===void 0&&(F=IU(g,i)),F!==null&&typeof Q=="string"&&(Q=F.createHTML(""));_n&&_n(O),hr=O}},ns=lt({},[..._g,...Eg,...xU]),lo=lt({},[...Tg,...SU]),co=function(O){let q=B(O);(!q||!q.tagName)&&(q={namespaceURI:An,tagName:"template"});let ce=Sh(O.tagName),de=Sh(q.tagName);return qn[O.namespaceURI]?O.namespaceURI===Yr?q.namespaceURI===Sr?ce==="svg":q.namespaceURI===Ir?ce==="svg"&&(de==="annotation-xml"||yr[de]):!!ns[ce]:O.namespaceURI===Ir?q.namespaceURI===Sr?ce==="math":q.namespaceURI===Yr?ce==="math"&&In[de]:!!lo[ce]:O.namespaceURI===Sr?q.namespaceURI===Yr&&!In[de]||q.namespaceURI===Ir&&!yr[de]?!1:!lo[ce]&&(kr[ce]||!ns[ce]):!!(Ce==="application/xhtml+xml"&&qn[O.namespaceURI]):!1},Ot=function(O){Pc(e.removed,{element:O});try{B(O).removeChild(O)}catch{y(O)}},Mr=function(O,q){try{Pc(e.removed,{attribute:q.getAttributeNode(O),from:q})}catch{Pc(e.removed,{attribute:null,from:q})}if(q.removeAttribute(O),O==="is")if(He||Xe)try{Ot(q)}catch{}else try{q.setAttribute(O,"")}catch{}},E=function(O){let q=null,ce=null;if(pe)O="<remove></remove>"+O;else{let _e=yg(O,/^[\r\n\t ]+/);ce=_e&&_e[0]}Ce==="application/xhtml+xml"&&An===Sr&&(O='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+O+"</body></html>");let de=F?F.createHTML(O):O;if(An===Sr)try{q=new p().parseFromString(de,Ce)}catch{}if(!q||!q.documentElement){q=he.createDocument(An,"template",null);try{q.documentElement.innerHTML=Cr?Q:de}catch{}}let we=q.body||q.documentElement;return O&&ce&&we.insertBefore(r.createTextNode(ce),we.childNodes[0]||null),An===Sr?K.call(q,ue?"html":"body")[0]:ue?q.documentElement:we},I=function(O){return U.call(O.ownerDocument||O,O,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},R=function(O){return O instanceof d&&(typeof O.nodeName!="string"||typeof O.textContent!="string"||typeof O.removeChild!="function"||!(O.attributes instanceof f)||typeof O.removeAttribute!="function"||typeof O.setAttribute!="function"||typeof O.namespaceURI!="string"||typeof O.insertBefore!="function"||typeof O.hasChildNodes!="function")},A=function(O){return typeof a=="function"&&O instanceof a};function k(j,O,q){wh(j,ce=>{ce.call(e,O,q,hr)})}let M=function(O){let q=null;if(k(ie.beforeSanitizeElements,O,null),R(O))return Ot(O),!0;let ce=yt(O.nodeName);if(k(ie.uponSanitizeElement,O,{tagName:ce,allowedTags:Ye}),ve&&O.hasChildNodes()&&!A(O.firstElementChild)&&yn(/<[/\w!]/g,O.innerHTML)&&yn(/<[/\w!]/g,O.textContent)||O.nodeType===Bc.progressingInstruction||ve&&O.nodeType===Bc.comment&&yn(/<[/\w]/g,O.data))return Ot(O),!0;if(!(D.tagCheck instanceof Function&&D.tagCheck(ce))&&(!Ye[ce]||S[ce])){if(!S[ce]&&se(ce)&&(m.tagNameCheck instanceof RegExp&&yn(m.tagNameCheck,ce)||m.tagNameCheck instanceof Function&&m.tagNameCheck(ce)))return!1;if(qe&&!Bt[ce]){let de=B(O)||O.parentNode,we=N(O)||O.childNodes;if(we&&de){let _e=we.length;for(let Ze=_e-1;Ze>=0;--Ze){let Vt=w(we[Ze],!0);Vt.__removalCount=(O.__removalCount||0)+1,de.insertBefore(Vt,P(O))}}}return Ot(O),!0}return O instanceof l&&!co(O)||(ce==="noscript"||ce==="noembed"||ce==="noframes")&&yn(/<\/no(script|embed|frames)/i,O.innerHTML)?(Ot(O),!0):(Oe&&O.nodeType===Bc.text&&(q=O.textContent,wh([te,Re,We],de=>{q=Nc(q,de," ")}),O.textContent!==q&&(Pc(e.removed,{element:O.cloneNode()}),O.textContent=q)),k(ie.afterSanitizeElements,O,null),!1)},Z=function(O,q,ce){if(Lt&&(q==="id"||q==="name")&&(ce in r||ce in nt))return!1;if(!(H&&!_[q]&&yn(ke,q))){if(!(L&&yn(wt,q))){if(!(D.attributeCheck instanceof Function&&D.attributeCheck(q,O))){if(!G[q]||_[q]){if(!(se(O)&&(m.tagNameCheck instanceof RegExp&&yn(m.tagNameCheck,O)||m.tagNameCheck instanceof Function&&m.tagNameCheck(O))&&(m.attributeNameCheck instanceof RegExp&&yn(m.attributeNameCheck,q)||m.attributeNameCheck instanceof Function&&m.attributeNameCheck(q,O))||q==="is"&&m.allowCustomizedBuiltInElements&&(m.tagNameCheck instanceof RegExp&&yn(m.tagNameCheck,ce)||m.tagNameCheck instanceof Function&&m.tagNameCheck(ce))))return!1}else if(!fr[q]){if(!yn($e,Nc(ce,ze,""))){if(!((q==="src"||q==="xlink:href"||q==="href")&&O!=="script"&&pU(ce,"data:")===0&&xr[O])){if(!(oe&&!yn(ut,Nc(ce,ze,"")))){if(ce)return!1}}}}}}}return!0},se=function(O){return O!=="annotation-xml"&&yg(O,rt)},J=function(O){k(ie.beforeSanitizeAttributes,O,null);let{attributes:q}=O;if(!q||R(O))return;let ce={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:G,forceKeepAttr:void 0},de=q.length;for(;de--;){let we=q[de],{name:_e,namespaceURI:Ze,value:Vt}=we,bt=yt(_e),_r=Vt,Ut=_e==="value"?_r:gU(_r);if(ce.attrName=bt,ce.attrValue=Ut,ce.keepAttr=!0,ce.forceKeepAttr=void 0,k(ie.uponSanitizeAttribute,O,ce),Ut=ce.attrValue,ur&&(bt==="id"||bt==="name")&&(Mr(_e,O),Ut=xt+Ut),ve&&yn(/((--!?|])>)|<\/(style|title|textarea)/i,Ut)){Mr(_e,O);continue}if(bt==="attributename"&&yg(Ut,"href")){Mr(_e,O);continue}if(ce.forceKeepAttr)continue;if(!ce.keepAttr){Mr(_e,O);continue}if(!fe&&yn(/\/>/i,Ut)){Mr(_e,O);continue}Oe&&wh([te,Re,We],oi=>{Ut=Nc(Ut,oi," ")});let is=yt(O.nodeName);if(!Z(is,bt,Ut)){Mr(_e,O);continue}if(F&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Ze)switch(g.getAttributeType(is,bt)){case"TrustedHTML":{Ut=F.createHTML(Ut);break}case"TrustedScriptURL":{Ut=F.createScriptURL(Ut);break}}if(Ut!==_r)try{Ze?O.setAttributeNS(Ze,_e,Ut):O.setAttribute(_e,Ut),R(O)?Ot(O):xR(e.removed)}catch{Mr(_e,O)}}k(ie.afterSanitizeAttributes,O,null)},ee=function j(O){let q=null,ce=I(O);for(k(ie.beforeSanitizeShadowDOM,O,null);q=ce.nextNode();)k(ie.uponSanitizeShadowNode,q,null),M(q),J(q),q.content instanceof s&&j(q.content);k(ie.afterSanitizeShadowDOM,O,null)};return e.sanitize=function(j){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},q=null,ce=null,de=null,we=null;if(Cr=!j,Cr&&(j="<!-->"),typeof j!="string"&&!A(j))if(typeof j.toString=="function"){if(j=j.toString(),typeof j!="string")throw Hc("dirty is not a string, aborting")}else throw Hc("toString is not a function");if(!e.isSupported)return j;if(Ie||gt(O),e.removed=[],typeof j=="string"&&(zt=!1),zt){if(j.nodeName){let Vt=yt(j.nodeName);if(!Ye[Vt]||S[Vt])throw Hc("root node is forbidden and cannot be sanitized in-place")}}else if(j instanceof a)q=E("<!---->"),ce=q.ownerDocument.importNode(j,!0),ce.nodeType===Bc.element&&ce.nodeName==="BODY"||ce.nodeName==="HTML"?q=ce:q.appendChild(ce);else{if(!He&&!Oe&&!ue&&j.indexOf("<")===-1)return F&&Tt?F.createHTML(j):j;if(q=E(j),!q)return He?null:Tt?Q:""}q&&pe&&Ot(q.firstChild);let _e=I(zt?j:q);for(;de=_e.nextNode();)M(de),J(de),de.content instanceof s&&ee(de.content);if(zt)return j;if(He){if(Xe)for(we=X.call(q.ownerDocument);q.firstChild;)we.appendChild(q.firstChild);else we=q;return(G.shadowroot||G.shadowrootmode)&&(we=ne.call(n,we,!0)),we}let Ze=ue?q.outerHTML:q.innerHTML;return ue&&Ye["!doctype"]&&q.ownerDocument&&q.ownerDocument.doctype&&q.ownerDocument.doctype.name&&yn(OR,q.ownerDocument.doctype.name)&&(Ze="<!DOCTYPE "+q.ownerDocument.doctype.name+`>
`+Ze),Oe&&wh([te,Re,We],Vt=>{Ze=Nc(Ze,Vt," ")}),F&&Tt?F.createHTML(Ze):Ze},e.setConfig=function(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt(j),Ie=!0},e.clearConfig=function(){hr=null,Ie=!1},e.isValidAttribute=function(j,O,q){hr||gt({});let ce=yt(j),de=yt(O);return Z(ce,de,q)},e.addHook=function(j,O){typeof O=="function"&&Pc(ie[j],O)},e.removeHook=function(j,O){if(O!==void 0){let q=dU(ie[j],O);return q===-1?void 0:mU(ie[j],q,1)[0]}return xR(ie[j])},e.removeHooks=function(j){ie[j]=[]},e.removeAllHooks=function(){ie=TR()},e}var IR=AR();var Pg=T(kR(),1);var hoe=T(tt(),1),doe=T(sr(),1),moe=T(Vc(),1);var toe=T(Qe(),1),roe=T($r(),1),noe=T(Xr(),1),ioe=T(Kr(),1),soe=T(Zr(),1),ooe=T(Jr(),1),aoe=T(Qr(),1),loe=T(en(),1),coe=T(tt(),1),uoe=T(Xn(),1);function PR(t){let e=t.length,r=0;for(;r<e;)t[r]=[t[r]],r+=1}function Mg(t,e){let r=e.length,n=0;for(;n<r;)t.push(e[n]),n+=1}function Ch(t){let e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;let r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function _o(t,e,r,n){let i=-1,s=t,o=r;Array.isArray(t)||(s=Array.from(t));let a=s.length;for(n&&a&&(i+=1,o=s[i]),i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function yh(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));let i=n.length,s=[],o=-1;for(;r<i;){let a=n[r];e(a,r,n)&&(o+=1,s[o]=a),r+=1}return s}function Di(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));let i=n.length,s=[],o=-1;for(;r<i;){let a=n[r];o+=1,s[o]=e(a,r,n),r+=1}return s}function Ue(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));let i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function Fg(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];let[n,...i]=[...e],s=n;return Ue(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function Dg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function mr(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return _o(t,(s,o,a)=>{let l=o.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return s+l+u},"").trim()}function Eh(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Be(t){return typeof t<"u"}function pr(t){return typeof t>"u"}function Ls(t){return t===null||t===""||pr(t)}function VR(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var Wc="length",Uc=t=>parseInt(t,16),NR=t=>parseInt(t,10),_h=(t,e,r)=>t.substr(e,r),jc=t=>t.codePointAt(0)-65,Ng=t=>`${t}`.replace(/\-/g,""),VU=t=>Uc(_h(Ng(t),Uc("12"),jc("F")))/(Uc(_h(Ng(t),jc("B"),~~![][Wc]))||9),WU=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),HR=!1,LR={invalid:()=>mr`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return mr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>mr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},BR={invalid:()=>mr`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return mr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>mr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function WR(t,e){let r=!Ls(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.2.0",s,o="invalid",a="invalid";t=Ng(t||"");let l=UU(t);if(r||n||l)if(l){let u=(0,Pg.default)("25/11/2025","DD/MM/YYYY"),f=Math.floor(u.toDate().getTime()/864e5),d=VU(t);s=(0,Pg.default)((d+1)*864e5,"x").format("MMMM DD, YYYY"),f>d?(o="expired",a="expired"):(o="valid",a="valid")}else n?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(WU()&&(o="valid",a="valid"),!HR&&o!=="valid"&&(LR[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](LR[o]({keyValidityDate:s,hotVersion:i})),HR=!0),a!=="valid"&&e&&BR[a]({keyValidityDate:s,hotVersion:i})){let f=document.createElement("div");f.className="handsontable hot-display-license-info",f.innerHTML=BR[a]({keyValidityDate:s,hotVersion:i}),e.appendChild(f)}}function UU(t){let e=[][Wc],r=e;if(t[Wc]!==jc("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=jc(i.shift());s;s=jc(i.shift()||"A"))--s<""[Wc]?r=r|(NR(`${NR(Uc(n)+(Uc(_h(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=_h(t,s,s?i[Wc]===1?9:8:6);return r===e}function dl(t){return t[0].toUpperCase()+t.substr(1)}function Th(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function bh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function UR(t,e){return IR.sanitize(t,e)}var ls=t=>["tabindex",t],jR=()=>["role","treegrid"],Pi=()=>["role","presentation"],GR=()=>["role","gridcell"],zR=()=>["role","gridcell button"],YR=()=>["role","rowheader"],Rh=()=>["role","rowgroup"],qR=()=>["role","columnheader"],Oh=()=>["role","row"];var $R=()=>["scope","col"],XR=()=>["scope","row"];var Ah=t=>["aria-label",t];var KR=()=>["aria-multiselectable","true"];var Ih=t=>["aria-rowcount",t],ml=t=>["aria-colcount",t],kh=t=>["aria-rowindex",t],pl=t=>["aria-colindex",t];var Hg=()=>["aria-readonly","true"],Lg=()=>["aria-invalid","true"];var Mh=()=>["aria-selected","true"];var Ooe=T(xe(),1),Aoe=T(Qe(),1),Ioe=T(x2(),1),koe=T(tt(),1),Moe=T(sr(),1);function ma(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ht(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=ma(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[ma(r[0])]:e[n]=[]:e[n]=null)})),e}function S2(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Ni(t,e,r){let n=Array.isArray(r);return ht(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function zg(t,e){ht(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),zg(t[n],e[n])):t[n]=e[n]})}function hi(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function ft(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Ue(r,i=>{t.MIXINS.push(i.MIXIN_NAME),ht(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{let a=function(f,d){let p=`_${f}`,g=x=>{let w=x;return(Array.isArray(w)||tn(w))&&(w=hi(w)),w};return function(){return this[p]===void 0&&(this[p]=g(d)),this[p]}},l=function(f){let d=`_${f}`;return function(p){this[d]=p}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function Nh(t,e){return JSON.stringify(t)===JSON.stringify(e)}function tn(t){return Object.prototype.toString.call(t)==="[object Object]"}function dn(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function ht(t,e){for(let r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function C2(t,e){let r=e.split("."),n=t;return ht(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Hh(t,e,r){if(typeof e!="string")return;let n=e.split("."),i=t;n.forEach((s,o)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(o!==n.length-1?(Hi(i,s)||(i[s]={}),i=i[s]):i[s]=r)})}function gl(t){if(!tn(t))return 0;let e=function(r){let n=0;return tn(r)?ht(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function Pr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Hi(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Yg(t){return window.requestAnimationFrame(t)}function y2(){return"ontouchstart"in window}function _2(){return typeof window<"u"}var di=t=>{let e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},To={chrome:di((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:di(t=>/CriOS/.test(t)),edge:di(t=>/Edge/.test(t)),edgeWebKit:di(t=>/EdgiOS/.test(t)),firefox:di(t=>/Firefox/.test(t)),firefoxWebKit:di(t=>/FxiOS/.test(t)),mobile:di(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:di((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Lh={mac:di(t=>/^Mac/.test(t)),win:di(t=>/^Win/.test(t)),linux:di(t=>/^Linux/.test(t)),ios:di(t=>/iPhone|iPad|iPod/i.test(t))};function h9(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ht(To,r=>{let{test:n}=r;return void n(t,e)})}function d9(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ht(Lh,e=>{let{test:r}=e;return void r(t)})}_2()&&(h9(),d9());function E2(){return To.chrome.value}function T2(){return To.chromeWebKit.value}function Bh(){return To.firefox.value}function b2(){return To.firefoxWebKit.value}function R2(){return To.safari.value}function O2(){return To.edge.value}function Li(){return To.mobile.value}function Vh(){return Lh.ios.value}function Wh(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Lh.mac.value}function Uh(){return Lh.mac.value}function A2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function I2(t,e){let r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function m9(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Bs(t){return m9(t)&&t.parent}function $g(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node,s=t;for(;s!=null&&s!==r;){let{nodeType:o,nodeName:a}=s;if(o===n&&(e.includes(a)||e.includes(s)))return s;let{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function Gc(t,e,r){let n=[],i=t;for(;i&&(i=$g(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;let s=n.length;return s?n[s-1]:null}function k2(t,e){let r={element:void 0,classNames:[]},n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){let i=Array.from(n.classList).filter(s=>e.test(s));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function zc(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function M2(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function bo(t,e,r){let n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function F2(t){return!t||!t.length?[]:t.filter(e=>!!e)}function D2(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];let r=[],n=[];return n.push(...t.filter(i=>{let s=i instanceof RegExp;return s&&e&&r.push(i),!s})),e?{regexFree:n,regexes:r}:n}function pt(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Ne(t,e){typeof e=="string"&&(e=e.split(" ")),e=F2(e),e.length>0&&t.classList.add(...e)}function ot(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=D2(e,!0);r=F2(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function dt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function us(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=D2(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function Xg(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){let e=t.childNodes;for(let r=e.length-1;r>=0;r--)Xg(e[r])}}function Ro(t){let e;for(;e=t.lastChild;)t.removeChild(e)}var p9=/(<(.*)>|&(.*);)/;function P2(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p9.test(e)?t.innerHTML=r?UR(e):e:Vs(t,e)}function Vs(t,e){let r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Ro(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function cs(t){let e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView,n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return cs(n.host.impl);if(n.host)return cs(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function N2(t){let r=t.ownerDocument.defaultView,n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function rn(t){let e=t.ownerDocument,r=e.defaultView,n=e.documentElement,i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:s,top:o}}function Kg(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Yc(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function vl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Kg(e):t.scrollTop}function jh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Yc(e):t.scrollLeft}function wl(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);let n=["auto","scroll"],i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=r.getComputedStyle(i),n.includes(s)||n.includes(o)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(o)||n.includes(s)))return i;i=i.parentNode}return r}function H2(t){return t.scrollHeight-t.clientHeight}function L2(t){return t.scrollWidth-t.clientWidth}function pa(t){let e=t.ownerDocument,r=e.defaultView,n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;let i=r.getComputedStyle(n),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return n;n=n.parentNode}return r}function Zg(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;let n=t.style[e];if(n!==""&&n!==void 0)return n;let i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function gr(t){return t.offsetWidth}function vr(t){return t.getBoundingClientRect().height}function Oo(t){return t.clientHeight||t.innerHeight}function Gh(t){return t.clientWidth||t.innerWidth}function B2(t){return t.selectionStart?t.selectionStart:0}function Jg(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function zh(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{let i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}var qg;function g9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";let r=t.createElement("div");R2()&&!Li()&&!Wh()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);let n=e.getBoundingClientRect().width;r.style.overflow="scroll";let i=e.getBoundingClientRect().width;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),parseFloat((n-i).toFixed(3))}function qt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return qg===void 0&&(qg=g9(t)),qg}function V2(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function W2(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function xl(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Ao(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function qc(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Yh(t){return qc(t)&&t.hasAttribute("data-hot-input")===!1}function U2(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Io(t){var e;let r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function et(t){return typeof t=="function"}function j2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,o)},e),n}return i}function G2(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,r.concat(o))}}function $c(t,e,r,n,i,s,o,a){return Be(a)?t.call(e,r,n,i,s,o,a):Be(o)?t.call(e,r,n,i,s,o):Be(s)?t.call(e,r,n,i,s):Be(i)?t.call(e,r,n,i):Be(n)?t.call(e,r,n):Be(r)?t.call(e,r):t.call(e)}var Kae=T(xe(),1);var Koe=T(Qe(),1);var Le={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Bh()?182:174,AUDIO_MUTE:Bh()?181:173,AUDIO_UP:Bh()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},v9=[Le.ALT,Le.ARROW_DOWN,Le.ARROW_LEFT,Le.ARROW_RIGHT,Le.ARROW_UP,Le.AUDIO_DOWN,Le.AUDIO_MUTE,Le.AUDIO_UP,Le.BACKSPACE,Le.CAPS_LOCK,Le.DELETE,Le.END,Le.ENTER,Le.ESCAPE,Le.F1,Le.F2,Le.F3,Le.F4,Le.F5,Le.F6,Le.F7,Le.F8,Le.F9,Le.F10,Le.F11,Le.F12,Le.F13,Le.F14,Le.F15,Le.F16,Le.F17,Le.F18,Le.F19,Le.HOME,Le.INSERT,Le.MEDIA_NEXT,Le.MEDIA_PLAY_PAUSE,Le.MEDIA_PREV,Le.MEDIA_STOP,Le.NULL,Le.NUM_LOCK,Le.PAGE_DOWN,Le.PAGE_UP,Le.PAUSE,Le.SCROLL_LOCK,Le.SHIFT,Le.TAB];function z2(t){return v9.includes(t)}function Y2(t){return[Le.CONTROL,Le.COMMAND_LEFT,Le.COMMAND_RIGHT,Le.COMMAND_FIREFOX].includes(t)}function q2(t,e){let r=e.split("|"),n=!1;return Ue(r,i=>{if(t===Le[i])return n=!0,!1}),n}function ko(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function fs(t){return t.isImmediatePropagationEnabled===!1}function Xc(t){return t.button===2}function qh(t){return t.button===0}var Vae=T(xe(),1);var Aae=T(xe(),1),Iae=T(Qe(),1);function Br(){Be(console)&&console.warn(...arguments)}function $2(t){Be(console)&&console.warn(`Deprecated: ${t}`)}function X2(){Be(console)&&console.error(...arguments)}var Ws=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceCacheUpdate","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceCacheUpdate","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","beforeEmptyDataStateShow","afterEmptyDataStateShow","beforeEmptyDataStateHide","afterEmptyDataStateHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],$h=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Xh=new Map([[]]);var dae=T(xe(),1),mae=T(Qe(),1),pae=T(tO(),1),gae=T($r(),1),vae=T(Xr(),1),wae=T(Kr(),1),xae=T(Zr(),1),Sae=T(Jr(),1),Cae=T(Qr(),1),yae=T(en(),1),_ae=T(tt(),1),Eae=T(Xn(),1),Tae=T(rv(),1),bae=T(sr(),1);function V9(t,e){sO(t,e),e.add(t)}function nv(t,e,r){sO(t,e),e.set(t,r)}function sO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nO(t,e,r){return t.set(Zh(t,e),r),r}function nn(t,e){return t.get(Zh(t,e))}function Zh(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var W9=100,Zn=new WeakMap,Sl=new WeakMap,iv=new WeakMap,sv=new WeakSet,Kc=class{constructor(){V9(this,sv),nv(this,Zn,new Map),nv(this,Sl,new Map),nv(this,iv,new Set),Ws.forEach(e=>Zh(sv,this,iO).call(this,e))}getHooks(e){var r;return(r=nn(Zn,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};nn(Zn,this).has(e)||(Zh(sv,this,iO).call(this,e),Ws.push(e));let i=nn(Zn,this).get(e),s=i.find(f=>f.callback===r);if(s){s.skip===!0&&(s.skip=!1);return}let o=Number.isInteger(n.orderIndex)?n.orderIndex:0,a=!!n.runOnce,l=!!n.initialHook,u=!1;if(l){let f=i.find(d=>d.initialHook);f&&(f.callback=r,u=!0)}if(!u){i.push({callback:r,orderIndex:o,runOnce:a,initialHook:l,skip:!1});let f=nn(iv,this).has(e);!f&&o!==0&&(f=!0,nn(iv,this).add(e)),f&&i.length>1&&nn(Zn,this).set(e,i.toSorted((d,p)=>d.orderIndex-p.orderIndex))}}has(e){return nn(Zn,this).has(e)&&nn(Zn,this).get(e).length>0}remove(e,r){if(!nn(Zn,this).has(e))return!1;let n=nn(Zn,this).get(e),i=n.find(s=>s.callback===r);if(i){let s=nn(Sl,this).get(e);return i.skip=!0,s+=1,s>W9&&(nn(Zn,this).set(e,n.filter(o=>!o.skip)),s=0),nn(Sl,this).set(e,s),!0}return!1}destroy(){nn(Zn,this).clear(),nn(Sl,this).clear(),nO(Zn,this,null),nO(Sl,this,null)}};function iO(t){nn(Zn,this).set(t,[]),nn(Sl,this).set(t,0)}function U9(t,e,r){return(e=j9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j9(t){var e=G9(t,"string");return typeof e=="symbol"?e:e+""}function G9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var z9=mr`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,$t=class{constructor(){U9(this,"globalBucket",new Kc)}static getSingleton(){return q9()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new Kc),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Ue(r,s=>this.add(e,s,n)):($h.has(e)&&Br(bh(z9,{hookName:e,removedInVersion:$h.get(e)})),Xh.has(e)&&Br(Xh.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Ue(r,s=>this.once(e,s,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?Ue(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,s,o,a,l){{let u=this.getBucket().getHooks(r),f=u?u.length:0,d=0;if(f)for(;d<f;){if(!u[d]||u[d].skip){d+=1;continue}let p=$c(u[d].callback,e,n,i,s,o,a,l);p!==void 0&&(n=p),u[d]&&u[d].runOnce&&this.remove(r,u[d].callback),d+=1}}{let u=this.getBucket(e).getHooks(r),f=u?u.length:0,d=0;if(f)for(;d<f;){if(!u[d]||u[d].skip){d+=1;continue}let p=$c(u[d].callback,e,n,i,s,o,a,l);p!==void 0&&(n=p),u[d]&&u[d].runOnce&&this.remove(r,u[d].callback,e),d+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Ws.push(e)}deregister(e){this.isRegistered(e)&&Ws.splice(Ws.indexOf(e),1)}isDeprecated(e){return Xh.has(e)||$h.has(e)}isRegistered(e){return Ws.indexOf(e)>=0}getRegistered(){return Ws}},Y9=new $t;function q9(){return Y9}var ga=new Map;function Hn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";ga.has(t)||ga.set(t,new Map);let e=ga.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function s(){return[...e.keys()]}function o(){return[...e.values()]}function a(){ga.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:o,clear:a}}function oO(t,e){var r;return ga==null||(r=ga.get(t.guid))===null||r===void 0?void 0:r.get(e)}var ov=new WeakMap,{register:$9,getItem:aO,hasItem:X9,getNames:jae,getValues:Gae}=Hn("editors");function K9(t){let e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},$t.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function lO(t,e){let r;if(typeof t=="function")ov.get(t)||lv(null,t),r=ov.get(t);else if(typeof t=="string")r=aO(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function av(t){if(typeof t=="function")return t;if(!X9(t))throw Error(`No registered editor found under "${t}" name`);return aO(t).getConstructor()}function lv(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);let r=new K9(e);typeof t=="string"&&$9(t,r),ov.set(e,r)}var Yae=T(xe(),1),qae=T(Qe(),1);function Z9(t,e,r){return(e=J9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J9(t){var e=Q9(t,"string");return typeof e=="symbol"?e:e+""}function Q9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cv=0,uv=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Z9(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){n.call(this,e7(o))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),cv+=1,()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===r&&o.element===e){if(n&&n!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),cv-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;let n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),cv-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);let s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,s.relatedTarget||n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}};function e7(t){let e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ko(this)},t}var Bi=uv;function t7(t,e){r7(t,e),e.add(t)}function r7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function va(t,e,r){return(e=n7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n7(t){var e=i7(t,"string");return typeof e=="symbol"?e:e+""}function i7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fv(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Jh=new WeakSet,Zc=class{constructor(e,r,n){t7(this,Jh),va(this,"hot",void 0),va(this,"tableMeta",void 0),va(this,"selection",void 0),va(this,"eventManager",void 0),va(this,"destroyed",!1),va(this,"activeEditor",void 0),va(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Bi(e),this.hot.addHook("afterDocumentKeyDown",i=>fv(Jh,this,cO).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>fv(Jh,this,cO).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>fv(Jh,this,s7).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}let r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;let{row:n,col:i}=r,s=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta"),o=n,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}let l=this.hot.getCell(n,i,!0);if(l){let u=this.hot.getCellEditor(this.cellProperties),f=this.hot.colToProp(a),d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=lO(u,this.hot),this.activeEditor.prepare(n,i,f,l,d,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}let i=this.hot.getSelectedRangeActive(),s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let e=this.hot.getSelectedRangeActive();if(!e)return!1;let r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){let r=De({},typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves);e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}};function cO(t){let e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||fs(t))return;let{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!z2(r)&&!Y2(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function s7(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}var uO=new WeakMap;Zc.getInstance=function(t,e,r){let n=uO.get(t);return n||(n=new Zc(t,e,r),uO.set(t,n)),n};var fO=Zc;var ule=T(Qe(),1),fle=T(bO(),1),hle=T(tt(),1),dle=T(Xn(),1),mle=T(Cn(),1),ple=T(Vc(),1);var L7={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},vle=new RegExp(Object.keys(L7).map(t=>`(${t})`).join("|"),"gi");function vv(t){let e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=r?1:0,d=e?1:0;for(let p=0;p<s;p+=1){let g=e&&p===0,x=[];for(let y=0;y<o;y+=1){let P=!g&&r&&y===0,N="";if(g)N=`<th>${t.getColHeader(y-f)}</th>`;else if(P)N=`<th>${t.getRowHeader(p-d)}</th>`;else{let B=i[p][y],{hidden:F,rowspan:Q,colspan:he}=t.getCellMeta(p-d,y-f);if(!F){let U=[];if(Q&&U.push(`rowspan="${Q}"`),he&&U.push(`colspan="${he}"`),Ls(B))N=`<td ${U.join(" ")}></td>`;else{let X=B.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");N=`<td ${U.join(" ")}>${X}</td>`}}}x.push(N)}let w=["<tr>",...x,"</tr>"].join("");g?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}var Kle=T(xe(),1);var Ale=T(xe(),1),Ile=T(tt(),1),kle=T(Cn(),1);var xle=T($r(),1),Sle=T(Xr(),1),Cle=T(Kr(),1),yle=T(Zr(),1),_le=T(Jr(),1),Ele=T(Qr(),1),Tle=T(en(),1),ble=T(tt(),1),Rle=T(Cn(),1);function RO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);let n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function sn(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function wv(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function Wt(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}function Us(t){return Number.isInteger(t)&&t>=0}var xv="asc",B7="desc",OO=new Map([[xv,[-1,1]],[B7,[1,-1]]]),V7=t=>`The priority '${t}' is already declared in a map.`,W7=t=>`The priority '${t}' is not a number.`;function AO(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=new Map;t=et(t)?t:V7,e=et(e)?e:W7;function n(s,o){if(!RO(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xv,[o,a]=OO.get(s)||OO.get(xv);return[...r].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:n,getItems:i}}var Ple=T(xe(),1),Nle=T(tt(),1),Hle=T(rv(),1);var U7=t=>`The id '${t}' is already declared in a map.`;function hs(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Map;t=et(t)?t:U7;function r(f,d){if(u(f))throw new Error(t(f));e.set(f,d)}function n(f){return e.delete(f)}function i(){e.clear()}function s(f){let[d]=a().find(p=>{let[g,x]=p;return f===x?g:!1})||[null];return d}function o(f){return e.get(f)}function a(){return[...e]}function l(){return[...e.values()]}function u(f){return e.has(f)}return{addItem:r,clear:i,getId:s,getItem:o,getItems:a,getValues:l,hasItem:u,removeItem:n}}var Vle=T(xe(),1),Wle=T($r(),1),Ule=T(Xr(),1),jle=T(Kr(),1),Gle=T(Zr(),1),zle=T(Jr(),1),Yle=T(Qr(),1),qle=T(en(),1);var j7=t=>`'${t}' value is already declared in a unique set.`;function IO(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Set;t=et(t)?t:j7;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}var kO=t=>`There is already registered "${t}" plugin.`,G7=t=>`There is already registered plugin on priority "${t}".`,z7=t=>`The priority "${t}" is not a number.`,Y7=AO({errorPriorityExists:G7,errorPriorityNaN:z7}),q7=IO({errorItemExists:kO}),$7=hs({errorIdExists:kO});function MO(){return[...Y7.getItems(),...q7.getItems()]}function FO(t){let e=dl(t);return $7.getItem(e)}var rce=T(xe(),1);var{register:X7,getItem:K7,hasItem:Z7,getNames:ice,getValues:sce}=Hn("renderers");function Sv(t){if(typeof t=="function")return t;if(!Z7(t))throw Error(`No registered renderer found under "${t}" name`);return K7(t)}function DO(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),X7(t,e)}var ace=T(xe(),1);var{register:J7,getItem:Q7,hasItem:ej,getNames:cce,getValues:uce}=Hn("validators");function PO(t){if(typeof t=="function")return t;if(!ej(t))throw Error(`No registered validator found under "${t}" name`);return Q7(t)}function NO(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),J7(t,e)}var epe=T(xe(),1),tpe=T(Qe(),1);var gce=T(xe(),1),vce=T(Jc(),1),wce=T(Qc(),1);function eu(t,e,r){return(e=mj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mj(t){var e=pj(t,"string");return typeof e=="symbol"?e:e+""}function pj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var tu=class{constructor(){eu(this,"count",0),eu(this,"startColumn",null),eu(this,"endColumn",null),eu(this,"startPosition",null),eu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){let{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=r,a=i>0?s+1:s;n>=i&&n+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;let{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:f}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){let x=u[this.endColumn]+f-u[this.startColumn-1];if(x<=i&&(this.startColumn-=1),x>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;let d=o>0?i+1:i,p=n+i-d,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);p<-1*s||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}};var Sce=T(xe(),1),Cce=T(Jc(),1),yce=T(Qc(),1);function ru(t,e,r){return(e=gj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gj(t){var e=vj(t,"string");return typeof e=="symbol"?e:e+""}function vj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nu=class{constructor(){ru(this,"count",0),ru(this,"startRow",null),ru(this,"endRow",null),ru(this,"startPosition",null),ru(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){let{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=r;n>=i&&n+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;let{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){let p=l[this.endRow]+u-l[this.startRow-1];if(p<=i-s&&(this.startRow-=1),p>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;let f=n+i-s,d=this.startRow===null?0:e.getRowHeight(this.startRow);f<d||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}};var Ece=T(xe(),1),Tce=T(Jc(),1),bce=T(Qc(),1);function iu(t,e,r){return(e=wj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wj(t){var e=xj(t,"string");return typeof e=="symbol"?e:e+""}function xj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wa=class{constructor(){iu(this,"count",0),iu(this,"startColumn",null),iu(this,"endColumn",null),iu(this,"startPosition",null),iu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){let{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s}=r;n<=i&&(this.startColumn=e);let o=i>0?s+1:s;n>=i&&n<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;let{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:f}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){let g=u[this.endColumn]+f-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;let d=o>0?i+1:i;n+i-d<-1*s||n>u.at(-1)+f||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}};var Oce=T(xe(),1),Ace=T(Jc(),1),Ice=T(Qc(),1);function su(t,e,r){return(e=Sj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sj(t){var e=Cj(t,"string");return typeof e=="symbol"?e:e+""}function Cj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xa=class{constructor(){su(this,"count",0),su(this,"startRow",null),su(this,"endRow",null),su(this,"startPosition",null),su(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){let{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s}=r;n<=i&&(this.startRow=e),n>=i&&n<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;let{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){let d=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,d>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-s<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}};var Mce=T(xe(),1);function ou(t,e,r){return(e=yj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yj(t){var e=_j(t,"string");return typeof e=="symbol"?e:e+""}function _j(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var au=class{constructor(){ou(this,"count",0),ou(this,"startColumn",0),ou(this,"endColumn",0),ou(this,"startPosition",0),ou(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}};var Dce=T(xe(),1);function lu(t,e,r){return(e=Ej(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ej(t){var e=Tj(t,"string");return typeof e=="symbol"?e:e+""}function Tj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cu=class{constructor(){lu(this,"count",0),lu(this,"startRow",0),lu(this,"endRow",0),lu(this,"startPosition",0),lu(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}};var Nce=T(xe(),1);function HO(t,e,r){return(e=bj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bj(t){var e=Rj(t,"string");return typeof e=="symbol"?e:e+""}function Rj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uu=class extends wa{constructor(){super(...arguments),HO(this,"columnStartOffset",0),HO(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);let{overrideFn:n,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof n=="function"){let o=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}};var Bce=T(xe(),1);function LO(t,e,r){return(e=Oj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Oj(t){var e=Aj(t,"string");return typeof e=="symbol"?e:e+""}function Aj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fu=class extends xa{constructor(){super(...arguments),LO(this,"rowStartOffset",0),LO(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);let{overrideFn:n,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof n=="function"){let o=this.startRow,a=this.endRow;n(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}};var Yce=T(xe(),1),qce=T(Qe(),1);var Uce=T(xe(),1),jce=T(tt(),1),Gce=T(sr(),1);function BO(t,e,r){return(e=Ij(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ij(t){var e=kj(t,"string");return typeof e=="symbol"?e:e+""}function kj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yl=class{constructor(e){BO(this,"calculationTypes",[]),BO(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}};function Vi(t,e,r){return(e=Mj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mj(t){var e=Fj(t,"string");return typeof e=="symbol"?e:e+""}function Fj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hu=50,_l=class extends yl{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(r),Vi(this,"viewportWidth",0),Vi(this,"scrollOffset",0),Vi(this,"zeroBasedScrollOffset",0),Vi(this,"totalColumns",0),Vi(this,"columnWidthFn",null),Vi(this,"columnWidth",0),Vi(this,"overrideFn",null),Vi(this,"inlineStartOffset",0),Vi(this,"totalCalculatedWidth",0),Vi(this,"startPositions",[]),Vi(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){let r=this.columnWidthFn(e);return isNaN(r)?hu:r}};var Kce=T(xe(),1),Zce=T(Qe(),1);function mi(t,e,r){return(e=Dj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dj(t){var e=Pj(t,"string");return typeof e=="symbol"?e:e+""}function Pj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var El=class extends yl{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),mi(this,"viewportHeight",0),mi(this,"scrollOffset",0),mi(this,"zeroBasedScrollOffset",0),mi(this,"totalRows",0),mi(this,"rowHeightFn",null),mi(this,"rowHeight",0),mi(this,"overrideFn",null),mi(this,"horizontalScrollbarHeight",0),mi(this,"innerViewportHeight",0),mi(this,"totalCalculatedHeight",0),mi(this,"startPositions",[]),mi(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){let r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}};var fue=T(xe(),1);function Nj(t,e,r){Hj(t,e),e.set(t,r)}function Hj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VO(t,e,r){return(e=Lj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lj(t){var e=Bj(t,"string");return typeof e=="symbol"?e:e+""}function Bj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tl(t,e){return t.get(UO(t,e))}function WO(t,e,r){return t.set(UO(t,e),r),r}function UO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var js=new WeakMap,Cv=class t{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;VO(this,"row",null),VO(this,"col",null),Nj(this,js,!1),WO(js,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){let{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:s}=De({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},e);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Tl(js,this)}isSouthEastOf(e){return this.row>=e.row&&(Tl(js,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Tl(js,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Tl(js,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Tl(js,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof t&&WO(js,this,e.isRtl()),this}clone(){return new t(this.row,this.col,Tl(js,this))}toObject(){return{row:this.row,col:this.col}}},Mo=Cv;var mue=T(xe(),1),pue=T(Qe(),1);function Vj(t,e,r){Wj(t,e),e.set(t,r)}function Wj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yv(t,e,r){return(e=Uj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uj(t){var e=jj(t,"string");return typeof e=="symbol"?e:e+""}function jj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pi(t,e){return t.get(jO(t,e))}function Gj(t,e,r){return t.set(jO(t,e),r),r}function jO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ln=new WeakMap,_v=class t{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;yv(this,"highlight",null),yv(this,"from",null),yv(this,"to",null),Vj(this,Ln,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),Gj(Ln,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){let{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){let r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;let n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),f=Math.max(i.row,a.row),d=Math.max(i.col,a.col),p=this._createCellCoords(l,u),g=this._createCellCoords(f,d);return this.from=p,this.to=g,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return pi(Ln,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return pi(Ln,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return pi(Ln,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return pi(Ln,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return pi(Ln,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return pi(Ln,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return pi(Ln,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return pi(Ln,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Mo))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];let r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(pi(Ln,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(pi(Ln,this)?"right":"left"),i}getInner(){let e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){let e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){let r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new t(this.highlight,this.from,this.to,pi(Ln,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Mo(e,r,pi(Ln,this))}},Sa=_v;var Rme=T(Qe(),1);var wue=T(xe(),1);function ds(t,e,r){zj(t,e),e.set(t,r)}function zj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return t.get(GO(t,e))}function Fo(t,e,r){return t.set(GO(t,e),r),r}function GO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gi=new WeakMap,Ev=new WeakMap,Vr=new WeakMap,bl=new WeakMap,Qh=new WeakMap,Wi=new WeakMap,Tv=new WeakMap,du=new WeakMap,Ca=new WeakMap,ms=new WeakMap,bv=class{constructor(e,r,n,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ds(this,gi,void 0),ds(this,Ev,void 0),ds(this,Vr,void 0),ds(this,bl,void 0),ds(this,Qh,void 0),ds(this,Wi,void 0),ds(this,Tv,void 0),ds(this,du,void 0),ds(this,Ca,[null,null]),ds(this,ms,[null,null]),Fo(gi,this,n),Fo(Ev,this,r),Fo(Vr,this,s),Fo(bl,this,o),Fo(Qh,this,a),Fo(Wi,this,i),Fo(Tv,this,e),this.registerEvents()}registerEvents(){Pe(Wi,this).addEventListener(Pe(Vr,this).holder,"contextmenu",n=>this.onContextMenu(n)),Pe(Wi,this).addEventListener(Pe(Vr,this).TABLE,"mouseover",n=>this.onMouseOver(n)),Pe(Wi,this).addEventListener(Pe(Vr,this).TABLE,"mouseout",n=>this.onMouseOut(n));let e=()=>{Pe(Wi,this).addEventListener(Pe(Vr,this).holder,"touchstart",n=>this.onTouchStart(n)),Pe(Wi,this).addEventListener(Pe(Vr,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),Pe(Wi,this).addEventListener(Pe(Vr,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Pe(gi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Pe(gi,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{Pe(Wi,this).addEventListener(Pe(Vr,this).holder,"mouseup",n=>this.onMouseUp(n)),Pe(Wi,this).addEventListener(Pe(Vr,this).holder,"mousedown",n=>this.onMouseDown(n))};Li()?e():(y2()&&e(),r())}selectedCellWasTouched(e){let n=this.parentCell(e).coords;if(Pe(du,this)&&n){let[i,s]=[n.row,Pe(du,this).from.row],[o,a]=[n.col,Pe(du,this).from.col];return i===s&&o===a}return!1}parentCell(e){let r={},n=Pe(Vr,this).TABLE,i=Gc(e,["TD","TH"],n);return i?(r.coords=Pe(Vr,this).getCoords(i),r.TD=i):pt(e,"wtBorder")&&pt(e,"current")?(r.coords=Pe(bl,this).getFocusSelection().cellRange.highlight,r.TD=Pe(Vr,this).getCell(r.coords)):pt(e,"wtBorder")&&pt(e,"area")&&Pe(bl,this).getAreaSelection().cellRange&&(r.coords=Pe(bl,this).getAreaSelection().cellRange.to,r.TD=Pe(Vr,this).getCell(r.coords)),r}onMouseDown(e){let r=Pe(Ev,this).rootDocument.activeElement,n=G2(A2,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;let s=this.parentCell(i);pt(i,"corner")?Pe(gi,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&Pe(gi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Pe(ms,this)[0]=s.TD,clearTimeout(Pe(Ca,this)[0]),Pe(Ca,this)[0]=setTimeout(()=>{Pe(ms,this)[0]=null},1e3))}onContextMenu(e){if(Pe(gi,this).has("onCellContextMenu")){let r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!Pe(gi,this).has("onCellMouseOver"))return;let r=Pe(Vr,this).TABLE,n=Gc(e.target,["TD","TH"],r),i=Pe(Qh,this)||this;n&&n!==i.lastMouseOver&&zc(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,Pe(Vr,this).getCoords(n),n))}onMouseOut(e){if(!Pe(gi,this).has("onCellMouseOut"))return;let r=Pe(Vr,this).TABLE,n=Gc(e.target,["TD","TH"],r),i=Gc(e.relatedTarget,["TD","TH"],r),s=Pe(Qh,this)||this;n&&n!==i&&zc(n,r)&&(this.callListener("onCellMouseOut",e,Pe(Vr,this).getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){let r=this.parentCell(e.target);r.TD&&Pe(gi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===Pe(ms,this)[0]&&r.TD===Pe(ms,this)[1]?(pt(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),Pe(ms,this)[0]=null,Pe(ms,this)[1]=null):r.TD===Pe(ms,this)[0]&&(Pe(ms,this)[1]=r.TD,clearTimeout(Pe(Ca,this)[1]),Pe(Ca,this)[1]=setTimeout(()=>{Pe(ms,this)[1]=null},500)))}onTouchStart(e){Fo(du,this,Pe(bl,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;let n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=Be(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&Pe(gi,this).getSetting("isDataViewInstance")){let a=["A","BUTTON","INPUT"];Vh()&&(T2()||b2())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){let s=Pe(gi,this).getSettingPure(e);s&&s(r,n,i,Pe(Tv,this).call(this))}destroy(){clearTimeout(Pe(Ca,this)[0]),clearTimeout(Pe(Ca,this)[1]),Pe(Wi,this).destroy()}},ed=bv;var J0e=T(xe(),1),Q0e=T(Qe(),1),eme=T(tt(),1),tme=T(sr(),1),rme=T(Vc(),1);var $fe=T(xe(),1),Xfe=T(Qe(),1),Kfe=T(tt(),1),Zfe=T(sr(),1);var Tue=T(xe(),1);function Rv(t,e,r){return(e=Yj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yj(t){var e=qj(t,"string");return typeof e=="symbol"?e:e+""}function qj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ov=class{constructor(e,r,n){Rv(this,"offset",void 0),Rv(this,"total",void 0),Rv(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}},zO=Ov;var Rue=T(xe(),1);function Av(t,e,r){return(e=$j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $j(t){var e=Xj(t,"string");return typeof e=="symbol"?e:e+""}function Xj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Iv=class{constructor(e,r,n){Av(this,"offset",void 0),Av(this,"total",void 0),Av(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}},YO=Iv;var ofe=T(xe(),1);var zue=T(xe(),1),Yue=T(Qe(),1);var Mue=T(xe(),1);var Aue=T(xe(),1);function td(t,e,r){return(e=Kj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kj(t){var e=Zj(t,"string");return typeof e=="symbol"?e:e+""}function Zj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rd=class{constructor(){td(this,"currentSize",0),td(this,"nextSize",0),td(this,"currentOffset",0),td(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}};function kv(t,e,r){return(e=Qj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qj(t){var e=eG(t,"string");return typeof e=="symbol"?e:e+""}function eG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nd=class{constructor(){kv(this,"size",new rd),kv(this,"workingSpace",0),kv(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}};var Wue=T(xe(),1),Uue=T(Qe(),1);var Lue=T(xe(),1),Bue=T(ZO(),1);function fG(t,e,r){return(e=hG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hG(t){var e=dG(t,"string");return typeof e=="symbol"?e:e+""}function dG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mu=class{constructor(e,r){fG(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}};function mG(t,e,r){return(e=pG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pG(t){var e=gG(t,"string");return typeof e=="symbol"?e:e+""}function gG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var id=class{constructor(e){mG(this,"sizeSet",void 0),this.sizeSet=e}diff(){let{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize(),i=Math.max(n,r);if(i===0)return[];let{currentOffset:s,nextOffset:o}=e.getViewSize(),a=new mu(s,r),l=new mu(o,n),u=[];for(let f=0;f<i;f++){let d=a.get(f),p=l.get(f);if(p===-1)u.push(["remove",d]);else if(d===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(2)?u.push(["append",p]):u.push(["prepend",p]);else if(p>d)a.has(p)&&(a.remove(p),n<=a.length&&(i-=1)),u.push(["replace",p,d]);else if(p<d){let g=a.prepend(p);u.push(["insert_before",p,d,g])}else u.push(["none",p])}return u}};function Rl(t,e,r){return(e=vG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vG(t){var e=wG(t,"string");return typeof e=="symbol"?e:e+""}function wG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ya=class{constructor(e,r){Rl(this,"rootNode",void 0),Rl(this,"nodesPool",void 0),Rl(this,"sizeSet",new nd),Rl(this,"collectedNodes",[]),Rl(this,"viewDiffer",new id(this.sizeSet)),Rl(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){let e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){let{rootNode:r}=this,[n,i,s,o]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(s)),r.removeChild(this.nodesPool(o));break;case"replace":r.replaceChild(a,this.nodesPool(s));break;case"remove":r.removeChild(a);break;default:break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}};var _a=class extends ya{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}};var nfe=T(xe(),1);var tfe=T(xe(),1);function JO(t,e,r){return(e=xG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xG(t){var e=SG(t,"string");return typeof e=="symbol"?e:e+""}function SG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sd=class{constructor(e){JO(this,"nodeType",void 0),JO(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){let i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);let s=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,s),s}};function pu(t,e,r){return(e=CG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CG(t){var e=yG(t,"string");return typeof e=="symbol"?e:e+""}function yG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vi=class{constructor(e,r){pu(this,"nodesPool",null),pu(this,"nodeType",void 0),pu(this,"rootNode",void 0),pu(this,"table",null),pu(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new sd(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}};function QO(t,e,r){return(e=_G(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _G(t){var e=EG(t,"string");return typeof e=="symbol"?e:e+""}function EG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var od=class extends vi{constructor(){super("TH"),QO(this,"orderViews",new WeakMap),QO(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new _a(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){let{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){let a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;let u=this.obtainOrderView(l),f=s.obtainOrderView(l);u.appendView(f).setSize(n).setOffset(0).start();for(let d=n-1;d>=0;d--){u.render();let p=u.getCurrentNode();p.className="",p.removeAttribute("style"),us(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&dt(p,[YR(),XR(),pl(d+1),ls(-1)]),r[d](a,p,d)}u.end()}}};var ad=class extends vi{constructor(e){super(null,e)}adjust(){let{columnHeadersCount:e,rowHeadersCount:r}=this.table,n=this.rootNode.firstChild;if(e){let{columnsToRender:i}=this.table,s=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}let o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Ro(n)}render(){let{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&dt(this.rootNode,[Rh()]);for(let r=0;r<e;r+=1){let{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&dt(o,[Oh(),kh(r+1)]);for(let a=-1*s;a<i;a+=1){let l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),us(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&dt(u,[pl(a+1+this.table.rowHeadersCount),ls(-1),qR(),...a>=0?[$R()]:[zR(),Ah("Select whole grid")]]),n[r](l,u,r)}}}};var eA=!1,ld=class extends vi{constructor(e){super(null,e)}adjust(){let{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:e,rowHeadersCount:r}=this.table;!eA&&e>1e3&&(eA=!0,Br(mr`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){let s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){let s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+r].style.width=`${o}px`}let n=this.rootNode.firstChild;n&&Ne(n,"rowHeader")}};var Cfe=T(xe(),1);function TG(t,e,r){return(e=bG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bG(t){var e=RG(t,"string");return typeof e=="symbol"?e:e+""}function RG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ol={rowEven:"ht__row_even",rowOdd:"ht__row_odd"},tA=!1,cd=class extends vi{constructor(e){super("TR",e),TG(this,"orderView",void 0),this.orderView=new ya(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){let{rowsToRender:e}=this.table;!tA&&e>1e3&&(tA=!0,Br(mr`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&dt(this.rootNode,[Rh()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();let s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;dt(s,[Oh(),kh(o+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(o+1)%2===0?pt(s,Ol.rowEven)||(ot(s,Ol.rowOdd),Ne(s,Ol.rowEven)):pt(s,Ol.rowOdd)||(ot(s,Ol.rowEven),Ne(s,Ol.rowOdd))}this.orderView.end()}};var Afe=T(xe(),1);function rA(t,e,r){return(e=OG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OG(t){var e=AG(t,"string");return typeof e=="symbol"?e:e+""}function AG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ud=class extends vi{constructor(){super("TD"),rA(this,"orderViews",new WeakMap),rA(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new _a(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){let{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){let l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;let f=this.obtainOrderView(u),d=i.obtainOrderView(u);f.prependView(d).setSize(r).setOffset(0).start();for(let p=0;p<r;p++){f.render();let g=this.table.renderedColumnToSource(p),x=f.getCurrentNode();if(pt(x,"hide")||(x.className=""),x.removeAttribute("style"),x.removeAttribute("dir"),us(x,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,x),this.table.isAriaEnabled()){var s,o;dt(x,[...x.hasAttribute("role")?[]:[GR()],ls(-1),pl(g+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}f.end()}}};var Pfe=T(xe(),1);function Tr(t,e,r){return(e=IG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IG(t){var e=kG(t,"string");return typeof e=="symbol"?e:e+""}function kG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fd=class{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Tr(this,"rootNode",void 0),Tr(this,"rootDocument",void 0),Tr(this,"rowHeaders",null),Tr(this,"columnHeaders",null),Tr(this,"colGroup",null),Tr(this,"rows",null),Tr(this,"cells",null),Tr(this,"rowFilter",null),Tr(this,"columnFilter",null),Tr(this,"rowUtils",null),Tr(this,"columnUtils",null),Tr(this,"rowsToRender",0),Tr(this,"columnsToRender",0),Tr(this,"rowHeaderFunctions",[]),Tr(this,"rowHeadersCount",0),Tr(this,"columnHeaderFunctions",[]),Tr(this,"columnHeadersCount",0),Tr(this,"cellRenderer",void 0),Tr(this,"activeOverlayName",void 0),Tr(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){let i=r.getRenderedNode(n),s=this.rowUtils;if(i.firstChild){let o=this.renderedRowToSource(n),a=s.getHeightByOverlayName(o,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}};var hd=class{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new fd(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new od,columnHeaders:new ad(r),colGroup:new ld(n),rows:new cd(i),cells:new ud}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}};var Gfe=T(xe(),1);function Mv(t,e,r){return(e=MG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MG(t){var e=FG(t,"string");return typeof e=="symbol"?e:e+""}function FG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dd=class{constructor(e,r){Mv(this,"dataAccessObject",void 0),Mv(this,"wtSettings",void 0),Mv(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight(),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){let{wtSettings:e}=this,r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){let n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<n;s++){let o=Array.isArray(r)?r[s]:r;o=o??i,this.headerWidths.set(s,o)}}}};var Yfe=T(xe(),1);function nA(t,e,r){return(e=DG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DG(t){var e=PG(t,"string");return typeof e=="symbol"?e:e+""}function PG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var md=class{constructor(e,r){nA(this,"dataAccessObject",void 0),nA(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e),n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r),i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}};function ps(t,e,r){return(e=NG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NG(t){var e=HG(t,"string");return typeof e=="symbol"?e:e+""}function HG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fv=class{constructor(e,r,n,i,s){ps(this,"wtSettings",null),ps(this,"domBindings",void 0),ps(this,"TBODY",null),ps(this,"THEAD",null),ps(this,"COLGROUP",null),ps(this,"hasTableHeight",!0),ps(this,"hasTableWidth",!0),ps(this,"isTableVisible",!1),ps(this,"tableOffset",0),ps(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Xg(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new md(this.dataAccessObject,this.wtSettings),this.columnUtils=new dd(this.dataAccessObject,this.wtSettings),this.tableRenderer=new hd({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){let e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){let r=e.parentNode,n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!pt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&dt(n,[Pi()]),n}createHider(e){let r=e.parentNode,n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!pt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&dt(n,[Pi()]),n}createHolder(e){let r=e.parentNode,n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!pt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&dt(n,[ls(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&dt(n.parentNode,[Pi()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&dt(n,[Pi()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),f=u.length,d=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=rn(this.holder),d=i.createCalculators(d),l&&!r.getSetting("fixedColumnsStart"))){let g=n.inlineStartOverlay.getScrollPosition(),x=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,x!==this.correctHeaderWidth&&(d=!1)}if(d)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=rn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let g=Math.max(this.getFirstRenderedRow(),0),x=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new YO(g,s,f),this.columnFilter=new zO(x,o,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let y={};this.wtSettings.getSetting("beforeDraw",!0,y),w=y.skipRender!==!0}w&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Jn)||this.is(Ui))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Jn))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Jn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let p=!1;return this.isMaster&&(p=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(p=n.bottomOverlay.resetFixedPosition()||p),p=n.inlineStartOverlay.resetFixedPosition()||p,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),p?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){let r=this.columnFilter.renderedToSource(e),n=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight(),s,o,a,l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),o=this.getColumnHeader(r,n),o&&(a=Oo(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){let{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){let{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Jn))&&!e.getSetting("externalRowCalculator")){let n=this.getRenderedRowsCount();for(let i=0;i<n;i++){let s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,n=e.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;let s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");let o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=this.THEAD.childNodes[r];return n?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){let r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{let s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;let i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a?.childNodes[r]}getRowHeaders(e){let r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){let s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s?.childNodes[i];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=$g(r,["TD","TH"])),r===null)return null;let n=r.parentNode;if(!n)return null;let i=n.parentNode,s=M2(n),o=r.cellIndex;bo(gs,r,this.wtRootElement)||bo(ji,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):bo(Ui,r,this.wtRootElement)||bo(Jn,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),bo(gs,r,this.wtRootElement)||bo(Gi,r,this.wtRootElement)||bo(Ui,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));let a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length,r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=Oo(this.TBODY)-1,s=r.areCellsBorderBox(),o=s?vr:Oo,a=s?0:1,l=s?1:0,u,f,d,p,g;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,d=this.rowFilter.renderedToSource(e),u=this.getRowHeight(d),p=this.getTrForRow(d),g=p.querySelector("th");let x=d===0?l:0;g?f=o(g):f=o(p)-a,(!u&&r.getDefaultRowHeight()<f-x||u<f)&&(s||(f+=1),this.dataAccessObject.wtViewport.oversizedRows[d]=f)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;let n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;let n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){let r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){let r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return gr(this.TABLE)}getHeight(){return vr(this.TABLE)}getTotalWidth(){let e=gr(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){let e=vr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return cs(this.TABLE)}_modifyRowHeaderWidth(e){let r=et(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}},wi=Fv;var LG="stickyRowsBottom",iA={getFirstRenderedRow(){let t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};dn(iA,"MIXIN_NAME",LG,{writable:!1,enumerable:!1});var pd=iA;var BG="stickyColumnsStart",sA={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};dn(sA,"MIXIN_NAME",BG,{writable:!1,enumerable:!1});var Al=sA;var gu=class extends wi{constructor(e,r,n,i){super(e,r,n,i,Ui)}};ft(gu,pd);ft(gu,Al);var oA=gu;var Nhe=T(xe(),1);var ji="top",Jn="bottom",Gi="inline_start",gs="top_inline_start_corner",Ui="bottom_inline_start_corner",gd=[ji,Jn,Gi,gs,Ui],aA=new Map([[ji,`ht_clone_${ji}`],[Jn,`ht_clone_${Jn}`],[Gi,`ht_clone_${Gi} ht_clone_left`],[gs,`ht_clone_${gs} ht_clone_top_left_corner`],[Ui,`ht_clone_${Ui} ht_clone_bottom_left_corner`]]);var Mhe=T(xe(),1);var _he=T(xe(),1),Ehe=T(Qe(),1);var xhe=T(xe(),1);function VG(t,e){WG(t,e),e.add(t)}function WG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UG(t,e,r){return(e=jG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jG(t){var e=GG(t,"string");return typeof e=="symbol"?e:e+""}function GG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vd(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var vu=new WeakSet,Dv=class{constructor(e){VG(this,vu),UG(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;let i=this.scrollViewportHorizontally(e.col,r),s=this.scrollViewportVertically(e.row,n);return i||s}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;let s=Pr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;let{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<o)return!1;let u=this.getFirstVisibleColumn(),f=this.getLastVisibleColumn(),d=!1;return(l&&(e<u||e>f)||!l)&&(d=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),d}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;let s=Pr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;let{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-o-1))return!1;let f=this.getFirstVisibleRow(),d=this.getLastVisibleRow(),p=!1;return(u&&(e<f||e>d)||!u)&&(p=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),p}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return vd(vu,this,cA).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return vd(vu,this,cA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return vd(vu,this,lA).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return vd(vu,this,lA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function lA(t){let{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){let a=e.getSetting("rtlMode"),l=null;if(a){let f=n.TABLE.getBoundingClientRect(),p=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(f.right-p)}else l=rn(n.wtRootElement).left;let u=Math.abs(jh(o,o));if(l>u){let f=Gh(o),d=i.getRowHeaderWidth();for(let p=1;p<=s;p++)if(d+=r.sumCellSizes(p-1,p),l+d-u>=f){t=p-2;break}}}return t}function cA(t){let{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){let o=rn(r.wtRootElement),a=vl(s,s);if(o.top>a){let l=Oo(s),u=n.getColumnHeaderHeight();for(let f=1;f<=i;f++)if(u+=e.sumCellSizes(f-1,f),o.top+u-a>=l){t=f-2;break}}}return t}var uA=Dv;function xi(t,e,r){return(e=zG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zG(t){var e=YG(t,"string");return typeof e=="symbol"?e:e+""}function YG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Do=class{get eventManager(){return new Bi(this)}constructor(e,r){xi(this,"wtTable",void 0),xi(this,"wtScroll",void 0),xi(this,"wtViewport",void 0),xi(this,"wtOverlays",void 0),xi(this,"selectionManager",void 0),xi(this,"wtEvent",void 0),xi(this,"guid",`wt_${Th()}`),xi(this,"drawInterrupted",!1),xi(this,"drawn",!1),xi(this,"activeOverlayName","master"),xi(this,"domBindings",void 0),xi(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new uA(this.createScrollDao())}findOriginalHeaders(){let e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Vs(n,e[r])}])}}createCellCoords(e,r){return new Mo(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new Sa(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||N2(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);let n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}};function fA(t,e,r){return(e=qG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qG(t){var e=$G(t,"string");return typeof e=="symbol"?e:e+""}function $G(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wd=class extends Do{constructor(e,r,n){super(e,r),fA(this,"cloneSource",void 0),fA(this,"cloneOverlay",void 0);let i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new ed(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}};function XG(t,e,r){return(e=KG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KG(t){var e=ZG(t,"string");return typeof e=="symbol"?e:e+""}function ZG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Si=class{constructor(e,r,n,i,s){XG(this,"wtSettings",null),dn(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;let{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:f}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=f,this.trimmingContainer=pa(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=pa(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=wl(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Br(`The provided element is not a child of the ${this.type} overlay`);return}let i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},f={start:this.getRelativeStartPosition(e),top:e.offsetTop},d=null;return i?d=this.getRelativeCellPositionWithinWindow(o,s,f,u):d=this.getRelativeCellPositionWithinHolder(o,a,s,f,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){let s=this.wot.wtTable.wtRootElement.getBoundingClientRect(),o=0,a=0;if(!r)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+qt())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,s){let o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,l=0;if(n||(a=o.horizontal-s.start),r){let u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(gd.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);let{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=n.createElement("div"),o=n.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${aA.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&dt(s,[Pi()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);let u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===ji||u==="vertical"&&this.type===Gi?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=wl(e.TABLE),new wd(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){let r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){let e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;[n,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}};var wu=class extends Si{constructor(e,r,n,i,s,o){super(e,r,Ui,n,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new oA(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;let r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${o}px`}else Ao(r),this.repositionOverlay();let n=vr(this.clone.wtTable.TABLE),i=gr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){let{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=qt(n)),i.style.bottom=`${s}px`}};var nde=T(xe(),1);var JG="calculatedColumns",hA={getFirstRenderedColumn(){let t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){let t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){let t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){let t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){let t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){let t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};dn(hA,"MIXIN_NAME",JG,{writable:!1,enumerable:!1});var Il=hA;var xu=class extends wi{constructor(e,r,n,i){super(e,r,n,i,Jn)}};ft(xu,pd);ft(xu,Il);var dA=xu;function QG(t,e,r){return(e=ez(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ez(t){var e=tz(t,"string");return typeof e=="symbol"?e:e+""}function tz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Su=class extends Si{constructor(e,r,n,i){super(e,r,Jn,n,i),QG(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new dA(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0,i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());let s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){let{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=qt(n)),i.style.bottom=`${s}px`}setScrollPosition(e){let{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement,i=!1;if(n===r&&e!==r.scrollY){let s=r.scrollY;r.scrollTo(Yc(r),top),i=s!==r.scrollY}else if(e!==n.scrollTop){let s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){let{wtTable:n,wtSettings:i}=this.wot,s=i.getSetting("stylesHandler").getDefaultRowHeight(),o=e,a=0;for(;o<r;){let l=n.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=qt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=vr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset(),s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;r&&s.offsetHeight!==s.clientHeight&&(o=qt(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return vl(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){let i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders"),s=!1;if((n||r===0)&&i.length>0){let o=this.wot.wtTable.holder.parentNode,a=pt(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Ne(o,"innerBorderBottom"),s=!a):(ot(o,"innerBorderBottom"),s=a)}return s}};var f0e=T(xe(),1);var rz="calculatedRows",mA={getFirstRenderedRow(){let t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){let t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){let t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){let t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){let t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){let t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};dn(mA,"MIXIN_NAME",rz,{writable:!1,enumerable:!1});var xd=mA;var Cu=class extends wi{constructor(e,r,n,i){super(e,r,n,i,Gi)}};ft(Cu,xd);ft(Cu,Al);var pA=Cu;var vde=T(Qe(),1);var nz="localHooks",gA={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){let r=this._localHooks[t].indexOf(e);r>-1&&this._localHooks[t].splice(r,1)}return this},runLocalHooks(t,e,r,n,i,s,o){if(this._localHooks[t]){let a=this._localHooks[t].length;for(let l=0;l<a;l++)$c(this._localHooks[t][l],this,e,r,n,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};dn(gA,"MIXIN_NAME",nz,{writable:!1,enumerable:!1});var mn=gA;var Sd=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};ft(Sd,mn);var Cd=Sd;var yd="active-header",kl="header",Po="area",No="focus",_d="fill",Ed="row",Td="column",bd="custom-selection";var Ml=t=>{let e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});let r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var Gde=T(xe(),1),zde=T(Qe(),1),Yde=T(vA(),1),qde=T($r(),1),$de=T(Xr(),1),Xde=T(Kr(),1),Kde=T(Zr(),1),Zde=T(Jr(),1),Jde=T(Qr(),1),Qde=T(en(),1),e0e=T(tt(),1),t0e=T(sr(),1),r0e=T(Cn(),1);var Ode=T(xe(),1),Ade=T($r(),1),Ide=T(Xr(),1),kde=T(Kr(),1),Mde=T(Zr(),1),Fde=T(Jr(),1),Dde=T(Qr(),1),Pde=T(en(),1);function sz(t,e){CA(t,e),e.add(t)}function wA(t,e,r){CA(t,e),e.set(t,r)}function CA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jt(t,e){return t.get(yu(t,e))}function xA(t,e,r){return t.set(yu(t,e),r),r}function yu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zi=new WeakMap,pn=new WeakMap,Rd=new WeakSet,Od=class{constructor(){sz(this,Rd),wA(this,zi,void 0),wA(this,pn,void 0)}setActiveOverlay(e){return xA(pn,this,e),this}setActiveSelection(e){return xA(zi,this,e),this}scan(){let e=Jt(zi,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){let[r,n,i,s]=Jt(zi,this).getCorners(),{wtTable:o}=Jt(pn,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount(),u=0;for(let f=-o.getRowHeadersCount();f<a;f++){let d=o.columnFilter.renderedToSource(f);if(!(d<n||d>s)){for(let p=-l;p<0;p++){if(p<r||p>i)continue;let g=p+l,x=o.getColumnHeader(d,g),w=Jt(pn,this).getSetting("onBeforeHighlightingColumnHeader",d,g,{selectionType:Jt(zi,this).settings.selectionType,columnCursor:u,selectionWidth:s-n+1});w!==null&&(w!==d&&(x=o.getColumnHeader(w,g)),e(x))}u+=1}}}scanRowsInHeadersRange(e){let[r,n,i,s]=Jt(zi,this).getCorners(),{wtTable:o}=Jt(pn,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount(),u=0;for(let f=-o.getColumnHeadersCount();f<a;f++){let d=o.rowFilter.renderedToSource(f);if(!(d<r||d>i)){for(let p=-l;p<0;p++){if(p<n||p>s)continue;let g=p+l,x=o.getRowHeader(d,g),w=Jt(pn,this).getSetting("onBeforeHighlightingRowHeader",d,g,{selectionType:Jt(zi,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});w!==null&&(w!==d&&(x=o.getRowHeader(w,g)),e(x))}u+=1}}}scanCellsRange(e){let{wtTable:r}=Jt(pn,this);yu(Rd,this,oz).call(this,(n,i)=>{let s=r.getCell(Jt(pn,this).createCellCoords(n,i)),o=Jt(pn,this).getSetting("onAfterDrawSelection",n,i,Jt(zi,this).settings.layerLevel);typeof o=="string"&&Ne(s,o),e(s)})}scanRowsInCellsRange(e){let[r,,n]=Jt(zi,this).getCorners(),{wtTable:i}=Jt(pn,this);yu(Rd,this,SA).call(this,(s,o)=>{if(s>=r&&s<=n){let a=i.getCell(Jt(pn,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){let[,r,,n]=Jt(zi,this).getCorners(),{wtTable:i}=Jt(pn,this);yu(Rd,this,SA).call(this,(s,o)=>{if(o>=r&&o<=n){let a=i.getCell(Jt(pn,this).createCellCoords(s,o));e(a)}})}};function oz(t){let[e,r,n,i]=Jt(zi,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;let{wtTable:s}=Jt(pn,this),o=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),o){if(r=Math.max(r,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),n=Math.min(n,s.getLastRenderedRow()),i<r||n<e)return}else{let a=s.getCell(Jt(pn,this).createCellCoords(e,r));if(!Io(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function SA(t){let{wtTable:e}=Jt(pn,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){let s=e.rowFilter.renderedToSource(i);for(let o=0;o<n;o+=1)t(s,e.columnFilter.renderedToSource(o))}}var yA="ht-border-style-",az="-vertical",lz="-horizontal",Pv=class{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Ml(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){let e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){let i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ko(e);let n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){let{rootDocument:r}=this.wot;this.main=r.createElement("div");let n=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){let l=n[a],u=r.createElement("div"),f=p=>this.settings[l]&&this.settings[l][p]?this.settings[l][p]:e.border[p];u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style;let d=f("style");d?(["start","end"].includes(l)?u.className+=` ${yA}${d}${az}`:u.className+=` ${yA}${d}${lz}`,i.setProperty("--ht-custom-border-size",`${f("width")}px`),i.setProperty("--ht-custom-border-color",f("color"))):i.backgroundColor=f("color"),i.height=`${f("width")}px`,i.width=`${f("width")}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Li()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:s}=this.wot,o=s.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),s=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};let u=10,f=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let d={position:"absolute",height:`${f}px`,width:`${f}px`,"border-radius":`${parseInt(f/1.5,10)}px`};ht(d,(g,x)=>{this.selectionHandles.styles.bottomHitArea[x]=g,this.selectionHandles.styles.topHitArea[x]=g});let p=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${s}px`,background:`${o}`,border:`${a}px solid ${l}`};ht(p,(g,x)=>{this.selectionHandles.styles.bottom[x]=g,this.selectionHandles.styles.top[x]=g}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){let n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,o){let l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:f,bottom:d,bottomHitArea:p}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),x=parseInt(u.width,10),w=parseInt(f.width,10),y=this.wot.wtTable.getWidth(),P=this.wot.wtTable.getHeight();u.top=`${parseInt(n-x-1,10)}px`,u[l]=`${parseInt(i-x-1,10)}px`,f.top=`${parseInt(n-w/4*3,10)}px`,f[l]=`${parseInt(i-w/4*3,10)}px`;let N=Math.min(parseInt(i+s,10),y-x-g*2),B=Math.min(parseInt(i+s-w/4,10),y-w-g*2);d[l]=`${N}px`,p[l]=`${B}px`;let F=Math.min(parseInt(n+o,10),P-x-g*2),Q=Math.min(parseInt(n+o-w/4,10),P-w-g*2);d.top=`${F}px`,p.top=`${Q}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",f.display="block",this.isPartRange(e,r)?(d.display="none",p.display="none"):(d.display="block",p.display="block")):(u.display="none",d.display="none",f.display="none",p.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",f.zIndex="9999"):(u.zIndex="",f.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,s]=e;if(r<0&&i<0||n<0&&s<0){this.disappear();return}let{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==s,f=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),d=o.getFirstRenderedRow(),p=o.getLastRenderedRow(),g=o.getFirstRenderedColumn(),x=o.getLastRenderedColumn();if(g<0&&x<0||d<0&&p<0){this.disappear();return}let w;if(u){if(n=Math.max(n,g),s=Math.min(s,x),r=Math.max(r,d),i=Math.min(i,p),s<n||i<r){this.disappear();return}w=o.getCell(this.wot.createCellCoords(r,n))}else if(w=o.getCell(this.wot.createCellCoords(r,n)),!Io(w)){this.disappear();return}let y=u?o.getCell(this.wot.createCellCoords(i,s)):w,P=rn(w),N=u?rn(y):P,B=rn(o.TABLE),F=P.top,Q=P.left,he=this.wot.wtSettings.getSetting("rtlMode"),U=0,X=0;if(he){let ze=gr(o.TABLE),rt=gr(w),$e=l.innerWidth-B.left-ze;X=Q+rt-N.left,U=l.innerWidth-Q-rt-$e-1}else X=N.left+gr(y)-Q,U=Q-B.left-1;if(this.isEntireColumnSelected(r,i)){let ze=r,rt=this.getDimensionsFromHeader("columns",n,s,ze,B),$e=null;rt&&([$e,U,X]=rt),$e&&(w=$e)}let K=F-B.top-1,ne=N.top+vr(y)-F;if(this.isEntireRowSelected(n,s)){let ze=n,rt=this.getDimensionsFromHeader("rows",r,i,ze,B),$e=null;rt&&([$e,K,ne]=rt),$e&&(w=$e)}let ie=l.getComputedStyle(w);parseInt(ie.borderTopWidth,10)>0&&(K+=1,ne=ne>0?ne-1:0),parseInt(ie[he?"borderRightWidth":"borderLeftWidth"],10)>0&&(U+=1,X=X>0?X-1:0);let te=he?"right":"left",Re=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${K}px`,this.topStyle[te]=`${U}px`,this.topStyle.width=`${X+Re}px`,this.topStyle.display="block",this.startStyle.top=`${K}px`,this.startStyle[te]=`${U}px`,this.startStyle.height=`${ne+Re}px`,this.startStyle.display="block",this.bottomStyle.top=`${K+ne-parseInt(this.bottomStyle.height,10)+Re}px`,this.bottomStyle[te]=`${U}px`,this.bottomStyle.width=`${X+Re}px`,this.bottomStyle.display="block",this.endStyle.top=`${K}px`,this.endStyle[te]=`${U+X-parseInt(this.endStyle.width,10)+Re}px`,this.endStyle.height=`${ne+Re}px`,this.endStyle.display="block";let We=this.settings.border.cornerVisible;We=typeof We=="function"?We(this.settings.layerLevel):We;let ke=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render"),[wt,ut]=[i,s];if(ke&&Array.isArray(ke)&&([,,wt,ut]=ke),Li()||!We||this.isPartRange(wt,ut))this.cornerStyle.display="none";else{this.cornerStyle.top=`${K+ne+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[te]=`${U+X+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ze=pa(o.TABLE),rt=ze===l;rt&&(ze=a.documentElement);let $e=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Ye=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),V=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){let G=rt?y.getBoundingClientRect().left:y.offsetLeft,z=!1,m=0;if(he?(m=G-parseInt(this.cornerDefaultStyle.width,10)/2,z=m<0):(m=G+gr(y)+parseInt(this.cornerDefaultStyle.width,10)/2,z=m>=Gh(ze)),z){let S=Math.floor(U+X+this.cornerCenterPointOffset-Ye-$e);f?(this.cornerStyle[te]=`${S}px`,this.cornerStyle[he?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[te]=`${S-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(rt?y.getBoundingClientRect().top:y.offsetTop)+vr(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=Oo(ze)){let S=Math.floor(K+ne+this.cornerCenterPointOffset-V-$e);f?(this.cornerStyle.top=`${S}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${S-1}px`}this.cornerStyle.display="block"}Li()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,K,U,X,ne)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){let{wtTable:o}=this.wot,a=o.wtRootElement.parentNode,l=null,u=null,f=null,d=null,p=null,g=null,x=null,w=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return vr(...arguments)},f="ht__selection--rows",g="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return gr(...arguments)},f="ht__selection--columns",g="left";break;default:}if(a.classList.contains(f)){let y=this.wot.getSetting("columnHeaders").length;if(x=l(r,y-i),w=l(n,y-i),!x||!w)return!1;let P=rn(x),N=rn(w);return x&&w&&(d=P[g]-s[g]-1,p=N[g]+u(w)-P[g]),[x,d,p]}return!1}changeBorderStyle(e,r){let n=this[e].style,i=r[e];!i||i.hide?Ne(this[e],"hidden"):(pt(this[e],"hidden")&&ot(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){let r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?Ne(this[e],"hidden"):ot(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Li()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}},Nv=Pv;function cz(t,e){TA(t,e),e.add(t)}function Fl(t,e,r){TA(t,e),e.set(t,r)}function TA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function it(t,e){return t.get(Bv(t,e))}function _A(t,e,r){return t.set(Bv(t,e),r),r}function Bv(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gn=new WeakMap,Bn=new WeakMap,Hv=new WeakMap,_u=new WeakMap,Lv=new WeakMap,Ea=new WeakMap,EA=new WeakSet,Ad=class{constructor(e){cz(this,EA),Fl(this,gn,void 0),Fl(this,Bn,void 0),Fl(this,Hv,new Od),Fl(this,_u,new WeakMap),Fl(this,Lv,new WeakSet),Fl(this,Ea,new Map),_A(Bn,this,e)}setActiveOverlay(e){return _A(gn,this,e),it(Hv,this).setActiveOverlay(it(gn,this)),it(_u,this).has(it(gn,this))||it(_u,this).set(it(gn,this),new Set),this}getFocusSelection(){return it(Bn,this)!==null?it(Bn,this).getFocus():null}getAreaSelection(){return it(Bn,this)!==null?it(Bn,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(it(Ea,this).has(e)){let n=it(Ea,this).get(e);if(n.has(it(gn,this)))return n.get(it(gn,this));let i=new Nv(it(gn,this),e.settings);return n.set(it(gn,this),i),i}let r=new Nv(it(gn,this),e.settings);return it(Ea,this).set(e,new Map([[it(gn,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=it(Ea,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){it(Ea,this).get(e).forEach(r=>r.destroy()),it(Ea,this).delete(e)}render(e){if(it(Bn,this)===null)return;e&&Bv(EA,this,uz).call(this);let r=Array.from(it(Bn,this)),n=new Map,i=new Map;for(let s=0;s<r.length;s++){let o=r[s],{className:a,headerAttributes:l,createLayers:u,selectionType:f}=o.settings;it(Lv,this).has(o)||(it(Lv,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));let d=this.getBorderInstance(o);if(o.isEmpty()){d?.disappear();continue}a&&it(Hv,this).setActiveSelection(o).scan().forEach(x=>{if(n.has(x)){let w=n.get(x);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else n.set(x,new Map([[a,1]]));l&&(i.has(x)||i.set(x,[]),x.nodeName==="TH"&&i.get(x).push(...l))});let p=o.getCorners();it(gn,this).getSetting("onBeforeDrawBorders",p,f),d?.appear(p)}n.forEach((s,o)=>{var a;let l=Array.from(s).map(u=>{let[f,d]=u;return d===1?f:[f,...Array.from({length:d-1},(p,g)=>`${f}-${g+1}`)]}).flat();l.forEach(u=>it(_u,this).get(it(gn,this)).add(u)),Ne(o,l),o.nodeName==="TD"&&Array.isArray((a=it(Bn,this).options)===null||a===void 0?void 0:a.cellAttributes)&&dt(o,it(Bn,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{dt(s,[...i.get(s)])})}};function uz(){let t=it(_u,this).get(it(gn,this)),e=it(gn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;let s=it(gn,this).wtTable.TABLE.querySelectorAll(`.${r}`),o=[];Array.isArray((n=it(Bn,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(o=it(Bn,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=it(Bn,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...it(Bn,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)ot(s[a],r),us(s[a],o)}),t.clear()}var Eu=class extends Si{constructor(e,r,n,i){super(e,r,Gi,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new pA(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;let{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),xl(n,`${s}px`,"0px")):(s=this.getScrollPosition(),Ao(n));let o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){let{rootWindow:r}=this.domBindings,n=!1;this.isRtl()&&(e=-e);let i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){let s=r.scrollX;r.scrollTo(e,Kg(r)),n=s!==r.scrollX}else if(e!==i.scrollLeft){let s=i.scrollLeft;i.scrollLeft=e,n=s!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){let n=this.wtSettings.getSetting("defaultColumnWidth"),i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=qt(n)),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;let l=gr(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,r=Ml(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){let{wtSettings:n}=this,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!pt(a.parentNode,"innerBorderInlineStart")?1:0,u=this.getTableParentOffset(),f=0;if(r){let d=this.wot.wtTable.getColumnWidth(e),p=this.wot.wtViewport.getViewportWidth();d>p&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(f=qt(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=f,L2(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){let e=this.wtSettings.getSetting("preventOverflow"),r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(jh(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";o?ot(n,"emptyRows"):Ne(n,"emptyRows");let l=!1;if(!a){if(s&&!i.length)Ne(n,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){let u=pt(n,"innerBorderInlineStart");e?(Ne(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(ot(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}};var b0e=T(xe(),1);var fz="stickyRowsTop",bA={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};dn(bA,"MIXIN_NAME",fz,{writable:!1,enumerable:!1});var Id=bA;var Tu=class extends wi{constructor(e,r,n,i){super(e,r,n,i,gs)}};ft(Tu,Id);ft(Tu,Al);var RA=Tu;function OA(t,e,r){return(e=hz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hz(t){var e=dz(t,"string");return typeof e=="symbol"?e:e+""}function dz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bu=class extends Si{constructor(e,r,n,i,s,o){super(e,r,gs,n,i),OA(this,"topOverlay",void 0),OA(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new RA(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();xl(e,`${i}px`,`${s}px`)}else Ao(e);let r=vr(this.clone.wtTable.TABLE),n=gr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}};var L0e=T(xe(),1);var Ru=class extends wi{constructor(e,r,n,i){super(e,r,n,i,ji)}};ft(Ru,Id);ft(Ru,Il);var AA=Ru;function mz(t,e,r){return(e=pz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pz(t){var e=gz(t,"string");return typeof e=="symbol"?e:e+""}function gz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ou=class extends Si{constructor(e,r,n,i){super(e,r,ji,n,i),mz(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new AA(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow"),i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){let{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),f=e.offsetHeight;s=u===f,i=this.getOverlayOffset(),xl(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Ao(e);let o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){let{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement,i=!1;if(n===r&&e!==r.scrollY){let s=r.scrollY;r.scrollTo(Yc(r),e),i=s!==r.scrollY}else if(e!==n.scrollTop){let s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight(),i=e,s=0;for(;i<r;){let o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?n:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=qt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=vr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,r=Ml(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let{wot:n,wtSettings:i}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!pt(o.parentNode,"innerBorderTop")?1:0,f=this.getTableParentOffset(),d=0;if(r){let p=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();p>g&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(d=qt(this.domBindings.rootDocument)),r){let p=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");f+=this.sumCellSizes(0,e+1),f-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-p,g),f+=1,f+=u}else f+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return f+=d,H2(this.mainTableScrollableElement)===f-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(f)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return vl(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){let i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,s=n.getSetting("totalColumns"),o=n.getSetting("preventOverflow")==="horizontal";s?ot(i,"emptyColumns"):Ne(i,"emptyColumns");let a=!1;if(!r&&!o){let l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,f=n.getSetting("columnHeaders");if((u||l===0)&&f.length>0){let d=pt(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(Ne(i,"innerBorderTop"),a=!d):(ot(i,"innerBorderTop"),a=d)}}return a}};function kd(t,e,r){vz(t,e),e.set(t,r)}function vz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gs(t,e,r){return(e=wz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wz(t){var e=xz(t,"string");return typeof e=="symbol"?e:e+""}function xz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ta(t,e,r){return t.set(IA(t,e),r),r}function zs(t,e){return t.get(IA(t,e))}function IA(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Dl=new WeakMap,Md=new WeakMap,Pl=new WeakMap,Fd=new WeakMap,Vv=class{constructor(e,r,n,i,s,o){Gs(this,"wot",null),kd(this,Dl,[]),Gs(this,"topOverlay",null),Gs(this,"bottomOverlay",null),Gs(this,"inlineStartOverlay",null),Gs(this,"topInlineStartCornerOverlay",null),Gs(this,"bottomInlineStartCornerOverlay",null),Gs(this,"browserLineHeight",void 0),Gs(this,"wtSettings",null),kd(this,Md,!1),kd(this,Pl,0),kd(this,Fd,null),Gs(this,"resizeObserver",new ResizeObserver(f=>{Yg(()=>{!Array.isArray(f)||!f.length||(Ta(Pl,this,zs(Pl,this)+1),zs(Pl,this)===300&&(Br("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),zs(Fd,this)!==null&&clearTimeout(zs(Fd,this)),Ta(Fd,this,setTimeout(()=>{Ta(Pl,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;let{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=qt(a);let u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:wl(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=[...zs(Dl,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){let{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){let e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Ou(...e),this.bottomOverlay=new Su(...e),this.inlineStartOverlay=new Eu(...e),this.topInlineStartCornerOverlay=new bu(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new wu(...e,this.bottomOverlay,this.inlineStartOverlay),Ta(Dl,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Ta(Md,this,zs(Dl,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),zs(Dl,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),zs(Dl,this).forEach(e=>{let r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",d=>this.onTableScroll(d),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});let s=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!E2())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{this.eventManager.addEventListener(d.clone.wtTable.holder,"wheel",p=>this.onCloneWheel(p,a),l)});let f;this.eventManager.addEventListener(r,"resize",()=>{Yg(()=>{clearTimeout(f),this.wtSettings.getSetting("onWindowResize"),f=setTimeout(()=>{Ta(Pl,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){let r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){if(e.ctrlKey)return;let{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==n&&o!==n&&!o.contains(s),l=i!==n&&o!==n&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;let u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=q2(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);let i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){let r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){let r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;let s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!zs(Md,this))return;let e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Ta(Md,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=wl(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){let e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){let{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,f=l+this.topOverlay.sumCellSizes(0,o)+u,d=a+this.inlineStartOverlay.sumCellSizes(0,s),g=r.hider.style,x=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,f-r.holder.clientHeight),w=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,d-r.holder.clientWidth),y=x()?1:0,P=w()?1:0;g.width=`${d+P}px`,g.height=`${f+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){let{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){let{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;let r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],n=null;return Ue(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){let e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Ue(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}},kA=Vv;var fme=T(xe(),1);function MA(t,e,r){return(e=Sz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sz(t){var e=Cz(t,"string");return typeof e=="symbol"?e:e+""}function Cz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Dd=class{constructor(e){MA(this,"settings",{}),MA(this,"defaults",Object.freeze(this.getDefaults())),ht(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{let i=this.getSetting("data",e,r);Vs(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?ht(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}};var Au=class extends wi{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){let e=pa(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{let n=e.parentElement,i=Zg(e,"height",r),s=Zg(e,"overflow",r),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e,u=e.offsetWidth,f=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(s)){let p=e.cloneNode(!1);p.style.overflow="auto",p.style.position="absolute",e.nextElementSibling?n.insertBefore(p,e.nextElementSibling):n.appendChild(p);let g=parseInt(r.getComputedStyle(p).height,10);n.removeChild(p),g===0&&(f=0)}f=Math.min(f,l),o.height=i==="auto"?"auto":`${f}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:f>0,this.hasTableWidth=u>0}this.isTableVisible=cs(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){let a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let f=-1*a;f<l;f++)this.markIfOversizedColumnHeader(f);r.hasOversizedColumnHeadersMarked[n]=!0}}};ft(Au,xd);ft(Au,Il);var FA=Au;var Cme=T(tt(),1),yme=T(Cn(),1);var Wv=class{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new cu:new fu],["fullyVisible",()=>new nu],["partiallyVisible",()=>new xa]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new au:new uu],["fullyVisible",()=>new tu],["partiallyVisible",()=>new wa]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer,n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=vr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;let r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){let{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i;if(n===r){let s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){let e=this.getWorkspaceWidth();if(e===1/0)return e;let r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){let s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}let{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){let i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}let{hider:e}=this.wtTable,r=e.offsetWidth,n=this.hasVerticalScroll()?qt():0;return r>this.getWorkspaceWidth()-n}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return rn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=vr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){let e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=gr(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:r,wtTable:n}=this,i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(f-u,f),i-=o),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=qt(this.domBindings.rootDocument),new El({calculationTypes:e.map(d=>[d,this.rowsCalculatorTypes.get(d)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:d=>n.getRowHeight(d),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:r,wtTable:n}=this,i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let o=r.getSetting("fixedColumnsStart");if(o&&s>=0){let a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=qt(this.domBindings.rootDocument)),new _l({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){let s=n.getResultsFor("fullyVisible"),o=n.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s,o)}if(e&&!r.getSetting("renderAllColumns")){let s=i.getResultsFor("fullyVisible"),o=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s,o)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){let e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,r){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e,{startRow:s,endRow:o}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(s)&&!this.wtTable.isRowAfterRenderedRows(o))return!0;n=s,i=o}let{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:f}=this.rowsRenderCalculator,d=this.wtSettings.getSetting("totalRows")-1,p=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(p)&&p>0?(n=Math.max(0,n-Math.min(u,p)),i=Math.min(d,i+Math.min(f,p))):p==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(d,i+Math.ceil(f/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<d)}areAllProposedVisibleColumnsAlreadyRendered(e,r){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e,{startColumn:s,endColumn:o}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(s)&&!this.wtTable.isColumnAfterRenderedColumns(o))return!0;n=s,i=o}let{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:f}=this.columnsRenderCalculator,d=this.wtSettings.getSetting("totalColumns")-1,p=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(p)&&p>0?(n=Math.max(0,n-Math.min(u,p)),i=Math.min(d,i+Math.min(f,p))):p==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(d,i+Math.ceil(f/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<d)}resetHasOversizedColumnHeadersMarked(){ht(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}},DA=Wv;var Pd=class extends Do{constructor(e,r){super(e,new Dd(r));let n=this.wtSettings.getSetting("facade",this);this.wtTable=new FA(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new DA(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Ad(this.wtSettings.getSetting("selections")),this.wtEvent=new ed(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new kA(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];ht(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),ot(this.wtTable.wtRootElement.parentNode,r),Ne(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!gd.includes(e))return null;let n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){let e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}};var Iu=class t{constructor(e){e instanceof Do?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{let n=new t(r);return()=>n},this._wot=new Pd(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}};var $me=T(tt(),1),Xme=T(Cn(),1);function PA(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t,l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),f=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||f)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):f&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!f&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!f&&i.row<0||f&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{let d=!s.inInSelection(i),p=r||n&&d;i.row<0&&i.col>=0&&!o.column?p&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?p&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?p&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function yz(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;let o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(s(u-1,r.col)):o&&!i.row?n.setRangeEnd(s(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function NA(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;let i=r.getSelectedRange(),s=i.clone().map(a=>n.toRenderable(a)),o=s.current();if(s.size()>1&&!o.isHeader()&&!r.isMultiple(o)){let a=s.findAll(o);a.length===s.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}var _z=new Map([["touchstart",PA],["touchend",NA],["mousedown",PA],["mouseover",yz],["mouseup",NA]]);function Nd(t,e){_z.get(t.type)(De({isShiftKey:t.shiftKey,isLeftClick:qh(t)||t.type==="touchstart",isRightClick:Xc(t)},e))}var HA=new WeakMap,Hd=Symbol("rootInstance");function LA(t){HA.set(t,!0)}function BA(t){return t===Hd}function Ci(t){return HA.has(t)}function Ez(t,e){VA(t,e),e.add(t)}function Ho(t,e,r){VA(t,e),e.set(t,r)}function VA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lo(t,e,r){return(e=Tz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tz(t){var e=bz(t,"string");return typeof e=="symbol"?e:e+""}function bz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wr(t,e){return t.get(Hl(t,e))}function Vn(t,e,r){return t.set(Hl(t,e),r),r}function Hl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Uv=new WeakMap,Ld=new WeakMap,Bd=new WeakMap,Ys=new WeakMap,Yi=new WeakMap,jv=new WeakMap,Gv=new WeakMap,Nl=new WeakMap,ku=new WeakSet,zv=class{constructor(e){Ez(this,ku),Lo(this,"hot",void 0),Lo(this,"eventManager",void 0),Lo(this,"settings",void 0),Lo(this,"THEAD",void 0),Lo(this,"TBODY",void 0),Lo(this,"_wt",void 0),Lo(this,"activeWt",void 0),Ho(this,Uv,0),Ho(this,Ld,0),Lo(this,"postponedAdjustElementsSize",!1),Ho(this,Bd,!1),Ho(this,Ys,void 0),Ho(this,Yi,void 0),Ho(this,jv,0),Ho(this,Gv,0),Ho(this,Nl,null),this.hot=e,this.eventManager=new Bi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){let e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),Hl(ku,this,Oz).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,r){let n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){let{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Ne(e,"handsontable"),Vn(Yi,this,r.createElement("TABLE")),Ne(wr(Yi,this),"htCore"),this.hot.getSettings().tableClassName&&Ne(wr(Yi,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(dt(wr(Yi,this),[Pi()]),dt(e,[jR(),Ih(-1),ml(this.hot.countCols()),KR()])),this.THEAD=r.createElement("THEAD"),wr(Yi,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),wr(Yi,this).appendChild(this.TBODY),this.hot.table=wr(Yi,this),this.hot.container.insertBefore(wr(Yi,this),this.hot.container.firstChild)}registerEvents(){let{rootWrapperElement:e,rootElement:r,rootDocument:n,selection:i,rootWindow:s}=this.hot,o=n.documentElement;this.eventManager.addEventListener(r,"mousedown",l=>{Vn(Bd,this,!0),this.isTextSelectionAllowed(l.target)||(Jg(s),l.preventDefault(),s.focus())}),this.eventManager.addEventListener(r,"mouseup",()=>{Vn(Bd,this,!1)}),this.eventManager.addEventListener(r,"mousemove",l=>{wr(Bd,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&Jg(s),l.preventDefault())}),this.eventManager.addEventListener(o,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(o,"mouseup",l=>{i.isInProgress()&&qh(l)&&i.finish(),Vn(Ys,this,!1);let u=Yh(n.activeElement);qc(n.activeElement)&&!u||(u||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??r).contains(l.target)&&!Xc(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",l=>{i.isInProgress()&&Xc(l)&&(i.finish(),Vn(Ys,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{i.isInProgress()&&i.finish(),Vn(Ys,this,!1)}),this.eventManager.addEventListener(o,"mousedown",l=>{let u=l.target,f=l.x||l.clientX,d=l.y||l.clientY,p=l.target;if(wr(Ys,this)||!r||!this.hot.view)return;let{holder:g}=this._wt.wtTable;if(p===g){let w=qt(n);if(n.elementFromPoint(f+w,d)!==g||n.elementFromPoint(f,d+w)!==g)return}else for(;p!==o;){if(p===null){if(l.isTargetWebComponent)break;return}if(p===r)return;p=p.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Bs(s);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Bs(a);this.eventManager.addEventListener(wr(Yi,this),"selectstart",l=>{this.settings.fragmentSelection||qc(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){let n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;let s=n.getNearestNotHiddenIndex(e,r),o=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return r<0?a=o+1:r>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){let e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){let e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){let e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;let n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Ne(n,e)}removeClassNameFromLicenseElement(e){var r;let n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&ot(n,e)}isMainTableNotFullyCoveredByOverlays(){let e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){let e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:wr(Yi,this),isDataViewInstance:()=>Ci(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{let l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),Vn(Ld,this,s.length),this.hot.getSettings().ariaTags&&Hl(ku,this,WA).call(this)===this.hot.countCols()&&Hl(ku,this,Rz).call(this,wr(Ld,this)),s},columnHeaders:()=>{let s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{let l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),Vn(Uv,this,s.length),s},columnWidth:s=>{let o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{let o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{let a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{let[l,u]=this.translateFromRenderableToVisualIndex(s,o),f=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta"),d=l,p=u;Array.isArray(f)&&([d,p]=f);let g=this.hot.getCellMeta(d,p),x=this.hot.colToProp(p),w=this.hot.getDataAtRowProp(d,x);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,g)),this.hot.runHooks("beforeRenderer",a,l,u,x,w,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,x,w,g),this.hot.runHooks("afterRenderer",a,l,u,x,w,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&cs(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{let u=this.translateFromRenderableToVisualCoords(o),f={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Vn(Ys,this,!0),Vn(Nl,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,f),!fs(s)&&(Nd(s,{coords:u,selection:this.hot.selection,controller:f,cellCoordsFactory:(d,p)=>this.hot._createCellCoords(d,p)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{let u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,Vn(Ys,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!fs(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{let u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!fs(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{let u=this.translateFromRenderableToVisualCoords(o),f={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,f),!fs(s)&&(wr(Ys,this)&&(!wr(Nl,this)||wr(Nl,this).x!==s.clientX||wr(Nl,this).y!==s.clientY)&&Nd(s,{coords:u,selection:this.hot.selection,controller:f,cellCoordsFactory:(d,p)=>this.hot._createCellCoords(d,p)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt,Vn(Nl,this,null))},onCellMouseUp:(s,o,a,l)=>{let u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(fs(s)||this.hot.isDestroyed)&&(Nd(s,{coords:u,selection:this.hot.selection,cellRangeMapper:oO(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{let a=this.hot.rowIndexMapper,l=s<0,u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollVertically",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(s,o)=>{let a=this.hot.columnIndexMapper,l=s<0,u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{let l=this.hot.rowIndexMapper,u=s<0,f=s;u||(f=l.getVisualFromRenderableIndex(s));let d=this.hot.runHooks("beforeHighlightingRowHeader",f,o,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{let l=this.hot.columnIndexMapper,u=s<0,f=s;u||(f=l.getVisualFromRenderableIndex(s));let d=this.hot.runHooks("beforeHighlightingColumnHeader",f,o,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(s,o,a)=>{let l,[u,f]=this.translateFromRenderableToVisualIndex(s,o),d=this.hot.selection.getSelectedRange();if(d.size()>0){let g=d.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,f,l,a)},onBeforeDrawBorders:(s,o)=>{let[a,l,u,f]=s,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(f)];return this.hot.runHooks("beforeDrawBorders",d,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{let u=this.hot.rowIndexMapper,f=this.hot.columnIndexMapper,d=o>=0?f.getVisualFromRenderableIndex(o):o,p=s>=0?u.getVisualFromRenderableIndex(s):s,g=this.hot.runHooks("modifyGetCellCoords",p,d,a,l);if(Array.isArray(g)){let[x,w,y,P]=g;return[x>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(x,1)):x,w>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(w,1)):w,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,P>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(P,-1)):P]}},onModifyGetCoordsElement:(s,o)=>{let a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=o>=0?l.getVisualFromRenderableIndex(o):o,f=s>=0?a.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCoordsElement",f,u);if(Array.isArray(d)){let[p,g]=d;return[p>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(p,1)):p,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){let a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){let f=Math.max(1,Math.ceil(u/a*12));s.startRow=Math.max(l-f,0),s.endRow=Math.min(u+f,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){let a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){let f=Math.max(1,Math.ceil(u/a*6));s.startColumn=Math.max(l-f,0),s.endColumn=Math.min(u+f,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Iu(e),this.activeWt=this._wt;let r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var r,n;if(qc(e))return!0;let i=zc(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;let s=(r=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingleCell())!==null&&r!==void 0?r:!1;return!!(this.settings.fragmentSelection==="cell"&&s&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&s)}isMouseDown(){return wr(Ys,this)}isCellEdited(){let e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){let n=r.firstChild;if(!pt(n,"relative")){Ro(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{let{rootDocument:n,getRowHeader:i}=this.hot,s=n.createElement("div"),o=n.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=()=>{let o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){let o=r.firstChild;pt(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,i),o.className="",Ne(o,["relative",...s()])):(Ro(r),this.appendColHeader(e,r,n,i))}else{let{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(dt(a,...Pi()),dt(l,...Pi())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r,o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(pt(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(r):pt(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(r))),s>-1?P2(e,n(r,i)):(Vs(e,"\xA0"),Ne(e,"cornerHeader"))}maximumVisibleElementWidth(e){let n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){let n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Vn(jv,this,e),Vn(Gv,this,r)}getLastSize(){return{width:wr(jv,this),height:wr(Gv,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;let e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;let e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;let e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;let e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return wr(Uv,this)}getRowHeadersCount(){return wr(Ld,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getTableScrollPosition(){return{left:this._wt.wtTable.holder.scrollLeft,top:this._wt.wtTable.holder.scrollTop}}setTableScrollPosition(e){this._wt.wtTable.holder.scrollLeft=e.left,this._wt.wtTable.holder.scrollTop=e.top}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};function WA(){return parseInt(this.hot.rootElement.getAttribute(ml()[0]),10)}function Rz(t){let e=Hl(ku,this,WA).call(this)+t;dt(this.hot.rootElement,...ml(e))}function Oz(){let t=this.hot.rootElement;this.hasVerticalScroll()?Ne(t,"htHasScrollY"):ot(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?Ne(t,"htVerticallyScrollableByWindow"):ot(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?Ne(t,"htHasScrollX"):ot(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?Ne(t,"htHorizontallyScrollableByWindow"):ot(t,"htHorizontallyScrollableByWindow")}var UA=zv;var Cpe=T(xe(),1),ype=T(Qe(),1),_pe=T(tt(),1),Epe=T(sr(),1);var ppe=T(Qe(),1),gpe=T(tt(),1),vpe=T(GA(),1),wpe=T(sr(),1);var Hz="ABCDEFGHIJKLMNOPQRSTUVWXYZ",zA=Hz.length;function YA(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%zA,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/zA,10);return r}function Vd(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&tn(t[0])&&(e=gl(t[0]))),e}function Mu(t,e,r){return(e=Lz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lz(t){var e=Bz(t,"string");return typeof e=="symbol"?e:e+""}function Bz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qv=class{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Mu(this,"hot",void 0),Mu(this,"data",void 0),Mu(this,"dataType","array"),Mu(this,"colToProp",()=>{}),Mu(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){let r=[];return Ue(this.data,(n,i)=>{let s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=r===void 0&&n===void 0,{dataDotNotation:o}=this.hot.getSettings(),a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,f)=>{l[f]=this.getAtPhysicalCell(e,f,a)}):sn(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(tn(a)||et(a))if(i?l=[]:l={},!s||i){let f=this.countFirstRowKeys()-1;sn(0,f,d=>{let p=this.colToProp(d);if(d>=(r||0)&&d<=(n||f)&&!Number.isInteger(p)){let g=this.getAtPhysicalCell(e,p,a);i?l.push(g):o?Hh(l,p,g):l[p]=g}})}else ht(a,(u,f)=>{let d=this.getAtPhysicalCell(e,f,a);o?Hh(l,f,d):l[f]=d});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let i=Pr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:Hh(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){let{dataDotNotation:s}=this.hot.getSettings();i=s?C2(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){let s=Pr(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){let n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||r===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,r.row),o=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));let u=[];return sn(s,a,f=>{u.push(i?this.getAtRow(f,void 0,void 0,n):this.getAtRow(f,o,l,n))}),u}getCopyable(e,r){let n=this.propToCol(r);return this.hot.getCellMeta(e,n).copyable?this.getAtCell(this.hot.toPhysicalRow(e),n):""}countRows(){if(this.hot.hasHook("modifySourceLength")){let e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Vd(this.data)}destroy(){this.data=null,this.hot=null}},qA=qv;var dve=T(xe(),1),mve=T($r(),1),pve=T(Xr(),1),gve=T(Kr(),1),vve=T(Zr(),1),wve=T(Jr(),1),xve=T(Qr(),1),Sve=T(en(),1),Cve=T(tt(),1),yve=T(Xn(),1),_ve=T(Cn(),1),Eve=T(Bo(),1);var bge=T(xe(),1);var Kpe=T(Qe(),1);var Ppe=T(xe(),1),Npe=T(Qe(),1);function XA(t,e,r){return(e=$z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $z(t){var e=Xz(t,"string");return typeof e=="symbol"?e:e+""}function Xz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qi=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;XA(this,"indexedValues",[]),XA(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){let r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,et(this.initValueOrFn)?sn(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):sn(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}};ft(qi,mn);var Upe=T(tt(),1),jpe=T(Cn(),1);function Wd(t,e,r,n){let i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,o)=>et(n)?n(s,o):n),...i===void 0?[]:t.slice(i)]}function Ud(t,e){return yh(t,(r,n)=>e.includes(n)===!1)}var Vo=class extends qi{insert(e,r){this.indexedValues=Wd(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=Ud(this.indexedValues,e),super.remove(e)}};var Ll=class extends Vo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return _o(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}};var oge=T(xe(),1),age=T(tt(),1),lge=T(Cn(),1);function jd(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function ba(t,e){return yh(t,r=>e.includes(r)===!1)}var rge=T(tt(),1),nge=T(Xn(),1);function Fu(t,e){return Di(t,r=>r-e.filter(n=>n<r).length)}function Du(t,e){let r=e[0],n=e.length;return Di(t,i=>i>=r?i+n:i)}function Kz(t,e,r){return(e=Zz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zz(t){var e=Jz(t,"string");return typeof e=="symbol"?e:e+""}function Jz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gd=class extends qi{constructor(){super(...arguments),Kz(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=ba(this.orderOfIndexes,[e]),et(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=Wd(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=Du(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=Ud(this.indexedValues,e),this.orderOfIndexes=ba(this.orderOfIndexes,e),this.orderOfIndexes=Fu(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}};var pge=T(Qe(),1);var Bl=class extends Vo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return _o(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}};var xge=T(xe(),1);var zd=class extends qi{constructor(){super(e=>e)}insert(e,r){let n=Du(this.indexedValues,r);this.indexedValues=jd(n,e,r),super.insert(e,r)}remove(e){let r=ba(this.indexedValues,e);this.indexedValues=Fu(r,e),super.remove(e)}};var KA=new Map([["hiding",Ll],["index",qi],["linkedPhysicalIndexToValue",Gd],["physicalIndexToValue",Vo],["trimming",Bl]]);function ZA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!KA.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(KA.get(t))(e)}var Uge=T(xe(),1),jge=T(Qe(),1);var Pge=T(xe(),1),Nge=T(tt(),1),Hge=T(sr(),1);function Qz(t,e,r){return(e=eY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eY(t){var e=tY(t,"string");return typeof e=="symbol"?e:e+""}function tY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var JA=0,Ra=class{constructor(){Qz(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)),JA+=1)}unregister(e){let r=this.collection.get(e);Be(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r),JA-=1)}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return pr(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}};ft(Ra,mn);function Xv(t,e,r){return(e=rY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rY(t){var e=nY(t,"string");return typeof e=="symbol"?e:e+""}function nY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Pu=class extends Ra{constructor(e,r){super(),Xv(this,"mergedValuesCache",[]),Xv(this,"aggregationFunction",void 0),Xv(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];let r=Di(this.get(),s=>s.getValues()),n=[],i=Be(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){let o=[];for(let a=0;a<this.getLength();a+=1)o.push(r[a][s]);n.push(o)}return Di(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){let n=this.getMergedValues(r)[e];return Be(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}};var eve=T(xe(),1),tve=T($r(),1),rve=T(Xr(),1),nve=T(Kr(),1),ive=T(Zr(),1),sve=T(Jr(),1),ove=T(Qr(),1),ave=T(en(),1),lve=T(tt(),1),cve=T(sr(),1);var $ge=T(xe(),1);function iY(t,e,r){sY(t,e),e.set(t,r)}function sY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oY(t,e,r){return t.set(QA(t,e),r),r}function aY(t,e){return t.get(QA(t,e))}function QA(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Kv=new WeakMap,Nu=class{constructor(){iY(this,Kv,[])}subscribe(e){return this.addLocalHook("change",e),this._write(aY(Kv,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){oY(Kv,this,e)}};ft(Nu,mn);var Jge=T(Qe(),1);function Zv(t,e){let r=[],n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function Hu(t,e,r){lY(t,e),e.set(t,r)}function lY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yi(t,e){return t.get(eI(t,e))}function Yd(t,e,r){return t.set(eI(t,e),r),r}function eI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qd=new WeakMap,Lu=new WeakMap,$d=new WeakMap,Xd=new WeakMap,Kd=new WeakMap,Zd=class{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Hu(this,qd,new Set),Hu(this,Lu,[]),Hu(this,$d,[]),Hu(this,Xd,!1),Hu(this,Kd,!1),Yd(Kd,this,e??!1)}createObserver(){let e=new Nu;return yi(qd,this).add(e),e.addLocalHook("unsubscribe",()=>{yi(qd,this).delete(e)}),e._writeInitialChanges(Zv(yi(Lu,this),yi($d,this))),e}emit(e){let r=yi($d,this);(!yi(Xd,this)||yi(Lu,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(yi(Kd,this)):Yd(Lu,this,new Array(e.length).fill(yi(Kd,this))),yi(Xd,this)||(Yd(Xd,this,!0),r=yi(Lu,this)));let n=Zv(r,e);yi(qd,this).forEach(i=>i._write(n)),Yd($d,this,e)}};function Tn(t,e,r){return(e=cY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cY(t){var e=uY(t,"string");return typeof e=="symbol"?e:e+""}function uY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Oa=class{constructor(){Tn(this,"indexesSequence",new zd),Tn(this,"trimmingMapsCollection",new Pu(e=>e.some(r=>r===!0),!1)),Tn(this,"hidingMapsCollection",new Pu(e=>e.some(r=>r===!0),!1)),Tn(this,"variousMapsCollection",new Ra),Tn(this,"hidingChangesObservable",new Zd({initialIndexValue:!1})),Tn(this,"notTrimmedIndexesCache",[]),Tn(this,"notHiddenIndexesCache",[]),Tn(this,"isBatched",!1),Tn(this,"indexesSequenceChanged",!1),Tn(this,"indexesChangeSource",void 0),Tn(this,"trimmedIndexesChanged",!1),Tn(this,"hiddenIndexesChanged",!1),Tn(this,"renderablePhysicalIndexesCache",[]),Tn(this,"fromPhysicalToVisualIndexesCache",new Map),Tn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,ZA(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof Bl?this.trimmingMapsCollection.register(e,r):r instanceof Ll?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);let n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){let r=this.notTrimmedIndexesCache[e];return Be(r)?r:null}getPhysicalFromRenderableIndex(e){let r=this.renderablePhysicalIndexesCache[e];return Be(r)?r:null}getVisualFromPhysicalIndex(e){let r=this.fromPhysicalToVisualIndexesCache.get(e);return Be(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){let r=this.fromVisualToRenderableIndexesCache.get(e);return Be(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;let s=Array.from(this.fromVisualToRenderableIndexesCache.keys()),o=-1;return r>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){let r=this.getNumberOfIndexes();if(e<r){let n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);let n=Di(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=ba(this.getIndexesSequence(),n),a=o.filter(u=>this.isTrimmed(u)===!1),l=o.indexOf(a[a.length-1])+1;if(r+s<i){let u=a[r];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(jd(o,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start",i=this.getNotTrimmedIndexes()[e],s=Be(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Di(new Array(r).fill(s),(u,f)=>u+f);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0;let l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(o,l),this.hidingMapsCollection.insertToEvery(o,l),this.variousMapsCollection.insertToEvery(o,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){let n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){let e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){let n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}};ft(Oa,mn);var Zve=T(tt(),1),Jve=T(Vc(),1);function tI(t,e){return ht(e,(r,n)=>{pr(t[n])&&(t[n]=r)}),t}function Jd(t){let r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function Qd(t){Be(t)&&X2(mr`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Jv(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}var Uve=T(tt(),1),jve=T(Cn(),1);function e0(t,e){return Array.isArray(t)?t.map(r=>e0(r,e)):bh(t,e)}var{register:fY,getValues:hY}=Hn("phraseFormatters");function rI(t,e){fY(t,e)}function nI(){return hY()}rI("pluralize",Jv);rI("substitute",e0);var t0={};pL(t0,{CANCEL:()=>tw,CHECKBOX_CHECKED:()=>Dx,CHECKBOX_RENDERER_NAMESPACE:()=>Fx,CHECKBOX_UNCHECKED:()=>Px,COMMON_NAMESPACE:()=>Qv,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>yw,CONTEXTMENU_ITEMS_ALIGNMENT:()=>bw,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>Fw,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>Ow,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>Iw,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>Rw,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>Mw,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>Aw,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>kw,CONTEXTMENU_ITEMS_BORDERS:()=>Dw,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>Hw,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>Lw,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>Nw,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>Pw,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>hw,CONTEXTMENU_ITEMS_COPY:()=>dw,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>gw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>pw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>mw,CONTEXTMENU_ITEMS_CUT:()=>vw,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>_w,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>ww,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>Uw,CONTEXTMENU_ITEMS_HIDE_ROW:()=>Gw,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>sw,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>ow,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>Sw,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>Ww,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>Vw,CONTEXTMENU_ITEMS_NO_ITEMS:()=>rw,CONTEXTMENU_ITEMS_READ_ONLY:()=>fw,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>Tw,CONTEXTMENU_ITEMS_REDO:()=>uw,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>Bw,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>lw,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>Ew,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>aw,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>nw,CONTEXTMENU_ITEMS_ROW_BELOW:()=>iw,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>jw,CONTEXTMENU_ITEMS_SHOW_ROW:()=>zw,CONTEXTMENU_ITEMS_UNDO:()=>cw,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>xw,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>Cw,CONTEXT_MENU_ITEMS_NAMESPACE:()=>iI,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET:()=>Wx,EMPTY_DATA_STATE_DESCRIPTION:()=>Lx,EMPTY_DATA_STATE_DESCRIPTION_FILTERS:()=>Vx,EMPTY_DATA_STATE_NAMESPACE:()=>Vl,EMPTY_DATA_STATE_TITLE:()=>Hx,EMPTY_DATA_STATE_TITLE_FILTERS:()=>Bx,FILTERS_BUTTONS_CANCEL:()=>Sx,FILTERS_BUTTONS_CLEAR:()=>wx,FILTERS_BUTTONS_OK:()=>xx,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>Cx,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>_x,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>yx,FILTERS_BUTTONS_SELECT_ALL:()=>vx,FILTERS_CONDITIONS_AFTER:()=>ax,FILTERS_CONDITIONS_BEFORE:()=>lx,FILTERS_CONDITIONS_BEGINS_WITH:()=>Zw,FILTERS_CONDITIONS_BETWEEN:()=>sx,FILTERS_CONDITIONS_BY_VALUE:()=>dY,FILTERS_CONDITIONS_CONTAINS:()=>Qw,FILTERS_CONDITIONS_EMPTY:()=>qw,FILTERS_CONDITIONS_ENDS_WITH:()=>Jw,FILTERS_CONDITIONS_EQUAL:()=>Xw,FILTERS_CONDITIONS_GREATER_THAN:()=>tx,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>rx,FILTERS_CONDITIONS_LESS_THAN:()=>nx,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>ix,FILTERS_CONDITIONS_NAMESPACE:()=>or,FILTERS_CONDITIONS_NONE:()=>Yw,FILTERS_CONDITIONS_NOT_BETWEEN:()=>ox,FILTERS_CONDITIONS_NOT_CONTAIN:()=>ex,FILTERS_CONDITIONS_NOT_EMPTY:()=>$w,FILTERS_CONDITIONS_NOT_EQUAL:()=>Kw,FILTERS_CONDITIONS_TODAY:()=>cx,FILTERS_CONDITIONS_TOMORROW:()=>ux,FILTERS_CONDITIONS_YESTERDAY:()=>fx,FILTERS_DIVS_FILTER_BY_CONDITION:()=>hx,FILTERS_DIVS_FILTER_BY_VALUE:()=>dx,FILTERS_LABELS_CONJUNCTION:()=>mx,FILTERS_LABELS_DISJUNCTION:()=>px,FILTERS_NAMESPACE:()=>Wn,FILTERS_VALUES_BLANK_CELLS:()=>gx,LOADING_NAMESPACE:()=>sI,LOADING_TITLE:()=>Nx,OK:()=>ew,PAGINATION_COUNTER_SECTION:()=>Rx,PAGINATION_FIRST_PAGE:()=>Ax,PAGINATION_LAST_PAGE:()=>Mx,PAGINATION_NAMESPACE:()=>vs,PAGINATION_NAV_SECTION:()=>Ox,PAGINATION_NEXT_PAGE:()=>kx,PAGINATION_PAGE_SIZE_AUTO:()=>Tx,PAGINATION_PAGE_SIZE_SECTION:()=>bx,PAGINATION_PREV_PAGE:()=>Ix,PAGINATION_SECTION:()=>Ex});var Qv="Common:",ew=`${Qv}ok`,tw=`${Qv}cancel`,iI="ContextMenu:items",Je=iI,rw=`${Je}.noItems`,nw=`${Je}.insertRowAbove`,iw=`${Je}.insertRowBelow`,sw=`${Je}.insertColumnOnTheLeft`,ow=`${Je}.insertColumnOnTheRight`,aw=`${Je}.removeRow`,lw=`${Je}.removeColumn`,cw=`${Je}.undo`,uw=`${Je}.redo`,fw=`${Je}.readOnly`,hw=`${Je}.clearColumn`,dw=`${Je}.copy`,mw=`${Je}.copyWithHeaders`,pw=`${Je}.copyWithGroupHeaders`,gw=`${Je}.copyHeadersOnly`,vw=`${Je}.cut`,ww=`${Je}.freezeColumn`,xw=`${Je}.unfreezeColumn`,Sw=`${Je}.mergeCells`,Cw=`${Je}.unmergeCells`,yw=`${Je}.addComment`,_w=`${Je}.editComment`,Ew=`${Je}.removeComment`,Tw=`${Je}.readOnlyComment`,bw=`${Je}.align`,Rw=`${Je}.align.left`,Ow=`${Je}.align.center`,Aw=`${Je}.align.right`,Iw=`${Je}.align.justify`,kw=`${Je}.align.top`,Mw=`${Je}.align.middle`,Fw=`${Je}.align.bottom`,Dw=`${Je}.borders`,Pw=`${Je}.borders.top`,Nw=`${Je}.borders.right`,Hw=`${Je}.borders.bottom`,Lw=`${Je}.borders.left`,Bw=`${Je}.borders.remove`,Vw=`${Je}.nestedHeaders.insertChildRow`,Ww=`${Je}.nestedHeaders.detachFromParent`,Uw=`${Je}.hideColumn`,jw=`${Je}.showColumn`,Gw=`${Je}.hideRow`,zw=`${Je}.showRow`,Wn="Filters:",or=`${Wn}conditions`,Yw=`${or}.none`,qw=`${or}.isEmpty`,$w=`${or}.isNotEmpty`,Xw=`${or}.isEqualTo`,Kw=`${or}.isNotEqualTo`,Zw=`${or}.beginsWith`,Jw=`${or}.endsWith`,Qw=`${or}.contains`,ex=`${or}.doesNotContain`,dY=`${or}.byValue`,tx=`${or}.greaterThan`,rx=`${or}.greaterThanOrEqualTo`,nx=`${or}.lessThan`,ix=`${or}.lessThanOrEqualTo`,sx=`${or}.isBetween`,ox=`${or}.isNotBetween`,ax=`${or}.after`,lx=`${or}.before`,cx=`${or}.today`,ux=`${or}.tomorrow`,fx=`${or}.yesterday`,hx=`${Wn}labels.filterByCondition`,dx=`${Wn}labels.filterByValue`,mx=`${Wn}labels.conjunction`,px=`${Wn}labels.disjunction`,gx=`${Wn}values.blankCells`,vx=`${Wn}buttons.selectAll`,wx=`${Wn}buttons.clear`,xx=`${Wn}buttons.ok`,Sx=`${Wn}buttons.cancel`,Cx=`${Wn}buttons.placeholder.search`,yx=`${Wn}buttons.placeholder.value`,_x=`${Wn}buttons.placeholder.secondValue`,vs="Pagination:",Ex=`${vs}section.pagination`,Tx=`${vs}.pageSize.auto`,bx=`${vs}section.pageSize`,Rx=`${vs}section.counter`,Ox=`${vs}section.navigation`,Ax=`${vs}firstPage`,Ix=`${vs}prevPage`,kx=`${vs}nextPage`,Mx=`${vs}lastPage`,Fx="CheckboxRenderer:",Dx=`${Fx}checked`,Px=`${Fx}unchecked`,sI="Loading:",Nx=`${sI}title`,Vl="EmptyDataState:",Hx=`${Vl}title`,Lx=`${Vl}description`,Bx=`${Vl}title.filters`,Vx=`${Vl}description.filters`,Wx=`${Vl}buttons.filters.reset`;var mY={languageCode:"en-US",[ew]:"OK",[tw]:"Cancel",[rw]:"No available options",[nw]:"Insert row above",[iw]:"Insert row below",[sw]:"Insert column left",[ow]:"Insert column right",[aw]:["Remove row","Remove rows"],[lw]:["Remove column","Remove columns"],[cw]:"Undo",[uw]:"Redo",[fw]:"Read only",[hw]:"Clear column",[bw]:"Alignment",[Rw]:"Left",[Ow]:"Center",[Aw]:"Right",[Iw]:"Justify",[kw]:"Top",[Mw]:"Middle",[Fw]:"Bottom",[ww]:"Freeze column",[xw]:"Unfreeze column",[Dw]:"Borders",[Pw]:"Top",[Nw]:"Right",[Hw]:"Bottom",[Lw]:"Left",[Bw]:"Remove border(s)",[yw]:"Add comment",[_w]:"Edit comment",[Ew]:"Delete comment",[Tw]:"Read-only comment",[Sw]:"Merge cells",[Cw]:"Unmerge cells",[dw]:"Copy",[mw]:["Copy with header","Copy with headers"],[pw]:["Copy with group header","Copy with group headers"],[gw]:["Copy header only","Copy headers only"],[vw]:"Cut",[Vw]:"Insert child row",[Ww]:"Detach from parent",[Uw]:["Hide column","Hide columns"],[jw]:["Show column","Show columns"],[Gw]:["Hide row","Hide rows"],[zw]:["Show row","Show rows"],[Yw]:"None",[qw]:"Is empty",[$w]:"Is not empty",[Xw]:"Is equal to",[Kw]:"Is not equal to",[Zw]:"Begins with",[Jw]:"Ends with",[Qw]:"Contains",[ex]:"Does not contain",[tx]:"Greater than",[rx]:"Greater than or equal to",[nx]:"Less than",[ix]:"Less than or equal to",[sx]:"Is between",[ox]:"Is not between",[ax]:"After",[lx]:"Before",[cx]:"Today",[ux]:"Tomorrow",[fx]:"Yesterday",[gx]:"Blank cells",[hx]:"Filter by condition",[dx]:"Filter by value",[mx]:"And",[px]:"Or",[vx]:"Select all",[wx]:"Clear",[xx]:"OK",[Sx]:"Cancel",[Cx]:"Search",[yx]:"Value",[_x]:"Second value",[Ex]:"Pagination",[bx]:"Page size",[Tx]:"Auto",[Rx]:"[start] - [end] of [total]",[Ox]:"Page [currentPage] of [totalPages]",[Ax]:"Go to first page",[Ix]:"Go to previous page",[kx]:"Go to next page",[Mx]:"Go to last page",[Dx]:"Checked",[Px]:"Unchecked",[Nx]:"Loading...",[Hx]:"No data available",[Lx]:"There\u2019s nothing to display yet.",[Bx]:"No results found",[Vx]:"It looks like your current filters are hiding all results.",[Wx]:"Reset filters"},Ux=mY;var oI=t0,jx=Ux.languageCode,{register:pY,getItem:aI,hasItem:gY,getValues:vY}=Hn("languagesDictionaries");Gx(Ux);function Gx(t,e){let r=t,n=e;return tn(t)&&(n=t,r=n.languageCode),wY(r,n),pY(r,hi(n)),hi(n)}function wY(t,e){t!==jx&&tI(e,aI(jx))}function zx(t){return r0(t)?hi(aI(t)):null}function r0(t){return gY(t)}function lI(){return vY()}function n0(t,e,r){let n=zx(t);if(n===null)return null;let i=n[e];if(pr(i))return null;let s=xY(i,r);return Array.isArray(s)?s[0]:s}function xY(t,e){return nI().reduce((r,n)=>n(r,e),t)}function cI(t){let e=Jd(t);return r0(e)||(e=jx,Qd(t)),e}var Wxe=T(xe(),1),Uxe=T(Qe(),1),jxe=T($r(),1),Gxe=T(Xr(),1),zxe=T(Kr(),1),Yxe=T(Zr(),1),qxe=T(Jr(),1),$xe=T(Qr(),1),Xxe=T(en(),1),Kxe=T(tt(),1),Zxe=T(sr(),1),Jxe=T(Cn(),1),Qxe=T(Bo(),1);var Ywe=T(xe(),1),qwe=T(Qe(),1);var owe=T(xe(),1);function SY(t,e,r){return(e=CY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CY(t){var e=yY(t,"string");return typeof e=="symbol"?e:e+""}function yY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Yx=class extends Cd{constructor(e,r){super(e,null),SY(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=r,s=n),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r,i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;let s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;let e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){let r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(r,n,i)),o!==null&&e.overlaps(o)){let a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){let l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){let e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){let n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}},Wr=Yx;function i0(t){let n=t,{activeHeaderClassName:e}=n,r=Hr(n,["activeHeaderClassName"]);return new Wr(At(De({className:e},r),{selectionType:yd}))}function uI(t){let n=t,{areaCornerVisible:e}=n,r=Hr(n,["areaCornerVisible"]);return new Wr(At(De({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e}},r),{selectionType:Po}))}function fI(t){let e=Hr(t,[]);return new Wr(At(De({className:"highlight"},e),{selectionType:Po}))}function hI(t){let n=t,{columnClassName:e}=n,r=Hr(n,["columnClassName"]);return new Wr(At(De({className:e},r),{selectionType:Td}))}function dI(t){let n=t,{cellCornerVisible:e}=n,r=Hr(n,["cellCornerVisible"]);return new Wr(At(De({className:"current",headerAttributes:[Mh()],border:{width:2,color:"#4b89ff",cornerVisible:e}},r),{selectionType:No}))}function mI(t){let i=t,{border:e,visualCellRange:r}=i,n=Hr(i,["border","visualCellRange"]);return new Wr(At(De(De({},e),n),{selectionType:bd}),r)}function pI(t){let e=Hr(t,[]);return new Wr(At(De({className:"fill",border:{width:1,color:"#ff0000"}},e),{selectionType:_d}))}function qx(t){let n=t,{headerClassName:e}=n,r=Hr(n,["headerClassName"]);return new Wr(At(De({className:e},r),{selectionType:kl}))}function gI(t){let n=t,{rowClassName:e}=n,r=Hr(n,["rowClassName"]);return new Wr(At(De({className:e},r),{selectionType:Ed}))}function _Y(t,e){EY(t,e),e.add(t)}function EY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Un(t,e,r){return(e=TY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TY(t){var e=bY(t,"string");return typeof e=="symbol"?e:e+""}function bY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ws=new WeakSet,$x=class{constructor(e){_Y(this,ws),Un(this,"options",void 0),Un(this,"layerLevel",0),Un(this,"focus",void 0),Un(this,"fill",void 0),Un(this,"layeredAreas",new Map),Un(this,"areas",new Map),Un(this,"rowHeaders",new Map),Un(this,"columnHeaders",new Map),Un(this,"activeRowHeaders",new Map),Un(this,"activeColumnHeaders",new Map),Un(this,"activeCornerHeaders",new Map),Un(this,"rowHighlights",new Map),Un(this,"columnHighlights",new Map),Un(this,"customSelections",[]),this.options=e,this.focus=dI(e),this.fill=pI(e)}isEnabledFor(e,r){let n=e;e===No&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return qs(ws,this,$s).call(this,this.layeredAreas,uI)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return qs(ws,this,$s).call(this,this.areas,fI)}getAreas(){return[...this.areas.values()]}createRowHeader(){return qs(ws,this,$s).call(this,this.rowHeaders,qx)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return qs(ws,this,$s).call(this,this.columnHeaders,qx)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return qs(ws,this,$s).call(this,this.activeRowHeaders,i0)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return qs(ws,this,$s).call(this,this.activeColumnHeaders,i0)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return qs(ws,this,$s).call(this,this.activeCornerHeaders,i0)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return qs(ws,this,$s).call(this,this.rowHighlights,gI)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return qs(ws,this,$s).call(this,this.columnHighlights,hI)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(mI(De(De({},this.options),e)))}clear(){this.focus.clear(),this.fill.clear(),Ue(this.areas.values(),e=>void e.clear()),Ue(this.layeredAreas.values(),e=>void e.clear()),Ue(this.rowHeaders.values(),e=>void e.clear()),Ue(this.columnHeaders.values(),e=>void e.clear()),Ue(this.activeRowHeaders.values(),e=>void e.clear()),Ue(this.activeColumnHeaders.values(),e=>void e.clear()),Ue(this.activeCornerHeaders.values(),e=>void e.clear()),Ue(this.rowHighlights.values(),e=>void e.clear()),Ue(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}};function $s(t,e){let r=this.layerLevel;if(t.has(r))return t.get(r);let n=e(De({layerLevel:r},this.options));return t.set(r,n),n}var vI=$x;var axe=T(xe(),1),lxe=T(Qe(),1),cxe=T(tt(),1),uxe=T(Xn(),1),fxe=T(sr(),1),hxe=T(Cn(),1),dxe=T(Bo(),1);function wI(t,e,r){return(e=RY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RY(t){var e=OY(t,"string");return typeof e=="symbol"?e:e+""}function OY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Xx=class t{constructor(e){wI(this,"ranges",[]),wI(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){let r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){let e=new t(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}},xI=Xx;var pxe=T(xe(),1);function AY(t,e){EI(t,e),e.add(t)}function IY(t,e,r){return(e=kY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kY(t){var e=MY(t,"string");return typeof e=="symbol"?e:e+""}function MY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kx(t,e,r){EI(t,e),e.set(t,r)}function EI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function br(t,e){return t.get(_t(t,e))}function Ul(t,e,r){return t.set(_t(t,e),r),r}function _t(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xs=new WeakMap,Aa=new WeakMap,Qn=new WeakMap,Rt=new WeakSet,Ia=class{constructor(e,r){AY(this,Rt),Kx(this,Xs,void 0),Kx(this,Aa,0),Kx(this,Qn,{x:0,y:0}),IY(this,"tableApi",void 0),Ul(Xs,this,e),this.tableApi=r}setActiveLayerIndex(e){Ul(Aa,this,e)}getCurrentSelection(){return br(Xs,this).peekByIndex(br(Aa,this))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Ul(Qn,this,this.calculateOffset());let i=this.tableApi.createCellCoords(e,r),s=this.getCurrentSelection().highlight,o=this.tableApi.visualToRenderableCoords(s),a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){let{width:u,height:f}=_t(Rt,this,Zx).call(this),{row:d,col:p}=_t(Rt,this,_I).call(this,s),g=this.tableApi.fixedRowsBottom(),x=this.tableApi.minSpareRows(),w=this.tableApi.minSpareCols(),y=this.tableApi.autoWrapRow(),P=this.tableApi.autoWrapCol(),N=this.tableApi.createCellCoords(d+i.row,p+i.col);if(N.row>=f){let Q=Pr(n&&x>0&&g===0),he=N.col+1,U=he>=u,X=this.tableApi.createCellCoords(N.row-f,U?he-u:he);if(this.runLocalHooks("beforeColumnWrap",Q,_t(Rt,this,Wl).call(this,X),U),Q.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(P){if(this.shouldSwitchSelectionLayer()&&U&&br(Xs,this).size()>1){_t(Rt,this,SI).call(this);let K=_t(Rt,this,s0).call(this,"forward");K!==null&&X.assign(K)}N.assign(X)}}else if(N.row<0){let Q=Pr(P),he=N.col-1,U=he<0,X=this.tableApi.createCellCoords(f+N.row,U?u+he:he);if(this.runLocalHooks("beforeColumnWrap",Q,_t(Rt,this,Wl).call(this,X),U),P){if(this.shouldSwitchSelectionLayer()&&U&&br(Xs,this).size()>1){_t(Rt,this,CI).call(this);let K=_t(Rt,this,s0).call(this,"backward");K!==null&&X.assign(K)}N.assign(X)}}if({width:u,height:f}=_t(Rt,this,Zx).call(this),N.col>=u){let Q=Pr(n&&w>0),he=N.row+1,U=he>=f,X=this.tableApi.createCellCoords(U?he-f:he,N.col-u);if(this.runLocalHooks("beforeRowWrap",Q,_t(Rt,this,Wl).call(this,X),U),Q.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(y){if(this.shouldSwitchSelectionLayer()&&U&&br(Xs,this).size()>1){_t(Rt,this,SI).call(this);let K=_t(Rt,this,s0).call(this,"forward");K!==null&&X.assign(K)}N.assign(X)}}else if(N.col<0){let Q=Pr(y),he=N.row-1,U=he<0,X=this.tableApi.createCellCoords(U?f+he:he,u+N.col);if(this.runLocalHooks("beforeRowWrap",Q,_t(Rt,this,Wl).call(this,X),U),y){if(this.shouldSwitchSelectionLayer()&&U&&br(Xs,this).size()>1){_t(Rt,this,CI).call(this);let K=_t(Rt,this,s0).call(this,"backward");K!==null&&X.assign(K)}N.assign(X)}}let{rowDir:B,colDir:F}=_t(Rt,this,yI).call(this,N);a=B,l=F,s=_t(Rt,this,Wl).call(this,N)}return this.runLocalHooks("afterTransformStart",s,a,l),{selectionLayer:br(Aa,this),visualCoords:s}}transformEnd(e,r){Ul(Qn,this,this.calculateOffset());let n=this.tableApi.createCellCoords(e,r),i=this.getCurrentSelection(),s=this.tableApi.visualToRenderableCoords(i.highlight),o=_t(Rt,this,o0).call(this,i.to.row,i.from.row),a=_t(Rt,this,a0).call(this,i.to.col,i.from.col),l=i.to.clone(),u=0,f=0;if(this.runLocalHooks("beforeTransformEnd",n),s.row!==null&&s.col!==null&&o!==null&&a!==null){let{row:d,col:p}=_t(Rt,this,_I).call(this,i.highlight),g=this.tableApi.createCellCoords(o+n.row,a+n.col),x=i.getTopStartCorner(),w=i.getTopEndCorner(),y=i.getBottomEndCorner();if(n.col<0&&a>=p&&g.col<p){let F=g.col-p;g.col=_t(Rt,this,a0).call(this,x.col,w.col)+F}else if(n.col>0&&a<=p&&g.col>p){let F=_t(Rt,this,a0).call(this,w.col,x.col),Q=Math.max(g.col-F,1);g.col=F+Q}if(n.row<0&&o>=d&&g.row<d){let F=g.row-d;g.row=_t(Rt,this,o0).call(this,x.row,y.row)+F}else if(n.row>0&&o<=d&&g.row>d){let F=_t(Rt,this,o0).call(this,y.row,x.row),Q=Math.max(g.row-F,1);g.row=F+Q}let{rowDir:P,colDir:N}=_t(Rt,this,yI).call(this,g);u=P,f=N;let B=_t(Rt,this,Wl).call(this,g);n.row===0&&n.col!==0?l.col=B.col:n.row!==0&&n.col===0?l.row=B.row:(l.row=B.row,l.col=B.col)}return this.runLocalHooks("afterTransformEnd",l,u,f),{selectionLayer:br(Aa,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}};function SI(){let t=br(Aa,this)+1;this.setActiveLayerIndex(t>=br(Xs,this).size()?0:t),Ul(Qn,this,this.calculateOffset())}function CI(){let t=br(Aa,this)-1;this.setActiveLayerIndex(t<0?br(Xs,this).size()-1:t),Ul(Qn,this,this.calculateOffset())}function yI(t){let{width:e,height:r}=_t(Rt,this,Zx).call(this),n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function Zx(){return{width:br(Qn,this).x+this.countRenderableColumns(),height:br(Qn,this).y+this.countRenderableRows()}}function s0(t){if(!["forward","backward"].includes(t))return null;let e=this.getCurrentSelection().getTopStartCorner(),r=this.getCurrentSelection().getBottomEndCorner(),[n,i,s,o]=t==="forward"?[e.row,r.row,e.col,r.col]:[r.row,e.row,r.col,e.col],a=_t(Rt,this,o0).call(this,n,i),l=_t(Rt,this,a0).call(this,s,o);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function o0(t,e){let r=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return r===null?null:br(Qn,this).y+r}function a0(t,e){let r=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return r===null?null:br(Qn,this).x+r}function _I(t){let{row:e,col:r}=this.tableApi.visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(br(Qn,this).y+e,br(Qn,this).x+r)}function Wl(t){let e=t.clone();return e.col=t.col-br(Qn,this).x,e.row=t.row-br(Qn,this).y,this.tableApi.renderableToVisualCoords(e)}ft(Ia,mn);var Bu=class extends Ia{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}};var Cxe=T(xe(),1);var Vu=class extends Ia{calculateOffset(){let e=this.getCurrentSelection(),{row:r,col:n}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,n-1),s=this.tableApi.countRenderableRowsInRange(0,r-1),o=e.highlight.isHeader(),a=o?Math.abs(n):0,l=o?Math.abs(r):0;return{x:n<0?a:-i,y:r<0?l:-s}}countRenderableRows(){let e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){let e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}};var Rxe=T(xe(),1),Oxe=T(Qe(),1),Axe=T($r(),1),Ixe=T(Xr(),1),kxe=T(Kr(),1),Mxe=T(Zr(),1),Fxe=T(Jr(),1),Dxe=T(Qr(),1),Pxe=T(en(),1),Nxe=T(tt(),1),Hxe=T(Bo(),1);var Qx=0,e1=1,bI=2,t1=3,FY=[t1,bI],DY=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Jx=Symbol("root"),TI=Symbol("child");function r1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jx;if(e!==Jx&&e!==TI)throw new Error("The second argument is used internally only and cannot be overwritten.");let r=Array.isArray(t),n=e===Jx,i=Qx;if(r){let s=t[0];t.length===0?i=e1:n&&s instanceof Sa?i=t1:n&&Array.isArray(s)?i=r1(s,TI):t.length>=2&&t.length<=4&&!t.some((a,l)=>!DY[l].includes(typeof a))&&(i=bI)}return i}function RI(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!FY.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){let o=t===t1,a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],f=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof f=="string"&&(f=i(f))),pr(u)&&(u=a),pr(f)&&(f=l),!n){let x=a,w=l,y=u,P=f;a=Math.min(x,y),l=Math.min(w,P),u=Math.max(x,y),f=Math.max(w,P)}let d=o?s.highlight.clone():e(a,l),p=e(a,l),g=e(u,f);return r(d,p,g)}}function ka(t,e,r){PY(t,e),e.set(t,r)}function PY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ma(t,e,r){return(e=NY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NY(t){var e=HY(t,"string");return typeof e=="symbol"?e:e+""}function HY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xt(t,e){return t.get(OI(t,e))}function ei(t,e,r){return t.set(OI(t,e),r),r}function OI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ti=new WeakMap,jl=new WeakMap,l0=new WeakMap,Wo=new WeakMap,c0=new WeakMap,Wu=new WeakMap,u0=new WeakMap,f0=class{constructor(e,r){var n=this;Ma(this,"settings",void 0),Ma(this,"tableProps",void 0),Ma(this,"inProgress",!1),Ma(this,"selectedRange",new xI((i,s,o)=>this.tableProps.createCellRange(i,s,o))),Ma(this,"highlight",void 0),ka(this,ti,void 0),ka(this,jl,void 0),Ma(this,"selectedByRowHeader",new Set),Ma(this,"selectedByColumnHeader",new Set),ka(this,l0,!1),ka(this,Wo,!1),ka(this,c0,"unknown"),ka(this,Wu,-1),ka(this,u0,0),this.settings=e,this.tableProps=r,this.highlight=new vI({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Mh()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),ei(ti,this,new Bu(this.selectedRange,At(De({},this.tableProps),{navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}))),ei(jl,this,new Vu(this.selectedRange,At(De({},this.tableProps),{navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0}))),Xt(ti,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...s)}),Xt(ti,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...s)}),Xt(ti,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),Xt(ti,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...s)}),Xt(ti,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...s)}),Xt(ti,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertColRequire",...s)}),Xt(ti,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...s)}),Xt(ti,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...s)}),Xt(jl,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...s)}),Xt(jl,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(Xt(u0,this))}getActiveSelectionLayerIndex(){return Xt(u0,this)}setActiveSelectionLayerIndex(e){ei(u0,this,e)}markSource(e){ei(c0,this,e)}markEndSource(){ei(c0,this,"unknown")}getSelectionSource(){return Xt(c0,this)}setExpectedLayers(e){ei(Wu,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,ei(Wu,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,s=this.settings.selectionMode==="multiple",o=pr(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();ei(Wo,this,!1),ei(l0,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!s||s&&!o&&pr(r))&&(this.selectedRange.clear(),Ue(this.highlight.getAreas(),l=>void l.clear()),Ue(this.highlight.getLayeredAreas(),l=>void l.clear()),Ue(this.highlight.getRowHeaders(),l=>void l.clear()),Ue(this.highlight.getColumnHeaders(),l=>void l.clear()),Ue(this.highlight.getActiveRowHeaders(),l=>void l.clear()),Ue(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),Ue(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),Ue(this.highlight.getRowHighlights(),l=>void l.clear()),Ue(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r);let n=e.clone(),i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||s>0)&&(i===0&&n.col<0&&!o||s===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();let a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{let u=a.getHorizontalDirection(),f=a.getVerticalDirection(),d=this.isMultiple();a.setTo(n),d&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),d&&(f!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&s>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,r),this.applyAndCommit(this.getActiveSelectedRange(),r);let l=Xt(Wu,this)===-1||this.selectedRange.size()===Xt(Wu,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel(),n=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(r);let s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),f=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),p=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),f.clear(),d.clear(),p.clear(),g.clear(),this.highlight.isEnabledFor(Po,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){let x=this.selectedRange.peekByIndex(r-1);this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(x.from).commit().syncWith(x),this.highlight.createLayeredArea().add(x.from).commit().syncWith(x),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(kl,e.highlight)){if(!e.isSingleHeader()){let y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),P=this.tableProps.createCellCoords(e.to.row,-1),N=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),B=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(N).commit(),p.add(y).commit(),g.add(N).commit()):(a.add(y).add(P).commit(),l.add(N).add(B).commit(),p.add(y).add(P).commit(),g.add(N).add(B).commit())}let x=!Xt(Wo,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),w=!Xt(Wo,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());x&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&f.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),x&&w&&d.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r),Xt(ti,this).setActiveLayerIndex(r),Xt(jl,this).setActiveLayerIndex(r);let n=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);let i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(No,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(ei(l0,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,{visualCoords:i}=Xt(ti,this).transformStart(e,r,n);this.setRangeStart(i)}transformEnd(e,r){let{visualCoords:n,selectionLayer:i}=Xt(ti,this).transformEnd(e,r);this.setRangeEnd(n,i)}transformFocus(e,r){let{selectionLayer:n,visualCoords:i}=Xt(jl,this).transformStart(e,r);this.setRangeFocus(i.normalize(),n)}shiftRows(e,r){if(!this.isSelected())return;let n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){let{from:i,to:s,highlight:o}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),f=u?-1:0,d=u?0:r;this.getSelectedRange().pop();let p=this.tableProps.createCellCoords(Wt(i.row+d,f,a-1),i.col),g=this.tableProps.createCellCoords(Wt(s.row+r,f,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(p,!0,this.tableProps.createCellCoords(Wt(o.row+r,0,a-1),o.col)):this.setRangeStartOnly(p,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;let n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){let{from:i,to:s,highlight:o}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),f=l?-1:0,d=l?0:r;this.getSelectedRange().pop();let p=this.tableProps.createCellCoords(i.row,Wt(i.col+d,f,a-1)),g=this.tableProps.createCellCoords(s.row,Wt(s.col+r,f,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(p,!0,this.tableProps.createCellCoords(o.row,Wt(o.col+r,0,a-1))):this.setRangeStartOnly(p,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;let r=Pr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&Xt(l0,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel(),r=i=>{let{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));let n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel(),r=i=>{let{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));let n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){let r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,f=r?-a:0;if(u===0&&f===0&&(s===0||o===0))return;let d=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight,{focusPosition:p,disableHeadersHighlight:g}=i;p&&Number.isInteger(p?.row)&&Number.isInteger(p?.col)&&(d=this.tableProps.createCellCoords(Wt(p.row,u,s-1),Wt(p.col,f,o-1)));let x=this.tableProps.createCellCoords(u,f),w=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.runLocalHooks("beforeSelectAll",x,w,d),this.setRangeStartOnly(x,void 0,d),ei(Wo,this,g),f<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectAll",x,w,d),this.finish()}selectCells(e){var r=this;let n=r1(e);if(n===e1)return!1;if(n===Qx)throw new Error(mr`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let i=RI(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{let u=i(l),f=u.isValid(o);return!(f&&!u.containsHeaders()||f&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),Ue(e,l=>{let{from:u,to:f}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(f.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,f=this.tableProps.createCellCoords(u,i),d=this.tableProps.createCellCoords(o-1,s),p=this.tableProps.createCellRange(f,f,d).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(p){let g=0,x=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(g=Wt(n.row,u,o-1),x=Wt(n.col,Math.min(i,s),Math.max(i,s))):(g=Wt(n,u,o-1),x=i);let w=this.tableProps.createCellCoords(g,x),y=l===0?0:Wt(w.row,u,-1),P=o-1,N=this.tableProps.createCellCoords(y,i),B=this.tableProps.createCellCoords(P,s);this.runLocalHooks("beforeSelectColumns",N,B,w),this.setRangeStartOnly(N,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(B),this.runLocalHooks("afterSelectColumns",N,B,w),this.finish()}return p}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,s-1),f=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(f){let d=0,p=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(d=Wt(n.row,Math.min(e,r),Math.max(e,r)),p=Wt(n.col,a,s-1)):(d=e,p=Wt(n,a,s-1));let g=this.tableProps.createCellCoords(d,p),x=o===0?0:Wt(g.col,a,-1),w=s-1,y=this.tableProps.createCellCoords(e,x),P=this.tableProps.createCellCoords(r,w);this.runLocalHooks("beforeSelectRows",y,P,g),this.setRangeStartOnly(y,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(P),this.runLocalHooks("afterSelectRows",y,P,g),this.finish()}return f}importSelection(e){let{ranges:r,activeRange:n,activeSelectionLayer:i,selectedByRowHeader:s,selectedByColumnHeader:o,disableHeadersHighlight:a}=e;r.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!1,ei(Wo,this,a),this.selectedByRowHeader=new Set(s),this.selectedByColumnHeader=new Set(o),this.setActiveSelectionLayerIndex(0),r.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(n.highlight,i),ei(Wo,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:Xt(Wo,this)}}refresh(){if(!this.isSelected())return;let e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}let n=this.selectedRange.ranges.map(o=>o.clone());this.markSource("refresh");let i=new Set(this.selectedByRowHeader),s=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(o=>{let{from:a,to:l,highlight:u}=o,f=e-1,d=r-1;u.assign({row:Wt(u.row,this.settings.navigableHeaders?-1/0:0,f),col:Wt(u.col,this.settings.navigableHeaders?-1/0:0,d)}),a.assign({row:Wt(a.row,-1/0,f),col:Wt(a.col,-1/0,d)}),l.assign({row:Wt(l.row,-1/0,f),col:Wt(l.col,-1/0,d)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=s,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;let r=this.getLayerLevel(),n=this.getActiveSelectedRange();this.highlight.isEnabledFor(No,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);let s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),f=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),p=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),f.commit(),d.commit(),p.commit(),g.commit()}this.highlight.useLayerLevel(r)}};ft(f0,mn);var n1=f0;var y1e=T(xe(),1),_1e=T(Qe(),1),E1e=T(tt(),1),T1e=T(Xn(),1),b1e=T(sr(),1);function h0(t){let e,r,n,i,s="",o;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),o=t[e][n],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==r-1&&(s+=`
`)}return s}function d0(t,e){let{instance:r,visualRow:n,visualCol:i,valueSetter:s}=e;return et(s)?s.call(r,t,n,i,e):t}function AI(t,e){let{instance:r,visualRow:n,visualCol:i,valueGetter:s}=e;return et(s)?s.call(r,t,n,i,e):t}function Fa(t,e,r){return(e=LY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LY(t){var e=BY(t,"string");return typeof e=="symbol"?e:e+""}function BY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var i1=class t{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Fa(this,"hot",void 0),Fa(this,"metaManager",void 0),Fa(this,"tableMeta",void 0),Fa(this,"dataSource",void 0),Fa(this,"duckSchema",void 0),Fa(this,"colToPropCache",void 0),Fa(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){let e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let r=this.tableMeta.columns,n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,o=!1;if(typeof r=="function"){let a=gl(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{let a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){let a=o?r(n):r[n];if(tn(a)){if(typeof a.data<"u"){let l=o?s:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Vd(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&ht(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;let r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&Be(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){let r=this.propToColCache.get(e);if(Be(r))return this.hot.toVisualColumn(r);let n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){let e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ma(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=this.hot.countSourceRows(),o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||o===null)return{delta:0};let f=this.tableMeta.maxRows,d=this.getSchema().length,p=[];for(;a<r&&s+a<f;){let x=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?x=hi(this.getSchema()):(x=[],sn(d-1,()=>x.push(null))):this.hot.dataType==="function"?x=this.tableMeta.dataSchema(l+a):(x={},zg(x,this.getSchema())),p.push(x),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,p);let g=this.hot.toVisualRow(o);return this.hot.countSourceRows()===p.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),f=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",f,r,n)===!1)return{delta:0};let d=f<l?this.hot.toPhysicalColumn(f):a,p=i==="end"?Math.min(d+1,a):d,g=0;for(let x=p;g<r&&l+g<o;x++){if(typeof f!="number"||f>=l+g)if(u>0)for(let w=0;w<u;w+=1)typeof s[w]>"u"&&(s[w]=[]),s[w].push(null);else s.push([null]);else for(let w=0;w<u;w++)s[w].splice(x,0,null);g+=1}return g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(p,r)),this.hot.columnIndexMapper.insertIndexes(f,g,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(p),g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:p}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r,s=this.visualRowsToPhysical(i,r),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;let l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);let f=Be(this.tableMeta.columns)||Be(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!f&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((f,d)=>d-f).forEach(f=>{this.metaManager.removeRow(f,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();let s=this.visualColumnsToPhysical(i,r),o=s.slice(0).sort((d,p)=>p-d);if(this.hot.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let l=!0,u=o.length,f=this.dataSource;for(let d=0;d<u;d++)l&&s[0]!==s[d]-d&&(l=!1);if(l)for(let d=0,p=this.hot.countSourceRows();d<p;d++)f[d].splice(s[0],r),d===0&&this.metaManager.removeColumn(s[0],r);else for(let d=0,p=this.hot.countSourceRows();d<p;d++)for(let g=0;g<u;g++)f[d].splice(o[g],1),d===0&&this.metaManager.removeColumn(o[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,s,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){let i=this.hot.getDataAtCol(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Mg(l,o);let f=0;for(;f<n;)l.push(null),f+=1;return PR(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),s}spliceRow(e,r,n){let i=this.hot.getSourceDataAtRow(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Mg(l,o);let f=0;for(;f<n;)l.push(null),f+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){let s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>n.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){let n=this.hot.toPhysicalRow(e),i=this.dataSource[n],s=this.hot.runHooks("modifyRowData",n);i=isNaN(s)?s:i;let{dataDotNotation:o}=this.hot.getSettings(),a=null;if(i&&i.hasOwnProperty&&Hi(i,r))a=i[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let f=i;if(!f)return null;let d=r.split(".");for(let p=0,g=d.length;p<g;p++)if(f=f[d[p]],typeof f>"u")return null;a=f}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));let l=this.propToCol(r),u=this.hot.toPhysicalColumn(l);if(Us(n)&&Us(u)&&(a=AI(a,this.metaManager.getCellMeta(n,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){let f=Pr(a);this.hot.runHooks("modifyData",e,l,f,"get"),f.isTouched()&&(a=f.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){let i=this.hot.toPhysicalRow(e),s=n,o=this.dataSource[i],a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){let u=Pr(s);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(s=u.value)}let{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Hi(o,r))o[r]=s;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=o,f=0,d,p=r.split(".");for(f=0,d=p.length-1;f<d;f++){if(p[f]==="__proto__"||p[f]==="constructor"||p[f]==="prototype")return;typeof u[p[f]]>"u"&&(u[p[f]]={}),u=u[p[f]]}u[p[f]]=s}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],s);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;o[r]=s}}visualRowsToPhysical(e,r){let n=this.hot.countSourceRows(),i=[],s=(n+e)%n,o=r,a;for(;s<n&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,r){let n=this.hot.countCols(),i=[],s=(n+e)%n,o=r;for(;s<n&&o;){let a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){let e=this.tableMeta.maxRows,r;e<0||e===0?r=0:r=e||1/0;let n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){let e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,t.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){let i=[],s,o,a,l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];let f=n===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),p=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=d;s++){a=[];let g=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,r.col);o<=p&&g!==null;o++)a.push(f.call(this,s,this.colToProp(o)));g!==null&&i.push(a)}return i}getText(e,r){return h0(this.getRange(e,r,t.DESTINATION_RENDERER))}getCopyableText(e,r){return h0(this.getRange(e,r,t.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}},II=i1;var WSe=T(xe(),1),USe=T(tt(),1),jSe=T(sr(),1);var nSe=T(xe(),1);var j1e=T(xe(),1),G1e=T($r(),1),z1e=T(Xr(),1),Y1e=T(Kr(),1),q1e=T(Zr(),1),$1e=T(Jr(),1),X1e=T(Qr(),1),K1e=T(en(),1);var P1e=T(xe(),1);var{register:VY,getItem:WY,hasItem:UY,getNames:V1e,getValues:W1e}=Hn("cellTypes");function kI(t){if(!UY(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return WY(t)}function MI(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);let{editor:r,renderer:n,validator:i}=e;r&&lv(t,r),n&&DO(t,n),i&&NO(t,i),VY(t,e)}function jY(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Hi(e,t)}function Uo(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,n=typeof e.type=="string"?kI(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ht(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!tn(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);let i={};ht(n,(s,o)=>{if(jY(o,r)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),Ni(t,i)}function FI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}S2(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Gl(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Uu(t){return t==null}var ju=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,emptyDataState:!1,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),Ls(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),Ls(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),Nh(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRowHeights:void 0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function DI(t,e,r){return(e=GY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GY(t){var e=zY(t,"string");return typeof e=="symbol"?e:e+""}function zY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YY(){return class{}}var m0=class{constructor(e){DI(this,"metaCtor",YY()),DI(this,"meta",void 0),this.meta=this.metaCtor.prototype,Ni(this.meta,ju()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Ni(this.meta,e),Uo(this.meta,At(De({},e),{type:(r=e.type)!==null&&r!==void 0?r:this.meta.type}),e)}};var uSe=T(xe(),1);function qY(t,e,r){return(e=$Y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Y(t){var e=XY(t,"string");return typeof e=="symbol"?e:e+""}function XY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var p0=class{constructor(e){qY(this,"meta",void 0);let r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Ni(this.meta,e),Uo(this.meta,e,e)}};var OSe=T(xe(),1);var mSe=T(xe(),1),pSe=T(Qe(),1),gSe=T($r(),1),vSe=T(Xr(),1),wSe=T(Kr(),1),xSe=T(Zr(),1),SSe=T(Jr(),1),CSe=T(Qr(),1),ySe=T(en(),1),_Se=T(tt(),1),ESe=T(Xn(),1);function g0(t,e,r){return(e=KY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KY(t){var e=ZY(t,"string");return typeof e=="symbol"?e:e+""}function ZY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jo=class{constructor(e){g0(this,"valueFactory",void 0),g0(this,"data",[]),g0(this,"index",[]),g0(this,"holes",new Set),this.valueFactory=e}obtain(e){Gl(()=>Us(e),"Expecting an unsigned number.");let r=this._getStorageIndexByKey(e),n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){let i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Gl(()=>Us(e)||Uu(e),"Expecting an unsigned number or null/undefined argument.");let n=[],i=this.data.length;for(let o=0;o<r;o++)n.push(i+o),this.data.push(void 0);let s=Uu(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Gl(()=>Us(e)||Uu(e),"Expecting an unsigned number or null/undefined argument.");let n=this.index.splice(Uu(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){let s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){let e=[];for(let n=0;n<this.data.length;n++){let i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){let n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}};function PI(t,e,r){return(e=JY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JY(t){var e=QY(t,"string");return typeof e=="symbol"?e:e+""}function QY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eq=["data","width"],v0=class{constructor(e){PI(this,"globalMeta",void 0),PI(this,"metas",new jo(()=>this._createMeta())),this.globalMeta=e,this.metas=new jo(()=>this._createMeta())}updateMeta(e,r){let n=this.getMeta(e);Ni(n,r),Uo(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return FI(this.globalMeta.getMetaConstructor(),eq).prototype}};var FSe=T(xe(),1),DSe=T(Qe(),1);function NI(t,e,r){return(e=tq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tq(t){var e=rq(t,"string");return typeof e=="symbol"?e:e+""}function rq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var w0=class{constructor(e){NI(this,"columnMeta",void 0),NI(this,"metas",new jo(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){let i=this.getMeta(e,r);Ni(i,n),Uo(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){let i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;let o=this.metas.obtain(e).obtain(r);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),o[n]=i}removeMeta(e,r,n){let i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){let e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)Be(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Gl(()=>Us(e),"Expecting an unsigned number.");let r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new jo(e=>this._createMeta(e))}_createMeta(e){let r=this.columnMeta.getMetaConstructor(e);return new r}};var zl=class{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new m0(e),this.tableMeta=new p0(this.globalMeta),this.columnMeta=new v0(this.globalMeta),this.cellMeta=new w0(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){let i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}};ft(zl,mn);var ZSe=T(xe(),1),JSe=T(Qe(),1);function x0(t,e,r,n){let{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:f}=n,d=dl(a),p=i.getSettings();Array.isArray(p.dataSchema)?i.dataType="array":et(p.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${d}`,t,f,l);let g=new II(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){let x=g.getSchema();t=[];let w,y=0,P=0;for(y=0,P=p.startRows;y<P;y++)if((i.dataType==="object"||i.dataType==="function")&&p.dataSchema)w=hi(x),t.push(w);else if(i.dataType==="array")w=hi(x[0]),t.push(w);else{w=[];for(let N=0,B=p.startCols;N<B;N++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),p.data=t,g.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=g.colToProp.bind(g),o.propToCol=g.propToCol.bind(g),o.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${d}`,t,f,l),f||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&dt(i.rootElement,[Ih(-1),ml(i.countCols()+(i.view?i.countRowHeaders():0))])}var oCe=T(xe(),1),aCe=T($r(),1),lCe=T(Xr(),1),cCe=T(Kr(),1),uCe=T(Zr(),1),fCe=T(Jr(),1),hCe=T(Qr(),1),dCe=T(en(),1);function HI(t,e,r){return(e=nq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nq(t){var e=iq(t,"string");return typeof e=="symbol"?e:e+""}function iq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gu=class{constructor(e){var r=this;HI(this,"metaManager",void 0),HI(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),$t.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;let{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;let{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);let u=Hi(e,"type")?e.type:null,f=et(e.cells)?e.cells(n,i,l):null;if(u)if(f){var d;f.type=(d=f.type)!==null&&d!==void 0?d:u}else f={type:u};f&&this.metaManager.updateCellMeta(n,i,f),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}};var wCe=T(xe(),1),xCe=T(Qe(),1),SCe=T($r(),1),CCe=T(Xr(),1),yCe=T(Kr(),1),_Ce=T(Zr(),1),ECe=T(Jr(),1),TCe=T(Qr(),1),bCe=T(en(),1),RCe=T(tt(),1),OCe=T(sr(),1);function sq(t,e,r){oq(t,e),e.set(t,r)}function oq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s1(t,e,r){return(e=aq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aq(t){var e=lq(t,"string");return typeof e=="symbol"?e:e+""}function lq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cq(t,e){return t.get(uq(t,e))}function uq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var LI=new WeakMap,zu=class{constructor(e){s1(this,"metaManager",void 0),s1(this,"usageTracker",new Set),s1(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),sq(this,LI,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{let{initOnly:n,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(r,l,s),o&&this.installPropWatcher(i,l,s)):n&&(this.installPropWatcher(r,l,cq(LI,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){let i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){let o=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,o),this[r]=s},enumerable:!0,configurable:!0})}};var NCe=T(xe(),1);function fq(t,e){GI(t,e),e.add(t)}function BI(t,e,r){GI(t,e),e.set(t,r)}function GI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VI(t,e){return t.get(Yl(t,e))}function WI(t,e,r){return t.set(Yl(t,e),r),r}function Yl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var o1=new WeakMap,a1=new WeakMap,Yu=new WeakSet,S0=class{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;fq(this,Yu),BI(this,o1,void 0),BI(this,a1,void 0),WI(o1,this,r),WI(a1,this,n)}toRenderable(e){let r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=Yl(Yu,this,UI).call(this,e.from,r,n);if(i===null)return null;let s=Yl(Yu,this,UI).call(this,e.to,-r,-n);if(s===null)return null;let o=e.clone();return o.from=i,o.to=s,o.includes(e.highlight)||(o.highlight=i),o}};function UI(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,n=Yl(Yu,this,jI).call(this,VI(o1,this),t.row,e);if(n===null)return null;let i=Yl(Yu,this,jI).call(this,VI(a1,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function jI(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}function _i(t){Io(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Go(t){let{selection:e,view:r}=t,n=t.getSelectedRangeActive(),i=e.getSelectionSource(),s=r.getFirstFullyVisibleColumn(),o=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=s,f=l>=o,d=r.getFirstFullyVisibleRow(),p=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,x=n.getBottomEndCorner().row,w=g<=d,y=x>=p;return{getComputedColumnTarget(P){return i==="mouse"||i==="keyboard"?P.col:u&&f?n.highlight.col:u?a:f?l:P.col},getComputedRowTarget(P){return i==="mouse"||i==="keyboard"?P.row:w&&y?n.highlight.row:w?g:y?x:P.row}}}function zI(t){return e=>{let r=Go(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{let n=!!t.getSettings().colHeaders;_i(t.getCell(n?-1:0,r,!0))})}}function YI(){return()=>{}}function qI(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{let r=t.getSelectedRangeActive();if(!r)return;let{row:n,col:i}=r.highlight;_i(t.getCell(n,i,!0))})}}function $I(t){return e=>{let r=Go(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{let{row:i,col:s}=n;_i(t.getCell(i,s,!0))})}}function XI(t){return e=>{let r=Go(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{let{row:i,col:s}=n;_i(t.getCell(i,s,!0))})}}function KI(t){return e=>{let r=Go(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{let n=!!t.getSettings().rowHeaders;_i(t.getCell(r,n?-1:0,!0))})}}function ZI(t){return e=>{let r=t.selection.getSelectionSource(),{row:n,col:i}=e,s=()=>{_i(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},s);else if(i<0&&n>=0)t.scrollViewportTo({row:n},s);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},s)}}}function JI(t){let{selection:e}=t,r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var s;if(r||n){r=!1;return}let o;e.isFocusSelectionChanged()?o=qI(t):e.isSelectedByCorner()?o=YI(t):e.isSelectedByRowHeader()?o=KI(t):e.isSelectedByColumnHeader()?o=zI(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=$I(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=ZI(t):e.getSelectedRange().size()>1&&(o=XI(t)),(s=o)===null||s===void 0||s(i)}}}var wye=T(xe(),1),xye=T(tt(),1),Sye=T(Xn(),1),Cye=T(sr(),1);var QI=Object.freeze({INLINE:"inline",MODAL:"modal"}),xs=Object.freeze({UNKNOWN:"unknown",CLICK:"click",TAB_FROM_ABOVE:"tab_from_above",TAB_FROM_BELOW:"tab_from_below"}),ek="grid";function rk(t,e){let r=tk(t,xs.TAB_FROM_ABOVE),n=tk(t,xs.TAB_FROM_BELOW);return e.prepend(r),e.append(n),{activate(){r.tabIndex=0,n.tabIndex=0},deactivate(){r.tabIndex=-1,n.tabIndex=-1},destroy(){r.remove(),n.remove()}}}function tk(t,e){let n=t.rootDocument.createElement("input");return n.type="text",n.name="htFocusCatcher",n.classList.add("htFocusCatcher"),n.dataset.htFocusSource=e,t.getSettings().ariaTags&&dt(n,[Ah("Focus catcher")]),n}function nk(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=De({shortcutsContextName:ek,type:QI.INLINE,contains:g=>g===e||e.contains(g),runOnlyIf:()=>!0},r),i=rk(t,e);return{getType:()=>n.type,hasContainerDetached:()=>!t.rootWrapperElement.contains(e),getShortcutsContextName:()=>n.shortcutsContextName,runOnlyIf:()=>n.runOnlyIf(),contains:g=>n.contains(g),activate:function(){var g;let x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xs.UNKNOWN;(g=n.onActivate)===null||g===void 0||g.call(n,x)},deactivate:()=>{var g;(g=n.onDeactivate)===null||g===void 0||g.call(n)},activateFocusCatchers:()=>{i?.activate()},deactivateFocusCatchers:()=>{i?.deactivate()},enable:()=>{e.removeAttribute("inert")},disable:()=>{e.setAttribute("inert","true")},destroy:()=>{i?.destroy()}}}function ik(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=!1;function n(f){if(!r){var d;(d=e.onFocus)===null||d===void 0||d.call(e,f)}}function i(f){var d;(d=e.onClick)===null||d===void 0||d.call(e,f)}function s(f){if(f.key==="Tab"){var d;(d=e.onTabKeyDown)===null||d===void 0||d.call(e,f)}}function o(){r=!0}function a(){r=!1}return{mount:()=>{let f=t;for(;f;){let{documentElement:d}=f.document;d.addEventListener("focusin",n),d.addEventListener("click",i),d.addEventListener("keydown",s),d.addEventListener("mousedown",o),d.addEventListener("mouseup",a),f=Bs(f)}},unmount:()=>{let f=t;for(;f;){let{documentElement:d}=f.document;d.removeEventListener("focusin",n),d.removeEventListener("click",i),d.removeEventListener("keydown",s),d.removeEventListener("mousedown",o),d.removeEventListener("mouseup",a),f=Bs(f)}}}}function l1(t){let e=hs({errorIdExists:x=>`The "${x}" focus scope is already registered.`}),r=t.getShortcutManager(),n=null;function i(){return n?e.getId(n):null}function s(x,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.hasItem(x))throw new Error(`Scope with id "${x}" already registered`);let P=nk(t,w,y);e.addItem(x,P),r.getOrCreateContext(P.getShortcutsContextName())}function o(x){if(!e.hasItem(x))throw new Error(`Scope with id "${x}" not found`);e.getItem(x).destroy(),e.removeItem(x)}function a(x){if(!e.hasItem(x))throw new Error(`Scope with id "${x}" not found`);u(e.getItem(x))}function l(x){if(!e.hasItem(x))throw new Error(`Scope with id "${x}" not found`);f(e.getItem(x))}function u(x){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xs.UNKNOWN;n!==x&&(n!==null&&f(n),n=x,n.activate(w),r.setActiveContextName(x.getShortcutsContextName()))}function f(x){d(),n===x&&(n=null,x.deactivate())}function d(){let x=e.getValues(),w=x.filter(y=>y.runOnlyIf()&&y.getType()==="modal");x.forEach(y=>{w.length>0&&w.includes(y)||w.length===0||y.hasContainerDetached()?y.enable():y.disable(),y===n?y.contains(t.rootDocument.activeElement)?y.deactivateFocusCatchers():y.activateFocusCatchers():y.runOnlyIf()?y.activateFocusCatchers():y.deactivateFocusCatchers()})}function p(x,w){if(!x.isConnected||!cs(x))return;let y=e.getValues().filter(N=>N.runOnlyIf()),P=!1;y.forEach(N=>{!P&&N.contains(x)&&(P=!0,w!==xs.UNKNOWN&&t.listen(),u(N,w))}),!P&&n&&(f(n),t.unlisten())}let g=ik(t.rootWindow,{onFocus:x=>{var w;p(x.target,(w=x.target.dataset.htFocusSource)!==null&&w!==void 0?w:xs.UNKNOWN)},onClick:x=>{p(x.target,xs.CLICK)},onTabKeyDown:()=>{d()}});return g.mount(),{getActiveScopeId:i,registerScope:s,unregisterScope:o,activateScope:x=>a(x),deactivateScope:x=>l(x),destroy:()=>g.unmount()}}var Oye=T(xe(),1);function hq(t,e){ok(t,e),e.add(t)}function ql(t,e,r){ok(t,e),e.set(t,r)}function ok(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function It(t,e){return t.get($i(t,e))}function Da(t,e,r){return t.set($i(t,e),r),r}function $i(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $l=Object.freeze({CELL:"cell",MIXED:"mixed"}),ar=new WeakMap,C0=new WeakMap,y0=new WeakMap,_0=new WeakMap,E0=new WeakMap,T0=new WeakMap,Ss=new WeakSet,qu=class{constructor(e){hq(this,Ss),ql(this,ar,void 0),ql(this,C0,void 0),ql(this,y0,1),ql(this,_0,null),ql(this,E0,new Map),ql(this,T0,!1),Da(ar,this,e)}init(){var e=this;let r=It(ar,this).getSettings();Da(C0,this,r.imeFastEdit?$l.MIXED:$l.CELL),It(ar,this).addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $i(Ss,e,gq).call(e,...i)}),It(ar,this).addHook("afterSelection",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $i(Ss,e,sk).call(e,...i)}),It(ar,this).addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $i(Ss,e,sk).call(e,...i)}),It(ar,this).addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $i(Ss,e,mq).call(e,...i)}),It(ar,this).addHook("afterRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $i(Ss,e,pq).call(e,...i)})}getFocusMode(){return It(C0,this)}setFocusMode(e){Object.values($l).includes(e)?Da(C0,this,e):Br(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return It(y0,this)}setRefocusDelay(e){Da(y0,this,e)}setRefocusElementGetter(e){Da(_0,this,e)}getRefocusElement(){var e;return typeof It(_0,this)=="function"?It(_0,this).call(this):(e=It(ar,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){let r=n=>{var i,s;let o=(i=It(ar,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=It(ar,this).runHooks("modifyFocusedElement",o.row,o.col,n);Io(a)||(a=n),a&&!((s=It(ar,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?r(e):$i(Ss,this,c1).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:It(y0,this);if(It(ar,this).getSettings().imeFastEdit&&!((e=It(ar,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=It(ar,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),It(E0,this).has(r)||It(E0,this).set(r,j2(()=>{if(!It(ar,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},r)),It(E0,this).get(r)()}}};function c1(t){var e;let r=(e=It(ar,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||!It(ar,this).selection.isCellVisible(r)){t(null);return}let n=It(ar,this).getCell(r.row,r.col,!0);n===null?It(ar,this).addHookOnce("afterScroll",()=>{t(It(ar,this).getCell(r.row,r.col,!0))}):t(n)}function dq(){$i(Ss,this,c1).call(this,t=>{let{activeElement:e}=It(ar,this).rootDocument;e&&Yh(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function mq(){$i(Ss,this,c1).call(this,t=>{this.getFocusMode()===$l.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function sk(){Da(T0,this,!0)}function pq(){It(T0,this)&&(Da(T0,this,!1),$i(Ss,this,dq).call(this))}function gq(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?$l.MIXED:$l.CELL)}function ak(t){return e=>{if(!e)return null;let{rowIndexMapper:r,columnIndexMapper:n}=t;if(r.isHidden(e.row)||n.isHidden(e.col))return null;let i=b0(t),s=R0(t);return i===null||s===null?null:(e.row=Wt(e.row,i.row,s.row),e.col=Wt(e.col,i.col,s.col),e)}}function b0(t){let{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings(),i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=r.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function R0(t){var e,r;let{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings(),o=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}var Pa="gridDefault",Xl="grid",Kl="grid.tabNavigation",O0="editorManager.handlingEditor",lk="editor";var ck={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}};var Wye=T(xe(),1);var Hye=T(Qe(),1);var vq="hooksRefRegisterer",uk={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Ue(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ht(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};dn(uk,"MIXIN_NAME",vq,{writable:!1,enumerable:!1});var fk=uk;function Xi(t,e,r){return(e=wq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wq(t){var e=xq(t,"string");return typeof e=="symbol"?e:e+""}function xq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hk="base",Qt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),zo=class{static get EDITOR_TYPE(){return hk}constructor(e){Xi(this,"hot",void 0),Xi(this,"state",Qt.VIRGIN),Xi(this,"_opened",!1),Xi(this,"_fullEditMode",!1),Xi(this,"_closeCallback",null),Xi(this,"TD",null),Xi(this,"row",null),Xi(this,"col",null),Xi(this,"prop",null),Xi(this,"originalValue",null),Xi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,o){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:Qt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,o;if(r){let l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),f=l.getBottomEndCorner();n=u.row,i=u.col,s=f.row,o=f.col}else[n,i,s,o]=[this.row,this.col,null,null];let a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,s,o,"edit")}beginEditing(e,r){if(this.state!==Qt.VIRGIN)return;let n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=Qt.EDITING,this.isInFullEditMode()){let l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:Eh(l);this.setValue(u)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),n.view.scrollViewport(n._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",o),o()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,r,n){let i;if(n){let s=this._closeCallback;this._closeCallback=o=>{s&&s(o),n(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Qt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Qt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}let s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=Qt.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=Qt.FINISHED,this.discardEditor(o)}):(this.state=Qt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Qt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Qt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Qt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Qt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Qt.WAITING}getEditedCellRect(){var e;let r=this.getEditedCell();if(!r)return;let{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=rn(r),a=gr(r),l=rn(this.hot.rootElement),u=gr(this.hot.rootElement),f=n.topOverlay.holder,d=n.inlineStartOverlay.holder,p=f!==s?f.scrollTop:0,g=d!==s?d.scrollLeft:0,x=s.innerWidth-l.left-u,{wtTable:w}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,y=w.name,P=["master","inline_start"].includes(y)?p:0,N=["master","top","bottom"].includes(y)?g:0,B=o.top===l.top?0:1,F=o.top-l.top-B-P,Q=0;this.hot.isRtl()?Q=s.innerWidth-o.left-a-x-1+N:Q=o.left-l.left-1-N,["top","top_inline_start_corner"].includes(y)&&(F+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(Q+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));let he=this.hot.hasColHeaders(),U=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),X=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ne=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(he&&U<=0||U===ne)&&(F+=1),X<=0&&(Q+=1);let ie=i.rowsRenderCalculator.startPosition,te=i.columnsRenderCalculator.startPosition,Re=Math.abs(n.inlineStartOverlay.getScrollPosition()),We=n.topOverlay.getScrollPosition(),ke=qt(this.hot.rootDocument),wt=r.offsetTop;if(["inline_start","master"].includes(y)&&(wt+=ie-We),["bottom","bottom_inline_start_corner"].includes(y)){let{wtViewport:D,wtTable:L}=n.bottomOverlay.clone;wt+=D.getWorkspaceHeight()-L.getHeight()-ke}let ut=r.offsetLeft;this.hot.isRtl()?(ut>=0?ut=w.getWidth()-r.offsetLeft:ut=Math.abs(ut),ut+=te-Re-a):["top","master","bottom"].includes(y)&&(ut+=te-Re);let ze=s.getComputedStyle(this.TD),rt=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",$e=parseInt(ze[rt],10)>0?0:1,Ye=parseInt(ze.borderTopWidth,10)>0?0:1,V=gr(r)+$e,G=vr(r)+Ye,z=V2(f)?ke:0,m=W2(d)?ke:0,S=this.hot.view.maximumVisibleElementWidth(ut)-z+$e,_=Math.max(this.hot.view.maximumVisibleElementHeight(wt)-m+Ye,this.hot.stylesHandler.getDefaultRowHeight());return{top:F,start:Q,height:G,maxHeight:_,width:V,maxWidth:S}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let e=this.hot.countRows(),r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}};ft(zo,fk);var dk={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){let n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===Qt.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}};var mk={name:"editorCloseAndSaveByEnter",callback(t,e){let r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}};var pk={name:"editorCloseWithoutSaving",callback(t){let e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}};var gk={name:"editorFastOpen",callback(t,e){let{highlight:r}=t.getSelectedRangeActive();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}};var t_e=T(tt(),1),r_e=T(Bo(),1);var vk={name:"editorOpen",callback(t,e,r){let{selection:n}=t,i=t._getEditorManager(),s=t.getSelectedRange(),o=t.getSelectedRangeActive(),{highlight:a}=o;if((s.some(l=>n.isMultiple(l))||s.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){let l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;r.includes("shift")?n.transformFocus(-u.row,-u.col):n.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),ko(e))}};function wk(){return[ck,dk,mk,pk,gk,vk]}var xk={name:"extendCellsSelectionDown",callback(t){let{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}};var Sk={name:"extendCellsSelectionDownByViewportHeight",callback(t){let{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),s=r.getNearestNotHiddenIndex(i,-1);if(s!==null){let o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(o.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(o,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};var Ck={name:"extendCellsSelectionLeft",callback(t){let{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}};var yk={name:"extendCellsSelectionRight",callback(t){let{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}};var _k={name:"extendCellsSelectionToColumns",callback(t){let{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}};var Ek={name:"extendCellsSelectionToMostBottom",callback(t){let{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){let a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}};var Tk={name:"extendCellsSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){let o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}};var bk={name:"extendCellsSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){let o=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}};var Rk={name:"extendCellsSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){let a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}};var Ok={name:"extendCellsSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){let a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}};var Ak={name:"extendCellsSelectionToMostTop",callback(t){let{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeActive(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){let a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}};var Ik={name:"extendCellsSelectionToRows",callback(t){let{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}};var kk={name:"extendCellsSelectionUp",callback(t){let{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}};var Mk={name:"extendCellsSelectionUpByViewportHeight",callback(t){let{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.max(n.row-t.countVisibleRows(),0),s=r.getNearestNotHiddenIndex(i,1);if(s!==null){let o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(o.row-a,0);e.markSource("keyboard"),e.setRangeEnd(o,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Fk(){return[xk,Sk,Ck,yk,_k,Ek,Tk,bk,Rk,Ok,Ak,Ik,kk,Mk]}var Dk={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}};var Pk={name:"moveCellSelectionDownByViewportHeight",callback(t){let{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight,s=t.countVisibleRows()+n;s=s===0?1:s,i===t.countRows()-1?s=1:i+s>t.countRows()&&(s=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};var j_e=T(tt(),1),G_e=T(Bo(),1),Nk={name:"moveCellSelectionInlineEnd",callback(t,e){let{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),s=t.getSelectedRangeActive(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-o.row,-o.col):r.transformStart(-o.row,-o.col),r.markEndSource()}};var Y_e=T(tt(),1),q_e=T(Bo(),1),Hk={name:"moveCellSelectionInlineStart",callback(t,e){let{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),s=t.getSelectedRangeActive(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(o.row,o.col):r.transformStart(o.row,o.col),r.markEndSource()}};var Lk={name:"moveCellSelectionLeft",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}};var Bk={name:"moveCellSelectionRight",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}};var Vk={name:"moveCellSelectionToMostBottom",callback(t){let{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight,n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}};var Wk={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){let{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),o=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,o)),e.markEndSource()}};var Uk={name:"moveCellSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}};var jk={name:"moveCellSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,s=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,s)),e.markEndSource()}};var Gk={name:"moveCellSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeActive().highlight.row,i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}};var zk={name:"moveCellSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeActive().highlight,i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}};var Yk={name:"moveCellSelectionToMostTop",callback(t){let{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight,n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}};var qk={name:"moveCellSelectionToMostTopInlineStart",callback(t){let{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}};var $k={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}};var Xk={name:"moveCellSelectionUpByViewportHight",callback(t){let{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight,s=t.countVisibleRows()+n;s=s===0?-1:-s,i===-n?s=-1:i+s<n&&(s=-(i+n)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function Kk(){return[Dk,Pk,Nk,Hk,Lk,Bk,Vk,Wk,Uk,jk,Gk,zk,Yk,qk,$k,Xk]}var Zk={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}};var Jk={name:"scrollToFocusedCell",callback(t){let{highlight:e}=t.getSelectedRangeActive(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,n),a=t._createCellCoords(i,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){let u={};if(e.col>=0){let f=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-f,0)}if(e.row>=0){let f=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-f,0)}t.scrollViewportTo(At(De({},u),{verticalSnap:"top",horizontalSnap:"start"}))}}};var Qk={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}};var eM={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}};var tM={name:"populateSelectedCellsData",callback(t){let e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){let{readOnly:u}=t.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(s.values()))}};var rM={name:"tabNavigation",callback(t){let e={wrapped:!1,flipped:!1},r=!1,n=!1;return t.addHook("afterSelection",(i,s,o,a,l)=>{r&&(e.wrapped&&e.flipped||n)&&(n=!1,l.value=!0)}),t.addHook("beforeRowWrap",(i,s,o)=>{e.wrapped=!0,e.flipped=o}),{before(){let{tabNavigation:i}=t.getSettings();r=!0,i||(n=!0)},after(i){let{tabNavigation:s,autoWrapRow:o}=t.getSettings();if(r=!1,!s||!t.selection.isSelected()||o&&e.wrapped&&e.flipped||!o&&e.wrapped)return e.wrapped=!1,e.flipped=!1,t.deselectCell(),!1;i.preventDefault()}}}};var Sq=[...wk(),...Fk(),...Kk(),Zk,Jk,Qk,eM,tM,rM];function A0(t){let e={};return Sq.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(t,...o)}}),e}function nM(t){let e=t.getShortcutManager().addContext(lk),r=A0(t),n={group:O0};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext(Xl),callback:(i,s)=>r.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>r.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function iM(t){let e=t.getShortcutManager().addContext(Xl),r=A0(t),n={runOnlyIf:()=>{let{navigableHeaders:s}=t.getSettings();return Be(t.getSelected())&&(s||!s&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Pa};e.addShortcuts([{keys:[["F2"]],callback:s=>r.editorFastOpen(s)},{keys:[["Enter"],["Enter","Shift"]],callback:(s,o)=>r.editorOpen(s,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:O0,runOnlyIf:()=>Be(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var s;return!((s=t.getSelectedRangeActive())!==null&&s!==void 0&&s.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var s;return(s=t.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var s,o;return!((s=t.getSelectedRangeActive())!==null&&s!==void 0&&s.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:s=>r.moveCellSelectionInlineStart(s)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:s=>r.moveCellSelectionInlineEnd(s)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n);let i=r.tabNavigation();e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Pa,group:Kl,position:"before",callback:s=>i.before(s)},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Pa,group:Kl,callback:s=>i.after(s),position:"after"}])}function sM(t){[iM,nM].forEach(e=>e(t))}function oM(t){var e;let r=ak(t),n={wrapped:!1,flipped:!1},i,s=!0,o=!1;t.addHook("afterSelection",()=>{if(s){var u;i=(u=t.getSelectedRangeActive())===null||u===void 0?void 0:u.highlight}}),t.addHook("beforeRowWrap",(u,f,d)=>{n.wrapped=!0,n.flipped=d}),t.addHook("beforeEmptyDataStateShow",()=>{o=!0}),t.addHook("beforeEmptyDataStateHide",()=>{o=!1}),t.getShortcutManager().getContext(Xl).addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Pa,group:Kl,position:"before",callback(){let{tabNavigation:u}=t.getSettings();t.getSelectedRangeActive()&&!u&&(s=!1)}},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Pa,group:Kl,callback(u){let{tabNavigation:f,autoWrapRow:d}=t.getSettings();s=!0,(!f||!t.selection.isSelected()||d&&n.wrapped&&n.flipped||!d&&n.wrapped)&&(d&&n.wrapped&&n.flipped&&(i=u.shiftKey?b0(t):R0(t)),n.wrapped=!1,n.flipped=!1)},position:"after"}]);let l=(e=t.rootGridElement)!==null&&e!==void 0?e:t.rootElement;t.getFocusScopeManager().registerScope("grid",l,{contains:u=>l===u||l.contains(u)?!0:u.closest(".htMenu")!==null?!1:t.rootPortalElement.contains(u),runOnlyIf:()=>{let{navigableHeaders:u}=t.getSettings();return(o||!u)&&t.countRenderedRows()===0&&t.countRenderedCols()===0&&t.countRowHeaders()>0&&t.countColHeaders()>0?!1:!u&&t.countRenderedRows()>0&&t.countRenderedCols()>0||u&&(t.countRowHeaders()>0||t.countColHeaders()>0)},onActivate:u=>{if(u==="tab_from_above"){var f;let p=(f=r(i))!==null&&f!==void 0?f:b0(t);p&&t.runHooks("modifyFocusOnTabNavigation","from_above",p)!==!1&&t.selectCell(p.row,p.col)}else if(u==="tab_from_below"){var d;let p=(d=r(i))!==null&&d!==void 0?d:R0(t);p&&t.runHooks("modifyFocusOnTabNavigation","from_below",p)!==!1&&t.selectCell(p.row,p.col)}}})}function aM(t){[oM].forEach(e=>e(t))}var HTe=T(xe(),1);var uTe=T(xe(),1),fTe=T(Qe(),1),hTe=T(tt(),1),dTe=T(Xn(),1),mTe=T(sr(),1);var aTe=T(tt(),1),lTe=T(Cn(),1),lM=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),$u=t=>t.map(e=>{let r=e.toLowerCase();return lM.has(r)?lM.get(r):r}).sort().join("+"),uM=t=>t.split("+"),cM=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),I0=t=>{let{which:e,key:r}=t;if(cM.has(e))return cM.get(e);let n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()};var fM=Symbol("shortcut-context");function k0(t){return tn(t)&&t.__kindOf===fM}var hM=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table",r=hs({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:u,callback:f,group:d,runOnlyIf:p=()=>!0,captureCtrl:g=!1,preventDefault:x=!0,stopPropagation:w=!1,relativeToGroup:y,position:P,forwardToContext:N}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(pr(d))throw new Error("You need to define the shortcut's group.");if(et(f)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(mr`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let B={callback:f,group:d,runOnlyIf:p,captureCtrl:g,preventDefault:x,stopPropagation:w};Be(y)&&(B.relativeToGroup=y,B.position=P),k0(N)&&(B.forwardToContext=N),u.forEach(F=>{let Q=$u(F);if(r.hasItem(Q)){let U=r.getItem(Q),X=U.findIndex(K=>K.group===y);X!==-1?P==="before"?X-=1:X+=1:X=U.length,U.splice(X,0,B)}else r.addItem(Q,[B])})},i=function(u){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(d=>{ht(f,(p,g)=>{Object.prototype.hasOwnProperty.call(d,g)===!1&&(d[g]=f[g])}),n(d)})},s=u=>{let f=$u(u);r.removeItem(f)};return{__kindOf:fM,scope:e,addShortcut:n,addShortcuts:i,getShortcuts:u=>{let f=$u(u),d=r.getItem(f);return Be(d)?d.slice():[]},hasShortcut:u=>{let f=$u(u);return r.hasItem(f)},removeShortcutsByKeys:s,removeShortcutsByGroup:u=>{r.getItems().forEach(d=>{let[p,g]=d,x=g.filter(w=>w.group!==u);x.length===0?s(uM(p)):(g.length=0,g.push(...x))})}}};var ITe=T(Qe(),1);var yTe=T($r(),1),_Te=T(Xr(),1),ETe=T(Kr(),1),TTe=T(Zr(),1),bTe=T(Jr(),1),RTe=T(Qr(),1),OTe=T(en(),1);function dM(){let t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}var Cq=["meta","alt","shift","control"],Xu=dM(),Ku=[],M0=0;function mM(t,e,r,n,i){let s=g=>Cq.includes(g),o=function(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,w=[];return g.altKey&&w.push("alt"),x&&(g.ctrlKey||g.metaKey)?w.push("control/meta"):(g.ctrlKey&&w.push("control"),g.metaKey&&w.push("meta")),g.shiftKey&&w.push("shift"),w},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||fs(g))return;let w=I0(g),y=[];s(w)||(y=o(g));let P=[w].concat(y);!i(g,P)&&(Uh()&&y.includes("meta")||!Uh()&&y.includes("control"))&&i(g,[w].concat(o(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){let x=I0(g);s(x)&&Xu.press(x)}},u=g=>{if(typeof g.key=="string"){let x=I0(g);s(x)&&Xu.release(x)}},f=()=>{Xu.releaseAll()};return{mount:()=>{let g=t;for(M0+=1;g;)M0===1&&(g.document.documentElement.addEventListener("keydown",l),Ku.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),Ku.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",f),g=Bs(g)},unmount:()=>{let g=t;for(M0-=1;g;){if(M0===0){for(let x=0;x<Ku.length;x++){let{event:w,listener:y}=Ku[x];g.document.documentElement.removeEventListener(w,y)}Ku.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",f),g=Bs(g)}},isPressed:g=>Xu.isPressed(g),releasePressedKeys:()=>Xu.releaseAll()}}var u1=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t,s=hs({errorIdExists:y=>`The "${y}" context name is already registered.`}),o="grid",a=function(y){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table",N=hM(y,P);return s.addItem(y,N),N},l=()=>o,u=y=>s.getItem(y),f=function(y){var P;let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";return(P=u(y))!==null&&P!==void 0?P:a(y,N)},d=y=>{if(!s.hasItem(y))throw new Error(mr`You've tried to activate the "${y}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=y},p=!1,g=function(y,P){let N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l(),B=k0(N)?N:u(N),F=!1;if(!B.hasShortcut(P))return F;let Q=B.getShortcuts(P);for(let he=0;he<Q.length;he++){let{callback:U,runOnlyIf:X,preventDefault:K,stopPropagation:ne,captureCtrl:ie,forwardToContext:te}=Q[he];if(X(y)===!0){if(p=ie,F=U(y,P)===!1,p=!1,K&&y.preventDefault(),ne&&(ko(y),y.stopPropagation()),F)break;te&&g(y,P,te)}}return F},w=mM(e,y=>{let P=l(),N=k0(P)?P:u(P);return r(y,N.scope)},n,i,g);return w.mount(),{addContext:a,getActiveContextName:l,getContext:u,getOrCreateContext:f,setActiveContextName:d,isCtrlPressed:()=>!p&&(w.isPressed("control")||w.isPressed("meta")),releasePressedKeys:()=>w.releasePressedKeys(),destroy:()=>w.unmount()}};function f1(t){let{classNames:e}=k2(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}var $Te=T(xe(),1),XTe=T(tt(),1),KTe=T(sr(),1);function yq(t,e){gM(t,e),e.add(t)}function Ks(t,e,r){gM(t,e),e.set(t,r)}function gM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function er(t,e){return t.get(Ki(t,e))}function jn(t,e,r){return t.set(Ki(t,e),r),r}function Ki(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pM=23,h1=new WeakMap,Cs=new WeakMap,F0=new WeakMap,p1=new WeakMap,m1=new WeakMap,Yo=new WeakMap,Ju=new WeakMap,Qu=new WeakMap,Zu=new WeakMap,ys=new WeakSet,D0=class{constructor(e){let{hot:r,rootElement:n,rootDocument:i,onThemeChange:s=()=>{}}=e;yq(this,ys),Ks(this,h1,void 0),Ks(this,Cs,void 0),Ks(this,F0,void 0),Ks(this,p1,void 0),Ks(this,m1,void 0),Ks(this,Yo,!0),Ks(this,Ju,{}),Ks(this,Qu,{}),Ks(this,Zu,void 0),jn(h1,this,r),jn(F0,this,n),jn(m1,this,i),jn(Zu,this,s)}isClassicTheme(){return er(Yo,this)}getCSSVariableValue(e){var r;if(er(Yo,this))return null;if(er(Ju,this)[`--ht-${e}`])return er(Ju,this)[`--ht-${e}`];let n=(r=Ki(ys,this,Tq).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Ki(ys,this,vM).call(this,`--ht-${e}`);if(n!==null)return er(Ju,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=er(Qu,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(e){if(er(Yo,this))return pM;let r=Ki(ys,this,_q).call(this);return r?e!==void 0&&e===er(h1,this).view.getFirstRenderedVisibleRow()?r+1:r:pM}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){jn(Cs,this,void 0),jn(Yo,this,!0),er(Zu,this).call(this,er(Cs,this)),Ki(ys,this,d1).call(this);return}if(e&&e!==er(Cs,this)){if(!/ht-theme-.*/.test(e)){Br(`Invalid theme name: ${e}. Please provide a valid theme name.`),jn(Cs,this,void 0),jn(Yo,this,!1),er(Zu,this).call(this,er(Cs,this)),Ki(ys,this,d1).call(this);return}er(Cs,this)&&Ki(ys,this,bq).call(this),jn(Cs,this,e),jn(Yo,this,!1),er(Zu,this).call(this,er(Cs,this)),Ki(ys,this,d1).call(this)}}getThemeName(){return er(Cs,this)}};function _q(){let t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function d1(){this.isClassicTheme()||jn(p1,this,getComputedStyle(er(F0,this)));let t=Ki(ys,this,Eq).call(this,["box-sizing","border-bottom-width"]);er(Qu,this).td=At(De({},er(Qu,this).td),{"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]})}function Eq(t){let e=er(m1,this),r=er(F0,this),n=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),i.appendChild(s),i.appendChild(o),n.appendChild(i),r.appendChild(n);let l=getComputedStyle(a),u={};return t.forEach(f=>{u[f]=l.getPropertyValue(f)}),r.removeChild(n),u}function Tq(t){let e=Math.ceil(parseFloat(Ki(ys,this,vM).call(this,t)));return Number.isNaN(e)?null:e}function vM(t){let e=er(p1,this).getPropertyValue(t);return e===""?null:e}function bq(){jn(Qu,this,{}),jn(Ju,this,{}),jn(Yo,this,!0)}var Zs=null,P0=0;function wM(t){let e=t.ownerDocument;if(!Zs){Zs=e.createElement("div"),Zs.setAttribute("role","status"),Zs.setAttribute("aria-live","assertive"),Zs.setAttribute("aria-atomic","true");let r=Zs.style;r.position="absolute",r.width="1px",r.height="1px",r.margin="-1px",r.overflow="hidden",r.clipPath="rect(0 0 0 0)",r.whiteSpace="nowrap",t.appendChild(Zs)}P0+=1}function xM(){P0!==0&&(P0===1&&(Zs.remove(),Zs=null),P0-=1)}var g1=null,N0=new WeakSet,v1=new Map;function H0(t,e){var r,n,i=this;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this,a=new Bi(o),l,u,f,d,p,g,x=!0,w=De(De({},e.initialState),e);BA(s)&&LA(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=Ci(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Ci(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Ne(this.rootElement,["ht-wrapper","handsontable"]),Ne(this.rootWrapperElement,"ht-root-wrapper"),Ne(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),Ne(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let y=(r=w?.layoutDirection)!==null&&r!==void 0?r:"inherit",P=["rtl","ltr"].includes(y)?y:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",P),(n=this.rootWrapperElement)===null||n===void 0||n.setAttribute("dir",P),this.isRtl=function(){return P==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new D0({hot:o,rootElement:o.rootElement,rootDocument:o.rootDocument,onThemeChange:m=>{Ci(this)&&(ot(this.rootWrapperElement,/ht-theme-.*/g),ot(this.rootPortalElement,/ht-theme-.*/g),m&&(Ne(this.rootWrapperElement,m),Ne(this.rootPortalElement,m),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Br(`The "${m}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),w.language=cI(w.language);let N=Object.fromEntries(Object.entries(w).filter(m=>{let[S]=m;return!($t.getSingleton().isRegistered(S)||$t.getSingleton().isDeprecated(S))})),B=new zl(o,N,[Gu,zu]),F=B.getTableMeta(),Q=B.getGlobalMeta(),he=hs();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${Th()}`,v1.set(this.guid,this),this.columnIndexMapper=new Oa,this.rowIndexMapper=new Oa,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),u=new qA(o);let U=Hn(this.guid);U.register("cellRangeMapper",new S0({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);let X=m=>{let{row:S,col:_}=m;return o._createCellCoords(S>=0?o.rowIndexMapper.getRenderableFromVisualIndex(S):S,_>=0?o.columnIndexMapper.getRenderableFromVisualIndex(_):_)},K=m=>{let{row:S,col:_}=m;return o._createCellCoords(S>=0?o.rowIndexMapper.getVisualFromRenderableIndex(S):S,_>=0?o.columnIndexMapper.getVisualFromRenderableIndex(_):_)},ne=(m,S)=>{let _=S>m?1:-1,D=Math.min(m,S),L=Math.max(m,S),H=o.rowIndexMapper.getNearestNotHiddenIndex(m,_);return H===null||_===1&&H>L||_===-1&&H<D?null:H>=0?o.rowIndexMapper.getRenderableFromVisualIndex(H):H},ie=(m,S)=>{let _=S>m?1:-1,D=Math.min(m,S),L=Math.max(m,S),H=o.columnIndexMapper.getNearestNotHiddenIndex(m,_);return H===null||_===1&&H>L||_===-1&&H<D?null:H>=0?o.columnIndexMapper.getRenderableFromVisualIndex(H):H},te=new n1(F,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>l.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,S)=>o._createCellCoords(m,S),createCellRange:(m,S,_)=>o._createCellRange(m,S,_),visualToRenderableCoords:X,renderableToVisualCoords:K,findFirstNonHiddenRenderableRow:ne,findFirstNonHiddenRenderableColumn:ie,isDisabledCellSelection:(m,S)=>m<0||S<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,S).disableVisualSelection});this.selection=te;let Re=m=>{let{hiddenIndexesChanged:S}=m;this.forceFullRender=!0,S&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",m=>{Re(m),this.runHooks("afterColumnSequenceCacheUpdate",m)}),this.rowIndexMapper.addLocalHook("cacheUpdated",m=>{Re(m),this.runHooks("afterRowSequenceCacheUpdate",m)}),this.selection.addLocalHook("afterSetRangeEnd",(m,S)=>{let _=Pr(!1),D=this.selection.getSelectedRange(),{from:L,to:H}=D.current(),oe=D.size()-1;this.runHooks("afterSelection",L.row,L.col,H.row,H.col,_,oe),this.runHooks("afterSelectionByProp",L.row,o.colToProp(L.col),H.row,o.colToProp(H.col),_,oe),S&&(!_.isTouched()||_.isTouched()&&!_.value)&&g.scrollTo(m);let fe=te.isSelectedByRowHeader(),Oe=te.isSelectedByColumnHeader();fe&&Oe?Ne(this.rootElement,["ht__selection--rows","ht__selection--columns"]):fe?(ot(this.rootElement,"ht__selection--columns"),Ne(this.rootElement,"ht__selection--rows")):Oe?(ot(this.rootElement,"ht__selection--rows"),Ne(this.rootElement,"ht__selection--columns")):ot(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(te.getSelectionSource())||d.closeEditor(null),te.getSelectionSource()!=="refresh"&&(o.view.render(),d.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{let S=Pr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,S),(!S.isTouched()||S.isTouched()&&!S.value)&&g.scrollTo(m),d.closeEditor(),o.view.render(),d.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{let S=m.length-1,{from:_,to:D}=m[S];this.runHooks("afterSelectionEnd",_.row,_.col,D.row,D.col,S),this.runHooks("afterSelectionEndByProp",_.row,o.colToProp(_.col),D.row,o.colToProp(D.col),S),te.getSelectionSource()==="refresh"&&(o.view.render(),d.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{let S=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=S)}),this.selection.addLocalHook("afterDeselect",()=>{d.closeEditor(),o.view.render(),ot(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("beforeSetRangeStart",...S)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("beforeSetRangeStartOnly",...S)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("beforeSetRangeEnd",...S)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("beforeSelectColumns",...S)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("afterSelectColumns",...S)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("beforeSelectRows",...S)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("afterSelectRows",...S)}).addLocalHook("beforeSelectAll",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("beforeSelectAll",...S)}).addLocalHook("afterSelectAll",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("afterSelectAll",...S)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("modifyTransformStart",...S)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("afterModifyTransformStart",...S)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("modifyTransformFocus",...S)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("afterModifyTransformFocus",...S)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("modifyTransformEnd",...S)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("afterModifyTransformEnd",...S)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("beforeRowWrap",...S)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,S=new Array(m),_=0;_<m;_++)S[_]=arguments[_];return i.runHooks("beforeColumnWrap",...S)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),f={alter(m,S){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0,H=oe=>{if(oe.length===0)return[];let fe=[...oe];return fe.sort((ve,ue)=>{let[Ie]=ve,[pe]=ue;return Ie===pe?0:Ie>pe?1:-1}),_o(fe,(ve,ue)=>{let[Ie,pe]=ue,He=ve[ve.length-1],[Xe,Tt]=He,Lt=Xe+Tt;if(Ie<=Lt){let ur=Math.max(pe-(Lt-Ie),0);He[1]+=ur}else ve.push([Ie,pe]);return ve},[fe[0]])};switch(m){case"insert_row_below":case"insert_row_above":let oe=o.countSourceRows();if(F.maxRows===oe)return;let fe=m==="insert_row_below"?"below":"above";S=S??(fe==="below"?oe:0);let{delta:Oe,startPhysicalIndex:ve}=l.createRow(S,_,{source:D,mode:fe});te.shiftRows(o.toVisualRow(ve),Oe);break;case"insert_col_start":case"insert_col_end":let ue=m==="insert_col_end"?"end":"start";S=S??(ue==="end"?o.countSourceCols():0);let{delta:Ie,startPhysicalIndex:pe}=l.createCol(S,_,{source:D,mode:ue});if(Ie){if(Array.isArray(F.colHeaders)){let Tt=[o.toVisualColumn(pe),0];Tt.length+=Ie,Array.prototype.splice.apply(F.colHeaders,Tt)}te.shiftColumns(o.toVisualColumn(pe),Ie)}break;case"remove_row":let He=Tt=>{let Lt=0;Ue(Tt,ur=>{let[xt,qe]=ur,zt=Ls(xt)?o.countRows()-1:Math.max(xt-Lt,0);if(Number.isInteger(xt)&&(xt=Math.max(xt-Lt,0)),!l.removeRow(xt,qe,D))return;if(te.isSelected()){let{row:Zt}=o.getSelectedRangeActive().highlight;Zt>=xt&&Zt<=xt+qe-1&&d.closeEditor(!0)}let Bt=o.countRows(),Ke=F.fixedRowsTop;Ke>=zt+1&&(F.fixedRowsTop-=Math.min(qe,Ke-zt));let xr=F.fixedRowsBottom;if(xr&&zt>=Bt-xr&&(F.fixedRowsBottom-=Math.min(qe,xr)),Bt===0)te.deselect();else if(D==="ContextMenu.removeRow"){let Zt=te.getSelectedRange(),fr=Zt.pop();Zt.clear().set(fr.from).current().setTo(fr.to),te.refresh()}else te.shiftRows(xt,-qe);Lt+=qe})};Array.isArray(S)?He(H(S)):He([[S,_]]);break;case"remove_col":let Xe=Tt=>{let Lt=0;Ue(Tt,ur=>{let[xt,qe]=ur,zt=Ls(xt)?o.countCols()-1:Math.max(xt-Lt,0),Kt=o.toPhysicalColumn(zt);if(Number.isInteger(xt)&&(xt=Math.max(xt-Lt,0)),!l.removeCol(xt,qe,D))return;if(te.isSelected()){let{col:Zt}=o.getSelectedRangeActive().highlight;Zt>=xt&&Zt<=xt+qe-1&&d.closeEditor(!0)}if(o.countCols()===0)te.deselect();else if(D==="ContextMenu.removeColumn"){let Zt=te.getSelectedRange(),fr=Zt.pop();Zt.clear().set(fr.from).current().setTo(fr.to),te.refresh()}else te.shiftColumns(xt,-qe);let xr=F.fixedColumnsStart;xr>=zt+1&&(F.fixedColumnsStart-=Math.min(qe,xr-zt)),Array.isArray(F.colHeaders)&&(typeof Kt>"u"&&(Kt=-1),F.colHeaders.splice(Kt,qe)),Lt+=qe})};Array.isArray(S)?Xe(H(S)):Xe([[S,_]]);break;default:throw new Error(`There is no such action "${m}"`)}L||f.adjustRowsAndCols(),o.view.adjustElementsSize(),o.view.render()},adjustRowsAndCols(){let m=F.minRows,S=F.minSpareRows,_=F.minCols,D=F.minSpareCols;if(m){let L=o.countRows();L<m&&l.createRow(L,m-L,{source:"auto"})}if(S){let L=o.countEmptyRows(!0);if(L<S){let H=S-L,oe=Math.min(H,F.maxRows-o.countSourceRows());l.createRow(o.countRows(),oe,{source:"auto"})}}{let L;(_||D)&&(L=o.countEmptyCols(!0));let H=o.countCols();if(_&&!F.columns&&H<_){let oe=_-H;L+=oe,l.createCol(H,oe,{source:"auto"})}if(D&&!F.columns&&o.dataType==="array"&&L<D){H=o.countCols();let oe=D-L,fe=Math.min(oe,F.maxCols-H);l.createCol(H,fe,{source:"auto"})}}},populateFromArray(m,S,_,D,L){let H,oe,fe,Oe,ve=[],ue={},Ie=[],pe=m.row,He=m.col;if(oe=S.length,oe===0)return!1;let Xe=0,Tt=0;switch(tn(_)&&(Xe=_.col-He+1,Tt=_.row-pe+1),L){case"shift_down":let ur=Ch(S),xt=ur.length,qe=Math.max(xt,Xe),zt=o.getData().slice(pe),Kt=Ch(zt).slice(He,He+qe);for(fe=0;fe<qe;fe+=1)if(fe<xt){for(H=0,oe=ur[fe].length;H<Tt-oe;H+=1)ur[fe].push(ur[fe][H%oe]);fe<Kt.length?Ie.push(ur[fe].concat(Kt[fe])):Ie.push(ur[fe].concat(new Array(zt.length).fill(null)))}else Ie.push(ur[fe%xt].concat(Kt[fe]));o.populateFromArray(pe,He,Ch(Ie));break;case"shift_right":let Bt=S.length,Ke=Math.max(Bt,Tt),xr=o.getData().slice(pe).map(Cr=>Cr.slice(He));for(H=0;H<Ke;H+=1)if(H<Bt){for(fe=0,Oe=S[H].length;fe<Xe-Oe;fe+=1)S[H].push(S[H][fe%Oe]);if(H<xr.length)for(let Cr=0;Cr<xr[H].length;Cr+=1)S[H].push(xr[H][Cr]);else S[H].push(...new Array(xr[0].length).fill(null))}else S.push(S[H%oe].slice(0,Ke).concat(xr[H]));o.populateFromArray(pe,He,S);break;case"overwrite":default:ue.row=m.row,ue.col=m.col;let Zt=0,fr=0,xn=!0,Ir,Yr=function(qn){let qr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,yr=S[qn%S.length];return qr!==null?yr[qr%yr.length]:yr},Sr=S.length,An=_?_.row-m.row+1:0;for(_?oe=An:oe=Math.max(Sr,An),H=0;H<oe&&!(_&&ue.row>_.row&&An>Sr||!F.allowInsertRow&&ue.row>o.countRows()-1||ue.row>=F.maxRows);H++){let Cr=H-Zt,qn=Yr(Cr).length,qr=_?_.col-m.col+1:0;if(_?Oe=qr:Oe=Math.max(qn,qr),ue.col=m.col,Ir=o.getCellMeta(ue.row,ue.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&Ir.skipRowOnPaste){Zt+=1,ue.row+=1,oe+=1;continue}for(fr=0,fe=0;fe<Oe;fe++){var Lt;if(_&&ue.col>_.col&&qr>qn||!F.allowInsertColumn&&ue.col>o.countCols()-1||ue.col>=F.maxCols)break;if(Ir=o.getCellMeta(ue.row,ue.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&Ir.skipColumnOnPaste){fr+=1,ue.col+=1,Oe+=1;continue}if(Ir.readOnly&&D!=="UndoRedo.undo"){ue.col+=1;continue}let yr=fe-fr,In=!!Ir.valueSetter,kr=Yr(Cr,yr),Ce=(Lt=o.getSourceDataAtCell(ue.row,ue.col))!==null&&Lt!==void 0?Lt:null;if(kr!==null&&typeof kr=="object"){if(Array.isArray(kr)&&Ce===null&&(Ce=[]),!In&&(typeof Ce!="object"||Ce===null))xn=!1;else if(Ce!==null){let so=ma(Array.isArray(Ce)?Ce:Ce[0]||Ce),oo=ma(Array.isArray(kr)?kr:kr[0]||kr);In||Nh(so,oo)||Array.isArray(so)&&Array.isArray(oo)?kr=hi(kr):xn=!1}}else!In&&Ce!==null&&typeof Ce=="object"&&(xn=!1);xn&&ve.push([ue.row,ue.col,kr]),xn=!0,ue.col+=1}ue.row+=1}o.setDataAtCell(ve,null,null,D||"populateFromArray");break}}};function We(m){let S=Jd(m);r0(S)?(o.runHooks("beforeLanguageChange",S),Q.language=S,o.runHooks("afterLanguageChange",S)):Qd(m)}function ke(m,S){let _=m==="className"?o.rootElement:o.table;if(x)Ne(_,S);else{let D=[],L=[];Q[m]&&(D=Array.isArray(Q[m])?Q[m]:Dg(Q[m])),S&&(L=Array.isArray(S)?S:Dg(S));let H=Fg(D,L),oe=Fg(L,D);H.length&&ot(_,H),oe.length&&Ne(_,oe)}Q[m]=S}this.init=function(){u.setData(F.data),o.runHooks("beforeInit"),(Li()||Wh())&&Ne(o.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new UA(this),d=fO.getInstance(o,F,te),g=JI(o),p.init(),Ci(this)&&(wM(o.rootPortalElement),WR(w.licenseKey,this.rootWrapperElement)),o.runHooks("init"),this.render(),x&&o.rootElement.offsetParent===null&&U2(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.view.adjustElementsSize(),o.render()}),typeof x=="object"&&(o.runHooks("afterChange",x[0],x[1]),x=!1),o.runHooks("afterInit")};function wt(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function ut(m,S,_){if(!m.length){_();return}let D=o.getActiveEditor(),L=new wt,H=!0;L.onQueueEmpty=()=>{D&&H&&D.cancelChanges(),_()};for(let oe=m.length-1;oe>=0;oe--){let[fe,Oe,,ve]=m[oe],ue=l.propToCol(Oe),Ie;Number.isInteger(ue)?Ie=o.getCellMeta(fe,ue):Ie=De(De({},Object.getPrototypeOf(F)),F),o.getCellValidator(Ie)&&(L.addValidatorToQueue(),o.validateCell(ve,Ie,function(pe,He){return function(Xe){if(typeof Xe!="boolean")throw new Error("Validation error: result is not boolean");Xe===!1&&He.allowInvalid===!1&&(H=!1,m.splice(pe,1),He.valid=!0),L.removeValidatorFormQueue()}}(oe,Ie),S))}L.checkIfQueueIsEmpty()}function ze(m,S){for(let D=m.length-1;D>=0;D--){let L=!1;if(m[D]===null){m.splice(D,1);continue}if(!((m[D][2]===null||m[D][2]===void 0)&&(m[D][3]===null||m[D][3]===void 0))){if(F.allowInsertRow)for(;m[D][0]>o.countRows()-1;){let{delta:H}=l.createRow(void 0,void 0,{source:"auto"});if(H===0){L=!0;break}}if(o.dataType==="array"&&(!F.columns||F.columns.length===0)&&F.allowInsertColumn)for(;l.propToCol(m[D][1])>o.countCols()-1;){let{delta:H}=l.createCol(void 0,void 0,{source:"auto"});if(H===0){L=!0;break}}L||l.set(m[D][0],m[D][1],m[D][3])}}if(m.length>0){f.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,S),d.closeEditor(),o.view.adjustElementsSize(),o.render(),d.prepareEditor(),o.runHooks("afterChange",m,S||"edit");let D=o.getActiveEditor();D&&Be(D.refreshValue)&&D.refreshValue()}else o.render()}this._createCellCoords=function(m,S){return o.view._wt.createCellCoords(m,S)},this._createCellRange=function(m,S,_){return o.view._wt.createCellRange(m,S,_)},this.validateCell=function(m,S,_,D){let L=o.getCellValidator(S);function H(oe){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||S.hidden===!0){_(oe);return}let Oe=S.visualCol,ve=S.visualRow,ue=o.getCell(ve,Oe,!0);if(ue&&ue.nodeName!=="TH"){let Ie=o.rowIndexMapper.getRenderableFromVisualIndex(ve),pe=o.columnIndexMapper.getRenderableFromVisualIndex(Oe);o.view._wt.getSetting("cellRenderer",Ie,pe,ue)}_(oe)}VR(L)&&(L=function(oe){return function(fe,Oe){Oe(oe.test(fe))}}(L)),et(L)?(m=o.runHooks("beforeValidate",m,S.visualRow,S.prop,D),o._registerImmediate(()=>{L.call(S,m,oe=>{o&&(oe=o.runHooks("afterValidate",oe,m,S.visualRow,S.prop,D),S.valid=oe,H(oe),o.runHooks("postAfterValidate",oe,m,S.visualRow,S.prop,D))})})):o._registerImmediate(()=>{S.valid=!0,H(S.valid,!1)})};function rt(m,S,_){return Array.isArray(m)?m:[[m,S,_]]}function $e(m,S){let _=o.runHooks("beforeChange",m,S||"edit"),D=m.filter(H=>H!==null);if(_===!1||D.length===0){var L;return(L=o.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let H=D.length-1;H>=0;H--){let[oe,fe,,Oe]=D[H],ve=l.propToCol(fe),ue;Number.isInteger(ve)?ue=o.getCellMeta(oe,ve):ue=De(De({},Object.getPrototypeOf(F)),F),D[H][3]=d0(Oe,ue)}return D}this.setDataAtCell=function(m,S,_,D){let L=rt(m,S,_),H=[],oe=D,fe,Oe,ve;for(fe=0,Oe=L.length;fe<Oe;fe++){let[Ie,pe,He]=L[fe];if(typeof L[fe]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof pe!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");pe>=this.countCols()?ve=pe:ve=l.colToProp(pe),H.push([Ie,ve,u.getAtCell(this.toPhysicalRow(Ie),pe),He])}!oe&&typeof m=="object"&&(oe=S);let ue=$e(H,oe);o.runHooks("afterSetDataAtCell",ue,oe),ut(ue,oe,()=>{ze(ue,oe)})},this.setDataAtRowProp=function(m,S,_,D){let L=rt(m,S,_),H=[],oe=D,fe,Oe;for(fe=0,Oe=L.length;fe<Oe;fe++){let[ue,Ie,pe]=L[fe];H.push([ue,Ie,u.getAtCell(this.toPhysicalRow(ue),Ie),pe])}!oe&&typeof m=="object"&&(oe=S);let ve=$e(H,D);o.runHooks("afterSetDataAtRowProp",ve,oe),ut(ve,oe,()=>{ze(ve,oe)})},this.listen=function(){o&&!o.isListening()&&(v1.forEach(m=>{o!==m&&m.unlisten()}),g1=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(g1=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return g1===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.closeEditor(m),o.view.render(),S&&te.isSelected()&&d.prepareEditor()},this.populateFromArray=function(m,S,_,D,L,H,oe){if(!(typeof _=="object"&&typeof _[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");let fe=typeof D=="number"?o._createCellCoords(D,L):null;return f.populateFromArray(o._createCellCoords(m,S),_,fe,H,oe)},this.spliceCol=function(m,S,_){for(var D=arguments.length,L=new Array(D>3?D-3:0),H=3;H<D;H++)L[H-3]=arguments[H];return l.spliceCol(m,S,_,...L)},this.spliceRow=function(m,S,_){for(var D=arguments.length,L=new Array(D>3?D-3:0),H=3;H<D;H++)L[H-3]=arguments[H];return l.spliceRow(m,S,_,...L)},this.getSelected=function(){if(te.isSelected())return Di(te.getSelectedRange(),m=>{let{from:S,to:_}=m;return[S.row,S.col,_.row,_.col]})},this.getSelectedLast=function(){let m=this.getSelected(),S;return m&&m.length>0&&(S=m[m.length-1]),S},this.getSelectedActive=function(){let m=this.getSelectedRangeActive();if(!m)return;let{from:S,to:_}=m;return[S.row,S.col,_.row,_.col]},this.getSelectedRange=function(){if(te.isSelected())return Array.from(te.getSelectedRange())},this.getSelectedRangeLast=function(){let m=this.getSelectedRange(),S;return m&&m.length>0&&(S=m[m.length-1]),S},this.getSelectedRangeActive=function(){return te.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return te.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(m){if(!te.isSelected()||this.countRows()===0||this.countCols()===0)return;let S=[];Ue(te.getSelectedRange(),_=>{if(_.isSingleHeader())return;let D=_.getTopStartCorner(),L=_.getBottomEndCorner();sn(D.row,L.row,H=>{sn(D.col,L.col,oe=>{this.getCellMeta(H,oe).readOnly||S.push([H,oe,null])})})}),S.length>0&&this.setDataAtCell(S,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();let S=m();return this.resumeRender(),S},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(S,0),(!this.isExecutionSuspended()&&S===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();let _=m();return this.resumeExecution(S),_},this.batch=function(m){this.suspendRender(),this.suspendExecution();let S=m();return this.resumeExecution(),this.resumeRender(),S},this.refreshDimensions=function(){if(!o.view)return;let m=o.view,{width:S,height:_}=m.getLastSize(),{width:D,height:L}=o.rootElement.getBoundingClientRect(),H=D!==S||L!==_;o.runHooks("beforeRefreshDimensions",{width:S,height:_},{width:D,height:L},H)!==!1&&((H||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(D,L),m.adjustElementsSize(),o.render()),o.runHooks("afterRefreshDimensions",{width:S,height:_},{width:D,height:L},H))},this.updateData=function(m,S){x0(m,_=>{l=_},_=>{l=_,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),f.adjustRowsAndCols(),te.refresh()},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"updateData",source:S,metaManager:B,firstRun:x})},this.loadData=function(m,S){x0(m,_=>{l=_},()=>{B.clearCellsCache(),o.initIndexMappers(),f.adjustRowsAndCols(),te.refresh(),x&&(x=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:u,internalSource:"loadData",source:S,metaManager:B,firstRun:x})},this.getInitialColumnCount=function(){let m=F.columns,S=0;if(Array.isArray(m))S=m.length;else if(et(m))if(o.dataType==="array"){let _=this.countSourceCols();for(let D=0;D<_;D+=1)m(D)&&(S+=1)}else(o.dataType==="object"||o.dataType==="function")&&(S=l.colToPropCache.length);else if(Be(F.dataSchema)){let _=l.getSchema();S=Array.isArray(_)?_.length:gl(_)}else S=this.countSourceCols();return S},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,S,_,D){return pr(m)?l.getAll():l.getRange(o._createCellCoords(m,S),o._createCellCoords(_,D),l.DESTINATION_RENDERER)},this.getCopyableText=function(m,S,_,D){return l.getCopyableText(o._createCellCoords(m,S),o._createCellCoords(_,D))},this.getCopyableData=function(m,S){return l.getCopyable(m,l.colToProp(S))},this.getCopyableSourceData=function(m,S){return u.getCopyable(m,l.colToProp(S))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(m){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_=(x?o.loadData:o.updateData).bind(this),D=!1,L,H;if(Be(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Be(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Be(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');Be(m.rowHeights)&&Be(m.minRowHeights)&&Br("Both `rowHeights` and `minRowHeights` are defined in your configuration. As one is the alias of the other, only one of them can be used at a time. `rowHeights` will be used as the row height configuration.");for(L in m)if(!(L==="data"||L==="language"))if(L==="className")ke("className",m.className);else if(L==="tableClassName"&&o.table)ke("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if($t.getSingleton().isRegistered(L)||$t.getSingleton().isDeprecated(L)){let ue=m[L];et(ue)?($t.getSingleton().addAsFixed(L,ue,o),F[L]=ue):Array.isArray(ue)&&($t.getSingleton().add(L,ue,o),F[L]=ue)}else!S&&Hi(m,L)&&(Q[L]=m[L]);if(S)o.useTheme(F.themeName||f1(o.rootContainer));else{let ue=o.getCurrentThemeName();Hi(m,"themeName")&&ue!==m.themeName&&o.useTheme(m.themeName)}N0.has(o)&&o.stylesHandler.getThemeName()!==void 0&&N0.delete(o),Ci(o)&&!N0.has(o)&&o.stylesHandler.isClassicTheme()&&($2("The stylesheet you are using is deprecated and will be removed in version 17.0. Please update your theme configuration to ensure compatibility with future releases."),N0.add(o)),m.data===void 0&&F.data===void 0?_(null,"updateSettings"):m.data!==void 0?_(m.data,"updateSettings"):m.columns!==void 0&&(l.createMap(),o.initIndexMappers()),!x&&m.language&&We(m.language);let oe=o.countCols(),fe=F.columns;if(fe&&et(fe)&&(D=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&B.clearCache(),oe>0)for(L=0,H=0;L<oe;L++){if(fe){let ue=D?fe(L):fe[H];ue&&B.updateColumnMeta(H,ue)}H+=1}Be(m.cell)&&ht(m.cell,ue=>{o.setCellMetaObject(ue.row,ue.col,ue)}),o.runHooks("afterCellMetaReset");let Oe=o.rootElement.style.height;Oe!==""&&(Oe=parseInt(o.rootElement.style.height,10)),S&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"));let ve=m.height;if(typeof m.height<"u")if(et(ve)&&(ve=ve()),ve=o.runHooks("beforeHeightChange",ve),ve===null){let ue=o.rootElement.getAttribute("data-initialstyle");ue&&(ue.indexOf("height")>-1||ue.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",ue):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else ve!==void 0&&(o.rootElement.style.height=isNaN(ve)?`${ve}`:`${ve}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let ue=m.width;et(ue)&&(ue=ue()),ue=o.runHooks("beforeWidthChange",ue),o.rootElement.style.width=isNaN(ue)?`${ue}`:`${ue}px`}S||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",m)),f.adjustRowsAndCols(),o.view&&!x&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!S&&o.view&&(Oe===""||ve===""||ve===void 0)&&Oe!==ve&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let m=o.getSelectedRangeActive();if(F.getValue){if(et(F.getValue))return F.getValue.call(o);if(m)return o.getData()[m.highlight.row][F.getValue]}else if(m)return o.getDataAtCell(m.highlight.row,m.highlight.col);return null},this.getSettings=function(){return F},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,S,_,D,L){f.alter(m,S,_,D,L)},this.getCell=function(m,S){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=S,L=m;if(S>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(S)))return null;D=this.columnIndexMapper.getRenderableFromVisualIndex(S)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return L===null||D===null||L===void 0||D===void 0?null:o.view.getCellAtCoords(o._createCellCoords(L,D),_)},this.getCoords=function(m){let S=this.view._wt.wtTable.getCoords(m);if(S===null)return null;let{row:_,col:D}=S,L=_,H=D;return _>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(_)),D>=0&&(H=this.columnIndexMapper.getVisualFromRenderableIndex(D)),o._createCellCoords(L,H)},this.colToProp=function(m){return l.colToProp(m)},this.propToCol=function(m){return l.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,S){return l.get(m,l.colToProp(S))},this.getDataAtRowProp=function(m,S){return l.get(m,S)},this.getDataAtCol=function(m){let S=[],_=l.getRange(o._createCellCoords(0,m),o._createCellCoords(F.data.length-1,m),l.DESTINATION_RENDERER);for(let D=0;D<_.length;D+=1)for(let L=0;L<_[D].length;L+=1)S.push(_[D][L]);return S},this.getDataAtProp=function(m){let S=[],_=l.getRange(o._createCellCoords(0,l.propToCol(m)),o._createCellCoords(F.data.length-1,l.propToCol(m)),l.DESTINATION_RENDERER);for(let D=0;D<_.length;D+=1)for(let L=0;L<_[D].length;L+=1)S.push(_[D][L]);return S},this.getSourceData=function(m,S,_,D){let L;return m===void 0?L=u.getData():L=u.getByRange(o._createCellCoords(m,S),o._createCellCoords(_,D)),L},this.getSourceDataArray=function(m,S,_,D){let L;return m===void 0?L=u.getData(!0):L=u.getByRange(o._createCellCoords(m,S),o._createCellCoords(_,D),!0),L},this.getSourceDataAtCol=function(m){return u.getAtColumn(m)},this.setSourceDataAtCell=function(m,S,_,D){let L=rt(m,S,_),H=this.hasHook("afterSetSourceDataAtCell"),oe=[],fe=(ve,ue)=>{let Ie=this.toVisualRow(ve),pe=this.toVisualColumn(ue);return Number.isInteger(pe)?this.getCellMeta(Ie,pe):De(De({},Object.getPrototypeOf(F)),F)};H&&Ue(L,ve=>{let[ue,Ie,pe]=ve,He=d0(pe,fe(ue,Ie));oe.push([ue,Ie,u.getAtCell(ue,Ie),He])}),Ue(L,ve=>{let[ue,Ie,pe]=ve,He=d0(pe,fe(ue,Ie));u.setAtCell(ue,Ie,He)}),H&&this.runHooks("afterSetSourceDataAtCell",oe,D),this.render();let Oe=o.getActiveEditor();Oe&&Be(Oe.refreshValue)&&Oe.refreshValue()},this.getSourceDataAtRow=function(m){return u.getAtRow(m)},this.getSourceDataAtCell=function(m,S){return u.getAtCell(m,S)},this.getDataAtRow=function(m){return l.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,S,_,D){let L=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,S,_,D],[H,oe]=L,[,,fe,Oe]=L,ve=null,ue=null;fe===void 0&&(fe=H),Oe===void 0&&(Oe=oe);let Ie="mixed";return sn(Math.max(Math.min(H,fe),0),Math.max(H,fe),pe=>{let He=!0;return sn(Math.max(Math.min(oe,Oe),0),Math.max(oe,Oe),Xe=>(ue=this.getCellMeta(pe,Xe).type,ve?He=ve===ue:ve=ue,He)),Ie=He?ue:"mixed",He}),Ie},this.removeCellMeta=function(m,S,_){let[D,L]=[this.toPhysicalRow(m),this.toPhysicalColumn(S)],H=B.getCellMetaKeyValue(D,L,_);o.runHooks("beforeRemoveCellMeta",m,S,_,H)!==!1&&(B.removeCellMeta(D,L,_),o.runHooks("afterRemoveCellMeta",m,S,_,H)),H=null},this.spliceCellsMeta=function(m){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var _=arguments.length,D=new Array(_>2?_-2:0),L=2;L<_;L++)D[L-2]=arguments[L];if(D.length>0&&!Array.isArray(D[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");S>0&&B.removeRow(this.toPhysicalRow(m),S),D.length>0&&Ue(D.reverse(),H=>{B.createRow(this.toPhysicalRow(m)),Ue(H,(oe,fe)=>this.setCellMetaObject(m,fe,oe))}),o.render()},this.setCellMetaObject=function(m,S,_){typeof _=="object"&&ht(_,(D,L)=>{this.setCellMeta(m,S,L,D)})},this.setCellMeta=function(m,S,_,D){if(o.runHooks("beforeSetCellMeta",m,S,_,D)===!1)return;let H=m,oe=S;m<this.countRows()&&(H=this.toPhysicalRow(m)),S<this.countCols()&&(oe=this.toPhysicalColumn(S)),B.setCellMeta(H,oe,_,D),o.runHooks("afterSetCellMeta",m,S,_,D)},this.getCellsMeta=function(){return B.getCellsMeta()},this.getCellMeta=function(m,S){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},D=this.toPhysicalRow(m),L=this.toPhysicalColumn(S);return D===null&&(D=m),L===null&&(L=S),B.getCellMeta(D,L,De({visualRow:m,visualColumn:S},_))},this.getColumnMeta=function(m){return B.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return B.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||F.columns)},this.getCellRenderer=function(m,S){let _=typeof m=="number"?o.getCellMeta(m,S).renderer:m.renderer;return typeof _=="string"?Sv(_):pr(_)?Sv("text"):_},this.getCellEditor=function(m,S){let _=typeof m=="number"?o.getCellMeta(m,S).editor:m.editor;return typeof _=="string"?av(_):pr(_)?av("text"):_},this.getCellValidator=function(m,S){let _=typeof m=="number"?o.getCellMeta(m,S).validator:m.validator;return typeof _=="string"?PO(_):_},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,S){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(S,m)},this.validateColumns=function(m,S){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(S,void 0,m)},this._validateCells=function(m,S,_){let D=new wt;m&&(D.onQueueEmpty=m);let L=o.countRows()-1;for(;L>=0;){if(S!==void 0&&S.indexOf(L)===-1){L-=1;continue}let H=o.countCols()-1;for(;H>=0;){if(_!==void 0&&_.indexOf(H)===-1){H-=1;continue}D.addValidatorToQueue(),o.validateCell(o.getDataAtCell(L,H),o.getCellMeta(L,H),oe=>{if(typeof oe!="boolean")throw new Error("Validation error: result is not boolean");oe===!1&&(D.valid=!1),D.removeValidatorFormQueue()},"validateCells"),H-=1}L-=1}D.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let S=F.rowHeaders,_=m;return _!==void 0&&(_=o.runHooks("modifyRowHeader",_)),_===void 0?(S=[],sn(o.countRows()-1,D=>{S.push(o.getRowHeader(D))})):Array.isArray(S)&&S[_]!==void 0?S=S[_]:et(S)?S=S(_):S&&typeof S!="string"&&typeof S!="number"&&(S=_+1),S},this.hasRowHeaders=function(){return!!F.rowHeaders},this.hasColHeaders=function(){if(F.colHeaders!==void 0&&F.colHeaders!==null)return!!F.colHeaders;for(let m=0,S=o.countCols();m<S;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,_=o.runHooks("modifyColHeader",m);if(_===void 0){let fe=[],Oe=o.countCols();for(let ve=0;ve<Oe;ve++)fe.push(o.getColHeader(ve));return fe}let D=F.colHeaders,L=function(fe){let Oe=[],ve=o.countCols(),ue=0;for(;ue<ve;ue++)et(F.columns)&&F.columns(ue)&&Oe.push(ue);return Oe[fe]},H=o.toPhysicalColumn(_),oe=L(H);return F.colHeaders===!1?D=null:F.columns&&et(F.columns)&&F.columns(oe)&&F.columns(oe).title?D=F.columns(oe).title:F.columns&&F.columns[H]&&F.columns[H].title?D=F.columns[H].title:Array.isArray(F.colHeaders)&&F.colHeaders[H]!==void 0?D=F.colHeaders[H]:et(F.colHeaders)?D=F.colHeaders(H):F.colHeaders&&typeof F.colHeaders!="string"&&typeof F.colHeaders!="number"&&(D=YA(_)),D=o.runHooks("modifyColumnHeaderValue",D,m,S),D},this._getColWidthFromSettings=function(m){let S;if(m>=0&&(S=o.getCellMeta(0,m).width),(S===void 0||S===F.width)&&(S=F.colWidths),S!=null){switch(typeof S){case"object":S=S[m];break;case"function":S=S(m);break;default:break}typeof S=="string"&&(S=Number.parseInt(S,10))}return S},this.getColWidth=function(m,S){let _=o._getColWidthFromSettings(m);return _=o.runHooks("modifyColWidth",_,m,S),_===void 0&&(_=hu),_},this._getRowHeightFromSettings=function(m){var S;let _=o.stylesHandler.getDefaultRowHeight(m),D=(S=F.rowHeights)!==null&&S!==void 0?S:F.minRowHeights;if(D!=null){switch(typeof D){case"object":D=D[m];break;case"function":D=D(m);break;default:break}typeof D=="string"&&(D=Number.parseInt(D,10))}return D!=null&&D<_?_:D},this.getRowHeight=function(m,S){let _=o._getRowHeightFromSettings(m);return _=o.runHooks("modifyRowHeight",_,m,S),_},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){let m=F.maxCols,S=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,S)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return wv(o.countRows()-1,_=>{if(o.isEmptyRow(_))S+=1;else if(m===!0)return!1}),S},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return wv(o.countCols()-1,_=>{if(o.isEmptyCol(_))S+=1;else if(m===!0)return!1}),S},this.isEmptyRow=function(m){return F.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return F.isEmptyCol.call(o,m)},this.selectCell=function(m,S,_,D){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,H=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return pr(m)||pr(S)?!1:this.selectCells([[m,S,_,D]],L,H)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;S===!1&&g.suspend();let D=te.selectCells(m);return D&&_&&o.listen(),g.resume(),D},this.selectColumns=function(m){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,_=arguments.length>2?arguments[2]:void 0;return te.selectColumns(m,S,_)},this.selectRows=function(m){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,_=arguments.length>2?arguments[2]:void 0;return te.selectRows(m,S,_)},this.deselectCell=function(){te.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,_=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),te.selectAll(m,S,_)};let Ye=(m,S)=>m.getNearestNotHiddenIndex(S,1,!0);this.scrollViewportTo=function(m,S){if(typeof m=="number"){var _;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(_=arguments[4])!==null&&_!==void 0?_:!0}}let{row:D,col:L,considerHiddenIndexes:H}=m??{},oe=D,fe=L;if(et(S)&&this.addHookOnce("afterScroll",S),H===void 0||H){let Ie=Number.isInteger(D)&&D>=0,pe=Number.isInteger(L)&&L>=0,He=Ie?Ye(this.rowIndexMapper,D):void 0,Xe=pe?Ye(this.columnIndexMapper,L):void 0;if(He===null||Xe===null)return!1;oe=Ie?o.rowIndexMapper.getRenderableFromVisualIndex(He):D,fe=pe?o.columnIndexMapper.getRenderableFromVisualIndex(Xe):L}let Oe=Number.isInteger(oe),ve=Number.isInteger(fe),ue=!1;return Oe&&oe>=0&&ve&&fe>=0?ue=o.view.scrollViewport(o._createCellCoords(oe,fe),m.horizontalSnap,m.verticalSnap):Oe&&oe>=0&&(ve&&fe<0||!ve)?ue=o.view.scrollViewportVertically(oe,m.verticalSnap):ve&&fe>=0&&(Oe&&oe<0||!Oe)&&(ue=o.view.scrollViewportHorizontally(fe,m.horizontalSnap)),et(S)&&(ue?this.view.render():(this.removeHook("afterScroll",S),this._registerMicrotask(()=>S()))),ue},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;et(m)&&this.addHookOnce("afterScroll",m);let{highlight:S}=this.getSelectedRangeActive(),_=this.scrollViewportTo(S.toObject());return _?this.view.render():et(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),_},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),u&&u.destroy(),u=null,Ci(this)&&(xM(),this.getFocusScopeManager().destroy()),this.getShortcutManager().destroy(),U.clear(),B.clearCache(),v1.delete(this.guid),a.destroy(),d&&d.destroy(),o.rootContainer&&Ro(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),he.getItems().forEach(m=>{let[,S]=m;S.destroy()}),he.clear(),o.runHooks("afterDestroy")},!0),$t.getSingleton().destroy(o),ht(o,(m,S,_)=>{et(m)?_[S]=V(S):S!=="guid"&&(_[S]=null)}),o.isDestroyed=!0,l&&l.destroy(),l=null,f=null,te=null,d=null,o=null};function V(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return he.getItem(dl(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:he.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,S,_){$t.getSingleton().add(m,S,o,_)},this.hasHook=function(m){return $t.getSingleton().has(m,o)||$t.getSingleton().has(m)},this.addHookOnce=function(m,S,_){$t.getSingleton().once(m,S,o,_)},this.removeHook=function(m,S){$t.getSingleton().remove(m,S,o)},this.runHooks=function(m,S,_,D,L,H,oe){return $t.getSingleton().run(o,m,S,_,D,L,H,oe)},this.getTranslatedPhrase=function(m,S){return n0(F.language,m,S)},this.toHTML=()=>vv(this),this.toTableElement=()=>{let m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",vv(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{let S=!!x;this.stylesHandler.useTheme(m);let _=this.stylesHandler.getThemeName();S||(o.render(),o.scrollViewportTo(0,0),f1(this.rootContainer)&&(ot(this.rootContainer,/ht-theme-.*/g),_&&Ne(this.rootContainer,_))),this.runHooks("afterSetTheme",_,S)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(m){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=m;typeof _=="function"&&(_=setTimeout(_,S)),this.timeouts.push(_)},this._clearTimeouts=function(){Ue(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){Ue(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return d};let G=u1({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&G.releasePressedKeys()}),this.getShortcutManager=function(){return G},p=new qu(o);let z=Ci(this)?l1(o):null;this.getFocusManager=function(){return p},this.getFocusScopeManager=function(){if(!Ci(o))throw new Error("The FocusScopeManager is only available for the main Handsontable instance.");return z},MO().forEach(m=>{let S=FO(m);he.addItem(m,new S(this))}),sM(o),Ci(this)&&aM(o),G.setActiveContextName("grid"),$t.getSingleton().run(o,"construct")}var iRe=T(xe(),1);function SM(t,e,r){t.addEventListener(e,r,!1)}function CM(t,e,r){t.removeEventListener(e,r,!1)}function L0(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function yM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=De({minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:d=>d.value},e),n=t.body,i=t.createTextNode(""),s=t.createElement("span"),o;function a(){var d,p;i.textContent=r.textContent(o),s.style.position="absolute",s.style.fontSize=L0(o).fontSize,s.style.fontFamily=L0(o).fontFamily,s.style.whiteSpace="pre",n.appendChild(s);let g=parseInt(((d=L0(o))===null||d===void 0?void 0:d.paddingInlineStart)||0,10),x=parseInt(((p=L0(o))===null||p===void 0?void 0:p.paddingInlineEnd)||0,10),w=s.clientWidth+g+x+1;n.removeChild(s);let y=o.style;y.height=`${r.minHeight}px`,r.minWidth>w?y.width=`${r.minWidth}px`:w>r.maxWidth?y.width=`${r.maxWidth}px`:y.width=`${w}px`;let P=o.scrollHeight?o.scrollHeight-1:0;r.minHeight>P?y.height=`${r.minHeight}px`:r.maxHeight<P?(y.height=`${r.maxHeight}px`,y.overflowY="visible"):y.height=`${P}px`}function l(){t.defaultView.setTimeout(a,0)}function u(d){if(d&&d.minHeight)if(d.minHeight==="inherit")r.minHeight=o.clientHeight;else{let p=parseInt(d.minHeight,10);isNaN(p)||(r.minHeight=p)}if(d&&d.maxHeight)if(d.maxHeight==="inherit")r.maxHeight=o.clientHeight;else{let p=parseInt(d.maxHeight,10);isNaN(p)||(r.maxHeight=p)}if(d&&d.minWidth)if(d.minWidth==="inherit")r.minWidth=o.clientWidth;else{let p=parseInt(d.minWidth,10);isNaN(p)||(r.minWidth=p)}if(d&&d.maxWidth)if(d.maxWidth==="inherit")r.maxWidth=o.clientWidth;else{let p=parseInt(d.maxWidth,10);isNaN(p)||(r.maxWidth=p)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function f(d,p){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=d,u(p),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${r.minHeight}px`,o.style.minWidth=`${r.minWidth}px`,o.style.maxWidth=`${r.maxWidth}px`,o.style.overflowY="hidden"),g&&(SM(o,"input",a),SM(o,"keydown",l)),a()}return{init:f,resize:a,unObserve(){CM(o,"input",a),CM(o,"keydown",l)}}}function w1(t,e){let r=B2(e),n=e.value.split(`
`),i=r,s=0;for(let o=0;o<n.length;o++){let a=n[o];o!==0&&(s+=n[o-1].length+1);let l=s+a.length;if(t==="home"?i=s:t==="end"&&(i=l),r<=l)break}zh(e,i)}function Na(t,e,r){return(e=Rq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rq(t){var e=Oq(t,"string");return typeof e=="symbol"?e:e+""}function Oq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Aq="ht_editor_visible",B0="ht_editor_hidden",_M="textEditor",EM="text",ef=class extends zo{static get EDITOR_TYPE(){return EM}constructor(e){super(e),Na(this,"eventManager",new Bi(this)),Na(this,"autoResize",yM(this.hot.rootDocument)),Na(this,"TEXTAREA",void 0),Na(this,"textareaStyle",void 0),Na(this,"TEXTAREA_PARENT",void 0),Na(this,"textareaParentStyle",void 0),Na(this,"layerClass",void 0),this.eventManager=new Bi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),I2(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,s,o){let a=this.state;if(super.prepare(e,r,n,i,s,o),!o.readOnly){this.refreshDimensions(!0);let{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Qt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===Qt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),zh(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),dt(this.TEXTAREA,[["data-hot-input",""],ls(-1)]),Ne(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Ne(this.TEXTAREA_PARENT,"handsontableInputHolder"),pt(this.TEXTAREA_PARENT,this.layerClass)&&ot(this.TEXTAREA_PARENT,this.layerClass),Ne(this.TEXTAREA_PARENT,B0),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){O2()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ot(this.TEXTAREA_PARENT,this.layerClass),Ne(this.TEXTAREA_PARENT,B0)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";let e=this.TEXTAREA_PARENT.childNodes,r=!1;sn(e.length-1,n=>{let i=e[n];if(pt(i,"handsontableEditor"))return r=!0,!1}),pt(this.TEXTAREA_PARENT,B0)&&ot(this.TEXTAREA_PARENT,B0),r?(this.layerClass=Aq,Ne(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ne(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){let e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Qt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}let{top:r,start:n,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();let l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){Vh()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Qt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Qt.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>Be(this.hot.getSelected()),group:_M},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;w1(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;w1(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(_M)}};var vRe=T(Qe(),1);var x1="base",Iq="htTextEllipsis";function Ha(t,e,r,n,i,s,o){let a=o.ariaTags,l=[],u=[],f=[],d=[];o.className&&Ne(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&d.push(Hg())):a&&f.push(Hg()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&d.push(Lg())):(u.push(o.invalidCellClassName),a&&f.push(Lg()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),o.textEllipsis&&l.push(Iq),ot(e,u),Ne(e,l),us(e,f),dt(e,d)}Ha.RENDERER_TYPE=x1;var TM="text";function V0(t,e,r,n,i,s,o){Ha.apply(this,[t,e,r,n,i,s,o]);let a=s;!a&&o.placeholder&&(a=o.placeholder),a=Eh(a),o.trimWhitespace&&(a=a.trim()),Vs(e,a)}V0.RENDERER_TYPE=TM;var bM="text",S1={CELL_TYPE:bM,editor:ef,renderer:V0};MI(S1);Zi.editors={BaseEditor:zo};function Zi(t,e){let r=new H0(t,e||{},Hd);return r.init(),r}Zi.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new H0(t,e,Hd)};Zi.DefaultSettings=ju();Zi.hooks=$t.getSingleton();Zi.CellCoords=Mo;Zi.CellRange=Sa;Zi.packageName="handsontable";Zi.buildDate="20/11/2025 13:26:54";Zi.version="16.2.0";Zi.languages={dictionaryKeys:oI,getLanguageDictionary:zx,getLanguagesDictionaries:lI,registerLanguageDictionary:Gx,getTranslatedPhrase:n0};var Zl=Zi;var kq=["inputPlaceholder"];function Mq(t,e){}var Fq=["container"],Dq=(()=>{class t{top;left;height;width;set isVisible(r){this._isVisible=r}set componentRef(r){r&&this.container.insert(r.hostView)}container;get display(){return this._isVisible?"block":"none"}_isVisible=!1;detachEditor(){this.container.detach()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=Ds({type:t,selectors:[["ng-component"]],viewQuery:function(n,i){if(n&1&&Wm(kq,7,el),n&2){let s;Um(s=jm())&&(i.container=s.first)}},inputs:{top:"top",left:"left",height:"height",width:"width",isVisible:"isVisible",componentRef:"componentRef"},standalone:!1,decls:3,vars:14,consts:[["inputPlaceholder",""],[1,"handsontableInputHolder","ht_clone_master"]],template:function(n,i){n&1&&(ye(0,"div",1),tr(1,Mq,0,0,"ng-template",null,0,rC),Ee()),n&2&&yc("display",i.display)("width",i.width,"px")("height",i.height,"px")("max-width",i.width,"px")("max-height",i.height,"px")("top",i.top,"px")("left",i.left,"px")},encapsulation:2,changeDetection:0})}return t})(),C1=class extends Zl.editors.BaseEditor{_componentRef;_editorPlaceHolderRef;_isPlaceholderReady=!1;_finishEditSubscription;_cancelEditSubscription;constructor(e){super(e),this.hot.addHook("afterRowResize",this.onAfterRowResize.bind(this)),this.hot.addHook("afterColumnResize",this.onAfterColumnResize.bind(this)),this.hot.addHook("afterDestroy",this.onAfterDestroy.bind(this))}prepare(e,r,n,i,s,o){if(!this.isOpened()){super.prepare(e,r,n,i,s,o);let a=this.hot.getColumnMeta(r);this._isPlaceholderReady||(this.createEditorPlaceholder(a._environmentInjector),this._isPlaceholderReady=!0),this._componentRef=a._editorComponentReference,this._finishEditSubscription&&(this._finishEditSubscription.unsubscribe(),this._finishEditSubscription=void 0),this._cancelEditSubscription&&(this._cancelEditSubscription.unsubscribe(),this._cancelEditSubscription=void 0),this._finishEditSubscription=this._componentRef.instance.finishEdit.pipe(Hm(1)).subscribe(()=>{this.finishEditing()}),this._cancelEditSubscription=this._componentRef.instance.cancelEdit.pipe(Hm(1)).subscribe(()=>{this.cancelChanges()})}}close(){this.isOpened()&&(this.resetEditorState(),this._editorPlaceHolderRef.changeDetectorRef.detectChanges(),this._editorPlaceHolderRef.instance.detachEditor(),this._componentRef.instance.onClose())}focus(){this._componentRef.instance.onFocus()}getValue(){return this._componentRef.instance?.getValue()}open(e){this.hot.getShortcutManager().setActiveContextName("editor"),this.applyPropsToEditor(),this._componentRef.instance.onOpen(e)}setValue(e){this._componentRef.instance?.setValue(e),this._componentRef.changeDetectorRef.detectChanges()}applyPropsToEditor(){let e=this.getEditedCellRect();this.isInFullEditMode()||this._componentRef.instance.setValue(null),this._componentRef.setInput("originalValue",this.originalValue),this._componentRef.setInput("row",this.row),this._componentRef.setInput("column",this.col),this._componentRef.setInput("prop",this.prop),this._componentRef.setInput("cellProperties",this.cellProperties),this._editorPlaceHolderRef.setInput("top",e.top),this._editorPlaceHolderRef.setInput("left",e.start),this._editorPlaceHolderRef.setInput("height",e.height),this._editorPlaceHolderRef.setInput("width",e.width),this._editorPlaceHolderRef.setInput("isVisible",!0),this._editorPlaceHolderRef.setInput("componentRef",this._componentRef),this._editorPlaceHolderRef.changeDetectorRef.detectChanges()}createEditorPlaceholder(e){this._editorPlaceHolderRef=Lf(Dq,{environmentInjector:e}),this.hot.rootElement.appendChild(this._editorPlaceHolderRef.location.nativeElement)}onAfterColumnResize(){this.isOpened()&&this.applyPropsToEditor()}onAfterRowResize(){this.isOpened()&&this.applyPropsToEditor()}onAfterDestroy(){this._editorPlaceHolderRef?.destroy()}resetEditorState(){this._editorPlaceHolderRef.setInput("top",void 0),this._editorPlaceHolderRef.setInput("left",void 0),this._editorPlaceHolderRef.setInput("height",void 0),this._editorPlaceHolderRef.setInput("width",void 0),this._editorPlaceHolderRef.setInput("isVisible",!1),this._editorPlaceHolderRef.setInput("componentRef",void 0)}},y1=class t{static RENDERER_MARKER=Symbol("HotCellRendererComponent");value="";instance;td;row;col;prop;cellProperties;getProps(){return this.cellProperties?.rendererProps??{}}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=Ds({type:t,selectors:[["hot-cell-renderer"]],inputs:{value:"value",instance:"instance",td:"td",row:"row",col:"col",prop:"prop",cellProperties:"cellProperties"},standalone:!1,decls:0,vars:0,template:function(r,n){},encapsulation:2})},Pq="The provided renderer component was not recognized as a valid custom renderer. It must either extend HotCellRendererComponent or be a valid TemplateRef. Please ensure that your custom renderer is implemented correctly and imported from the proper source.";function Nq(t){return t&&typeof t.createEmbeddedView=="function"}function RM(t){return t?.RENDERER_MARKER===y1.RENDERER_MARKER}var Hq=(()=>{class t{appRef;environmentInjector;constructor(r,n){this.appRef=r,this.environmentInjector=n}createRendererFromComponent(r,n={},i=!1){return(s,o,a,l,u,f,d)=>{let p={value:f,instance:s,td:o,row:a,col:l,prop:u,cellProperties:d};n&&Object.assign(d,{rendererProps:n});let g=[s,o,a,l,u,f,d];if(Ha.apply(this,g),o.innerHTML="",Nq(r))this.attachTemplateToElement(r,o,p);else if(RM(r)){let x=this.createComponent(r,p);this.attachComponentToElement(x,o)}else console.warn(Pq);return i&&RM(r)&&Zl.renderers.registerRenderer(r.constructor.name,r),o}}attachTemplateToElement(r,n,i){let s=r.createEmbeddedView(De({$implicit:i.value},i));s.detectChanges(),s.rootNodes.forEach(o=>{n.appendChild(o)})}createComponent(r,n){let i=Lf(r,{environmentInjector:this.environmentInjector});return Object.keys(n).forEach(s=>{n.hasOwnProperty(s)?i.setInput(s,n[s]):console.warn(`Input property "${s}" does not exist on component instance: ${r?.name}.`)}),i.changeDetectorRef.detectChanges(),this.appRef.attachView(i.hostView),i}attachComponentToElement(r,n){let i=r.hostView.rootNodes[0];n.appendChild(i)}destroyComponent(r){this.appRef.detachView(r.hostView),r.destroy()}static \u0275fac=function(n){return new(n||t)(mo(JS),mo(Bm))};static \u0275prov=ra({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Lq=Object.keys(Zl.DefaultSettings),OM=Zl.hooks.getRegistered(),AM=(()=>{class t{dynamicComponentService;environmentInjector;constructor(r,n){this.dynamicComponentService=r,this.environmentInjector=n}applyCustomSettings(r,n){let i=r;return this.updateColumnRendererForGivenCustomRenderer(i),this.updateColumnEditorForGivenCustomEditor(i),this.updateColumnValidatorForGivenCustomValidator(i),this.wrapHooksInNgZone(i,n),i??{}}wrapHooksInNgZone(r,n){OM.concat(Lq).forEach(s=>{let o=OM.indexOf(s)>-1,a;o&&(a=r[s]),a!==void 0&&(n&&typeof a=="function"&&o?r[s]=function(...l){return n.run(()=>a.apply(this,l))}:r[s]=a)})}updateColumnRendererForGivenCustomRenderer(r){Array.isArray(r?.columns)&&r?.columns?.filter(n=>this.isRendererComponentRefType(n.renderer)||this.isTemplateRef(n.renderer))?.forEach(n=>{let i=(this.isTemplateRef(n.renderer),n.renderer),s=n.rendererProps??{};n.renderer=this.dynamicComponentService.createRendererFromComponent(i,s)})}updateColumnEditorForGivenCustomEditor(r){Array.isArray(r?.columns)&&r?.columns?.filter(n=>this.isEditorComponentRefType(n.editor))?.forEach(n=>{let i=n.editor;n._editorComponentReference=Lf(i,{environmentInjector:this.environmentInjector}),n._environmentInjector=this.environmentInjector,n.editor=C1})}updateColumnValidatorForGivenCustomValidator(r){Array.isArray(r?.columns)&&r?.columns?.filter(n=>this.isCustomValidatorFn(n.validator))?.forEach(n=>{let i=n.validator;n.validator=(s,o)=>{o(i(s))}})}isCustomValidatorFn(r){return typeof r=="function"&&r.length===1}isEditorComponentRefType(r){return typeof r=="function"&&!!r?.\u0275cmp}isRendererComponentRefType(r){return typeof r=="function"&&!!r?.\u0275cmp}isTemplateRef(r){return r&&typeof r.createEmbeddedView=="function"}static \u0275fac=function(n){return new(n||t)(mo(Hq),mo(Bm))};static \u0275prov=ra({token:t,factory:t.\u0275fac})}return t})();var Bq=new XS("HOT_GLOBAL_CONFIG",{providedIn:"root",factory:()=>({})}),Vq=(()=>{class t{defaultConfig={license:void 0,themeName:""};configSubject=new $S(this.defaultConfig);get config$(){return this.configSubject.asObservable()}constructor(r){this.defaultConfig=De(De({},this.defaultConfig),r),this.configSubject.next(this.defaultConfig)}setConfig(r){this.configSubject.next(De(De({},this.defaultConfig),r))}getConfig(){return this.configSubject.value}resetConfig(){this.configSubject.next(De({},this.defaultConfig))}static \u0275fac=function(n){return new(n||t)(mo(Bq))};static \u0275prov=ra({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Wq="The Handsontable instance bound to this component was destroyed and cannot be used properly.",IM=(()=>{class t{_hotSettingsResolver;_hotConfig;ngZone;data=null;settings={};container;__hotInstance=null;configSubscription;constructor(r,n,i){this._hotSettingsResolver=r,this._hotConfig=n,this.ngZone=i}get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Wq),null)}set hotInstance(r){this.__hotInstance=r}ngAfterViewInit(){let r=this._hotSettingsResolver.applyCustomSettings(this.settings,this.ngZone),n=this.getNegotiatedSettings(r);r=At(De(De({},r),n),{data:this.data}),this.ngZone.runOutsideAngular(()=>{this.hotInstance=new Zl.Core(this.container.nativeElement,r),this.hotInstance.init()}),this.configSubscription=this._hotConfig.config$.subscribe(i=>{if(this.hotInstance){let s=this.getNegotiatedSettings(this.settings);this.updateHotTable(s)}})}ngOnChanges(r){if(this.hotInstance!==null){if(r.settings&&!r.settings.firstChange){let n=this._hotSettingsResolver.applyCustomSettings(r.settings.currentValue,this.ngZone);this.updateHotTable(n)}r.data&&!r.data.firstChange&&this.hotInstance?.updateData(r.data.currentValue)}}ngOnDestroy(){this.ngZone.runOutsideAngular(()=>{if(!this.hotInstance)return;let r=this.hotInstance.getSettings().columns;r&&Array.isArray(r)&&r.forEach(n=>{n._editorComponentReference&&n._editorComponentReference.destroy()}),this.hotInstance.destroy()}),this.configSubscription.unsubscribe()}updateHotTable(r){this.hotInstance&&this.ngZone.runOutsideAngular(()=>{this.hotInstance?.updateSettings(r,!1)})}getNegotiatedSettings(r){let n=this._hotConfig.getConfig(),i={};return i.licenseKey=r.licenseKey??n.license,i.themeName=r.themeName??n.themeName,i.language=r.language??n.language,this.__hotInstance||(i.layoutDirection=r.layoutDirection??n.layoutDirection),i}static \u0275fac=function(n){return new(n||t)(Fs(AM),Fs(Vq),Fs(na))};static \u0275cmp=Ds({type:t,selectors:[["hot-table"]],viewQuery:function(n,i){if(n&1&&Wm(Fq,5),n&2){let s;Um(s=jm())&&(i.container=s.first)}},inputs:{data:"data",settings:"settings"},standalone:!1,features:[Pf([AM]),Ff],decls:2,vars:0,consts:[["container",""]],template:function(n,i){n&1&&po(0,"div",null,0)},styles:[`:host{display:block}
`],encapsulation:2})}return t})(),kM=(()=>{class t{static version="16.2.0";constructor(){}static forRoot(){return{ngModule:t}}static \u0275fac=function(n){return new(n||t)};static \u0275mod=Vm({type:t});static \u0275inj=Lm({})}return t})();var uf={};uf.version="0.18.5";var Ba=1200,lc=1252,jq=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gq={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},wF=function(t){jq.indexOf(t)!=-1&&(lc=Gq[0]=t)};function zq(){wF(1252)}var ff=function(t){Ba=t,wF(t)};function Yq(){ff(1200),zq()}function qq(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var W0=function(e){return String.fromCharCode(e)},MM=function(e){return String.fromCharCode(e)},Ht;var Ts=null,tf=!0,$o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hf(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),o=(r&3)<<4|n>>4,i=t.charCodeAt(u++),a=(n&15)<<2|i>>6,l=i&63,isNaN(n)?a=l=64:isNaN(i)&&(l=64),e+=$o.charAt(s)+$o.charAt(o)+$o.charAt(a)+$o.charAt(l);return e}function ro(t){var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=$o.indexOf(t.charAt(u++)),o=$o.indexOf(t.charAt(u++)),r=s<<2|o>>4,e+=String.fromCharCode(r),a=$o.indexOf(t.charAt(u++)),n=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(n)),l=$o.indexOf(t.charAt(u++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Et=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),io=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Wa(t){return Et?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function FM(t){return Et?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var es=function(e){return Et?io(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function cm(t){if(typeof ArrayBuffer>"u")return es(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function vf(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function $q(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ln=Et?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:io(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Xq(t){for(var e=[],r=0,n=t.length+250,i=Wa(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Wa(65535),n=65530)}return e.push(i.slice(0,r)),ln(e)}var nc=/\u0000/g,U0=/[\u0001-\u0006]/g;function ic(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ts(t,e){var r=""+t;return r.length>=e?r:lr("0",e-r.length)+r}function P1(t,e){var r=""+t;return r.length>=e?r:lr(" ",e-r.length)+r}function K0(t,e){var r=""+t;return r.length>=e?r:r+lr(" ",e-r.length)}function Kq(t,e){var r=""+Math.round(t);return r.length>=e?r:lr("0",e-r.length)+r}function Zq(t,e){var r=""+t;return r.length>=e?r:lr("0",e-r.length)+r}var DM=Math.pow(2,32);function Jl(t,e){if(t>DM||t<-DM)return Kq(t,e);var r=Math.round(t);return Zq(r,e)}function Z0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var PM=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Jq(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var cr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},NM={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Qq={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function J0(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,o=1,a=0,l=1,u=0,f=0,d=Math.floor(i);u<e&&(d=Math.floor(i),a=d*o+s,f=d*u+l,!(i-d<5e-8));)i=1/(i-d),s=o,o=a,l=u,u=f;if(f>e&&(u>e?(f=l,a=s):(f=u,a=o)),!r)return[0,n*a,f];var p=Math.floor(n*a/f);return[p,n*a-p*f,f]}function j0(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,o=[],a={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=o$(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var xF=new Date(1899,11,31,0,0,0),e$=xF.getTime(),t$=new Date(1900,2,1,0,0,0);function SF(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=t$&&(r+=24*60*60*1e3),(r-(e$+(t.getTimezoneOffset()-xF.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function N1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function r$(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function n$(t){var e=t<0?12:11,r=N1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function i$(t){var e=N1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function s$(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=n$(t):e===10?r=t.toFixed(10).substr(0,12):r=i$(t),N1(r$(r.toUpperCase()))}function k1(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):s$(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ko(14,SF(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function o$(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function a$(t,e,r,n){var i="",s=0,o=0,a=r.y,l,u=0;switch(t){case 98:a=r.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,u=2;break;default:l=a%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return _1[r.m-1][1];case 5:return _1[r.m-1][0];default:return _1[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return PM[r.q][0];default:return PM[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ts(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=ts(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=a,u=1;break}var f=u>0?ts(l,u):"";return f}function Xo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var CF=/%/g;function l$(t,e,r){var n=e.replace(CF,""),i=e.length-n.length;return Qs(t,n,r*Math.pow(10,2*i))+lr("%",i)}function c$(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Qs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function yF(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+yF(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var _F=/# (\?+)( ?)\/( ?)(\d+)/;function u$(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(s===0?"":""+s)+" "+(o===0?lr(" ",t[1].length+1+t[4].length):P1(o,t[1].length)+t[2]+"/"+t[3]+ts(a,t[4].length))}function f$(t,e,r){return r+(e===0?"":""+e)+lr(" ",t[1].length+2+t[4].length)}var EF=/^#*0*\.([0#]+)/,TF=/\).*[0#]/,bF=/\(###\) ###\\?-####/;function bn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function HM(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function LM(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function h$(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function d$(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ei(t,e,r){if(t.charCodeAt(0)===40&&!e.match(TF)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ei("n",n,r):"("+Ei("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return c$(t,e,r);if(e.indexOf("%")!==-1)return l$(t,e,r);if(e.indexOf("E")!==-1)return yF(e,r);if(e.charCodeAt(0)===36)return"$"+Ei(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Jl(l,e.length);if(e.match(/^[#?]+$/))return i=Jl(r,0),i==="0"&&(i=""),i.length>e.length?i:bn(e.substr(0,e.length-i.length))+i;if(s=e.match(_F))return u$(s,l,u);if(e.match(/^#+0+$/))return u+Jl(l,e.length-e.indexOf("0"));if(s=e.match(EF))return i=HM(r,s[1].length).replace(/^([^\.]+)$/,"$1."+bn(s[1])).replace(/\.$/,"."+bn(s[1])).replace(/\.(\d*)$/,function(x,w){return"."+w+lr("0",bn(s[1]).length-w.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+HM(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Xo(Jl(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ei(t,e,-r):Xo(""+(Math.floor(r)+h$(r,s[1].length)))+"."+ts(LM(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Ei(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ic(Ei(t,e.replace(/[\\-]/g,""),r)),o=0,ic(ic(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<i.length?i.charAt(o++):x==="0"?"0":""}));if(e.match(bF))return i=Ei(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=J0(l,Math.pow(10,o)-1,!1),i=""+u,f=Qs("n",s[1],a[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=K0(a[2],o),f.length<s[4].length&&(f=bn(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=J0(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?P1(a[1],o)+s[2]+"/"+s[3]+K0(a[2],o):lr(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Jl(r,0),e.length<=i.length?i:bn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var d=e.indexOf(".")-o,p=e.length-i.length-d;return bn(e.substr(0,d)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=LM(r,s[1].length),r<0?"-"+Ei(t,e,-r):Xo(d$(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ts(0,3-x.length):"")+x})+"."+ts(o,s[1].length);switch(e){case"###,##0.00":return Ei(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Xo(Jl(l,0));return g!=="0"?u+g:"";case"###,###.00":return Ei(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ei(t,"#,##0.00",r).replace(/^0\./,".");default:}throw new Error("unsupported format |"+e+"|")}function m$(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Qs(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function p$(t,e,r){var n=e.replace(CF,""),i=e.length-n.length;return Qs(t,n,r*Math.pow(10,2*i))+lr("%",i)}function RF(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+RF(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,f){return l+u+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _s(t,e,r){if(t.charCodeAt(0)===40&&!e.match(TF)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_s("n",n,r):"("+_s("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return m$(t,e,r);if(e.indexOf("%")!==-1)return p$(t,e,r);if(e.indexOf("E")!==-1)return RF(e,r);if(e.charCodeAt(0)===36)return"$"+_s(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+ts(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:bn(e.substr(0,e.length-i.length))+i;if(s=e.match(_F))return f$(s,l,u);if(e.match(/^#+0+$/))return u+ts(l,e.length-e.indexOf("0"));if(s=e.match(EF))return i=(""+r).replace(/^([^\.]+)$/,"$1."+bn(s[1])).replace(/\.$/,"."+bn(s[1])),i=i.replace(/\.(\d*)$/,function(x,w){return"."+w+lr("0",bn(s[1]).length-w.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Xo(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_s(t,e,-r):Xo(""+r)+"."+lr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return _s(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ic(_s(t,e.replace(/[\\-]/g,""),r)),o=0,ic(ic(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<i.length?i.charAt(o++):x==="0"?"0":""}));if(e.match(bF))return i=_s(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=J0(l,Math.pow(10,o)-1,!1),i=""+u,f=Qs("n",s[1],a[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=K0(a[2],o),f.length<s[4].length&&(f=bn(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=J0(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?P1(a[1],o)+s[2]+"/"+s[3]+K0(a[2],o):lr(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:bn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var d=e.indexOf(".")-o,p=e.length-i.length-d;return bn(e.substr(0,d)+i+e.substr(e.length-p))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_s(t,e,-r):Xo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ts(0,3-x.length):"")+x})+"."+ts(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=Xo(""+l);return g!=="0"?u+g:"";default:if(e.match(/\.[0#?]*$/))return _s(t,e.slice(0,e.lastIndexOf(".")),r)+bn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Qs(t,e,r){return(r|0)===r?_s(t,e,r):Ei(t,e,r)}function g$(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var OF=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function AF(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Z0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(OF))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function v$(t,e,r,n){for(var i=[],s="",o=0,a="",l="t",u,f,d,p="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!Z0(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(d=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++o;break;case"\\":var g=t.charAt(++o),x=g==="("||g===")"?g:"t";i[i.length]={t:x,v:g},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(u==null&&(u=j0(e,r,t.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=j0(e,r),u==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=p),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"\u4E0A":var w={t:a,v:a};if(u==null&&(u=j0(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(w.v=u.H>=12?"P":"A"),w.t="T",p="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(w.v=u.H>=12?"PM":"AM"),w.t="T",o+=5,p="h"):t.substr(o,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(u!=null&&(w.v=u.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),w.t="T",o+=5,p="h"):(w.t="t",++o),u==null&&w.t==="T")return"";i[i.length]=w,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(OF)){if(u==null&&(u=j0(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",AF(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var y=0,P=0,N;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=p,l="h",y<1&&(y=1);break;case"s":(N=i[o].v.match(/\.0+$/))&&(P=Math.max(P,N[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[o].v.match(/[Hh]/)&&(y=1),y<2&&i[o].v.match(/[Mm]/)&&(y=2),y<3&&i[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var B="",F;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=a$(i[o].t.charCodeAt(0),i[o].v,u,P),i[o].t="t";break;case"n":case"?":for(F=o+1;i[F]!=null&&((a=i[F].t)==="?"||a==="D"||(a===" "||a==="t")&&i[F+1]!=null&&(i[F+1].t==="?"||i[F+1].t==="t"&&i[F+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[F].v==="/"||i[F].v===" "&&i[F+1]!=null&&i[F+1].t=="?"));)i[o].v+=i[F].v,i[F]={v:"",t:";"},++F;B+=i[o].v,o=F-1;break;case"G":i[o].t="t",i[o].v=k1(e,r);break}var Q="",he,U;if(B.length>0){B.charCodeAt(0)==40?(he=e<0&&B.charCodeAt(0)===45?-e:e,U=Qs("n",B,he)):(he=e<0&&n>1?-e:e,U=Qs("n",B,he),he<0&&i[0]&&i[0].t=="t"&&(U=U.substr(1),i[0].v="-"+i[0].v)),F=U.length-1;var X=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){X=o;break}var K=i.length;if(X===i.length&&U.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(F>=i[o].v.length-1?(F-=i[o].v.length,i[o].v=U.substr(F+1,i[o].v.length)):F<0?i[o].v="":(i[o].v=U.substr(0,F+1),F=-1),i[o].t="t",K=o);F>=0&&K<i.length&&(i[K].v=U.substr(0,F+1)+i[K].v)}else if(X!==i.length&&U.indexOf("E")===-1){for(F=U.indexOf(".")-1,o=X;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(f=i[o].v.indexOf(".")>-1&&o===X?i[o].v.indexOf(".")-1:i[o].v.length-1,Q=i[o].v.substr(f+1);f>=0;--f)F>=0&&(i[o].v.charAt(f)==="0"||i[o].v.charAt(f)==="#")&&(Q=U.charAt(F--)+Q);i[o].v=Q,i[o].t="t",K=o}for(F>=0&&K<i.length&&(i[K].v=U.substr(0,F+1)+i[K].v),F=U.indexOf(".")+1,o=X;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==X)){for(f=i[o].v.indexOf(".")>-1&&o===X?i[o].v.indexOf(".")+1:0,Q=i[o].v.substr(0,f);f<i[o].v.length;++f)F<U.length&&(Q+=U.charAt(F++));i[o].v=Q,i[o].t="t",K=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(he=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Qs(i[o].t,i[o].v,he),i[o].t="t");var ne="";for(o=0;o!==i.length;++o)i[o]!=null&&(ne+=i[o].v);return ne}var BM=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function VM(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function w$(t,e){var r=g$(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(BM),a=r[1].match(BM);return VM(e,o)?[n,r[0]]:VM(e,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,s]}function Ko(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:cr)[t],n==null&&(n=r.table&&r.table[NM[t]]||cr[NM[t]]),n==null&&(n=Qq[t]||"General");break}if(Z0(n,0))return k1(e,r);e instanceof Date&&(e=SF(e,r.date1904));var i=w$(n,e);if(Z0(i[1]))return k1(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return v$(i[1],e,r,i[0])}function IF(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(cr[r]==null){e<0&&(e=r);continue}if(cr[r]==t){e=r;break}}e<0&&(e=391)}return cr[e]=t,e}function um(t){for(var e=0;e!=392;++e)t[e]!==void 0&&IF(t[e],e)}function fm(){cr=Jq()}var kF=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function x$(t){var e=typeof t=="number"?cr[t]:t;return e=e.replace(kF,"(\\d+)"),new RegExp("^"+e+"$")}function S$(t,e,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(kF)||[]).forEach(function(d,p){var g=parseInt(r[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":o=g;break;case"s":l=g;break;case"m":o>=0?a=g:i=g;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?u:n==-1&&i==-1&&s==-1?f:u+"T"+f}var C$=function(){var t={};t.version="1.2.0";function e(){for(var U=0,X=new Array(256),K=0;K!=256;++K)U=K,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,U=U&1?-306674912^U>>>1:U>>>1,X[K]=U;return typeof Int32Array<"u"?new Int32Array(X):X}var r=e();function n(U){var X=0,K=0,ne=0,ie=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)ie[ne]=U[ne];for(ne=0;ne!=256;++ne)for(K=U[ne],X=256+ne;X<4096;X+=256)K=ie[X]=K>>>8^U[K&255];var te=[];for(ne=1;ne!=16;++ne)te[ne-1]=typeof Int32Array<"u"?ie.subarray(ne*256,ne*256+256):ie.slice(ne*256,ne*256+256);return te}var i=n(r),s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],f=i[5],d=i[6],p=i[7],g=i[8],x=i[9],w=i[10],y=i[11],P=i[12],N=i[13],B=i[14];function F(U,X){for(var K=X^-1,ne=0,ie=U.length;ne<ie;)K=K>>>8^r[(K^U.charCodeAt(ne++))&255];return~K}function Q(U,X){for(var K=X^-1,ne=U.length-15,ie=0;ie<ne;)K=B[U[ie++]^K&255]^N[U[ie++]^K>>8&255]^P[U[ie++]^K>>16&255]^y[U[ie++]^K>>>24]^w[U[ie++]]^x[U[ie++]]^g[U[ie++]]^p[U[ie++]]^d[U[ie++]]^f[U[ie++]]^u[U[ie++]]^l[U[ie++]]^a[U[ie++]]^o[U[ie++]]^s[U[ie++]]^r[U[ie++]];for(ne+=15;ie<ne;)K=K>>>8^r[(K^U[ie++])&255];return~K}function he(U,X){for(var K=X^-1,ne=0,ie=U.length,te=0,Re=0;ne<ie;)te=U.charCodeAt(ne++),te<128?K=K>>>8^r[(K^te)&255]:te<2048?(K=K>>>8^r[(K^(192|te>>6&31))&255],K=K>>>8^r[(K^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,Re=U.charCodeAt(ne++)&1023,K=K>>>8^r[(K^(240|te>>8&7))&255],K=K>>>8^r[(K^(128|te>>2&63))&255],K=K>>>8^r[(K^(128|Re>>6&15|(te&3)<<4))&255],K=K>>>8^r[(K^(128|Re&63))&255]):(K=K>>>8^r[(K^(224|te>>12&15))&255],K=K>>>8^r[(K^(128|te>>6&63))&255],K=K>>>8^r[(K^(128|te&63))&255]);return~K}return t.table=r,t.bstr=F,t.buf=Q,t.str=he,t}(),Pt=function(){var e={};e.version="1.2.1";function r(E,I){for(var R=E.split("/"),A=I.split("/"),k=0,M=0,Z=Math.min(R.length,A.length);k<Z;++k){if(M=R[k].length-A[k].length)return M;if(R[k]!=A[k])return R[k]<A[k]?-1:1}return R.length-A.length}function n(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:n(E.slice(0,-1));var I=E.lastIndexOf("/");return I===-1?E:E.slice(0,I+1)}function i(E){if(E.charAt(E.length-1)=="/")return i(E.slice(0,-1));var I=E.lastIndexOf("/");return I===-1?E:E.slice(I+1)}function s(E,I){typeof I=="string"&&(I=new Date(I));var R=I.getHours();R=R<<6|I.getMinutes(),R=R<<5|I.getSeconds()>>>1,E.write_shift(2,R);var A=I.getFullYear()-1980;A=A<<4|I.getMonth()+1,A=A<<5|I.getDate(),E.write_shift(2,A)}function o(E){var I=E.read_shift(2)&65535,R=E.read_shift(2)&65535,A=new Date,k=R&31;R>>>=5;var M=R&15;R>>>=4,A.setMilliseconds(0),A.setFullYear(R+1980),A.setMonth(M-1),A.setDate(k);var Z=I&31;I>>>=5;var se=I&63;return I>>>=6,A.setHours(I),A.setMinutes(se),A.setSeconds(Z<<1),A}function a(E){ni(E,0);for(var I={},R=0;E.l<=E.length-4;){var A=E.read_shift(2),k=E.read_shift(2),M=E.l+k,Z={};switch(A){case 21589:R=E.read_shift(1),R&1&&(Z.mtime=E.read_shift(4)),k>5&&(R&2&&(Z.atime=E.read_shift(4)),R&4&&(Z.ctime=E.read_shift(4))),Z.mtime&&(Z.mt=new Date(Z.mtime*1e3));break}E.l=M,I[A]=Z}return I}var l;function u(){return l||(l={})}function f(E,I){if(E[0]==80&&E[1]==75)return yr(E,I);if((E[0]|32)==109&&(E[1]|32)==105)return ao(E,I);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var R=3,A=512,k=0,M=0,Z=0,se=0,J=0,ee=[],j=E.slice(0,512);ni(j,0);var O=d(j);switch(R=O[0],R){case 3:A=512;break;case 4:A=4096;break;case 0:if(O[1]==0)return yr(E,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}A!==512&&(j=E.slice(0,A),ni(j,28));var q=E.slice(0,A);p(j,R);var ce=j.read_shift(4,"i");if(R===3&&ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ce);j.l+=4,Z=j.read_shift(4,"i"),j.l+=4,j.chk("00100000","Mini Stream Cutoff Size: "),se=j.read_shift(4,"i"),k=j.read_shift(4,"i"),J=j.read_shift(4,"i"),M=j.read_shift(4,"i");for(var de=-1,we=0;we<109&&(de=j.read_shift(4,"i"),!(de<0));++we)ee[we]=de;var _e=g(E,A);y(J,M,_e,A,ee);var Ze=N(_e,Z,ee,A);Ze[Z].name="!Directory",k>0&&se!==Re&&(Ze[se].name="!MiniFAT"),Ze[ee[0]].name="!FAT",Ze.fat_addrs=ee,Ze.ssz=A;var Vt={},bt=[],_r=[],Ut=[];B(Z,Ze,_e,bt,k,Vt,_r,se),x(_r,Ut,bt),bt.shift();var is={FileIndex:_r,FullPaths:Ut};return I&&I.raw&&(is.raw={header:q,sectors:_e}),is}function d(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(We,"Header Signature: "),E.l+=16;var I=E.read_shift(2,"u");return[E.read_shift(2,"u"),I]}function p(E,I){var R=9;switch(E.l+=2,R=E.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function g(E,I){for(var R=Math.ceil(E.length/I)-1,A=[],k=1;k<R;++k)A[k-1]=E.slice(k*I,(k+1)*I);return A[R-1]=E.slice(R*I),A}function x(E,I,R){for(var A=0,k=0,M=0,Z=0,se=0,J=R.length,ee=[],j=[];A<J;++A)ee[A]=j[A]=A,I[A]=R[A];for(;se<j.length;++se)A=j[se],k=E[A].L,M=E[A].R,Z=E[A].C,ee[A]===A&&(k!==-1&&ee[k]!==k&&(ee[A]=ee[k]),M!==-1&&ee[M]!==M&&(ee[A]=ee[M])),Z!==-1&&(ee[Z]=A),k!==-1&&A!=ee[A]&&(ee[k]=ee[A],j.lastIndexOf(k)<se&&j.push(k)),M!==-1&&A!=ee[A]&&(ee[M]=ee[A],j.lastIndexOf(M)<se&&j.push(M));for(A=1;A<J;++A)ee[A]===A&&(M!==-1&&ee[M]!==M?ee[A]=ee[M]:k!==-1&&ee[k]!==k&&(ee[A]=ee[k]));for(A=1;A<J;++A)if(E[A].type!==0){if(se=A,se!=ee[se])do se=ee[se],I[A]=I[se]+"/"+I[A];while(se!==0&&ee[se]!==-1&&se!=ee[se]);ee[A]=-1}for(I[0]+="/",A=1;A<J;++A)E[A].type!==2&&(I[A]+="/")}function w(E,I,R){for(var A=E.start,k=E.size,M=[],Z=A;R&&k>0&&Z>=0;)M.push(I.slice(Z*te,Z*te+te)),k-=te,Z=La(R,Z*4);return M.length===0?le(0):ln(M).slice(0,E.size)}function y(E,I,R,A,k){var M=Re;if(E===Re){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var Z=R[E],se=(A>>>2)-1;if(!Z)return;for(var J=0;J<se&&(M=La(Z,J*4))!==Re;++J)k.push(M);y(La(Z,A-4),I-1,R,A,k)}}function P(E,I,R,A,k){var M=[],Z=[];k||(k=[]);var se=A-1,J=0,ee=0;for(J=I;J>=0;){k[J]=!0,M[M.length]=J,Z.push(E[J]);var j=R[Math.floor(J*4/A)];if(ee=J*4&se,A<4+ee)throw new Error("FAT boundary crossed: "+J+" 4 "+A);if(!E[j])break;J=La(E[j],ee)}return{nodes:M,data:$M([Z])}}function N(E,I,R,A){var k=E.length,M=[],Z=[],se=[],J=[],ee=A-1,j=0,O=0,q=0,ce=0;for(j=0;j<k;++j)if(se=[],q=j+I,q>=k&&(q-=k),!Z[q]){J=[];var de=[];for(O=q;O>=0;){de[O]=!0,Z[O]=!0,se[se.length]=O,J.push(E[O]);var we=R[Math.floor(O*4/A)];if(ce=O*4&ee,A<4+ce)throw new Error("FAT boundary crossed: "+O+" 4 "+A);if(!E[we]||(O=La(E[we],ce),de[O]))break}M[q]={nodes:se,data:$M([J])}}return M}function B(E,I,R,A,k,M,Z,se){for(var J=0,ee=A.length?2:0,j=I[E].data,O=0,q=0,ce;O<j.length;O+=128){var de=j.slice(O,O+128);ni(de,64),q=de.read_shift(2),ce=mm(de,0,q-ee),A.push(ce);var we={name:ce,type:de.read_shift(1),color:de.read_shift(1),L:de.read_shift(4,"i"),R:de.read_shift(4,"i"),C:de.read_shift(4,"i"),clsid:de.read_shift(16),state:de.read_shift(4,"i"),start:0,size:0},_e=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);_e!==0&&(we.ct=F(de,de.l-8));var Ze=de.read_shift(2)+de.read_shift(2)+de.read_shift(2)+de.read_shift(2);Ze!==0&&(we.mt=F(de,de.l-8)),we.start=de.read_shift(4,"i"),we.size=de.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=Re,we.name=""),we.type===5?(J=we.start,k>0&&J!==Re&&(I[J].name="!StreamData")):we.size>=4096?(we.storage="fat",I[we.start]===void 0&&(I[we.start]=P(R,we.start,I.fat_addrs,I.ssz)),I[we.start].name=we.name,we.content=I[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:J!==Re&&we.start!==Re&&I[J]&&(we.content=w(we,I[J].data,(I[se]||{}).data))),we.content&&ni(we.content,0),M[ce]=we,Z.push(we)}}function F(E,I){return new Date((Ur(E,I+4)/1e7*Math.pow(2,32)+Ur(E,I)/1e7-11644473600)*1e3)}function Q(E,I){return u(),f(l.readFileSync(E),I)}function he(E,I){var R=I&&I.type;switch(R||Et&&Buffer.isBuffer(E)&&(R="buffer"),R||"base64"){case"file":return Q(E,I);case"base64":return f(es(ro(E)),I);case"binary":return f(es(E),I)}return f(E,I)}function U(E,I){var R=I||{},A=R.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=A+"/",E.FileIndex[0]={name:A,type:5}),R.CLSID&&(E.FileIndex[0].clsid=R.CLSID),X(E)}function X(E){var I="Sh33tJ5";if(!Pt.find(E,"/"+I)){var R=le(4);R[0]=55,R[1]=R[3]=50,R[2]=54,E.FileIndex.push({name:I,type:2,content:R,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+I),K(E)}}function K(E,I){U(E);for(var R=!1,A=!1,k=E.FullPaths.length-1;k>=0;--k){var M=E.FileIndex[k];switch(M.type){case 0:A?R=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:A=!0,isNaN(M.R*M.L*M.C)&&(R=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!I)){var Z=new Date(1987,1,19),se=0,J=Object.create?Object.create(null):{},ee=[];for(k=0;k<E.FullPaths.length;++k)J[E.FullPaths[k]]=!0,E.FileIndex[k].type!==0&&ee.push([E.FullPaths[k],E.FileIndex[k]]);for(k=0;k<ee.length;++k){var j=n(ee[k][0]);A=J[j],A||(ee.push([j,{name:i(j).replace("/",""),type:1,clsid:wt,ct:Z,mt:Z,content:null}]),J[j]=!0)}for(ee.sort(function(ce,de){return r(ce[0],de[0])}),E.FullPaths=[],E.FileIndex=[],k=0;k<ee.length;++k)E.FullPaths[k]=ee[k][0],E.FileIndex[k]=ee[k][1];for(k=0;k<ee.length;++k){var O=E.FileIndex[k],q=E.FullPaths[k];if(O.name=i(q).replace("/",""),O.L=O.R=O.C=-(O.color=1),O.size=O.content?O.content.length:0,O.start=0,O.clsid=O.clsid||wt,k===0)O.C=ee.length>1?1:-1,O.size=0,O.type=5;else if(q.slice(-1)=="/"){for(se=k+1;se<ee.length&&n(E.FullPaths[se])!=q;++se);for(O.C=se>=ee.length?-1:se,se=k+1;se<ee.length&&n(E.FullPaths[se])!=n(q);++se);O.R=se>=ee.length?-1:se,O.type=1}else n(E.FullPaths[k+1]||"")==n(q)&&(O.R=k+1),O.type=2}}}function ne(E,I){var R=I||{};if(R.fileType=="mad")return gt(E,R);switch(K(E),R.fileType){case"zip":return kr(E,R)}var A=function(ce){for(var de=0,we=0,_e=0;_e<ce.FileIndex.length;++_e){var Ze=ce.FileIndex[_e];if(Ze.content){var Vt=Ze.content.length;Vt>0&&(Vt<4096?de+=Vt+63>>6:we+=Vt+511>>9)}}for(var bt=ce.FullPaths.length+3>>2,_r=de+7>>3,Ut=de+127>>7,is=_r+we+bt+Ut,oi=is+127>>7,pc=oi<=109?0:Math.ceil((oi-109)/127);is+oi+pc+127>>7>oi;)pc=++oi<=109?0:Math.ceil((oi-109)/127);var Ri=[1,pc,oi,Ut,bt,we,de,0];return ce.FileIndex[0].size=de<<6,Ri[7]=(ce.FileIndex[0].start=Ri[0]+Ri[1]+Ri[2]+Ri[3]+Ri[4]+Ri[5])+(Ri[6]+7>>3),Ri}(E),k=le(A[7]<<9),M=0,Z=0;{for(M=0;M<8;++M)k.write_shift(1,ke[M]);for(M=0;M<8;++M)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),M=0;M<3;++M)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,A[2]),k.write_shift(4,A[0]+A[1]+A[2]+A[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,A[3]?A[0]+A[1]+A[2]-1:Re),k.write_shift(4,A[3]),k.write_shift(-4,A[1]?A[0]-1:Re),k.write_shift(4,A[1]),M=0;M<109;++M)k.write_shift(-4,M<A[2]?A[1]+M:-1)}if(A[1])for(Z=0;Z<A[1];++Z){for(;M<236+Z*127;++M)k.write_shift(-4,M<A[2]?A[1]+M:-1);k.write_shift(-4,Z===A[1]-1?Re:Z+1)}var se=function(ce){for(Z+=ce;M<Z-1;++M)k.write_shift(-4,M+1);ce&&(++M,k.write_shift(-4,Re))};for(Z=M=0,Z+=A[1];M<Z;++M)k.write_shift(-4,ut.DIFSECT);for(Z+=A[2];M<Z;++M)k.write_shift(-4,ut.FATSECT);se(A[3]),se(A[4]);for(var J=0,ee=0,j=E.FileIndex[0];J<E.FileIndex.length;++J)j=E.FileIndex[J],j.content&&(ee=j.content.length,!(ee<4096)&&(j.start=Z,se(ee+511>>9)));for(se(A[6]+7>>3);k.l&511;)k.write_shift(-4,ut.ENDOFCHAIN);for(Z=M=0,J=0;J<E.FileIndex.length;++J)j=E.FileIndex[J],j.content&&(ee=j.content.length,!(!ee||ee>=4096)&&(j.start=Z,se(ee+63>>6)));for(;k.l&511;)k.write_shift(-4,ut.ENDOFCHAIN);for(M=0;M<A[4]<<2;++M){var O=E.FullPaths[M];if(!O||O.length===0){for(J=0;J<17;++J)k.write_shift(4,0);for(J=0;J<3;++J)k.write_shift(4,-1);for(J=0;J<12;++J)k.write_shift(4,0);continue}j=E.FileIndex[M],M===0&&(j.start=j.size?j.start-1:Re);var q=M===0&&R.root||j.name;if(ee=2*(q.length+1),k.write_shift(64,q,"utf16le"),k.write_shift(2,ee),k.write_shift(1,j.type),k.write_shift(1,j.color),k.write_shift(-4,j.L),k.write_shift(-4,j.R),k.write_shift(-4,j.C),j.clsid)k.write_shift(16,j.clsid,"hex");else for(J=0;J<4;++J)k.write_shift(4,0);k.write_shift(4,j.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,j.start),k.write_shift(4,j.size),k.write_shift(4,0)}for(M=1;M<E.FileIndex.length;++M)if(j=E.FileIndex[M],j.size>=4096)if(k.l=j.start+1<<9,Et&&Buffer.isBuffer(j.content))j.content.copy(k,k.l,0,j.size),k.l+=j.size+511&-512;else{for(J=0;J<j.size;++J)k.write_shift(1,j.content[J]);for(;J&511;++J)k.write_shift(1,0)}for(M=1;M<E.FileIndex.length;++M)if(j=E.FileIndex[M],j.size>0&&j.size<4096)if(Et&&Buffer.isBuffer(j.content))j.content.copy(k,k.l,0,j.size),k.l+=j.size+63&-64;else{for(J=0;J<j.size;++J)k.write_shift(1,j.content[J]);for(;J&63;++J)k.write_shift(1,0)}if(Et)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function ie(E,I){var R=E.FullPaths.map(function(J){return J.toUpperCase()}),A=R.map(function(J){var ee=J.split("/");return ee[ee.length-(J.slice(-1)=="/"?2:1)]}),k=!1;I.charCodeAt(0)===47?(k=!0,I=R[0].slice(0,-1)+I):k=I.indexOf("/")!==-1;var M=I.toUpperCase(),Z=k===!0?R.indexOf(M):A.indexOf(M);if(Z!==-1)return E.FileIndex[Z];var se=!M.match(U0);for(M=M.replace(nc,""),se&&(M=M.replace(U0,"!")),Z=0;Z<R.length;++Z)if((se?R[Z].replace(U0,"!"):R[Z]).replace(nc,"")==M||(se?A[Z].replace(U0,"!"):A[Z]).replace(nc,"")==M)return E.FileIndex[Z];return null}var te=64,Re=-2,We="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],wt="00000000000000000000000000000000",ut={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Re,FREESECT:-1,HEADER_SIGNATURE:We,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:wt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ze(E,I,R){u();var A=ne(E,R);l.writeFileSync(I,A)}function rt(E){for(var I=new Array(E.length),R=0;R<E.length;++R)I[R]=String.fromCharCode(E[R]);return I.join("")}function $e(E,I){var R=ne(E,I);switch(I&&I.type||"buffer"){case"file":return u(),l.writeFileSync(I.filename,R),R;case"binary":return typeof R=="string"?R:rt(R);case"base64":return hf(typeof R=="string"?R:rt(R));case"buffer":if(Et)return Buffer.isBuffer(R)?R:io(R);case"array":return typeof R=="string"?es(R):R}return R}var Ye;function V(E){try{var I=E.InflateRaw,R=new I;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)Ye=E;else throw new Error("zlib does not expose bytesRead")}catch(A){console.error("cannot use native zlib: "+(A.message||A))}}function G(E,I){if(!Ye)return qn(E,I);var R=Ye.InflateRaw,A=new R,k=A._processChunk(E.slice(E.l),A._finishFlushFlag);return E.l+=A.bytesRead,k}function z(E){return Ye?Ye.deflateRawSync(E):Zt(E)}var m=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function D(E){var I=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(I>>16|I>>8|I)&255}for(var L=typeof Uint8Array<"u",H=L?new Uint8Array(256):[],oe=0;oe<256;++oe)H[oe]=D(oe);function fe(E,I){var R=H[E&255];return I<=8?R>>>8-I:(R=R<<8|H[E>>8&255],I<=16?R>>>16-I:(R=R<<8|H[E>>16&255],R>>>24-I))}function Oe(E,I){var R=I&7,A=I>>>3;return(E[A]|(R<=6?0:E[A+1]<<8))>>>R&3}function ve(E,I){var R=I&7,A=I>>>3;return(E[A]|(R<=5?0:E[A+1]<<8))>>>R&7}function ue(E,I){var R=I&7,A=I>>>3;return(E[A]|(R<=4?0:E[A+1]<<8))>>>R&15}function Ie(E,I){var R=I&7,A=I>>>3;return(E[A]|(R<=3?0:E[A+1]<<8))>>>R&31}function pe(E,I){var R=I&7,A=I>>>3;return(E[A]|(R<=1?0:E[A+1]<<8))>>>R&127}function He(E,I,R){var A=I&7,k=I>>>3,M=(1<<R)-1,Z=E[k]>>>A;return R<8-A||(Z|=E[k+1]<<8-A,R<16-A)||(Z|=E[k+2]<<16-A,R<24-A)||(Z|=E[k+3]<<24-A),Z&M}function Xe(E,I,R){var A=I&7,k=I>>>3;return A<=5?E[k]|=(R&7)<<A:(E[k]|=R<<A&255,E[k+1]=(R&7)>>8-A),I+3}function Tt(E,I,R){var A=I&7,k=I>>>3;return R=(R&1)<<A,E[k]|=R,I+1}function Lt(E,I,R){var A=I&7,k=I>>>3;return R<<=A,E[k]|=R&255,R>>>=8,E[k+1]=R,I+8}function ur(E,I,R){var A=I&7,k=I>>>3;return R<<=A,E[k]|=R&255,R>>>=8,E[k+1]=R&255,E[k+2]=R>>>8,I+16}function xt(E,I){var R=E.length,A=2*R>I?2*R:I+5,k=0;if(R>=I)return E;if(Et){var M=FM(A);if(E.copy)E.copy(M);else for(;k<E.length;++k)M[k]=E[k];return M}else if(L){var Z=new Uint8Array(A);if(Z.set)Z.set(E);else for(;k<R;++k)Z[k]=E[k];return Z}return E.length=A,E}function qe(E){for(var I=new Array(E),R=0;R<E;++R)I[R]=0;return I}function zt(E,I,R){var A=1,k=0,M=0,Z=0,se=0,J=E.length,ee=L?new Uint16Array(32):qe(32);for(M=0;M<32;++M)ee[M]=0;for(M=J;M<R;++M)E[M]=0;J=E.length;var j=L?new Uint16Array(J):qe(J);for(M=0;M<J;++M)ee[k=E[M]]++,A<k&&(A=k),j[M]=0;for(ee[0]=0,M=1;M<=A;++M)ee[M+16]=se=se+ee[M-1]<<1;for(M=0;M<J;++M)se=E[M],se!=0&&(j[M]=ee[se+16]++);var O=0;for(M=0;M<J;++M)if(O=E[M],O!=0)for(se=fe(j[M],A)>>A-O,Z=(1<<A+4-O)-1;Z>=0;--Z)I[se|Z<<O]=O&15|M<<4;return A}var Kt=L?new Uint16Array(512):qe(512),Bt=L?new Uint16Array(32):qe(32);if(!L){for(var Ke=0;Ke<512;++Ke)Kt[Ke]=0;for(Ke=0;Ke<32;++Ke)Bt[Ke]=0}(function(){for(var E=[],I=0;I<32;I++)E.push(5);zt(E,Bt,32);var R=[];for(I=0;I<=143;I++)R.push(8);for(;I<=255;I++)R.push(9);for(;I<=279;I++)R.push(7);for(;I<=287;I++)R.push(8);zt(R,Kt,288)})();var xr=function(){for(var I=L?new Uint8Array(32768):[],R=0,A=0;R<_.length-1;++R)for(;A<_[R+1];++A)I[A]=R;for(;A<32768;++A)I[A]=29;var k=L?new Uint8Array(259):[];for(R=0,A=0;R<S.length-1;++R)for(;A<S[R+1];++A)k[A]=R;function M(se,J){for(var ee=0;ee<se.length;){var j=Math.min(65535,se.length-ee),O=ee+j==se.length;for(J.write_shift(1,+O),J.write_shift(2,j),J.write_shift(2,~j&65535);j-- >0;)J[J.l++]=se[ee++]}return J.l}function Z(se,J){for(var ee=0,j=0,O=L?new Uint16Array(32768):[];j<se.length;){var q=Math.min(65535,se.length-j);if(q<10){for(ee=Xe(J,ee,+(j+q==se.length)),ee&7&&(ee+=8-(ee&7)),J.l=ee/8|0,J.write_shift(2,q),J.write_shift(2,~q&65535);q-- >0;)J[J.l++]=se[j++];ee=J.l*8;continue}ee=Xe(J,ee,+(j+q==se.length)+2);for(var ce=0;q-- >0;){var de=se[j];ce=(ce<<5^de)&32767;var we=-1,_e=0;if((we=O[ce])&&(we|=j&-32768,we>j&&(we-=32768),we<j))for(;se[we+_e]==se[j+_e]&&_e<250;)++_e;if(_e>2){de=k[_e],de<=22?ee=Lt(J,ee,H[de+1]>>1)-1:(Lt(J,ee,3),ee+=5,Lt(J,ee,H[de-23]>>5),ee+=3);var Ze=de<8?0:de-4>>2;Ze>0&&(ur(J,ee,_e-S[de]),ee+=Ze),de=I[j-we],ee=Lt(J,ee,H[de]>>3),ee-=3;var Vt=de<4?0:de-2>>1;Vt>0&&(ur(J,ee,j-we-_[de]),ee+=Vt);for(var bt=0;bt<_e;++bt)O[ce]=j&32767,ce=(ce<<5^se[j])&32767,++j;q-=_e-1}else de<=143?de=de+48:ee=Tt(J,ee,1),ee=Lt(J,ee,H[de]),O[ce]=j&32767,++j}ee=Lt(J,ee,0)-1}return J.l=(ee+7)/8|0,J.l}return function(J,ee){return J.length<8?M(J,ee):Z(J,ee)}}();function Zt(E){var I=le(50+Math.floor(E.length*1.1)),R=xr(E,I);return I.slice(0,R)}var fr=L?new Uint16Array(32768):qe(32768),xn=L?new Uint16Array(32768):qe(32768),Ir=L?new Uint16Array(128):qe(128),Yr=1,Sr=1;function An(E,I){var R=Ie(E,I)+257;I+=5;var A=Ie(E,I)+1;I+=5;var k=ue(E,I)+4;I+=4;for(var M=0,Z=L?new Uint8Array(19):qe(19),se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=1,ee=L?new Uint8Array(8):qe(8),j=L?new Uint8Array(8):qe(8),O=Z.length,q=0;q<k;++q)Z[m[q]]=M=ve(E,I),J<M&&(J=M),ee[M]++,I+=3;var ce=0;for(ee[0]=0,q=1;q<=J;++q)j[q]=ce=ce+ee[q-1]<<1;for(q=0;q<O;++q)(ce=Z[q])!=0&&(se[q]=j[ce]++);var de=0;for(q=0;q<O;++q)if(de=Z[q],de!=0){ce=H[se[q]]>>8-de;for(var we=(1<<7-de)-1;we>=0;--we)Ir[ce|we<<de]=de&7|q<<3}var _e=[];for(J=1;_e.length<R+A;)switch(ce=Ir[pe(E,I)],I+=ce&7,ce>>>=3){case 16:for(M=3+Oe(E,I),I+=2,ce=_e[_e.length-1];M-- >0;)_e.push(ce);break;case 17:for(M=3+ve(E,I),I+=3;M-- >0;)_e.push(0);break;case 18:for(M=11+pe(E,I),I+=7;M-- >0;)_e.push(0);break;default:_e.push(ce),J<ce&&(J=ce);break}var Ze=_e.slice(0,R),Vt=_e.slice(R);for(q=R;q<286;++q)Ze[q]=0;for(q=A;q<30;++q)Vt[q]=0;return Yr=zt(Ze,fr,286),Sr=zt(Vt,xn,30),I}function Cr(E,I){if(E[0]==3&&!(E[1]&3))return[Wa(I),2];for(var R=0,A=0,k=FM(I||1<<18),M=0,Z=k.length>>>0,se=0,J=0;(A&1)==0;){if(A=ve(E,R),R+=3,A>>>1)A>>1==1?(se=9,J=5):(R=An(E,R),se=Yr,J=Sr);else{R&7&&(R+=8-(R&7));var ee=E[R>>>3]|E[(R>>>3)+1]<<8;if(R+=32,ee>0)for(!I&&Z<M+ee&&(k=xt(k,M+ee),Z=k.length);ee-- >0;)k[M++]=E[R>>>3],R+=8;continue}for(;;){!I&&Z<M+32767&&(k=xt(k,M+32767),Z=k.length);var j=He(E,R,se),O=A>>>1==1?Kt[j]:fr[j];if(R+=O&15,O>>>=4,(O>>>8&255)===0)k[M++]=O;else{if(O==256)break;O-=257;var q=O<8?0:O-4>>2;q>5&&(q=0);var ce=M+S[O];q>0&&(ce+=He(E,R,q),R+=q),j=He(E,R,J),O=A>>>1==1?Bt[j]:xn[j],R+=O&15,O>>>=4;var de=O<4?0:O-2>>1,we=_[O];for(de>0&&(we+=He(E,R,de),R+=de),!I&&Z<ce&&(k=xt(k,ce+100),Z=k.length);M<ce;)k[M]=k[M-we],++M}}}return I?[k,R+7>>>3]:[k.slice(0,M),R+7>>>3]}function qn(E,I){var R=E.slice(E.l||0),A=Cr(R,I);return E.l+=A[1],A[0]}function qr(E,I){if(E)typeof console<"u"&&console.error(I);else throw new Error(I)}function yr(E,I){var R=E;ni(R,0);var A=[],k=[],M={FileIndex:A,FullPaths:k};U(M,{root:I.root});for(var Z=R.length-4;(R[Z]!=80||R[Z+1]!=75||R[Z+2]!=5||R[Z+3]!=6)&&Z>=0;)--Z;R.l=Z+4,R.l+=4;var se=R.read_shift(2);R.l+=6;var J=R.read_shift(4);for(R.l=J,Z=0;Z<se;++Z){R.l+=20;var ee=R.read_shift(4),j=R.read_shift(4),O=R.read_shift(2),q=R.read_shift(2),ce=R.read_shift(2);R.l+=8;var de=R.read_shift(4),we=a(R.slice(R.l+O,R.l+O+q));R.l+=O+q+ce;var _e=R.l;R.l=de+4,In(R,ee,j,M,we),R.l=_e}return M}function In(E,I,R,A,k){E.l+=2;var M=E.read_shift(2),Z=E.read_shift(2),se=o(E);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var J=E.read_shift(4),ee=E.read_shift(4),j=E.read_shift(4),O=E.read_shift(2),q=E.read_shift(2),ce="",de=0;de<O;++de)ce+=String.fromCharCode(E[E.l++]);if(q){var we=a(E.slice(E.l,E.l+q));(we[21589]||{}).mt&&(se=we[21589].mt),((k||{})[21589]||{}).mt&&(se=k[21589].mt)}E.l+=q;var _e=E.slice(E.l,E.l+ee);switch(Z){case 8:_e=G(E,j);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Z)}var Ze=!1;M&8&&(J=E.read_shift(4),J==134695760&&(J=E.read_shift(4),Ze=!0),ee=E.read_shift(4),j=E.read_shift(4)),ee!=I&&qr(Ze,"Bad compressed size: "+I+" != "+ee),j!=R&&qr(Ze,"Bad uncompressed size: "+R+" != "+j),lo(A,ce,_e,{unsafe:!0,mt:se})}function kr(E,I){var R=I||{},A=[],k=[],M=le(1),Z=R.compression?8:0,se=0,J=!1;J&&(se|=8);var ee=0,j=0,O=0,q=0,ce=E.FullPaths[0],de=ce,we=E.FileIndex[0],_e=[],Ze=0;for(ee=1;ee<E.FullPaths.length;++ee)if(de=E.FullPaths[ee].slice(ce.length),we=E.FileIndex[ee],!(!we.size||!we.content||de=="Sh33tJ5")){var Vt=O,bt=le(de.length);for(j=0;j<de.length;++j)bt.write_shift(1,de.charCodeAt(j)&127);bt=bt.slice(0,bt.l),_e[q]=C$.buf(we.content,0);var _r=we.content;Z==8&&(_r=z(_r)),M=le(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,se),M.write_shift(2,Z),we.mt?s(M,we.mt):M.write_shift(4,0),M.write_shift(-4,se&8?0:_e[q]),M.write_shift(4,se&8?0:_r.length),M.write_shift(4,se&8?0:we.content.length),M.write_shift(2,bt.length),M.write_shift(2,0),O+=M.length,A.push(M),O+=bt.length,A.push(bt),O+=_r.length,A.push(_r),se&8&&(M=le(12),M.write_shift(-4,_e[q]),M.write_shift(4,_r.length),M.write_shift(4,we.content.length),O+=M.l,A.push(M)),M=le(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,se),M.write_shift(2,Z),M.write_shift(4,0),M.write_shift(-4,_e[q]),M.write_shift(4,_r.length),M.write_shift(4,we.content.length),M.write_shift(2,bt.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,Vt),Ze+=M.l,k.push(M),Ze+=bt.length,k.push(bt),++q}return M=le(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,q),M.write_shift(2,q),M.write_shift(4,Ze),M.write_shift(4,O),M.write_shift(2,0),ln([ln(A),ln(k),M])}var Ce={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function so(E,I){if(E.ctype)return E.ctype;var R=E.name||"",A=R.match(/\.([^\.]+)$/);return A&&Ce[A[1]]||I&&(A=(R=I).match(/[\.\\]([^\.\\])+$/),A&&Ce[A[1]])?Ce[A[1]]:"application/octet-stream"}function oo(E){for(var I=hf(E),R=[],A=0;A<I.length;A+=76)R.push(I.slice(A,A+76));return R.join(`\r
`)+`\r
`}function yt(E){var I=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var j=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(j.length==1?"0"+j:j)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],A=I.split(`\r
`),k=0;k<A.length;++k){var M=A[k];if(M.length==0){R.push("");continue}for(var Z=0;Z<M.length;){var se=76,J=M.slice(Z,Z+se);J.charAt(se-1)=="="?se--:J.charAt(se-2)=="="?se-=2:J.charAt(se-3)=="="&&(se-=3),J=M.slice(Z,Z+se),Z+=se,Z<M.length&&(J+="="),R.push(J)}}return R.join(`\r
`)}function hr(E){for(var I=[],R=0;R<E.length;++R){for(var A=E[R];R<=E.length&&A.charAt(A.length-1)=="=";)A=A.slice(0,A.length-1)+E[++R];I.push(A)}for(var k=0;k<I.length;++k)I[k]=I[k].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return es(I.join(`\r
`))}function nt(E,I,R){for(var A="",k="",M="",Z,se=0;se<10;++se){var J=I[se];if(!J||J.match(/^\s*$/))break;var ee=J.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":A=ee[2].trim();break;case"content-type":M=ee[2].trim();break;case"content-transfer-encoding":k=ee[2].trim();break}}switch(++se,k.toLowerCase()){case"base64":Z=es(ro(I.slice(se).join("")));break;case"quoted-printable":Z=hr(I.slice(se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var j=lo(E,A.slice(R.length),Z,{unsafe:!0});M&&(j.ctype=M)}function ao(E,I){if(rt(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=I&&I.root||"",A=(Et&&Buffer.isBuffer(E)?E.toString("binary"):rt(E)).split(`\r
`),k=0,M="";for(k=0;k<A.length;++k)if(M=A[k],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),R||(R=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),M.slice(0,R.length)!=R););var Z=(A[1]||"").match(/boundary="(.*?)"/);if(!Z)throw new Error("MAD cannot find boundary");var se="--"+(Z[1]||""),J=[],ee=[],j={FileIndex:J,FullPaths:ee};U(j);var O,q=0;for(k=0;k<A.length;++k){var ce=A[k];ce!==se&&ce!==se+"--"||(q++&&nt(j,A.slice(O,k),R),O=k)}return j}function gt(E,I){var R=I||{},A=R.boundary||"SheetJS";A="------="+A;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+A.slice(2)+'"',"","",""],M=E.FullPaths[0],Z=M,se=E.FileIndex[0],J=1;J<E.FullPaths.length;++J)if(Z=E.FullPaths[J].slice(M.length),se=E.FileIndex[J],!(!se.size||!se.content||Z=="Sh33tJ5")){Z=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_e){return"_x"+_e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_e){return"_u"+_e.charCodeAt(0).toString(16)+"_"});for(var ee=se.content,j=Et&&Buffer.isBuffer(ee)?ee.toString("binary"):rt(ee),O=0,q=Math.min(1024,j.length),ce=0,de=0;de<=q;++de)(ce=j.charCodeAt(de))>=32&&ce<128&&++O;var we=O>=q*4/5;k.push(A),k.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+Z),k.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),k.push("Content-Type: "+so(se,Z)),k.push(""),k.push(we?yt(j):oo(j))}return k.push(A+`--\r
`),k.join(`\r
`)}function ns(E){var I={};return U(I,E),I}function lo(E,I,R,A){var k=A&&A.unsafe;k||U(E);var M=!k&&Pt.find(E,I);if(!M){var Z=E.FullPaths[0];I.slice(0,Z.length)==Z?Z=I:(Z.slice(-1)!="/"&&(Z+="/"),Z=(Z+I).replace("//","/")),M={name:i(I),type:2},E.FileIndex.push(M),E.FullPaths.push(Z),k||Pt.utils.cfb_gc(E)}return M.content=R,M.size=R?R.length:0,A&&(A.CLSID&&(M.clsid=A.CLSID),A.mt&&(M.mt=A.mt),A.ct&&(M.ct=A.ct)),M}function co(E,I){U(E);var R=Pt.find(E,I);if(R){for(var A=0;A<E.FileIndex.length;++A)if(E.FileIndex[A]==R)return E.FileIndex.splice(A,1),E.FullPaths.splice(A,1),!0}return!1}function Ot(E,I,R){U(E);var A=Pt.find(E,I);if(A){for(var k=0;k<E.FileIndex.length;++k)if(E.FileIndex[k]==A)return E.FileIndex[k].name=i(R),E.FullPaths[k]=R,!0}return!1}function Mr(E){K(E,!0)}return e.find=ie,e.read=he,e.parse=f,e.write=$e,e.writeFile=ze,e.utils={cfb_new:ns,cfb_add:lo,cfb_del:co,cfb_mov:Ot,cfb_gc:Mr,ReadShift:of,CheckField:GF,prep_blob:ni,bconcat:ln,use_zlib:V,_deflateRaw:Zt,_inflateRaw:qn,consts:ut},e}(),G0;function y$(t){return typeof t=="string"?cm(t):Array.isArray(t)?$q(t):t}function wf(t,e,r){if(typeof G0<"u"&&G0.writeFileSync)return r?G0.writeFileSync(t,e,r):G0.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=cm(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Js(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([y$(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=vf(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function fn(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function WM(t,e){for(var r=[],n=fn(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function H1(t){for(var e=[],r=fn(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function hm(t){for(var e=[],r=fn(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function _$(t){for(var e=[],r=fn(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Q0=new Date(1899,11,30,0,0,0);function zn(t,e){var r=t.getTime();e&&(r-=1462*24*60*60*1e3);var n=Q0.getTime()+(t.getTimezoneOffset()-Q0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var MF=new Date,E$=Q0.getTime()+(MF.getTimezoneOffset()-Q0.getTimezoneOffset())*6e4,UM=MF.getTimezoneOffset();function FF(t){var e=new Date;return e.setTime(t*24*60*60*1e3+E$),e.getTimezoneOffset()!==UM&&e.setTime(e.getTime()+(e.getTimezoneOffset()-UM)*6e4),e}var jM=new Date("2017-02-19T19:06:09.000Z"),DF=isNaN(jM.getFullYear())?new Date("2/19/17"):jM,T$=DF.getFullYear()==2017;function On(t,e){var r=new Date(t);if(T$)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(DF.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function dm(t,e){if(Et&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Js(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Js(qq(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Js(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Js(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Yn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Yn(t[r]));return e}function lr(t,e){for(var r="";r.length<e;)r+=t;return r}function eo(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var b$=["january","february","march","april","may","june","july","august","september","october","november","december"];function df(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&b$.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function st(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Et?n=io(r):n=Xq(r),Pt.utils.cfb_add(t,e,n)}Pt.utils.cfb_add(t,e,r)}else t.file(e,r)}function L1(){return Pt.utils.cfb_new()}var Ar=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var R$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},B1=H1(R$);var V1=/[&<>'"]/g,O$=/[\u0000-\u0008\u000b-\u001f]/g;function Ft(t){var e=t+"";return e.replace(V1,function(r){return B1[r]}).replace(O$,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function GM(t){return Ft(t).replace(/ /g,"_x0020_")}var PF=/[\u0000-\u001f]/g;function A$(t){var e=t+"";return e.replace(V1,function(r){return B1[r]}).replace(/\n/g,"<br/>").replace(PF,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function I$(t){var e=t+"";return e.replace(V1,function(r){return B1[r]}).replace(PF,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function k$(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function M$(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function E1(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(r++),a=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function zM(t){var e=Wa(2*t.length),r,n,i=1,s=0,o=0,a;for(n=0;n<t.length;n+=i)i=1,(a=t.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(t.charCodeAt(n+1)&63),i=2):a<240?(r=(a&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(a&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function YM(t){return io(t,"binary").toString("utf8")}var z0="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",sf=Et&&(YM(z0)==E1(z0)&&YM||zM(z0)==E1(z0)&&zM)||E1,Js=Et?function(t){return io(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")};var F$=function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}();var NF=/(^\s|\s$|\n)/;function cn(t,e){return"<"+t+(e.match(NF)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function mf(t){return fn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Te(t,e,r){return"<"+t+(r!=null?mf(r):"")+(e!=null?(e.match(NF)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function M1(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function D$(t,e){switch(typeof t){case"string":var r=Te("vt:lpwstr",Ft(t));return e&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Te((t|0)==t?"vt:i4":"vt:r8",Ft(String(t)));case"boolean":return Te("vt:bool",t?"true":"false")}if(t instanceof Date)return Te("vt:filetime",M1(t));throw new Error("Unable to serialize "+t)}var jr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},uc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ii={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function P$(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function N$(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=n?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[r+a]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var qM=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},$M=Et?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:io(e)})):qM(t)}:qM,XM=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(nf(t,i)));return n.join("").replace(nc,"")},mm=Et?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(nc,""):XM(t,e,r)}:XM,KM=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},HF=Et?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):KM(t,e,r)}:KM,ZM=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(tc(t,i)));return n.join("")},fc=Et?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):ZM(e,r,n)}:ZM,LF=function(t,e){var r=Ur(t,e);return r>0?fc(t,e+4,e+4+r-1):""},W1=LF,BF=function(t,e){var r=Ur(t,e);return r>0?fc(t,e+4,e+4+r-1):""},U1=BF,VF=function(t,e){var r=2*Ur(t,e);return r>0?fc(t,e+4,e+4+r-1):""},j1=VF,WF=function(e,r){var n=Ur(e,r);return n>0?mm(e,r+4,r+4+n):""},G1=WF,UF=function(t,e){var r=Ur(t,e);return r>0?fc(t,e+4,e+4+r):""},z1=UF,jF=function(t,e){return P$(t,e)},em=jF,Y1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Et&&(W1=function(e,r){if(!Buffer.isBuffer(e))return LF(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},U1=function(e,r){if(!Buffer.isBuffer(e))return BF(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},j1=function(e,r){if(!Buffer.isBuffer(e))return VF(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},G1=function(e,r){if(!Buffer.isBuffer(e))return WF(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},z1=function(e,r){if(!Buffer.isBuffer(e))return UF(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},em=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):jF(e,r)},Y1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function H$(){mm=function(t,e,r){return Ht.utils.decode(1200,t.slice(e,r)).replace(nc,"")},fc=function(t,e,r){return Ht.utils.decode(65001,t.slice(e,r))},W1=function(t,e){var r=Ur(t,e);return r>0?Ht.utils.decode(lc,t.slice(e+4,e+4+r-1)):""},U1=function(t,e){var r=Ur(t,e);return r>0?Ht.utils.decode(Ba,t.slice(e+4,e+4+r-1)):""},j1=function(t,e){var r=2*Ur(t,e);return r>0?Ht.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},G1=function(t,e){var r=Ur(t,e);return r>0?Ht.utils.decode(1200,t.slice(e+4,e+4+r)):""},z1=function(t,e){var r=Ur(t,e);return r>0?Ht.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof Ht<"u"&&H$();var tc=function(t,e){return t[e]},nf=function(t,e){return t[e+1]*256+t[e]},L$=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ur=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},La=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},B$=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function of(t,e){var r="",n,i,s=[],o,a,l,u;switch(e){case"dbcs":if(u=this.l,Et&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(nf(this,u)),u+=2;t*=2;break;case"utf8":r=fc(this,this.l,this.l+t);break;case"utf16le":t*=2,r=mm(this,this.l,this.l+t);break;case"wstr":if(typeof Ht<"u")r=Ht.utils.decode(Ba,this.slice(this.l,this.l+2*t));else return of.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=W1(this,this.l),t=4+Ur(this,this.l);break;case"lpstr-cp":r=U1(this,this.l),t=4+Ur(this,this.l);break;case"lpwstr":r=j1(this,this.l),t=4+2*Ur(this,this.l);break;case"lpp4":t=4+Ur(this,this.l),r=G1(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ur(this,this.l),r=z1(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=tc(this,this.l+t++))!==0;)s.push(W0(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=nf(this,this.l+t))!==0;)s.push(W0(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=tc(this,u),this.l=u+1,a=of.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(W0(nf(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":if(typeof Ht<"u"){r=Ht.utils.decode(Ba,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=tc(this,u),this.l=u+1,a=of.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(W0(tc(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=tc(this,this.l),this.l++,n;case 2:return n=(e==="i"?L$:nf)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?La:B$)(this,this.l),this.l+=4,n):(i=Ur(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=em(this,this.l):i=em([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=HF(this,this.l,t);break}}return this.l+=t,r}var V$=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},W$=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},U$=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function j$(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)U$(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){if(typeof Ht<"u"&&lc==874)for(i=0;i!=e.length;++i){var s=Ht.utils.encode(lc,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,V$(this,e,this.l);break;case 8:if(n=8,r==="f"){N$(this,e,this.l);break}case 16:break;case-4:n=4,W$(this,e,this.l);break}return this.l+=n,this}function GF(t,e){var r=HF(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ni(t,e){t.l=e,t.read_shift=of,t.chk=GF,t.write_shift=j$}function bs(t,e){t.l+=e}function le(t){var e=Wa(t);return ni(e,0),e}function Gn(){var t=[],e=Et?256:2048,r=function(u){var f=le(u);return ni(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},o=function(){return i(),ln(t)},a=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function ge(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=Nee[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Y1(r)&&t.push(r)}}function af(t,e,r){var n=Yn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function JM(t,e,r){var n=Yn(t);return n.s=af(n.s,e.s,r),n.e=af(n.e,e.s,r),n}function lf(t,e){if(t.cRel&&t.c<0)for(t=Yn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Yn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Dt(t);return!t.cRel&&t.cRel!=null&&(r=Y$(r)),!t.rRel&&t.rRel!=null&&(r=G$(r)),r}function T1(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+vn(t.s.c)+":"+(t.e.cRel?"":"$")+vn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+un(t.s.r)+":"+(t.e.rRel?"":"$")+un(t.e.r):lf(t.s,e.biff)+":"+lf(t.e,e.biff)}function q1(t){return parseInt(z$(t),10)-1}function un(t){return""+(t+1)}function G$(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function z$(t){return t.replace(/\$(\d+)$/,"$1")}function $1(t){for(var e=q$(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function vn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Y$(t){return t.replace(/^([A-Z])/,"$$$1")}function q$(t){return t.replace(/^\$([A-Z])/,"$1")}function $$(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Gr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Dt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function si(t){var e=t.indexOf(":");return e==-1?{s:Gr(t),e:Gr(t)}:{s:Gr(t.slice(0,e)),e:Gr(t.slice(e+1))}}function Or(t,e){return typeof e>"u"||typeof e=="number"?Or(t.s,t.e):(typeof t!="string"&&(t=Dt(t)),typeof e!="string"&&(e=Dt(e)),t==e?t:t+":"+e)}function Gt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function QM(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ko(t.z,r?zn(e):e)}catch{}try{return t.w=Ko((t.XF||{}).numFmtId||(r?14:0),r?zn(e):e)}catch{return""+e}}function no(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?xf[t.v]||t.v:e==null?QM(t,t.v):QM(t,e))}function Ga(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function zF(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense;Ts!=null&&i==null&&(i=Ts);var s=t||(i?[]:{}),o=0,a=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?Gr(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Gt(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(u.e.r=o=f.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=e[d].length;++p)if(!(typeof e[d][p]>"u")){var g={v:e[d][p]},x=o+d,w=a+p;if(u.s.r>x&&(u.s.r=x),u.s.c>w&&(u.s.c=w),u.e.r<x&&(u.e.r=x),u.e.c<w&&(u.e.c=w),e[d][p]&&typeof e[d][p]=="object"&&!Array.isArray(e[d][p])&&!(e[d][p]instanceof Date))g=e[d][p];else if(Array.isArray(g.v)&&(g.f=e[d][p][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||cr[14],n.cellDates?(g.t="d",g.w=Ko(g.z,zn(g.v))):(g.t="n",g.v=zn(g.v),g.w=Ko(g.z,g.v))):g.t="s";if(i)s[x]||(s[x]=[]),s[x][w]&&s[x][w].z&&(g.z=s[x][w].z),s[x][w]=g;else{var y=Dt({c:w,r:x});s[y]&&s[y].z&&(g.z=s[y].z),s[y]=g}}}return u.s.c<1e7&&(s["!ref"]=Or(u)),s}function hc(t,e){return zF(null,t,e)}function X$(t){return t.read_shift(4,"i")}function rs(t,e){return e||(e=le(4)),e.write_shift(4,t),e}function wn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function zr(t,e){var r=!1;return e==null&&(r=!0,e=le(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function K$(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Z$(t,e){return e||(e=le(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0),e}function X1(t,e){var r=t.l,n=t.read_shift(1),i=wn(t),s=[],o={t:i,h:i};if((n&1)!==0){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(K$(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function J$(t,e){var r=!1;return e==null&&(r=!0,e=le(15+4*t.t.length)),e.write_shift(1,0),zr(t.t,e),r?e.slice(0,e.l):e}var Q$=X1;function eX(t,e){var r=!1;return e==null&&(r=!0,e=le(23+4*t.t.length)),e.write_shift(1,1),zr(t.t,e),e.write_shift(4,1),Z$({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function bi(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function za(t,e){return e==null&&(e=le(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Ya(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function qa(t,e){return e==null&&(e=le(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var tX=wn,YF=zr;function K1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function tm(t,e){var r=!1;return e==null&&(r=!0,e=le(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var rX=wn,F1=K1,Z1=tm;function qF(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?em([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):La(e,0)>>2;return r?i/100:i}function $F(t,e){e==null&&(e=le(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function XF(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function nX(t,e){return e||(e=le(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var $a=XF,dc=nX;function mc(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ua(t,e){return(e||le(8)).write_shift(8,t,"f")}function iX(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=dX[i];u&&(e.rgb=uF(u));break;case 2:e.rgb=uF([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function rm(t,e){if(e||(e=le(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function sX(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function oX(t,e){e||(e=le(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var KF=2,ri=3,Y0=11;var nm=19;var q0=64,aX=65,lX=71;var cX=4108,uX=4126,an=80;var eF={1:{n:"CodePage",t:KF},2:{n:"Category",t:an},3:{n:"PresentationFormat",t:an},4:{n:"ByteCount",t:ri},5:{n:"LineCount",t:ri},6:{n:"ParagraphCount",t:ri},7:{n:"SlideCount",t:ri},8:{n:"NoteCount",t:ri},9:{n:"HiddenCount",t:ri},10:{n:"MultimediaClipCount",t:ri},11:{n:"ScaleCrop",t:Y0},12:{n:"HeadingPairs",t:cX},13:{n:"TitlesOfParts",t:uX},14:{n:"Manager",t:an},15:{n:"Company",t:an},16:{n:"LinksUpToDate",t:Y0},17:{n:"CharacterCount",t:ri},19:{n:"SharedDoc",t:Y0},22:{n:"HyperlinksChanged",t:Y0},23:{n:"AppVersion",t:ri,p:"version"},24:{n:"DigSig",t:aX},26:{n:"ContentType",t:an},27:{n:"ContentStatus",t:an},28:{n:"Language",t:an},29:{n:"Version",t:an},255:{},2147483648:{n:"Locale",t:nm},2147483651:{n:"Behavior",t:nm},1919054434:{}},tF={1:{n:"CodePage",t:KF},2:{n:"Title",t:an},3:{n:"Subject",t:an},4:{n:"Author",t:an},5:{n:"Keywords",t:an},6:{n:"Comments",t:an},7:{n:"Template",t:an},8:{n:"LastAuthor",t:an},9:{n:"RevNumber",t:an},10:{n:"EditTime",t:q0},11:{n:"LastPrinted",t:q0},12:{n:"CreatedDate",t:q0},13:{n:"ModifiedDate",t:q0},14:{n:"PageCount",t:ri},15:{n:"WordCount",t:ri},16:{n:"CharCount",t:ri},17:{n:"Thumbnail",t:lX},18:{n:"Application",t:an},19:{n:"DocSecurity",t:ri},255:{},2147483648:{n:"Locale",t:nm},2147483651:{n:"Behavior",t:nm},1919054434:{}};function fX(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var hX=fX([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),dX=Yn(hX),xf={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var mX={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ZF(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function JF(t,e){var r=_$(mX),n=[],i;n[n.length]=Ar,n[n.length]=Te("Types",null,{xmlns:jr.CT,"xmlns:xsd":jr.xsd,"xmlns:xsi":jr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Te("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Te("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:$0[l][e.bookType]||$0[l].xlsx}))},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:$0[l][e.bookType]||$0[l].xlsx})})},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ct={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function QF(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function sc(t){var e=[Ar,Te("Relationships",null,{xmlns:jr.RELS})];return fn(t["!id"]).forEach(function(r){e[e.length]=Te("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Mt(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,s?i.TargetMode=s:[Ct.HLINK,Ct.XPATH,Ct.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function pX(t){var e=[Ar];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function rF(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function gX(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function vX(t){var e=[Ar];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(rF(t[r][0],t[r][1])),e.push(gX("",t[r][0]));return e.push(rF("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function eD(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+uf.version+"</meta:generator></office:meta></office:document-meta>"}var Va=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function b1(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Ft(e),n[n.length]=r?Te(t,e,r):cn(t,e))}function tD(t,e){var r=e||{},n=[Ar,Te("cp:coreProperties",null,{"xmlns:cp":jr.CORE_PROPS,"xmlns:dc":jr.dc,"xmlns:dcterms":jr.dcterms,"xmlns:dcmitype":jr.dcmitype,"xmlns:xsi":jr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&b1("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:M1(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&b1("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:M1(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Va.length;++s){var o=Va[s],a=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&b1(o[0],a,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var oc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],rD=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function nD(t){var e=[],r=Te;return t||(t={}),t.Application="SheetJS",e[e.length]=Ar,e[e.length]=Te("Properties",null,{xmlns:jr.EXT_PROPS,"xmlns:vt":jr.vt}),oc.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ft(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Ft(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function iD(t){var e=[Ar,Te("Properties",null,{xmlns:jr.CUST_PROPS,"xmlns:vt":jr.vt})];if(!t)return e.join("");var r=1;return fn(t).forEach(function(i){++r,e[e.length]=Te("property",D$(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ft(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var nF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function wX(t,e){var r=[];return fn(nF).map(function(n){for(var i=0;i<Va.length;++i)if(Va[i][1]==n)return Va[i];for(i=0;i<oc.length;++i)if(oc[i][1]==n)return oc[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(cn(nF[n[1]]||n[1],i))}}),Te("DocumentProperties",r.join(""),{xmlns:ii.o})}function xX(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&fn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<Va.length;++o)if(s==Va[o][1])return;for(o=0;o<oc.length;++o)if(s==oc[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(Te(GM(s),a,{"dt:dt":l}))}}),e&&fn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Te(GM(s),o,{"dt:dt":a}))}}),"<"+n+' xmlns="'+ii.o+'">'+i.join("")+"</"+n+">"}function SX(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=le(8);return o.write_shift(4,n),o.write_shift(4,i),o}function iF(t,e){var r=le(4),n=le(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=le(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=SX(e);break;case 31:case 80:for(n=le(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return ln([r,n])}var sD=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function CX(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function sF(t,e,r){var n=le(8),i=[],s=[],o=8,a=0,l=le(8),u=le(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),o+=8+l.length,!e){u=le(8),u.write_shift(4,0),i.unshift(u);var f=[le(4)];for(f[0].write_shift(4,t.length),a=0;a<t.length;++a){var d=t[a][0];for(l=le(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=ln(f),s.unshift(l),o+=8+l.length}for(a=0;a<t.length;++a)if(!(e&&!e[t[a][0]])&&!(sD.indexOf(t[a][0])>-1||rD.indexOf(t[a][0])>-1)&&t[a][1]!=null){var p=t[a][1],g=0;if(e){g=+e[t[a][0]];var x=r[g];if(x.p=="version"&&typeof p=="string"){var w=p.split(".");p=(+w[0]<<16)+(+w[1]||0)}l=iF(x.t,p)}else{var y=CX(p);y==-1&&(y=31,p=String(p)),l=iF(y,p)}s.push(l),u=le(8),u.write_shift(4,e?g:2+a),i.push(u),o+=8+l.length}var P=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,P),P+=s[a].length;return n.write_shift(4,o),n.write_shift(4,s.length),ln([n].concat(i).concat(s))}function oF(t,e,r,n,i,s){var o=le(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Pt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var l=sF(t,r,n);if(a.push(l),i){var u=sF(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(u)}return ln(a)}function yX(t,e){e||(e=le(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function _X(t,e){return t.read_shift(e)===1}function Rn(t,e){return e||(e=le(2)),e.write_shift(2,+!!t),e}function oD(t){return t.read_shift(2,"u")}function Ti(t,e){return e||(e=le(2)),e.write_shift(2,t),e}function aD(t,e,r){return r||(r=le(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function lD(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",s=Ba;if(r&&r.biff>=8&&(Ba=1200),!r||r.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return Ba=s,a}function EX(t){var e=t.t||"",r=1,n=le(3+(r>1?2:0));n.write_shift(2,e.length),n.write_shift(1,(r>1?8:0)|1),r>1&&n.write_shift(2,r);var i=le(2*e.length);i.write_shift(2*e.length,e,"utf16le");var s=[n,i];return ln(s)}function TX(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function bX(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):TX(t,n,r)}function RX(t,e,r){if(r.biff>5)return bX(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function cD(t,e,r){return r||(r=le(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function aF(t,e){e||(e=le(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function OX(t){var e=le(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),aF(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var a=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)e.write_shift(2,a.charCodeAt(r));e.write_shift(2,0),s&8&&aF(i>-1?n.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function ja(t,e,r,n){return n||(n=le(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function AX(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,s,o]}function IX(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function uD(t,e){return e||(e=le(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function J1(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=le(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function kX(t,e){var r=!e||e.biff==8,n=le(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function MX(t,e){var r=!e||e.biff>=8?2:1,n=le(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function FX(t,e){var r=le(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=EX(t[i],e);var s=ln([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function DX(){var t=le(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function PX(t){var e=le(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function NX(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=le(i);return s.write_shift(2,(t.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function HX(t,e,r,n){var i=le(10);return ja(t,e,n,i),i.write_shift(4,r),i}function LX(t,e,r,n,i){var s=!i||i.biff==8,o=le(8+ +s+(1+s)*r.length);return ja(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function BX(t,e,r,n){var i=r&&r.biff==5;n||(n=le(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function VX(t,e){var r=e.biff==8||!e.biff?4:2,n=le(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function lF(t,e,r,n){var i=r&&r.biff==5;n||(n=le(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function WX(t){var e=le(8);return e.write_shift(4,0),e.write_shift(2,t[0]?t[0]+1:0),e.write_shift(2,t[1]?t[1]+1:0),e}function UX(t,e,r,n,i,s){var o=le(8);return ja(t,e,n,o),aD(r,s,o),o}function jX(t,e,r,n){var i=le(14);return ja(t,e,n,i),Ua(r,i),i}function GX(t,e,r){if(r.biff<8)return zX(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(AX(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function zX(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=lD(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function YX(t){var e=le(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)uD(t[r],e);return e}function qX(t){var e=le(24),r=Gr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return ln([e,OX(t[1])])}function $X(t){var e=t[1].Tooltip,r=le(10+2*(e.length+1));r.write_shift(2,2048);var n=Gr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function XX(t){return t||(t=le(4)),t.write_shift(2,1),t.write_shift(2,1),t}function KX(t,e,r){if(!r.cellStyles)return bs(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),a=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function ZX(t,e){var r=le(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function JX(t){for(var e=le(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function QX(t,e,r){var n=le(15);return Cf(n,t,e),n.write_shift(8,r,"f"),n}function eK(t,e,r){var n=le(9);return Cf(n,t,e),n.write_shift(2,r),n}var tK=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=H1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var u=[],f=Wa(1);switch(l.type){case"base64":f=es(ro(a));break;case"binary":f=es(a);break;case"buffer":case"array":f=a;break}ni(f,0);var d=f.read_shift(1),p=!!(d&136),g=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:g=!0,p=!0;break;case 49:g=!0,p=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var w=0,y=521;d==2&&(w=f.read_shift(2)),f.l+=3,d!=2&&(w=f.read_shift(4)),w>1048576&&(w=1e6),d!=2&&(y=f.read_shift(2));var P=f.read_shift(2),N=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(N=t[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var B=[],F={},Q=Math.min(f.length,d==2?521:y-10-(g?264:0)),he=x?32:11;f.l<Q&&f[f.l]!=13;)switch(F={},F.name=Ht.utils.decode(N,f.slice(f.l,f.l+he)).replace(/[\u0000\r\n].*$/g,""),f.l+=he,F.type=String.fromCharCode(f.read_shift(1)),d!=2&&!x&&(F.offset=f.read_shift(4)),F.len=f.read_shift(1),d==2&&(F.offset=f.read_shift(2)),F.dec=f.read_shift(1),F.name.length&&B.push(F),d!=2&&(f.l+=x?13:14),F.type){case"B":(!g||F.len!=8)&&l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var U=0,X=0;for(u[0]=[],X=0;X!=B.length;++X)u[0][X]=B[X].name;for(;w-- >0;){if(f[f.l]===42){f.l+=P;continue}for(++f.l,u[++U]=[],X=0,X=0;X!=B.length;++X){var K=f.slice(f.l,f.l+B[X].len);f.l+=B[X].len,ni(K,0);var ne=Ht.utils.decode(N,K);switch(B[X].type){case"C":ne.trim().length&&(u[U][X]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?u[U][X]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):u[U][X]=ne;break;case"F":u[U][X]=parseFloat(ne.trim());break;case"+":case"I":u[U][X]=x?K.read_shift(-4,"i")^2147483648:K.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":u[U][X]=!0;break;case"N":case"F":u[U][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[U][X]="##MEMO##"+(x?parseInt(ne.trim(),10):K.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(u[U][X]=+ne||0);break;case"@":u[U][X]=new Date(K.read_shift(-8,"f")-621356832e5);break;case"T":u[U][X]=new Date((K.read_shift(4)-2440588)*864e5+K.read_shift(4));break;case"Y":u[U][X]=K.read_shift(4,"i")/1e4+K.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[U][X]=-K.read_shift(-8,"f");break;case"B":if(g&&B[X].len==8){u[U][X]=K.read_shift(8,"f");break}case"G":case"P":K.l+=B[X].len;break;case"0":if(B[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+B[X].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=B,u}function n(a,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=hc(r(a,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function i(a,l){try{return Ga(n(a,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var u=l||{};if(+u.codepage>=0&&ff(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Gn(),d=lm(a,{header:1,raw:!0,cellDates:!0}),p=d[0],g=d.slice(1),x=a["!cols"]||[],w=0,y=0,P=0,N=1;for(w=0;w<p.length;++w){if(((x[w]||{}).DBF||{}).name){p[w]=x[w].DBF.name,++P;continue}if(p[w]!=null){if(++P,typeof p[w]=="number"&&(p[w]=p[w].toString(10)),typeof p[w]!="string")throw new Error("DBF Invalid column name "+p[w]+" |"+typeof p[w]+"|");if(p.indexOf(p[w])!==w){for(y=0;y<1024;++y)if(p.indexOf(p[w]+"_"+y)==-1){p[w]+="_"+y;break}}}}var B=Gt(a["!ref"]),F=[],Q=[],he=[];for(w=0;w<=B.e.c-B.s.c;++w){var U="",X="",K=0,ne=[];for(y=0;y<g.length;++y)g[y][w]!=null&&ne.push(g[y][w]);if(ne.length==0||p[w]==null){F[w]="?";continue}for(y=0;y<ne.length;++y){switch(typeof ne[y]){case"number":X="B";break;case"string":X="C";break;case"boolean":X="L";break;case"object":X=ne[y]instanceof Date?"D":"C";break;default:X="C"}K=Math.max(K,String(ne[y]).length),U=U&&U!=X?"C":X}K>250&&(K=250),X=((x[w]||{}).DBF||{}).type,X=="C"&&x[w].DBF.len>K&&(K=x[w].DBF.len),U=="B"&&X=="N"&&(U="N",he[w]=x[w].DBF.dec,K=x[w].DBF.len),Q[w]=U=="C"||X=="N"?K:s[U]||0,N+=Q[w],F[w]=U}var ie=f.next(32);for(ie.write_shift(4,318902576),ie.write_shift(4,g.length),ie.write_shift(2,296+32*P),ie.write_shift(2,N),w=0;w<4;++w)ie.write_shift(4,0);for(ie.write_shift(4,0|(+e[lc]||3)<<8),w=0,y=0;w<p.length;++w)if(p[w]!=null){var te=f.next(32),Re=(p[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,Re,"sbcs"),te.write_shift(1,F[w]=="?"?"C":F[w],"sbcs"),te.write_shift(4,y),te.write_shift(1,Q[w]||s[F[w]]||0),te.write_shift(1,he[w]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),y+=Q[w]||s[F[w]]||0}var We=f.next(264);for(We.write_shift(4,13),w=0;w<65;++w)We.write_shift(4,0);for(w=0;w<g.length;++w){var ke=f.next(N);for(ke.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(F[y]){case"L":ke.write_shift(1,g[w][y]==null?63:g[w][y]?84:70);break;case"B":ke.write_shift(8,g[w][y]||0,"f");break;case"N":var wt="0";for(typeof g[w][y]=="number"&&(wt=g[w][y].toFixed(he[y]||0)),P=0;P<Q[y]-wt.length;++P)ke.write_shift(1,32);ke.write_shift(1,wt,"sbcs");break;case"D":g[w][y]?(ke.write_shift(4,("0000"+g[w][y].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(g[w][y].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+g[w][y].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var ut=String(g[w][y]!=null?g[w][y]:"").slice(0,Q[y]);for(ke.write_shift(1,ut,"sbcs"),P=0;P<Q[y]-ut.length;++P)ke.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),rK=function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+fn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,g){var x=t[g];return typeof x=="number"?MM(x):x},n=function(p,g,x){var w=g.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return w==59?p:MM(w)};t["|"]=254;function i(p,g){switch(g.type){case"base64":return s(ro(p),g);case"binary":return s(p,g);case"buffer":return s(Et&&Buffer.isBuffer(p)?p.toString("binary"):vf(p),g);case"array":return s(dm(p),g)}throw new Error("Unrecognized type "+g.type)}function s(p,g){var x=p.split(/[\n\r]+/),w=-1,y=-1,P=0,N=0,B=[],F=[],Q=null,he={},U=[],X=[],K=[],ne=0,ie;for(+g.codepage>=0&&ff(+g.codepage);P!==x.length;++P){ne=0;var te=x[P].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),Re=te.replace(/;;/g,"\0").split(";").map(function(m){return m.replace(/\u0000/g,";")}),We=Re[0],ke;if(te.length>0)switch(We){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Re[1].charAt(0)=="P"&&F.push(te.slice(3).replace(/;;/g,";"));break;case"C":var wt=!1,ut=!1,ze=!1,rt=!1,$e=-1,Ye=-1;for(N=1;N<Re.length;++N)switch(Re[N].charAt(0)){case"A":break;case"X":y=parseInt(Re[N].slice(1))-1,ut=!0;break;case"Y":for(w=parseInt(Re[N].slice(1))-1,ut||(y=0),ie=B.length;ie<=w;++ie)B[ie]=[];break;case"K":ke=Re[N].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(eo(ke))?isNaN(df(ke).getDate())||(ke=On(ke)):(ke=eo(ke),Q!==null&&AF(Q)&&(ke=FF(ke))),typeof Ht<"u"&&typeof ke=="string"&&(g||{}).type!="string"&&(g||{}).codepage&&(ke=Ht.utils.decode(g.codepage,ke)),wt=!0;break;case"E":rt=!0;var V=eZ(Re[N].slice(1),{r:w,c:y});B[w][y]=[B[w][y],V];break;case"S":ze=!0,B[w][y]=[B[w][y],"S5S"];break;case"G":break;case"R":$e=parseInt(Re[N].slice(1))-1;break;case"C":Ye=parseInt(Re[N].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+te)}if(wt&&(B[w][y]&&B[w][y].length==2?B[w][y][0]=ke:B[w][y]=ke,Q=null),ze){if(rt)throw new Error("SYLK shared formula cannot have own formula");var G=$e>-1&&B[$e][Ye];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");B[w][y][1]=tZ(G[1],{r:w-$e,c:y-Ye})}break;case"F":var z=0;for(N=1;N<Re.length;++N)switch(Re[N].charAt(0)){case"X":y=parseInt(Re[N].slice(1))-1,++z;break;case"Y":for(w=parseInt(Re[N].slice(1))-1,ie=B.length;ie<=w;++ie)B[ie]=[];break;case"M":ne=parseInt(Re[N].slice(1))/20;break;case"F":break;case"G":break;case"P":Q=F[parseInt(Re[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(K=Re[N].slice(1).split(" "),ie=parseInt(K[0],10);ie<=parseInt(K[1],10);++ie)ne=parseInt(K[2],10),X[ie-1]=ne===0?{hidden:!0}:{wch:ne},Q1(X[ie-1]);break;case"C":y=parseInt(Re[N].slice(1))-1,X[y]||(X[y]={});break;case"R":w=parseInt(Re[N].slice(1))-1,U[w]||(U[w]={}),ne>0?(U[w].hpt=ne,U[w].hpx=pD(ne)):ne===0&&(U[w].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+te)}z<1&&(Q=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+te)}}return U.length>0&&(he["!rows"]=U),X.length>0&&(he["!cols"]=X),g&&g.sheetRows&&(B=B.slice(0,g.sheetRows)),[B,he]}function o(p,g){var x=i(p,g),w=x[0],y=x[1],P=hc(w,g);return fn(y).forEach(function(N){P[N]=y[N]}),P}function a(p,g){return Ga(o(p,g),g)}function l(p,g,x,w){var y="C;Y"+(x+1)+";X"+(w+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+tS(p.f,{r:x,c:w}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(p,g){g.forEach(function(x,w){var y="F;W"+(w+1)+" "+(w+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=im(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=sm(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function f(p,g){g.forEach(function(x,w){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*om(x.hpx)+";"),y.length>2&&p.push(y+"R"+(w+1))})}function d(p,g){var x=["ID;PWXL;N;E"],w=[],y=Gt(p["!ref"]),P,N=Array.isArray(p),B=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),p["!cols"]&&u(x,p["!cols"]),p["!rows"]&&f(x,p["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var F=y.s.r;F<=y.e.r;++F)for(var Q=y.s.c;Q<=y.e.c;++Q){var he=Dt({r:F,c:Q});P=N?(p[F]||[])[Q]:p[he],!(!P||P.v==null&&(!P.f||P.F))&&w.push(l(P,p,F,Q,g))}return x.join(B)+B+w.join(B)+B+"E"+B}return{to_workbook:a,to_sheet:o,from_sheet:d}}(),nK=function(){function t(s,o){switch(o.type){case"base64":return e(ro(s),o);case"binary":return e(s,o);case"buffer":return e(Et&&Buffer.isBuffer(s)?s.toString("binary"):vf(s),o);case"array":return e(dm(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,u=-1,f=0,d=[];f!==a.length;++f){if(a[f].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var p=a[f].trim().split(","),g=p[0],x=p[1];++f;for(var w=a[f]||"";(w.match(/["]/g)||[]).length&1&&f<a.length-1;)w+=`
`+a[++f];switch(w=w.trim(),+g){case-1:if(w==="BOT"){d[++l]=[],u=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?d[l][u]=!0:w==="FALSE"?d[l][u]=!1:isNaN(eo(x))?isNaN(df(x).getDate())?d[l][u]=x:d[l][u]=On(x):d[l][u]=eo(x),++u;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),tf&&w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),d[l][u++]=w!==""?w:null;break}if(w==="EOD")break}}return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),d}function r(s,o){return hc(t(s,o),o)}function n(s,o){return Ga(r(s,o),o)}var i=function(){var s=function(l,u,f,d,p){l.push(u),l.push(f+","+d),l.push('"'+p.replace(/"/g,'""')+'"')},o=function(l,u,f,d){l.push(u+","+f),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],f=Gt(l["!ref"]),d,p=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var g=f.s.r;g<=f.e.r;++g){o(u,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var w=Dt({r:g,c:x});if(d=p?(l[g]||[])[x]:l[w],!d){o(u,1,0,"");continue}switch(d.t){case"n":var y=tf?d.w:d.v;!y&&d.v!=null&&(y=d.v),y==null?tf&&d.f&&!d.F?o(u,1,0,"="+d.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":o(u,1,0,!tf||isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Ko(d.z||cr[14],zn(On(d.v)))),tf?o(u,0,d.w,"V"):o(u,1,0,d.w);break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var P=`\r
`,N=u.join(P);return N}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),fD=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,p){for(var g=d.split(`
`),x=-1,w=-1,y=0,P=[];y!==g.length;++y){var N=g[y].trim().split(":");if(N[0]==="cell"){var B=Gr(N[1]);if(P.length<=B.r)for(x=P.length;x<=B.r;++x)P[x]||(P[x]=[]);switch(x=B.r,w=B.c,N[2]){case"t":P[x][w]=t(N[3]);break;case"v":P[x][w]=+N[3];break;case"vtf":var F=N[N.length-1];case"vtc":switch(N[3]){case"nl":P[x][w]=!!+N[4];break;default:P[x][w]=+N[4];break}N[2]=="vtf"&&(P[x][w]=[P[x][w],F])}}}return p&&p.sheetRows&&(P=P.slice(0,p.sheetRows)),P}function n(d,p){return hc(r(d,p),p)}function i(d,p){return Ga(n(d,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var p=[],g=[],x,w="",y=si(d["!ref"]),P=Array.isArray(d),N=y.s.r;N<=y.e.r;++N)for(var B=y.s.c;B<=y.e.c;++B)if(w=Dt({r:N,c:B}),x=P?(d[N]||[])[B]:d[w],!(!x||x.v==null||x.t==="z")){switch(g=["cell",w,"t"],x.t){case"s":case"str":g.push(e(x.v));break;case"n":x.f?(g[2]="vtf",g[3]="n",g[4]=x.v,g[5]=e(x.f)):(g[2]="v",g[3]=x.v);break;case"b":g[2]="vt"+(x.f?"f":"c"),g[3]="nl",g[4]=x.v?"1":"0",g[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var F=zn(On(x.v));g[2]="vtc",g[3]="nd",g[4]=""+F,g[5]=x.w||Ko(x.z||cr[14],F);break;case"e":continue}p.push(g.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(d){return[s,o,a,o,u(d),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),iK=function(){function t(f,d,p,g,x){x.raw?d[p][g]=f:f===""||(f==="TRUE"?d[p][g]=!0:f==="FALSE"?d[p][g]=!1:isNaN(eo(f))?isNaN(df(f).getDate())?d[p][g]=f:d[p][g]=On(f):d[p][g]=eo(f))}function e(f,d){var p=d||{},g=[];if(!f||f.length===0)return g;for(var x=f.split(/[\r\n]/),w=x.length-1;w>=0&&x[w].length===0;)--w;for(var y=10,P=0,N=0;N<=w;++N)P=x[N].indexOf(" "),P==-1?P=x[N].length:P++,y=Math.max(y,P);for(N=0;N<=w;++N){g[N]=[];var B=0;for(t(x[N].slice(0,y).trim(),g,N,B,p),B=1;B<=(x[N].length-y)/10+1;++B)t(x[N].slice(y+(B-1)*10,y+B*10).trim(),g,N,B,p)}return p.sheetRows&&(g=g.slice(0,p.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var d={},p=!1,g=0,x=0;g<f.length;++g)(x=f.charCodeAt(g))==34?p=!p:!p&&x in r&&(d[x]=(d[x]||0)+1);x=[];for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&x.push([d[g],g]);if(!x.length){d=n;for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&x.push([d[g],g])}return x.sort(function(w,y){return w[0]-y[0]||n[w[1]]-n[y[1]]}),r[x.pop()[1]]||44}function s(f,d){var p=d||{},g="";Ts!=null&&p.dense==null&&(p.dense=Ts);var x=p.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(g=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(g=f.charAt(4),f=f.slice(6)):g=i(f.slice(0,1024)):p&&p.FS?g=p.FS:g=i(f.slice(0,1024));var y=0,P=0,N=0,B=0,F=0,Q=g.charCodeAt(0),he=!1,U=0,X=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var K=p.dateNF!=null?x$(p.dateNF):null;function ne(){var ie=f.slice(B,F),te={};if(ie.charAt(0)=='"'&&ie.charAt(ie.length-1)=='"'&&(ie=ie.slice(1,-1).replace(/""/g,'"')),ie.length===0)te.t="z";else if(p.raw)te.t="s",te.v=ie;else if(ie.trim().length===0)te.t="s",te.v=ie;else if(ie.charCodeAt(0)==61)ie.charCodeAt(1)==34&&ie.charCodeAt(ie.length-1)==34?(te.t="s",te.v=ie.slice(2,-1).replace(/""/g,'"')):rZ(ie)?(te.t="n",te.f=ie.slice(1)):(te.t="s",te.v=ie);else if(ie=="TRUE")te.t="b",te.v=!0;else if(ie=="FALSE")te.t="b",te.v=!1;else if(!isNaN(N=eo(ie)))te.t="n",p.cellText!==!1&&(te.w=ie),te.v=N;else if(!isNaN(df(ie).getDate())||K&&ie.match(K)){te.z=p.dateNF||cr[14];var Re=0;K&&ie.match(K)&&(ie=S$(ie,p.dateNF,ie.match(K)||[]),Re=1),p.cellDates?(te.t="d",te.v=On(ie,Re)):(te.t="n",te.v=zn(On(ie,Re))),p.cellText!==!1&&(te.w=Ko(te.z,te.v instanceof Date?zn(te.v):te.v)),p.cellNF||delete te.z}else te.t="s",te.v=ie;if(te.t=="z"||(p.dense?(x[y]||(x[y]=[]),x[y][P]=te):x[Dt({c:P,r:y})]=te),B=F+1,X=f.charCodeAt(B),w.e.c<P&&(w.e.c=P),w.e.r<y&&(w.e.r=y),U==Q)++P;else if(P=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;F<f.length;++F)switch(U=f.charCodeAt(F)){case 34:X===34&&(he=!he);break;case Q:case 10:case 13:if(!he&&ne())break e;break;default:break}return F-B>0&&ne(),x["!ref"]=Or(w),x}function o(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):hc(e(f,d),d)}function a(f,d){var p="",g=d.type=="string"?[0,0,0,0]:gte(f,d);switch(d.type){case"base64":p=ro(f);break;case"binary":p=f;break;case"buffer":d.codepage==65001?p=f.toString("utf8"):d.codepage&&typeof Ht<"u"?p=Ht.utils.decode(d.codepage,f):p=Et&&Buffer.isBuffer(f)?f.toString("binary"):vf(f);break;case"array":p=dm(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+d.type)}return g[0]==239&&g[1]==187&&g[2]==191?p=sf(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=sf(p):d.type=="binary"&&typeof Ht<"u"&&d.codepage&&(p=Ht.utils.decode(d.codepage,Ht.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?fD.to_sheet(d.type=="string"?p:sf(p),d):o(p,d)}function l(f,d){return Ga(a(f,d),d)}function u(f){for(var d=[],p=Gt(f["!ref"]),g,x=Array.isArray(f),w=p.s.r;w<=p.e.r;++w){for(var y=[],P=p.s.c;P<=p.e.c;++P){var N=Dt({r:w,c:P});if(g=x?(f[w]||[])[P]:f[N],!g||g.v==null){y.push("          ");continue}for(var B=(g.w||(no(g),g.w)||"").slice(0,10);B.length<10;)B+=" ";y.push(B+(P===0?" ":""))}d.push(y.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:u}}();var cF=function(){function t(V,G,z){if(V){ni(V,V.l||0);for(var m=z.Enum||$e;V.l<V.length;){var S=V.read_shift(2),_=m[S]||m[65535],D=V.read_shift(2),L=V.l+D,H=_.f&&_.f(V,D,z);if(V.l=L,G(H,_,S))return}}}function e(V,G){switch(G.type){case"base64":return r(es(ro(V)),G);case"binary":return r(es(V),G);case"buffer":case"array":return r(V,G)}throw"Unsupported type "+G.type}function r(V,G){if(!V)return V;var z=G||{};Ts!=null&&z.dense==null&&(z.dense=Ts);var m=z.dense?[]:{},S="Sheet1",_="",D=0,L={},H=[],oe=[],fe={s:{r:0,c:0},e:{r:0,c:0}},Oe=z.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)z.Enum=$e,t(V,function(pe,He,Xe){switch(Xe){case 0:z.vers=pe,pe>=4096&&(z.qpro=!0);break;case 6:fe=pe;break;case 204:pe&&(_=pe);break;case 222:_=pe;break;case 15:case 51:z.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:Xe==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=z.dateNF||cr[14],z.cellDates&&(pe[1].t="d",pe[1].v=FF(pe[1].v))),z.qpro&&pe[3]>D&&(m["!ref"]=Or(fe),L[S]=m,H.push(S),m=z.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},D=pe[3],S=_||"Sheet"+(D+1),_="");var Tt=z.dense?(m[pe[0].r]||[])[pe[0].c]:m[Dt(pe[0])];if(Tt){Tt.t=pe[1].t,Tt.v=pe[1].v,pe[1].z!=null&&(Tt.z=pe[1].z),pe[1].f!=null&&(Tt.f=pe[1].f);break}z.dense?(m[pe[0].r]||(m[pe[0].r]=[]),m[pe[0].r][pe[0].c]=pe[1]):m[Dt(pe[0])]=pe[1];break;default:}},z);else if(V[2]==26||V[2]==14)z.Enum=Ye,V[2]==14&&(z.qpro=!0,V.l=0),t(V,function(pe,He,Xe){switch(Xe){case 204:S=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>D&&(m["!ref"]=Or(fe),L[S]=m,H.push(S),m=z.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},D=pe[3],S="Sheet"+(D+1)),Oe>0&&pe[0].r>=Oe)break;z.dense?(m[pe[0].r]||(m[pe[0].r]=[]),m[pe[0].r][pe[0].c]=pe[1]):m[Dt(pe[0])]=pe[1],fe.e.c<pe[0].c&&(fe.e.c=pe[0].c),fe.e.r<pe[0].r&&(fe.e.r=pe[0].r);break;case 27:pe[14e3]&&(oe[pe[14e3][0]]=pe[14e3][1]);break;case 1537:oe[pe[0]]=pe[1],pe[0]==D&&(S=pe[1]);break;default:break}},z);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(m["!ref"]=Or(fe),L[_||S]=m,H.push(_||S),!oe.length)return{SheetNames:H,Sheets:L};for(var ve={},ue=[],Ie=0;Ie<oe.length;++Ie)L[H[Ie]]?(ue.push(oe[Ie]||H[Ie]),ve[oe[Ie]]=L[oe[Ie]]||L[H[Ie]]):(ue.push(oe[Ie]),ve[oe[Ie]]={"!ref":"A1"});return{SheetNames:ue,Sheets:ve}}function n(V,G){var z=G||{};if(+z.codepage>=0&&ff(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var m=Gn(),S=Gt(V["!ref"]),_=Array.isArray(V),D=[];be(m,0,s(1030)),be(m,6,l(S));for(var L=Math.min(S.e.r,8191),H=S.s.r;H<=L;++H)for(var oe=un(H),fe=S.s.c;fe<=S.e.c;++fe){H===S.s.r&&(D[fe]=vn(fe));var Oe=D[fe]+oe,ve=_?(V[H]||[])[fe]:V[Oe];if(!(!ve||ve.t=="z"))if(ve.t=="n")(ve.v|0)==ve.v&&ve.v>=-32768&&ve.v<=32767?be(m,13,g(H,fe,ve.v)):be(m,14,w(H,fe,ve.v));else{var ue=no(ve);be(m,15,d(H,fe,ue.slice(0,239)))}}return be(m,1),m.end()}function i(V,G){var z=G||{};if(+z.codepage>=0&&ff(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var m=Gn();be(m,0,o(V));for(var S=0,_=0;S<V.SheetNames.length;++S)(V.Sheets[V.SheetNames[S]]||{})["!ref"]&&be(m,27,rt(V.SheetNames[S],_++));var D=0;for(S=0;S<V.SheetNames.length;++S){var L=V.Sheets[V.SheetNames[S]];if(!(!L||!L["!ref"])){for(var H=Gt(L["!ref"]),oe=Array.isArray(L),fe=[],Oe=Math.min(H.e.r,8191),ve=H.s.r;ve<=Oe;++ve)for(var ue=un(ve),Ie=H.s.c;Ie<=H.e.c;++Ie){ve===H.s.r&&(fe[Ie]=vn(Ie));var pe=fe[Ie]+ue,He=oe?(L[ve]||[])[Ie]:L[pe];if(!(!He||He.t=="z"))if(He.t=="n")be(m,23,ne(ve,Ie,D,He.v));else{var Xe=no(He);be(m,22,U(ve,Ie,D,Xe.slice(0,239)))}}++D}}return be(m,1),m.end()}function s(V){var G=le(2);return G.write_shift(2,V),G}function o(V){var G=le(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var z=0,m=0,S=0,_=0;_<V.SheetNames.length;++_){var D=V.SheetNames[_],L=V.Sheets[D];if(!(!L||!L["!ref"])){++S;var H=si(L["!ref"]);z<H.e.r&&(z=H.e.r),m<H.e.c&&(m=H.e.c)}}return z>8191&&(z=8191),G.write_shift(2,z),G.write_shift(1,S),G.write_shift(1,m),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function a(V,G,z){var m={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&z.qpro?(m.s.c=V.read_shift(1),V.l++,m.s.r=V.read_shift(2),m.e.c=V.read_shift(1),V.l++,m.e.r=V.read_shift(2),m):(m.s.c=V.read_shift(2),m.s.r=V.read_shift(2),G==12&&z.qpro&&(V.l+=2),m.e.c=V.read_shift(2),m.e.r=V.read_shift(2),G==12&&z.qpro&&(V.l+=2),m.s.c==65535&&(m.s.c=m.e.c=m.s.r=m.e.r=0),m)}function l(V){var G=le(8);return G.write_shift(2,V.s.c),G.write_shift(2,V.s.r),G.write_shift(2,V.e.c),G.write_shift(2,V.e.r),G}function u(V,G,z){var m=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(m[0].c=V.read_shift(1),m[3]=V.read_shift(1),m[0].r=V.read_shift(2),V.l+=2):(m[2]=V.read_shift(1),m[0].c=V.read_shift(2),m[0].r=V.read_shift(2)),m}function f(V,G,z){var m=V.l+G,S=u(V,G,z);if(S[1].t="s",z.vers==20768){V.l++;var _=V.read_shift(1);return S[1].v=V.read_shift(_,"utf8"),S}return z.qpro&&V.l++,S[1].v=V.read_shift(m-V.l,"cstr"),S}function d(V,G,z){var m=le(7+z.length);m.write_shift(1,255),m.write_shift(2,G),m.write_shift(2,V),m.write_shift(1,39);for(var S=0;S<m.length;++S){var _=z.charCodeAt(S);m.write_shift(1,_>=128?95:_)}return m.write_shift(1,0),m}function p(V,G,z){var m=u(V,G,z);return m[1].v=V.read_shift(2,"i"),m}function g(V,G,z){var m=le(7);return m.write_shift(1,255),m.write_shift(2,G),m.write_shift(2,V),m.write_shift(2,z,"i"),m}function x(V,G,z){var m=u(V,G,z);return m[1].v=V.read_shift(8,"f"),m}function w(V,G,z){var m=le(13);return m.write_shift(1,255),m.write_shift(2,G),m.write_shift(2,V),m.write_shift(8,z,"f"),m}function y(V,G,z){var m=V.l+G,S=u(V,G,z);if(S[1].v=V.read_shift(8,"f"),z.qpro)V.l=m;else{var _=V.read_shift(2);F(V.slice(V.l,V.l+_),S),V.l+=_}return S}function P(V,G,z){var m=G&32768;return G&=-32769,G=(m?V:0)+(G>=8192?G-16384:G),(m?"":"$")+(z?vn(G):un(G))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},B=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(V,G){ni(V,0);for(var z=[],m=0,S="",_="",D="",L="";V.l<V.length;){var H=V[V.l++];switch(H){case 0:z.push(V.read_shift(8,"f"));break;case 1:_=P(G[0].c,V.read_shift(2),!0),S=P(G[0].r,V.read_shift(2),!1),z.push(_+S);break;case 2:{var oe=P(G[0].c,V.read_shift(2),!0),fe=P(G[0].r,V.read_shift(2),!1);_=P(G[0].c,V.read_shift(2),!0),S=P(G[0].r,V.read_shift(2),!1),z.push(oe+fe+":"+_+S)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(V.read_shift(2));break;case 6:{for(var Oe="";H=V[V.l++];)Oe+=String.fromCharCode(H);z.push('"'+Oe.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:L=z.pop(),D=z.pop(),z.push(["AND","OR"][H-20]+"("+D+","+L+")");break;default:if(H<32&&B[H])L=z.pop(),D=z.pop(),z.push(D+B[H]+L);else if(N[H]){if(m=N[H][1],m==69&&(m=V[V.l++]),m>z.length){console.error("WK1 bad formula parse 0x"+H.toString(16)+":|"+z.join("|")+"|");return}var ve=z.slice(-m);z.length-=m,z.push(N[H][0]+"("+ve.join(",")+")")}else return H<=7?console.error("WK1 invalid opcode "+H.toString(16)):H<=24?console.error("WK1 unsupported op "+H.toString(16)):H<=30?console.error("WK1 invalid opcode "+H.toString(16)):H<=115?console.error("WK1 unsupported function opcode "+H.toString(16)):console.error("WK1 unrecognized opcode "+H.toString(16))}}z.length==1?G[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function Q(V){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=V.read_shift(2),G[3]=V[V.l++],G[0].c=V[V.l++],G}function he(V,G){var z=Q(V,G);return z[1].t="s",z[1].v=V.read_shift(G-4,"cstr"),z}function U(V,G,z,m){var S=le(6+m.length);S.write_shift(2,V),S.write_shift(1,z),S.write_shift(1,G),S.write_shift(1,39);for(var _=0;_<m.length;++_){var D=m.charCodeAt(_);S.write_shift(1,D>=128?95:D)}return S.write_shift(1,0),S}function X(V,G){var z=Q(V,G);z[1].v=V.read_shift(2);var m=z[1].v>>1;if(z[1].v&1)switch(m&7){case 0:m=(m>>3)*5e3;break;case 1:m=(m>>3)*500;break;case 2:m=(m>>3)/20;break;case 3:m=(m>>3)/200;break;case 4:m=(m>>3)/2e3;break;case 5:m=(m>>3)/2e4;break;case 6:m=(m>>3)/16;break;case 7:m=(m>>3)/64;break}return z[1].v=m,z}function K(V,G){var z=Q(V,G),m=V.read_shift(4),S=V.read_shift(4),_=V.read_shift(2);if(_==65535)return m===0&&S===3221225472?(z[1].t="e",z[1].v=15):m===0&&S===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var D=_&32768;return _=(_&32767)-16446,z[1].v=(1-D*2)*(S*Math.pow(2,_+32)+m*Math.pow(2,_)),z}function ne(V,G,z,m){var S=le(14);if(S.write_shift(2,V),S.write_shift(1,z),S.write_shift(1,G),m==0)return S.write_shift(4,0),S.write_shift(4,0),S.write_shift(2,65535),S;var _=0,D=0,L=0,H=0;return m<0&&(_=1,m=-m),D=Math.log2(m)|0,m/=Math.pow(2,D-31),H=m>>>0,(H&2147483648)==0&&(m/=2,++D,H=m>>>0),m-=H,H|=2147483648,H>>>=0,m*=Math.pow(2,32),L=m>>>0,S.write_shift(4,L),S.write_shift(4,H),D+=16383+(_?32768:0),S.write_shift(2,D),S}function ie(V,G){var z=K(V,14);return V.l+=G-14,z}function te(V,G){var z=Q(V,G),m=V.read_shift(4);return z[1].v=m>>6,z}function Re(V,G){var z=Q(V,G),m=V.read_shift(8,"f");return z[1].v=m,z}function We(V,G){var z=Re(V,14);return V.l+=G-10,z}function ke(V,G){return V[V.l+G-1]==0?V.read_shift(G,"cstr"):""}function wt(V,G){var z=V[V.l++];z>G-1&&(z=G-1);for(var m="";m.length<z;)m+=String.fromCharCode(V[V.l++]);return m}function ut(V,G,z){if(!(!z.qpro||G<21)){var m=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var S=V.read_shift(G-21,"cstr");return[m,S]}}function ze(V,G){for(var z={},m=V.l+G;V.l<m;){var S=V.read_shift(2);if(S==14e3){for(z[S]=[0,""],z[S][0]=V.read_shift(2);V[V.l];)z[S][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return z}function rt(V,G){var z=le(5+V.length);z.write_shift(2,14e3),z.write_shift(2,G);for(var m=0;m<V.length;++m){var S=V.charCodeAt(m);z[z.l++]=S>127?95:S}return z[z.l++]=0,z}var $e={0:{n:"BOF",f:oD},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:wt},65535:{n:""}},Ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:he},23:{n:"NUMBER17",f:K},24:{n:"NUMBER18",f:X},25:{n:"FORMULA19",f:ie},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ze},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:Re},40:{n:"FORMULA28",f:We},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ut},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();var sK=/^\s|\s$|[\t\n\r]/;function hD(t,e){if(!e.bookSST)return"";var r=[Ar];r[r.length]=Te("sst",null,{xmlns:uc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(sK)&&(s+=' xml:space="preserve"'),s+=">"+Ft(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function oK(t){return[t.read_shift(4),t.read_shift(4)]}function aK(t,e){return e||(e=le(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var lK=J$;function cK(t){var e=Gn();ge(e,159,aK(t));for(var r=0;r<t.length;++r)ge(e,19,lK(t[r]));return ge(e,160),e.end()}function uK(t){if(typeof Ht<"u")return Ht.utils.encode(lc,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function dD(t){var e=0,r,n=uK(t),i=n.length+1,s,o,a,l,u;for(r=Wa(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],a=(e&16384)===0?0:1,l=e<<1&32767,u=a|l,e=u^o;return e^52811}var fK=function(){function t(i,s){switch(s.type){case"base64":return e(ro(i),s);case"binary":return e(i,s);case"buffer":return e(Et&&Buffer.isBuffer(i)?i.toString("binary"):vf(i),s);case"array":return e(dm(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(a)&&(a[d]=[]);for(var p=/\\\w+\b/g,g=0,x,w=-1;x=p.exec(f);){switch(x[0]){case"\\cell":var y=f.slice(g,p.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++w,y.length){var P={v:y,t:"s"};Array.isArray(a)?a[d][w]=P:a[Dt({r:d,c:w})]=P}break}g=p.lastIndex}w>u.e.c&&(u.e.c=w)}),a["!ref"]=Or(u),a}function r(i,s){return Ga(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Gt(i["!ref"]),a,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=o.s.c;f<=o.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=o.s.c;f<=o.e.c;++f){var d=Dt({r:u,c:f});a=l?(i[u]||[])[f]:i[d],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(no(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function uF(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var hK=6;var to=hK;function im(t){return Math.floor((t+Math.round(128/to)/256)*to)}function sm(t){return Math.floor((t-5)/to*100+.5)/100}function D1(t){return Math.round((t*to+5)/to*256)/256}function Q1(t){t.width?(t.wpx=im(t.width),t.wch=sm(t.wpx),t.MDW=to):t.wpx?(t.wch=sm(t.wpx),t.width=D1(t.wch),t.MDW=to):typeof t.wch=="number"&&(t.width=D1(t.wch),t.wpx=im(t.width),t.MDW=to),t.customWidth&&delete t.customWidth}var dK=96,mD=dK;function om(t){return t*96/mD}function pD(t){return t*mD/96}function mK(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Te("numFmt",null,{numFmtId:n,formatCode:Ft(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Te("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function pK(t){var e=[];return e[e.length]=Te("cellXfs",null),t.forEach(function(r){e[e.length]=Te("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Te("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function gD(t,e){var r=[Ar,Te("styleSheet",null,{xmlns:uc[0],"xmlns:vt":jr.vt})],n;return t.SSF&&(n=mK(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=pK(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function gK(t,e){var r=t.read_shift(2),n=wn(t,e-2);return[r,n]}function vK(t,e,r){r||(r=le(6+4*e.length)),r.write_shift(2,t),zr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function wK(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=sX(t,2,r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var a=t.read_shift(1);a>0&&(n.family=a);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=iX(t,8),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=wn(t,e-21),n}function xK(t,e){e||(e=le(25+4*32)),e.write_shift(2,t.sz*20),oX(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),rm(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),zr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var SK=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],R1,CK=bs;function fF(t,e){e||(e=le(4*3+8*7+16*1)),R1||(R1=H1(SK));var r=R1[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(rm({auto:1},e),rm({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function yK(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function vD(t,e,r){r||(r=le(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function rf(t,e){return e||(e=le(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var _K=bs;function EK(t,e){return e||(e=le(51)),e.write_shift(1,0),rf(null,e),rf(null,e),rf(null,e),rf(null,e),rf(null,e),e.length>e.l?e.slice(0,e.l):e}function TK(t,e){return e||(e=le(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),tm(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function bK(t,e,r){var n=le(2052);return n.write_shift(4,t),tm(e,n),tm(r,n),n.length>n.l?n.slice(0,n.l):n}function RK(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ge(t,615,rs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ge(t,44,vK(i,e[i]))}),ge(t,616))}}function OK(t){var e=1;e!=0&&(ge(t,611,rs(e)),ge(t,43,xK({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ge(t,612))}function AK(t){var e=2;e!=0&&(ge(t,603,rs(e)),ge(t,45,fF({patternType:"none"})),ge(t,45,fF({patternType:"gray125"})),ge(t,604))}function IK(t){var e=1;e!=0&&(ge(t,613,rs(e)),ge(t,46,EK({})),ge(t,614))}function kK(t){var e=1;ge(t,626,rs(e)),ge(t,47,vD({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ge(t,627)}function MK(t,e){ge(t,617,rs(e.length)),e.forEach(function(r){ge(t,47,vD(r,0))}),ge(t,618)}function FK(t){var e=1;ge(t,619,rs(e)),ge(t,48,TK({xfId:0,builtinId:0,name:"Normal"})),ge(t,620)}function DK(t){var e=0;ge(t,505,rs(e)),ge(t,506)}function PK(t){var e=0;ge(t,508,bK(e,"TableStyleMedium9","PivotStyleMedium4")),ge(t,509)}function NK(t,e){var r=Gn();return ge(r,278),RK(r,t.SSF),OK(r,t),AK(r,t),IK(r,t),kK(r,t),MK(r,e.cellXfs),FK(r,t),DK(r,t),PK(r,t),ge(r,279),r.end()}function wD(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Ar];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function HK(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:wn(t,e-8)}}function LK(t){var e=le(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),zr(t.name,e),e.slice(0,e.l)}function BK(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function VK(t){var e=le(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function WK(t,e){var r=le(8+2*e.length);return r.write_shift(4,t),zr(e,r),r.slice(0,r.l)}function UK(t){return t.l+=4,t.read_shift(4)!=0}function jK(t,e){var r=le(8);return r.write_shift(4,t),r.write_shift(4,e?1:0),r}function GK(){var t=Gn();return ge(t,332),ge(t,334,rs(1)),ge(t,335,LK({name:"XLDAPR",version:12e4,flags:3496657072})),ge(t,336),ge(t,339,WK(1,"XLDAPR")),ge(t,52),ge(t,35,rs(514)),ge(t,4096,rs(0)),ge(t,4097,Ti(1)),ge(t,36),ge(t,53),ge(t,340),ge(t,337,jK(1,!0)),ge(t,51,VK([[1,0]])),ge(t,338),ge(t,333),t.end()}function xD(){var t=[Ar];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function zK(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Dt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var rc=1024;function SD(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Te("xml",null,{"xmlns:v":ii.v,"xmlns:o":ii.o,"xmlns:x":ii.x,"xmlns:mv":ii.mv}).replace(/\/>/,">"),Te("o:shapelayout",Te("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Te("v:shapetype",[Te("v:stroke",null,{joinstyle:"miter"}),Te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];rc<t*1e3;)rc+=1e3;return e.forEach(function(s){var o=Gr(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?Te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Te("v:fill",l,a),f={on:"t",obscured:"t"};++rc,i=i.concat(["<v:shape"+mf({id:"_x0000_s"+rc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Te("v:shadow",null,f),Te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",cn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),cn("x:AutoFill","False"),cn("x:Row",String(o.r)),cn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function CD(t){var e=[Ar,Te("comments",null,{xmlns:uc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Ft(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Ft(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(cn("t",Ft(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;e.push(cn("t",Ft(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function YK(t,e,r){var n=[Ar,Te("ThreadedComments",null,{xmlns:jr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Te("threadedComment",cn("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function qK(t){var e=[Ar,Te("personList",null,{xmlns:jr.TCMNT,"xmlns:x":uc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Te("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function $K(t){var e={};e.iauthor=t.read_shift(4);var r=$a(t,16);return e.rfx=r.s,e.ref=Dt(r.s),t.l+=16,e}function XK(t,e){return e==null&&(e=le(36)),e.write_shift(4,t[1].iauthor),dc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var KK=wn;function ZK(t){return zr(t.slice(0,54))}function JK(t){var e=Gn(),r=[];return ge(e,628),ge(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ge(e,632,ZK(i.a)))})}),ge(e,631),ge(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Gr(n[0]),e:Gr(n[0])};ge(e,635,XK([s,i])),i.t&&i.t.length>0&&ge(e,637,eX(i)),ge(e,636),delete i.iauthor})}),ge(e,634),ge(e,629),e.end()}function QK(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Pt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var yD=["xlsb","xlsm","xlam","biff8","xla"];var eZ=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=o.length>0?parseInt(o,10)|0:0;return a?f+=e.c:--f,l?u+=e.r:--u,i+(a?"":"$")+vn(f)+(l?"":"$")+un(u)}return function(i,s){return e=s,i.replace(t,r)}}(),eS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tS=function(){return function(e,r){return e.replace(eS,function(n,i,s,o,a,l){var u=$1(o)-(s?0:r.c),f=q1(l)-(a?0:r.r),d=f==0?"":a?f+1:"["+f+"]",p=u==0?"":s?u+1:"["+u+"]";return i+"R"+d+"C"+p})}}();function tZ(t,e){return t.replace(eS,function(r,n,i,s,o,a){return n+(i=="$"?i+s:vn($1(s)+e.c))+(o=="$"?o+a:un(q1(a)+e.r))})}function rZ(t){return t.length!=1}function Rr(t){t.l+=1}function Zo(t,e){var r=t.read_shift(e==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function _D(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ED(t,e,r);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),o=Zo(t,2),a=Zo(t,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function ED(t){var e=Zo(t,2),r=Zo(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function nZ(t,e,r){if(r.biff<8)return ED(t,e,r);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Zo(t,2),o=Zo(t,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function TD(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return iZ(t,e,r);var n=t.read_shift(r&&r.biff==12?4:2),i=Zo(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function iZ(t){var e=Zo(t,2),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function sZ(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function oZ(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return aZ(t,e,r);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function aZ(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function lZ(t,e,r){var n=(t[t.l++]&96)>>5,i=_D(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function cZ(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=_D(t,s,r);return[n,i,o]}function uZ(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function fZ(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function hZ(t,e,r){var n=(t[t.l++]&96)>>5,i=nZ(t,e-1,r);return[n,i]}function dZ(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function hF(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function mZ(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function pZ(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function gZ(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function vZ(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function wZ(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function bD(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function xZ(t){return t.read_shift(2),bD(t,2)}function SZ(t){return t.read_shift(2),bD(t,2)}function CZ(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=TD(t,0,r);return[n,i]}function yZ(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=oZ(t,0,r);return[n,i]}function _Z(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=TD(t,0,r);return[n,i,s]}function EZ(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[EJ[i],AD[i],n]}function TZ(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:bZ(t);return[i,(s[0]===0?AD:_J)[s[1]]]}function bZ(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function RZ(t,e,r){t.l+=r&&r.biff==2?3:4}function OZ(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function AZ(t){return t.l++,xf[t.read_shift(1)]}function IZ(t){return t.l++,t.read_shift(2)}function kZ(t){return t.l++,t.read_shift(1)!==0}function MZ(t){return t.l++,mc(t,8)}function FZ(t,e,r){return t.l++,lD(t,e-1,r)}function DZ(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=_X(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=xf[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=mc(t,8);break;case 2:r[1]=RX(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function PZ(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?$a:IX)(t,8));return i}function NZ(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=DZ(t,r.biff);return o}function HZ(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function LZ(t,e,r){if(r.biff==5)return BZ(t,e,r);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function BZ(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function VZ(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function WZ(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function UZ(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function jZ(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var GZ=bs,zZ=bs,YZ=bs;function Sf(t,e,r){return t.l+=2,[sZ(t,4,r)]}function rS(t){return t.l+=6,[]}var qZ=Sf,$Z=rS,XZ=rS,KZ=Sf;function RD(t){return t.l+=2,[oD(t),t.read_shift(2)&1]}var ZZ=Sf,JZ=RD,QZ=rS,eJ=Sf,tJ=Sf,rJ=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function nJ(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=rJ[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:s}}function iJ(t){return t.l+=2,[t.read_shift(4)]}function sJ(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function oJ(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function aJ(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function lJ(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function cJ(t){return t.l+=4,[0,0]}var dF={1:{n:"PtgExp",f:OZ},2:{n:"PtgTbl",f:YZ},3:{n:"PtgAdd",f:Rr},4:{n:"PtgSub",f:Rr},5:{n:"PtgMul",f:Rr},6:{n:"PtgDiv",f:Rr},7:{n:"PtgPower",f:Rr},8:{n:"PtgConcat",f:Rr},9:{n:"PtgLt",f:Rr},10:{n:"PtgLe",f:Rr},11:{n:"PtgEq",f:Rr},12:{n:"PtgGe",f:Rr},13:{n:"PtgGt",f:Rr},14:{n:"PtgNe",f:Rr},15:{n:"PtgIsect",f:Rr},16:{n:"PtgUnion",f:Rr},17:{n:"PtgRange",f:Rr},18:{n:"PtgUplus",f:Rr},19:{n:"PtgUminus",f:Rr},20:{n:"PtgPercent",f:Rr},21:{n:"PtgParen",f:Rr},22:{n:"PtgMissArg",f:Rr},23:{n:"PtgStr",f:FZ},26:{n:"PtgSheet",f:sJ},27:{n:"PtgEndSheet",f:oJ},28:{n:"PtgErr",f:AZ},29:{n:"PtgBool",f:kZ},30:{n:"PtgInt",f:IZ},31:{n:"PtgNum",f:MZ},32:{n:"PtgArray",f:dZ},33:{n:"PtgFunc",f:EZ},34:{n:"PtgFuncVar",f:TZ},35:{n:"PtgName",f:HZ},36:{n:"PtgRef",f:CZ},37:{n:"PtgArea",f:lZ},38:{n:"PtgMemArea",f:VZ},39:{n:"PtgMemErr",f:GZ},40:{n:"PtgMemNoMem",f:zZ},41:{n:"PtgMemFunc",f:WZ},42:{n:"PtgRefErr",f:UZ},43:{n:"PtgAreaErr",f:uZ},44:{n:"PtgRefN",f:yZ},45:{n:"PtgAreaN",f:hZ},46:{n:"PtgMemAreaN",f:aJ},47:{n:"PtgMemNoMemN",f:lJ},57:{n:"PtgNameX",f:LZ},58:{n:"PtgRef3d",f:_Z},59:{n:"PtgArea3d",f:cZ},60:{n:"PtgRefErr3d",f:jZ},61:{n:"PtgAreaErr3d",f:fZ},255:{}},uJ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},fJ={1:{n:"PtgElfLel",f:RD},2:{n:"PtgElfRw",f:eJ},3:{n:"PtgElfCol",f:qZ},6:{n:"PtgElfRwV",f:tJ},7:{n:"PtgElfColV",f:KZ},10:{n:"PtgElfRadical",f:ZZ},11:{n:"PtgElfRadicalS",f:QZ},13:{n:"PtgElfColS",f:$Z},15:{n:"PtgElfColSV",f:XZ},16:{n:"PtgElfRadicalLel",f:JZ},25:{n:"PtgList",f:nJ},29:{n:"PtgSxName",f:iJ},255:{}},hJ={0:{n:"PtgAttrNoop",f:cJ},1:{n:"PtgAttrSemi",f:wZ},2:{n:"PtgAttrIf",f:gZ},4:{n:"PtgAttrChoose",f:mZ},8:{n:"PtgAttrGoto",f:pZ},16:{n:"PtgAttrSum",f:RZ},32:{n:"PtgAttrBaxcel",f:hF},33:{n:"PtgAttrBaxcel",f:hF},64:{n:"PtgAttrSpace",f:xZ},65:{n:"PtgAttrSpaceSemi",f:SZ},128:{n:"PtgAttrIfError",f:vZ},255:{}};function dJ(t,e,r,n){if(n.biff<8)return bs(t,e);for(var i=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=NZ(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=PZ(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0];default:break}return e=i-t.l,e!==0&&s.push(bs(t,e)),s}function mJ(t,e,r){for(var n=t.l+e,i,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],i=dF[s]||dF[uJ[s]],(s===24||s===25)&&(i=(s===24?fJ:hJ)[t[t.l+1]]),!i||!i.f?bs(t,e):o.push([i.n,i.f(t,e,r)]);return o}function pJ(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var gJ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vJ(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function OD(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function mF(t,e,r){var n=OD(t,e,r);return n=="#REF"?n:vJ(n,r)}function cc(t,e,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},a=[],l,u,f,d=0,p=0,g,x="";if(!t[0]||!t[0][0])return"";for(var w=-1,y="",P=0,N=t[0].length;P<N;++P){var B=t[0][P];switch(B[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),u=a.pop(),w>=0){switch(t[0][w][1][0]){case 0:y=lr(" ",t[0][w][1][1]);break;case 1:y=lr("\r",t[0][w][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}u=u+y,w=-1}a.push(u+gJ[B[0]]+l);break;case"PtgIsect":l=a.pop(),u=a.pop(),a.push(u+" "+l);break;case"PtgUnion":l=a.pop(),u=a.pop(),a.push(u+","+l);break;case"PtgRange":l=a.pop(),u=a.pop(),a.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=af(B[1][1],o,i),a.push(lf(f,s));break;case"PtgRefN":f=r?af(B[1][1],r,i):B[1][1],a.push(lf(f,s));break;case"PtgRef3d":d=B[1][1],f=af(B[1][2],o,i),x=mF(n,d,i);var F=x;a.push(x+"!"+lf(f,s));break;case"PtgFunc":case"PtgFuncVar":var Q=B[1][0],he=B[1][1];Q||(Q=0),Q&=127;var U=Q==0?[]:a.slice(-Q);a.length-=Q,he==="User"&&(he=U.shift()),a.push(he+"("+U.join(",")+")");break;case"PtgBool":a.push(B[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(B[1]);break;case"PtgNum":a.push(String(B[1]));break;case"PtgStr":a.push('"'+B[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(B[1]);break;case"PtgAreaN":g=JM(B[1][1],r?{s:r}:o,i),a.push(T1(g,i));break;case"PtgArea":g=JM(B[1][1],o,i),a.push(T1(g,i));break;case"PtgArea3d":d=B[1][1],g=B[1][2],x=mF(n,d,i),a.push(x+"!"+T1(g,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=B[1][2];var X=(n.names||[])[p-1]||(n[0]||[])[p],K=X?X.Name:"SH33TJSNAME"+String(p);K&&K.slice(0,6)=="_xlfn."&&!i.xlfn&&(K=K.slice(6)),a.push(K);break;case"PtgNameX":var ne=B[1][1];p=B[1][2];var ie;if(i.biff<=5)ne<0&&(ne=-ne),n[ne]&&(ie=n[ne][p]);else{var te="";if(((n[ne]||[])[0]||[])[0]==14849||(((n[ne]||[])[0]||[])[0]==1025?n[ne][p]&&n[ne][p].itab>0&&(te=n.SheetNames[n[ne][p].itab-1]+"!"):te=n.SheetNames[p-1]+"!"),n[ne]&&n[ne][p])te+=n[ne][p].Name;else if(n[0]&&n[0][p])te+=n[0][p].Name;else{var Re=(OD(n,ne,i)||"").split(";;");Re[p-1]?te=Re[p-1]:te+="SH33TJSERRX"}a.push(te);break}ie||(ie={Name:"SH33TJSERRY"}),a.push(ie.Name);break;case"PtgParen":var We="(",ke=")";if(w>=0){switch(y="",t[0][w][1][0]){case 2:We=lr(" ",t[0][w][1][1])+We;break;case 3:We=lr("\r",t[0][w][1][1])+We;break;case 4:ke=lr(" ",t[0][w][1][1])+ke;break;case 5:ke=lr("\r",t[0][w][1][1])+ke;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}a.push(We+a.pop()+ke);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":f={c:B[1][1],r:B[1][0]};var wt={c:r.c,r:r.r};if(n.sharedf[Dt(f)]){var ut=n.sharedf[Dt(f)];a.push(cc(ut,o,wt,n,i))}else{var ze=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){a.push(cc(u[1],o,wt,n,i)),ze=!0;break}ze||a.push(B[1])}break;case"PtgArray":a.push("{"+pJ(B[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=P;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+B[1].idx+"[#"+B[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(B));default:throw new Error("Unrecognized Formula Token: "+String(B))}var rt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&w>=0&&rt.indexOf(t[0][P][0])==-1){B=t[0][w];var $e=!0;switch(B[1][0]){case 4:$e=!1;case 0:y=lr(" ",B[1][1]);break;case 5:$e=!1;case 1:y=lr("\r",B[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+B[1][0])}a.push(($e?y:"")+a.pop()+($e?"":y)),w=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function wJ(t){if(t==null){var e=le(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ua(t);return Ua(0)}function xJ(t,e,r,n,i){var s=ja(e,r,i),o=wJ(t.v),a=le(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var u=le(t.bf.length),f=0;f<t.bf.length;++f)u[f]=t.bf[f];var d=ln([s,o,a,u]);return d}function pm(t,e,r){var n=t.read_shift(4),i=mJ(t,n,r),s=t.read_shift(4),o=s>0?dJ(t,s,i,r):null;return[i,o]}var SJ=pm,gm=pm,CJ=pm,yJ=pm,_J={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},AD={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},EJ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function TJ(t){var e="of:="+t.replace(eS,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function bJ(t){return t.replace(/\./,"!")}var cf=typeof Map<"u";function nS(t,e,r){var n=0,i=t.length;if(r){if(cf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=cf?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(cf?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function vm(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(to=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=sm(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=D1(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function ID(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Qo(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){IF(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function RJ(t,e,r){if(t&&t["!ref"]){var n=Gt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function OJ(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Or(t[r])+'"/>';return e+"</mergeCells>"}function AJ(t,e,r,n,i){var s=!1,o={},a=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,o.codeName=Js(Ft(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),a=(a||"")+Te("outlinePr",null,u)}!s&&!a||(i[i.length]=Te("sheetPr",a,o))}var IJ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],kJ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function MJ(t){var e={sheet:1};return IJ.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),kJ.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=dD(t.password).toString(16).toUpperCase()),Te("sheetProtection",null,e)}function FJ(t){return ID(t),Te("pageMargins",null,t)}function DJ(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Te("col",null,vm(i,n)));return r[r.length]="</cols>",r.join("")}function PJ(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Or(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=si(i);o.s.r==o.e.r&&(o.e.r=si(e["!ref"]).e.r,i=Or(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Te("autoFilter",null,{ref:i})}function NJ(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Te("sheetViews",Te("sheetView",null,i),{})}function HJ(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=xf[t.v];break;case"d":n&&n.cellDates?i=On(t.v,-1).toISOString():(t=Yn(t),t.t="n",i=""+(t.v=zn(On(t.v)))),typeof t.z>"u"&&(t.z=cr[14]);break;default:i=t.v;break}var a=cn("v",Ft(i)),l={r:e},u=Qo(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){a=cn("v",""+nS(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;a=Te("f",Ft(t.f),f)+(t.v!=null?a:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Te("c",a,l)}function LJ(t,e,r,n){var i=[],s=[],o=Gt(t["!ref"]),a="",l,u="",f=[],d=0,p=0,g=t["!rows"],x=Array.isArray(t),w={r:u},y,P=-1;for(p=o.s.c;p<=o.e.c;++p)f[p]=vn(p);for(d=o.s.r;d<=o.e.r;++d){for(s=[],u=un(d),p=o.s.c;p<=o.e.c;++p){l=f[p]+u;var N=x?(t[d]||[])[p]:t[l];N!==void 0&&(a=HJ(N,l,t,e,r,n))!=null&&s.push(a)}(s.length>0||g&&g[d])&&(w={r:u},g&&g[d]&&(y=g[d],y.hidden&&(w.hidden=1),P=-1,y.hpx?P=om(y.hpx):y.hpt&&(P=y.hpt),P>-1&&(w.ht=P,w.customHeight=1),y.level&&(w.outlineLevel=y.level)),i[i.length]=Te("row",s.join(""),w))}if(g)for(;d<g.length;++d)g&&g[d]&&(w={r:d+1},y=g[d],y.hidden&&(w.hidden=1),P=-1,y.hpx?P=om(y.hpx):y.hpt&&(P=y.hpt),P>-1&&(w.ht=P,w.customHeight=1),y.level&&(w.outlineLevel=y.level),i[i.length]=Te("row","",w));return i.join("")}function kD(t,e,r,n){var i=[Ar,Te("worksheet",null,{xmlns:uc[0],"xmlns:r":jr.r})],s=r.SheetNames[t],o=0,a="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=Gt(u);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Or(f)}n||(n={}),l["!comments"]=[];var d=[];AJ(l,r,t,e,i),i[i.length]=Te("dimension",null,{ref:u}),i[i.length]=NJ(l,e,t,r),e.sheetFormat&&(i[i.length]=Te("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=DJ(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=LJ(l,e,t,r,n),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=MJ(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=PJ(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=OJ(l["!merges"]));var p=-1,g,x=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(w){w[1].Target&&(g={ref:w[0]},w[1].Target.charAt(0)!="#"&&(x=Mt(n,-1,Ft(w[1].Target).replace(/#.*$/,""),Ct.HLINK),g["r:id"]="rId"+x),(p=w[1].Target.indexOf("#"))>-1&&(g.location=Ft(w[1].Target.slice(p+1))),w[1].Tooltip&&(g.tooltip=Ft(w[1].Tooltip)),i[i.length]=Te("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=FJ(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=cn("ignoredErrors",Te("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(x=Mt(n,-1,"../drawings/drawing"+(t+1)+".xml",Ct.DRAW),i[i.length]=Te("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=d),l["!comments"].length>0&&(x=Mt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ct.VML),i[i.length]=Te("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function BJ(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function VJ(t,e,r){var n=le(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=om(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var a=0,l=n.l;n.l+=4;for(var u={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var d=-1,p=-1,g=f<<10;g<f+1<<10;++g){u.c=g;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Dt(u)];x&&(d<0&&(d=g),p=g)}d<0||(++a,n.write_shift(4,d),n.write_shift(4,p))}var w=n.l;return n.l=l,n.write_shift(4,a),n.l=w,n.length>n.l?n.slice(0,n.l):n}function WJ(t,e,r,n){var i=VJ(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ge(t,0,i)}var UJ=$a,jJ=dc;function GJ(){}function zJ(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=tX(t,e-19),r}function YJ(t,e,r){r==null&&(r=le(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return rm({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),YF(t,r),r.slice(0,r.l)}function qJ(t){var e=bi(t);return[e]}function $J(t,e,r){return r==null&&(r=le(8)),za(e,r)}function XJ(t){var e=Ya(t);return[e]}function KJ(t,e,r){return r==null&&(r=le(4)),qa(e,r)}function ZJ(t){var e=bi(t),r=t.read_shift(1);return[e,r,"b"]}function JJ(t,e,r){return r==null&&(r=le(9)),za(e,r),r.write_shift(1,t.v?1:0),r}function QJ(t){var e=Ya(t),r=t.read_shift(1);return[e,r,"b"]}function eQ(t,e,r){return r==null&&(r=le(5)),qa(e,r),r.write_shift(1,t.v?1:0),r}function tQ(t){var e=bi(t),r=t.read_shift(1);return[e,r,"e"]}function rQ(t,e,r){return r==null&&(r=le(9)),za(e,r),r.write_shift(1,t.v),r}function nQ(t){var e=Ya(t),r=t.read_shift(1);return[e,r,"e"]}function iQ(t,e,r){return r==null&&(r=le(8)),qa(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function sQ(t){var e=bi(t),r=t.read_shift(4);return[e,r,"s"]}function oQ(t,e,r){return r==null&&(r=le(12)),za(e,r),r.write_shift(4,e.v),r}function aQ(t){var e=Ya(t),r=t.read_shift(4);return[e,r,"s"]}function lQ(t,e,r){return r==null&&(r=le(8)),qa(e,r),r.write_shift(4,e.v),r}function cQ(t){var e=bi(t),r=mc(t);return[e,r,"n"]}function uQ(t,e,r){return r==null&&(r=le(16)),za(e,r),Ua(t.v,r),r}function fQ(t){var e=Ya(t),r=mc(t);return[e,r,"n"]}function hQ(t,e,r){return r==null&&(r=le(12)),qa(e,r),Ua(t.v,r),r}function dQ(t){var e=bi(t),r=qF(t);return[e,r,"n"]}function mQ(t,e,r){return r==null&&(r=le(12)),za(e,r),$F(t.v,r),r}function pQ(t){var e=Ya(t),r=qF(t);return[e,r,"n"]}function gQ(t,e,r){return r==null&&(r=le(8)),qa(e,r),$F(t.v,r),r}function vQ(t){var e=bi(t),r=X1(t);return[e,r,"is"]}function wQ(t){var e=bi(t),r=wn(t);return[e,r,"str"]}function xQ(t,e,r){return r==null&&(r=le(12+4*t.v.length)),za(e,r),zr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function SQ(t){var e=Ya(t),r=wn(t);return[e,r,"str"]}function CQ(t,e,r){return r==null&&(r=le(8+4*t.v.length)),qa(e,r),zr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function yQ(t,e,r){var n=t.l+e,i=bi(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(r.cellFormula){t.l+=2;var a=gm(t,n-t.l,r);o[3]=cc(a,null,i,r.supbooks,r)}else t.l=n;return o}function _Q(t,e,r){var n=t.l+e,i=bi(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(r.cellFormula){t.l+=2;var a=gm(t,n-t.l,r);o[3]=cc(a,null,i,r.supbooks,r)}else t.l=n;return o}function EQ(t,e,r){var n=t.l+e,i=bi(t);i.r=r["!row"];var s=mc(t),o=[i,s,"n"];if(r.cellFormula){t.l+=2;var a=gm(t,n-t.l,r);o[3]=cc(a,null,i,r.supbooks,r)}else t.l=n;return o}function TQ(t,e,r){var n=t.l+e,i=bi(t);i.r=r["!row"];var s=wn(t),o=[i,s,"str"];if(r.cellFormula){t.l+=2;var a=gm(t,n-t.l,r);o[3]=cc(a,null,i,r.supbooks,r)}else t.l=n;return o}var bQ=$a,RQ=dc;function OQ(t,e){return e==null&&(e=le(4)),e.write_shift(4,t),e}function AQ(t,e){var r=t.l+e,n=$a(t,16),i=K1(t),s=wn(t),o=wn(t),a=wn(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function IQ(t,e){var r=le(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));dc({s:Gr(t[0]),e:Gr(t[0])},r),Z1("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return zr(i||"",r),zr(t[1].Tooltip||"",r),zr("",r),r.slice(0,r.l)}function kQ(){}function MQ(t,e,r){var n=t.l+e,i=XF(t,16),s=t.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=SJ(t,n-t.l,r);o[1]=a}else t.l=n;return o}function FQ(t,e,r){var n=t.l+e,i=$a(t,16),s=[i];if(r.cellFormula){var o=yJ(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function DQ(t,e,r){r==null&&(r=le(18));var n=vm(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var MD=["left","right","top","bottom","header","footer"];function PQ(t){var e={};return MD.forEach(function(r){e[r]=mc(t,8)}),e}function NQ(t,e){return e==null&&(e=le(6*8)),ID(t),MD.forEach(function(r){Ua(t[r],e)}),e}function HQ(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function LQ(t,e,r){r==null&&(r=le(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function BQ(t){var e=le(24);return e.write_shift(4,4),e.write_shift(4,1),dc(t,e),e}function VQ(t,e){return e==null&&(e=le(16*4+2)),e.write_shift(2,t.password?dD(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function WQ(){}function UQ(){}function jQ(t,e,r,n,i,s,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=Yn(e),e.z=e.z||cr[14],e.v=zn(On(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r,c:n};switch(l.s=Qo(i.cellXfs,e,i),e.l&&s["!links"].push([Dt(l),e.l]),e.c&&s["!comments"].push([Dt(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=nS(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,o?ge(t,18,lQ(e,l)):ge(t,7,oQ(e,l))):(l.t="str",o?ge(t,17,CQ(e,l)):ge(t,6,xQ(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?ge(t,13,gQ(e,l)):ge(t,2,mQ(e,l)):o?ge(t,16,hQ(e,l)):ge(t,5,uQ(e,l)),!0;case"b":return l.t="b",o?ge(t,15,eQ(e,l)):ge(t,4,JJ(e,l)),!0;case"e":return l.t="e",o?ge(t,14,iQ(e,l)):ge(t,3,rQ(e,l)),!0}return o?ge(t,12,KJ(e,l)):ge(t,1,$J(e,l)),!0}function GQ(t,e,r,n){var i=Gt(e["!ref"]||"A1"),s,o="",a=[];ge(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=u;++f){o=un(f),WJ(t,e,i,f);var d=!1;if(f<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){f===i.s.r&&(a[p]=vn(p)),s=a[p]+o;var g=l?(e[f]||[])[p]:e[s];if(!g){d=!1;continue}d=jQ(t,g,f,p,n,e,d)}}ge(t,146)}function zQ(t,e){!e||!e["!merges"]||(ge(t,177,OQ(e["!merges"].length)),e["!merges"].forEach(function(r){ge(t,176,RQ(r))}),ge(t,178))}function YQ(t,e){!e||!e["!cols"]||(ge(t,390),e["!cols"].forEach(function(r,n){r&&ge(t,60,DQ(n,r))}),ge(t,391))}function qQ(t,e){!e||!e["!ref"]||(ge(t,648),ge(t,649,BQ(Gt(e["!ref"]))),ge(t,650))}function $Q(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Mt(r,-1,n[1].Target.replace(/#.*$/,""),Ct.HLINK);ge(t,494,IQ(n,i))}}),delete e["!links"]}function XQ(t,e,r,n){if(e["!comments"].length>0){var i=Mt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ct.VML);ge(t,551,Z1("rId"+i)),e["!legacy"]=i}}function KQ(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Or(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=si(s);a.s.r==a.e.r&&(a.e.r=si(e["!ref"]).e.r,s=Or(a));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ge(t,161,dc(Gt(s))),ge(t,162)}}function ZQ(t,e,r){ge(t,133),ge(t,137,LQ(e,r)),ge(t,138),ge(t,134)}function JQ(t,e){e["!protect"]&&ge(t,535,VQ(e["!protect"]))}function QQ(t,e,r,n){var i=Gn(),s=r.SheetNames[t],o=r.Sheets[s]||{},a=s;try{r&&r.Workbook&&(a=r.Workbook.Sheets[t].CodeName||a)}catch{}var l=Gt(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ge(i,129),(r.vbaraw||o["!outline"])&&ge(i,147,YJ(a,o["!outline"])),ge(i,148,jJ(l)),ZQ(i,o,r.Workbook),YQ(i,o,t,e,r),GQ(i,o,t,e,r),JQ(i,o),KQ(i,o,r,t),zQ(i,o),$Q(i,o,n),o["!margins"]&&ge(i,476,NQ(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&qQ(i,o),XQ(i,o,t,n),ge(i,130),i.end()}function eee(t,e){t.l+=10;var r=wn(t,e-10);return{name:r}}var tee=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function ree(t){return!t.Workbook||!t.Workbook.WBProps?"false":M$(t.Workbook.WBProps.date1904)?"true":"false"}var nee="][*?/\\".split("");function FD(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return nee.forEach(function(n){if(t.indexOf(n)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function iee(t,e,r){t.forEach(function(n,i){FD(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[i]&&e[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function see(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];iee(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)RJ(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function DD(t){var e=[Ar];e[e.length]=Te("workbook",null,{xmlns:uc[0],"xmlns:r":jr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(tee.forEach(function(a){t.Workbook.WBProps[a[0]]!=null&&t.Workbook.WBProps[a[0]]!=a[1]&&(n[a[0]]=t.Workbook.WBProps[a[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Te("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:Ft(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Te("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=Te("definedName",Ft(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function oee(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=F1(t,e-8),r.name=wn(t),r}function aee(t,e){return e||(e=le(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Z1(t.strRelID,e),zr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function lee(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?wn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function cee(t,e){e||(e=le(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),YF(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function uee(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=rX(t),o=CJ(t,0,r),a=K1(t);t.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function fee(t,e){ge(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ge(t,156,aee(i))}ge(t,144)}function hee(t,e){e||(e=le(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return zr("SheetJS",e),zr(uf.version,e),zr(uf.version,e),zr("7262",e),e.length>e.l?e.slice(0,e.l):e}function dee(t,e){e||(e=le(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function mee(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ge(t,135),ge(t,158,dee(i)),ge(t,136))}}function pee(t,e){var r=Gn();return ge(r,131),ge(r,128,hee()),ge(r,153,cee(t.Workbook&&t.Workbook.WBProps||null)),mee(r,t,e),fee(r,t,e),ge(r,132),r.end()}function gee(t,e,r){return(e.slice(-4)===".bin"?pee:DD)(t,r)}function vee(t,e,r,n,i){return(e.slice(-4)===".bin"?QQ:kD)(t,r,n,i)}function wee(t,e,r){return(e.slice(-4)===".bin"?NK:gD)(t,r)}function xee(t,e,r){return(e.slice(-4)===".bin"?cK:hD)(t,r)}function See(t,e,r){return(e.slice(-4)===".bin"?JK:CD)(t,r)}function Cee(t){return(t.slice(-4)===".bin"?GK:xD)()}function yee(t,e){var r=[];return t.Props&&r.push(wX(t.Props,e)),t.Custprops&&r.push(xX(t.Props,t.Custprops,e)),r.join("")}function _ee(){return""}function Eee(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Te("NumberFormat",null,{"ss:Format":Ft(cr[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Te("Style",s.join(""),o))}),Te("Styles",r.join(""))}function PD(t){return Te("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+tS(t.Ref,{r:0,c:0})})}function Tee(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(PD(i)))}return Te("Names",r.join(""))}function bee(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||s.push(PD(a)))}return s.join("")}function Ree(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Te("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Te("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Te("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Te("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(cn("ProtectContents","True")),t["!protect"].objects&&i.push(cn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(cn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(cn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(cn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Te("WorksheetOptions",i.join(""),{xmlns:ii.x})}function Oee(t){return t.map(function(e){var r=k$(e.t||""),n=Te("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Te("Comment",n,{"ss:Author":e.a})}).join("")}function Aee(t,e,r,n,i,s,o){if(!t||t.v==null&&t.f==null)return"";var a={};if(t.f&&(a["ss:Formula"]="="+Ft(tS(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var l=Gr(t.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(t.l&&t.l.Target&&(a["ss:HRef"]=Ft(t.l.Target),t.l.Tooltip&&(a["x:HRefScreenTip"]=Ft(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=o.c||u[f].s.r!=o.r||(u[f].e.c>u[f].s.c&&(a["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(a["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",p="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",p=String(t.v);break;case"b":d="Boolean",p=t.v?"1":"0";break;case"e":d="Error",p=xf[t.v];break;case"d":d="DateTime",p=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||cr[14]);break;case"s":d="String",p=I$(t.v||"");break}var g=Qo(n.cellXfs,t,n);a["ss:StyleID"]="s"+(21+g),a["ss:Index"]=o.c+1;var x=t.v!=null?p:"",w=t.t=="z"?"":'<Data ss:Type="'+d+'">'+x+"</Data>";return(t.c||[]).length>0&&(w+=Oee(t.c)),Te("Cell",w,a)}function Iee(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=pD(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function kee(t,e,r,n){if(!t["!ref"])return"";var i=Gt(t["!ref"]),s=t["!merges"]||[],o=0,a=[];t["!cols"]&&t["!cols"].forEach(function(y,P){Q1(y);var N=!!y.width,B=vm(P,y),F={"ss:Index":P+1};N&&(F["ss:Width"]=im(B.width)),y.hidden&&(F["ss:Hidden"]="1"),a.push(Te("Column",null,F))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var f=[Iee(u,(t["!rows"]||[])[u])],d=i.s.c;d<=i.e.c;++d){var p=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>d)&&!(s[o].s.r>u)&&!(s[o].e.c<d)&&!(s[o].e.r<u)){(s[o].s.c!=d||s[o].s.r!=u)&&(p=!0);break}if(!p){var g={r:u,c:d},x=Dt(g),w=l?(t[u]||[])[d]:t[x];f.push(Aee(w,x,t,e,r,n,g))}}f.push("</Row>"),f.length>2&&a.push(f.join(""))}return a.join("")}function Mee(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],o=s?bee(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?kee(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Ree(s,e,t,r)),n.join("")}function Fee(t,e){e||(e={}),t.SSF||(t.SSF=Yn(cr)),t.SSF&&(fm(),um(t.SSF),e.revssf=hm(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Qo(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(yee(t,e)),r.push(_ee(t,e)),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Te("Worksheet",Mee(n,e,t),{"ss:Name":Ft(t.SheetNames[n])}));return r[2]=Eee(t,e),r[3]=Tee(t,e),Ar+Te("Workbook",r.join(""),{xmlns:ii.ss,"xmlns:o":ii.o,"xmlns:x":ii.x,"xmlns:ss":ii.ss,"xmlns:dt":ii.dt,"xmlns:html":ii.html})}var O1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Dee(t,e){var r=[],n=[],i=[],s=0,o,a=WM(eF,"n"),l=WM(tF,"n");if(t.Props)for(o=fn(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=fn(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)sD.indexOf(i[s][0])>-1||rD.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&Pt.utils.cfb_add(e,"/SummaryInformation",oF(n,O1.SI,l,tF)),(r.length||u.length)&&Pt.utils.cfb_add(e,"/DocumentSummaryInformation",oF(r,O1.DSI,a,eF,u.length?u:null,O1.UDI))}function Pee(t,e){var r=e||{},n=Pt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Pt.utils.cfb_add(n,i,ND(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Dee(t,n),r.biff==8&&t.vbaraw&&QK(n,Pt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Nee={0:{f:BJ},1:{f:qJ},2:{f:dQ},3:{f:tQ},4:{f:ZJ},5:{f:cQ},6:{f:wQ},7:{f:sQ},8:{f:TQ},9:{f:EQ},10:{f:yQ},11:{f:_Q},12:{f:XJ},13:{f:pQ},14:{f:nQ},15:{f:QJ},16:{f:fQ},17:{f:SQ},18:{f:aQ},19:{f:X1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:uee},40:{},42:{},43:{f:wK},44:{f:gK},45:{f:CK},46:{f:_K},47:{f:yK},48:{},49:{f:X$},50:{},51:{f:BK},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:KX},62:{f:vQ},63:{f:zK},64:{f:WQ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:bs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:HQ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:zJ},148:{f:UJ,p:16},151:{f:kQ},152:{},153:{f:lee},154:{},155:{},156:{f:oee},157:{},158:{},159:{T:1,f:oK},160:{T:-1},161:{T:1,f:$a},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bQ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:HK},336:{T:-1},337:{f:UK,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:F1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:GX},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:MQ},427:{f:FQ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:PQ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:GJ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:AQ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:F1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:KK},633:{T:1},634:{T:-1},635:{T:1,f:$K},636:{T:-1},637:{f:Q$},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:eee},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:UQ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function be(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&Y1(r)&&t.push(r)}}function Hee(t,e,r,n){var i=n||(r||[]).length||0;if(i<=8224)return be(t,e,r,i);var s=e;if(!isNaN(s)){for(var o=r.parts||[],a=0,l=0,u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(f=t.next(4),f.write_shift(2,60),u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;f.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Cf(t,e,r){return t||(t=le(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Lee(t,e,r,n){var i=le(9);return Cf(i,t,e),aD(r,n||"b",i),i}function Bee(t,e,r){var n=le(8+2*r.length);return Cf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Vee(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?zn(On(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?be(t,2,eK(r,n,i)):be(t,3,QX(r,n,i));return;case"b":case"e":be(t,5,Lee(r,n,e.v,e.t));return;case"s":case"str":be(t,4,Bee(r,n,(e.v||"").slice(0,255)));return}be(t,1,Cf(null,r,n))}function Wee(t,e,r,n){var i=Array.isArray(e),s=Gt(e["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=Or(s)}for(var u=s.s.r;u<=s.e.r;++u){a=un(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=vn(f)),o=l[f]+a;var d=i?(e[u]||[])[f]:e[o];d&&Vee(t,d,u,f,n)}}}function Uee(t,e){var r=e||{};Ts!=null&&r.dense==null&&(r.dense=Ts);for(var n=Gn(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return be(n,r.biff==4?1033:r.biff==3?521:9,J1(t,16,r)),Wee(n,t.Sheets[t.SheetNames[i]],i,r,t),be(n,10),n.end()}function jee(t,e,r){be(t,49,NX({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function Gee(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&be(t,1054,BX(i,e[i],r))})}function zee(t,e){var r=le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),be(t,2151,r),r=le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),uD(Gt(e["!ref"]||"A1"),r),r.write_shift(4,4),be(t,2152,r)}function Yee(t,e){for(var r=0;r<16;++r)be(t,224,lF({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){be(t,224,lF(n,0,e))})}function qee(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];be(t,440,qX(n)),n[1].Tooltip&&be(t,2048,$X(n))}delete e["!links"]}function $ee(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&be(t,125,ZX(vm(i,n),i))})}}function Xee(t,e,r,n,i){var s=16+Qo(i.cellXfs,e,i);if(e.v==null&&!e.bf){be(t,513,ja(r,n,s));return}if(e.bf)be(t,6,xJ(e,r,n,i,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?zn(On(e.v)):e.v;be(t,515,jX(r,n,o,s,i));break;case"b":case"e":be(t,517,UX(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var a=nS(i.Strings,e.v,i.revStrings);be(t,253,HX(r,n,a,s,i))}else be(t,516,LX(r,n,(e.v||"").slice(0,255),s,i));break;default:be(t,513,ja(r,n,s))}}function Kee(t,e,r){var n=Gn(),i=r.SheetNames[t],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,f,d="",p=[],g=Gt(s["!ref"]||"A1"),x=u?65536:16384;if(g.e.c>255||g.e.r>=x){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,x-1)}be(n,2057,J1(r,16,e)),be(n,13,Ti(1)),be(n,12,Ti(100)),be(n,15,Rn(!0)),be(n,17,Rn(!1)),be(n,16,Ua(.001)),be(n,95,Rn(!0)),be(n,42,Rn(!1)),be(n,43,Rn(!1)),be(n,130,Ti(1)),be(n,128,WX([0,0])),be(n,131,Rn(!1)),be(n,132,Rn(!1)),u&&$ee(n,s["!cols"]),be(n,512,VX(g,e)),u&&(s["!links"]=[]);for(var w=g.s.r;w<=g.e.r;++w){d=un(w);for(var y=g.s.c;y<=g.e.c;++y){w===g.s.r&&(p[y]=vn(y)),f=p[y]+d;var P=l?(s[w]||[])[y]:s[f];P&&(Xee(n,P,w,y,e),u&&P.l&&s["!links"].push([f,P.l]))}}var N=a.CodeName||a.name||i;return u&&be(n,574,PX((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&be(n,229,YX(s["!merges"])),u&&qee(n,s),be(n,442,cD(N,e)),u&&zee(n,s),be(n,10),n.end()}function Zee(t,e,r){var n=Gn(),i=(t||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=r.biff==8,l=r.biff==5;if(be(n,2057,J1(t,5,r)),r.bookType=="xla"&&be(n,135),be(n,225,a?Ti(1200):null),be(n,193,yX(2)),l&&be(n,191),l&&be(n,192),be(n,226),be(n,92,kX("SheetJS",r)),be(n,66,Ti(a?1200:1252)),a&&be(n,353,Ti(0)),a&&be(n,448),be(n,317,JX(t.SheetNames.length)),a&&t.vbaraw&&be(n,211),a&&t.vbaraw){var u=o.CodeName||"ThisWorkbook";be(n,442,cD(u,r))}be(n,156,Ti(17)),be(n,25,Rn(!1)),be(n,18,Rn(!1)),be(n,19,Ti(0)),a&&be(n,431,Rn(!1)),a&&be(n,444,Ti(0)),be(n,61,DX(r)),be(n,64,Rn(!1)),be(n,141,Ti(0)),be(n,34,Rn(ree(t)=="true")),be(n,14,Rn(!0)),a&&be(n,439,Rn(!1)),be(n,218,Ti(0)),jee(n,t,r),Gee(n,t.SSF,r),Yee(n,r),a&&be(n,352,Rn(!1));var f=n.end(),d=Gn();a&&be(d,140,XX()),a&&r.Strings&&Hee(d,252,FX(r.Strings,r)),be(d,10);var p=d.end(),g=Gn(),x=0,w=0;for(w=0;w<t.SheetNames.length;++w)x+=(a?12:11)+(a?2:1)*t.SheetNames[w].length;var y=f.length+x+p.length;for(w=0;w<t.SheetNames.length;++w){var P=s[w]||{};be(g,133,MX({pos:y,hs:P.Hidden||0,dt:0,name:t.SheetNames[w]},r)),y+=e[w].length}var N=g.end();if(x!=N.length)throw new Error("BS8 "+x+" != "+N.length);var B=[];return f.length&&B.push(f),N.length&&B.push(N),p.length&&B.push(p),ln(B)}function Jee(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Yn(cr)),t&&t.SSF&&(fm(),um(t.SSF),r.revssf=hm(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,iS(r),r.cellXfs=[],Qo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=Kee(i,r,t);return n.unshift(Zee(t,n,r)),ln(n)}function ND(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=si(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return Jee(t,e);case 4:case 3:case 2:return Uee(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Qee(t,e,r,n){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){a=-1;break}a=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(a<0)){var f=Dt({r,c:o}),d=n.dense?(t[r]||[])[o]:t[f],p=d&&d.v!=null&&(d.h||A$(d.w||(no(d),d.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(g["data-t"]=d&&d.t||"z",d.v!=null&&(g["data-v"]=d.v),d.z!=null&&(g["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),g.id=(n.id||"sjs")+"-"+f,s.push(Te("td",p,g))}}var x="<tr>";return x+s.join("")+"</tr>"}var ete='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tte="</body></html>";function rte(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function HD(t,e){var r=e||{},n=r.header!=null?r.header:ete,i=r.footer!=null?r.footer:tte,s=[n],o=si(t["!ref"]);r.dense=Array.isArray(t),s.push(rte(t,o,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(Qee(t,o,a,r));return s.push("</table>"+i),s.join("")}function LD(t,e,r){var n=r||{};Ts!=null&&(n.dense=Ts);var i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Gr(n.origin):n.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=si(t["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var d=[],p=0,g=t["!rows"]||(t["!rows"]=[]),x=0,w=0,y=0,P=0,N=0,B=0;for(t["!cols"]||(t["!cols"]=[]);x<a.length&&w<l;++x){var F=a[x];if(pF(F)){if(n.display)continue;g[w]={hidden:!0}}var Q=F.children;for(y=P=0;y<Q.length;++y){var he=Q[y];if(!(n.display&&pF(he))){var U=he.hasAttribute("data-v")?he.getAttribute("data-v"):he.hasAttribute("v")?he.getAttribute("v"):F$(he.innerHTML),X=he.getAttribute("data-z")||he.getAttribute("z");for(p=0;p<d.length;++p){var K=d[p];K.s.c==P+s&&K.s.r<w+i&&w+i<=K.e.r&&(P=K.e.c+1-s,p=-1)}B=+he.getAttribute("colspan")||1,((N=+he.getAttribute("rowspan")||1)>1||B>1)&&d.push({s:{r:w+i,c:P+s},e:{r:w+i+(N||1)-1,c:P+s+(B||1)-1}});var ne={t:"s",v:U},ie=he.getAttribute("data-t")||he.getAttribute("t")||"";U!=null&&(U.length==0?ne.t=ie||"z":n.raw||U.trim().length==0||ie=="s"||(U==="TRUE"?ne={t:"b",v:!0}:U==="FALSE"?ne={t:"b",v:!1}:isNaN(eo(U))?isNaN(df(U).getDate())||(ne={t:"d",v:On(U)},n.cellDates||(ne={t:"n",v:zn(ne.v)}),ne.z=n.dateNF||cr[14]):ne={t:"n",v:eo(U)})),ne.z===void 0&&X!=null&&(ne.z=X);var te="",Re=he.getElementsByTagName("A");if(Re&&Re.length)for(var We=0;We<Re.length&&!(Re[We].hasAttribute("href")&&(te=Re[We].getAttribute("href"),te.charAt(0)!="#"));++We);te&&te.charAt(0)!="#"&&(ne.l={Target:te}),n.dense?(t[w+i]||(t[w+i]=[]),t[w+i][P+s]=ne):t[Dt({c:P+s,r:w+i})]=ne,u.e.c<P+s&&(u.e.c=P+s),P+=B}}++w}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,w-1+i),t["!ref"]=Or(u),w>=l&&(t["!fullref"]=Or((u.e.r=a.length-x+w-1+i,u))),t}function BD(t,e){var r=e||{},n=r.dense?[]:{};return LD(n,t,e)}function nte(t,e){return Ga(BD(t,e),e)}function pF(t){var e="",r=ite(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function ite(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var ste=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+mf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ar+e}}(),gF=function(){var t=function(s){return Ft(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,a){var l=[];l.push('      <table:table table:name="'+Ft(o.SheetNames[a])+`" table:style-name="ta1">
`);var u=0,f=0,d=si(s["!ref"]||"A1"),p=s["!merges"]||[],g=0,x=Array.isArray(s);if(s["!cols"])for(f=0;f<=d.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var w="",y=s["!rows"]||[];for(u=0;u<d.s.r;++u)w=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+w+`></table:table-row>
`);for(;u<=d.e.r;++u){for(w=y[u]?' table:style-name="ro'+y[u].ods+'"':"",l.push("        <table:table-row"+w+`>
`),f=0;f<d.s.c;++f)l.push(e);for(;f<=d.e.c;++f){var P=!1,N={},B="";for(g=0;g!=p.length;++g)if(!(p[g].s.c>f)&&!(p[g].s.r>u)&&!(p[g].e.c<f)&&!(p[g].e.r<u)){(p[g].s.c!=f||p[g].s.r!=u)&&(P=!0),N["table:number-columns-spanned"]=p[g].e.c-p[g].s.c+1,N["table:number-rows-spanned"]=p[g].e.r-p[g].s.r+1;break}if(P){l.push(r);continue}var F=Dt({r:u,c:f}),Q=x?(s[u]||[])[f]:s[F];if(Q&&Q.f&&(N["table:formula"]=Ft(TJ(Q.f)),Q.F&&Q.F.slice(0,F.length)==F)){var he=si(Q.F);N["table:number-matrix-columns-spanned"]=he.e.c-he.s.c+1,N["table:number-matrix-rows-spanned"]=he.e.r-he.s.r+1}if(!Q){l.push(e);continue}switch(Q.t){case"b":B=Q.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=Q.v?"true":"false";break;case"n":B=Q.w||String(Q.v||0),N["office:value-type"]="float",N["office:value"]=Q.v||0;break;case"s":case"str":B=Q.v==null?"":Q.v,N["office:value-type"]="string";break;case"d":B=Q.w||On(Q.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=On(Q.v).toISOString(),N["table:style-name"]="ce1";break;default:l.push(e);continue}var U=t(B);if(Q.l&&Q.l.Target){var X=Q.l.Target;X=X.charAt(0)=="#"?"#"+bJ(X.slice(1)):X,X.charAt(0)!="#"&&!X.match(/^\w+:/)&&(X="../"+X),U=Te("text:a",U,{"xlink:href":X.replace(/&/g,"&amp;")})}l.push("          "+Te("table:table-cell",Te("text:p",U,{}),N)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Q1(d),d.ods=a;var p=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var d=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[Ar],u=mf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=mf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(eD().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=o.SheetNames.length;++d)l.push(n(o.Sheets[o.SheetNames[d]],o,d,a));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function VD(t,e){if(e.bookType=="fods")return gF(t,e);var r=L1(),n="",i=[],s=[];return n="mimetype",st(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",st(r,n,gF(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",st(r,n,ste(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",st(r,n,Ar+eD()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",st(r,n,vX(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",st(r,n,pX(i)),r}function am(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ote(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):es(Js(t))}function ate(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Jo(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function lte(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function pf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function kt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function ac(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Nr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=pf(t,r),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);a=t.slice(l,r[0])}break;case 5:o=4,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=pf(t,r),a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:a,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function on(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(kt(n*8+i.type)),i.type==2&&e.push(kt(i.data.length)),e.push(i.data))})}),Jo(e)}function Ji(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=pf(t,n),s=Nr(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:ac(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Nr(a.data),u=ac(l[3][0].data);o.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=ac(s[3][0].data)>>>0>0),r.push(o)}return r}function Ql(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:kt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:kt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:kt(o.data.length)}],n[2].push({data:on(o.meta),type:2})});var s=on(n);e.push(kt(s.length)),e.push(s),i.forEach(function(o){return e.push(o)})}),Jo(e)}function cte(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=pf(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[r[0]],a>1&&(o|=e[r[0]+1]<<8),a>2&&(o|=e[r[0]+2]<<16),a>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Jo(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=Jo(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Qi(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(cte(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Jo(e)}function ec(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=kt(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return Jo(e)}function A1(t,e){var r=new Uint8Array(32),n=am(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,lte(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function I1(t,e){var r=new Uint8Array(32),n=am(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function qo(t){var e=Nr(t);return pf(e[1][0].data)}function ute(t,e,r){var n,i,s,o;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&ac(t[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,u=am(t[7][0].data),f=0,d=[],p=am(t[4][0].data),g=0,x=[],w=0;w<e.length;++w){if(e[w]==null){u.setUint16(w*2,65535,!0),p.setUint16(w*2,65535);continue}u.setUint16(w*2,f,!0),p.setUint16(w*2,g,!0);var y,P;switch(typeof e[w]){case"string":y=A1({t:"s",v:e[w]},r),P=I1({t:"s",v:e[w]},r);break;case"number":y=A1({t:"n",v:e[w]},r),P=I1({t:"n",v:e[w]},r);break;case"boolean":y=A1({t:"b",v:e[w]},r),P=I1({t:"b",v:e[w]},r);break;default:throw new Error("Unsupported value "+e[w])}d.push(y),f+=y.length,x.push(P),g+=P.length,++l}for(t[2][0].data=kt(l);w<t[7][0].data.length/2;++w)u.setUint16(w*2,65535,!0),p.setUint16(w*2,65535,!0);return t[6][0].data=Jo(d),t[3][0].data=Jo(x),l}function fte(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=si(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Or(n)));var s=lm(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(z){return z.forEach(function(m){typeof m=="string"&&o.push(m)})});var a={},l=[],u=Pt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(z,m){return[z,u.FullPaths[m]]}).forEach(function(z){var m=z[0],S=z[1];if(m.type==2&&m.name.match(/\.iwa/)){var _=m.content,D=Qi(_),L=Ji(D);L.forEach(function(H){l.push(H.id),a[H.id]={deps:[],location:S,type:ac(H.messages[0].meta[1][0].data)}})}}),l.sort(function(z,m){return z-m});var f=l.filter(function(z){return z>1}).map(function(z){return[z,kt(z)]});u.FileIndex.map(function(z,m){return[z,u.FullPaths[m]]}).forEach(function(z){var m=z[0],S=z[1];if(m.name.match(/\.iwa/)){var _=Ji(Qi(m.content));_.forEach(function(D){D.messages.forEach(function(L){f.forEach(function(H){D.messages.some(function(oe){return ac(oe.meta[1][0].data)!=11006&&ate(oe.data,H[1])})&&a[H[0]].deps.push(D.id)})})})}});function d(){for(var z=927262;z<2e6;++z)if(!a[z])return z;throw new Error("Too many messages")}for(var p=Pt.find(u,a[1].location),g=Ji(Qi(p.content)),x,w=0;w<g.length;++w){var y=g[w];y.id==1&&(x=y)}var P=qo(Nr(x.messages[0].data)[1][0].data);for(p=Pt.find(u,a[P].location),g=Ji(Qi(p.content)),w=0;w<g.length;++w)y=g[w],y.id==P&&(x=y);for(P=qo(Nr(x.messages[0].data)[2][0].data),p=Pt.find(u,a[P].location),g=Ji(Qi(p.content)),w=0;w<g.length;++w)y=g[w],y.id==P&&(x=y);for(P=qo(Nr(x.messages[0].data)[2][0].data),p=Pt.find(u,a[P].location),g=Ji(Qi(p.content)),w=0;w<g.length;++w)y=g[w],y.id==P&&(x=y);var N=Nr(x.messages[0].data);{N[6][0].data=kt(n.e.r+1),N[7][0].data=kt(n.e.c+1);var B=qo(N[46][0].data),F=Pt.find(u,a[B].location),Q=Ji(Qi(F.content));{for(var he=0;he<Q.length&&Q[he].id!=B;++he);if(Q[he].id!=B)throw"Bad ColumnRowUIDMapArchive";var U=Nr(Q[he].messages[0].data);U[1]=[],U[2]=[],U[3]=[];for(var X=0;X<=n.e.c;++X){var K=[];K[1]=K[2]=[{type:0,data:kt(X+420690)}],U[1].push({type:2,data:on(K)}),U[2].push({type:0,data:kt(X)}),U[3].push({type:0,data:kt(X)})}U[4]=[],U[5]=[],U[6]=[];for(var ne=0;ne<=n.e.r;++ne)K=[],K[1]=K[2]=[{type:0,data:kt(ne+726270)}],U[4].push({type:2,data:on(K)}),U[5].push({type:0,data:kt(ne)}),U[6].push({type:0,data:kt(ne)});Q[he].messages[0].data=on(U)}F.content=ec(Ql(Q)),F.size=F.content.length,delete N[46];var ie=Nr(N[4][0].data);{ie[7][0].data=kt(n.e.r+1);var te=Nr(ie[1][0].data),Re=qo(te[2][0].data);F=Pt.find(u,a[Re].location),Q=Ji(Qi(F.content));{if(Q[0].id!=Re)throw"Bad HeaderStorageBucket";var We=Nr(Q[0].messages[0].data);for(ne=0;ne<s.length;++ne){var ke=Nr(We[2][0].data);ke[1][0].data=kt(ne),ke[4][0].data=kt(s[ne].length),We[2][ne]={type:We[2][0].type,data:on(ke)}}Q[0].messages[0].data=on(We)}F.content=ec(Ql(Q)),F.size=F.content.length;var wt=qo(ie[2][0].data);F=Pt.find(u,a[wt].location),Q=Ji(Qi(F.content));{if(Q[0].id!=wt)throw"Bad HeaderStorageBucket";for(We=Nr(Q[0].messages[0].data),X=0;X<=n.e.c;++X)ke=Nr(We[2][0].data),ke[1][0].data=kt(X),ke[4][0].data=kt(n.e.r+1),We[2][X]={type:We[2][0].type,data:on(ke)};Q[0].messages[0].data=on(We)}F.content=ec(Ql(Q)),F.size=F.content.length;var ut=qo(ie[4][0].data);(function(){for(var z=Pt.find(u,a[ut].location),m=Ji(Qi(z.content)),S,_=0;_<m.length;++_){var D=m[_];D.id==ut&&(S=D)}var L=Nr(S.messages[0].data);{L[3]=[];var H=[];o.forEach(function(Oe,ve){H[1]=[{type:0,data:kt(ve)}],H[2]=[{type:0,data:kt(1)}],H[3]=[{type:2,data:ote(Oe)}],L[3].push({type:2,data:on(H)})})}S.messages[0].data=on(L);var oe=Ql(m),fe=ec(oe);z.content=fe,z.size=z.content.length})();var ze=Nr(ie[3][0].data);{var rt=ze[1][0];delete ze[2];var $e=Nr(rt.data);{var Ye=qo($e[2][0].data);(function(){for(var z=Pt.find(u,a[Ye].location),m=Ji(Qi(z.content)),S,_=0;_<m.length;++_){var D=m[_];D.id==Ye&&(S=D)}var L=Nr(S.messages[0].data);{delete L[6],delete ze[7];var H=new Uint8Array(L[5][0].data);L[5]=[];for(var oe=0,fe=0;fe<=n.e.r;++fe){var Oe=Nr(H);oe+=ute(Oe,s[fe],o),Oe[1][0].data=kt(fe),L[5].push({data:on(Oe),type:2})}L[1]=[{type:0,data:kt(n.e.c+1)}],L[2]=[{type:0,data:kt(n.e.r+1)}],L[3]=[{type:0,data:kt(oe)}],L[4]=[{type:0,data:kt(n.e.r+1)}]}S.messages[0].data=on(L);var ve=Ql(m),ue=ec(ve);z.content=ue,z.size=z.content.length})()}rt.data=on($e)}ie[3][0].data=on(ze)}N[4][0].data=on(ie)}x.messages[0].data=on(N);var V=Ql(g),G=ec(V);return p.content=G,p.size=p.content.length,u}function hte(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function iS(t){hte([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function dte(t,e){return e.bookType=="ods"?VD(t,e):e.bookType=="numbers"?fte(t,e):e.bookType=="xlsb"?mte(t,e):pte(t,e)}function mte(t,e){rc=1024,t&&!t.SSF&&(t.SSF=Yn(cr)),t&&t.SSF&&(fm(),um(t.SSF),e.revssf=hm(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,cf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=yD.indexOf(e.bookType)>-1,i=ZF();iS(e=e||{});var s=L1(),o="",a=0;if(e.cellXfs=[],Qo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",st(s,o,tD(t.Props,e)),i.coreprops.push(o),Mt(e.rels,2,o,Ct.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,st(s,o,nD(t.Props,e)),i.extprops.push(o),Mt(e.rels,3,o,Ct.EXT_PROPS),t.Custprops!==t.Props&&fn(t.Custprops||{}).length>0&&(o="docProps/custom.xml",st(s,o,iD(t.Custprops,e)),i.custprops.push(o),Mt(e.rels,4,o,Ct.CUST_PROPS)),a=1;a<=t.SheetNames.length;++a){var f={"!id":{}},d=t.Sheets[t.SheetNames[a-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,st(s,o,vee(a-1,o,e,t,f)),i.sheets.push(o),Mt(e.wbrels,-1,"worksheets/sheet"+a+"."+r,Ct.WS[0])}if(d){var g=d["!comments"],x=!1,w="";g&&g.length>0&&(w="xl/comments"+a+"."+r,st(s,w,See(g,w,e)),i.comments.push(w),Mt(f,-1,"../comments"+a+"."+r,Ct.CMNT),x=!0),d["!legacy"]&&x&&st(s,"xl/drawings/vmlDrawing"+a+".vml",SD(a,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&st(s,QF(o),sc(f))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,st(s,o,xee(e.Strings,o,e)),i.strs.push(o),Mt(e.wbrels,-1,"sharedStrings."+r,Ct.SST)),o="xl/workbook."+r,st(s,o,gee(t,o,e)),i.workbooks.push(o),Mt(e.rels,1,o,Ct.WB),o="xl/theme/theme1.xml",st(s,o,wD(t.Themes,e)),i.themes.push(o),Mt(e.wbrels,-1,"theme/theme1.xml",Ct.THEME),o="xl/styles."+r,st(s,o,wee(t,o,e)),i.styles.push(o),Mt(e.wbrels,-1,"styles."+r,Ct.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",st(s,o,t.vbaraw),i.vba.push(o),Mt(e.wbrels,-1,"vbaProject.bin",Ct.VBA)),o="xl/metadata."+r,st(s,o,Cee(o)),i.metadata.push(o),Mt(e.wbrels,-1,"metadata."+r,Ct.XLMETA),st(s,"[Content_Types].xml",JF(i,e)),st(s,"_rels/.rels",sc(e.rels)),st(s,"xl/_rels/workbook."+r+".rels",sc(e.wbrels)),delete e.revssf,delete e.ssf,s}function pte(t,e){rc=1024,t&&!t.SSF&&(t.SSF=Yn(cr)),t&&t.SSF&&(fm(),um(t.SSF),e.revssf=hm(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,cf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=yD.indexOf(e.bookType)>-1,i=ZF();iS(e=e||{});var s=L1(),o="",a=0;if(e.cellXfs=[],Qo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",st(s,o,tD(t.Props,e)),i.coreprops.push(o),Mt(e.rels,2,o,Ct.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,st(s,o,nD(t.Props,e)),i.extprops.push(o),Mt(e.rels,3,o,Ct.EXT_PROPS),t.Custprops!==t.Props&&fn(t.Custprops||{}).length>0&&(o="docProps/custom.xml",st(s,o,iD(t.Custprops,e)),i.custprops.push(o),Mt(e.rels,4,o,Ct.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,a=1;a<=t.SheetNames.length;++a){var d={"!id":{}},p=t.Sheets[t.SheetNames[a-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,st(s,o,kD(a-1,e,t,d)),i.sheets.push(o),Mt(e.wbrels,-1,"worksheets/sheet"+a+"."+r,Ct.WS[0])}if(p){var x=p["!comments"],w=!1,y="";if(x&&x.length>0){var P=!1;x.forEach(function(N){N[1].forEach(function(B){B.T==!0&&(P=!0)})}),P&&(y="xl/threadedComments/threadedComment"+a+"."+r,st(s,y,YK(x,f,e)),i.threadedcomments.push(y),Mt(d,-1,"../threadedComments/threadedComment"+a+"."+r,Ct.TCMNT)),y="xl/comments"+a+"."+r,st(s,y,CD(x,e)),i.comments.push(y),Mt(d,-1,"../comments"+a+"."+r,Ct.CMNT),w=!0}p["!legacy"]&&w&&st(s,"xl/drawings/vmlDrawing"+a+".vml",SD(a,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&st(s,QF(o),sc(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,st(s,o,hD(e.Strings,e)),i.strs.push(o),Mt(e.wbrels,-1,"sharedStrings."+r,Ct.SST)),o="xl/workbook."+r,st(s,o,DD(t,e)),i.workbooks.push(o),Mt(e.rels,1,o,Ct.WB),o="xl/theme/theme1.xml",st(s,o,wD(t.Themes,e)),i.themes.push(o),Mt(e.wbrels,-1,"theme/theme1.xml",Ct.THEME),o="xl/styles."+r,st(s,o,gD(t,e)),i.styles.push(o),Mt(e.wbrels,-1,"styles."+r,Ct.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",st(s,o,t.vbaraw),i.vba.push(o),Mt(e.wbrels,-1,"vbaProject.bin",Ct.VBA)),o="xl/metadata."+r,st(s,o,xD()),i.metadata.push(o),Mt(e.wbrels,-1,"metadata."+r,Ct.XLMETA),f.length>1&&(o="xl/persons/person.xml",st(s,o,qK(f,e)),i.people.push(o),Mt(e.wbrels,-1,"persons/person.xml",Ct.PEOPLE)),st(s,"[Content_Types].xml",JF(i,e)),st(s,"_rels/.rels",sc(e.rels)),st(s,"xl/_rels/workbook."+r+".rels",sc(e.wbrels)),delete e.revssf,delete e.ssf,s}function gte(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ro(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function WD(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return wf(e.file,Pt.write(t,{type:Et?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Pt.write(t,e)}function vte(t,e){var r=Yn(e||{}),n=dte(t,r);return wte(n,r)}function wte(t,e){var r={},n=Et?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Pt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(cm(i))}return e.password&&typeof encrypt_agile<"u"?WD(encrypt_agile(i,e.password),e):e.type==="file"?wf(e.file,i):e.type=="string"?sf(i):i}function xte(t,e){var r=e||{},n=Pee(t,r);return WD(n,r)}function Es(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return hf(Js(n));case"binary":return Js(n);case"string":return t;case"file":return wf(e.file,n,"utf8");case"buffer":return Et?io(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Es(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Ste(t,e){switch(e.type){case"base64":return hf(t);case"binary":return t;case"string":return t;case"file":return wf(e.file,t,"binary");case"buffer":return Et?io(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function X0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?hf(r):e.type=="string"?sf(r):r;case"file":return wf(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function UD(t,e){Yq(),see(t);var r=Yn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=UD(t,r);return r.type="array",cm(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Es(Fee(t,r),r);case"slk":case"sylk":return Es(rK.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Es(HD(t.Sheets[t.SheetNames[i]],r),r);case"txt":return Ste(GD(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Es(sS(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Es(nK.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return X0(tK.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Es(iK.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Es(fK.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Es(fD.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Es(VD(t,r),r);case"wk1":return X0(cF.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return X0(cF.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),X0(ND(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),xte(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vte(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Cte(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function jD(t,e,r){var n=r||{};return n.type="file",n.file=e,Cte(n),UD(t,n)}function yte(t,e,r,n,i,s,o,a){var l=un(r),u=a.defval,f=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!o||t[r])for(var g=e.s.c;g<=e.e.c;++g){var x=o?t[r][g]:t[n[g]+l];if(x===void 0||x.t===void 0){if(u===void 0)continue;s[g]!=null&&(p[s[g]]=u);continue}var w=x.v;switch(x.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[g]!=null){if(w==null)if(x.t=="e"&&w===null)p[s[g]]=null;else if(u!==void 0)p[s[g]]=u;else if(f&&w===null)p[s[g]]=null;else continue;else p[s[g]]=f&&(x.t!=="n"||x.t==="n"&&a.rawNumbers!==!1)?w:no(x,w,a);w!=null&&(d=!1)}}return{row:p,isempty:d}}function lm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},f=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=Gt(f);break;case"number":l=Gt(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var d=un(l.s.r),p=[],g=[],x=0,w=0,y=Array.isArray(t),P=l.s.r,N=0,B={};y&&!t[P]&&(t[P]=[]);var F=u.skipHidden&&t["!cols"]||[],Q=u.skipHidden&&t["!rows"]||[];for(N=l.s.c;N<=l.e.c;++N)if(!(F[N]||{}).hidden)switch(p[N]=vn(N),r=y?t[P][N]:t[p[N]+d],n){case 1:s[N]=N-l.s.c;break;case 2:s[N]=p[N];break;case 3:s[N]=u.header[N-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=no(r,null,u),w=B[o]||0,!w)B[o]=1;else{do a=o+"_"+w++;while(B[a]);B[o]=w,B[a]=1}s[N]=a}for(P=l.s.r+i;P<=l.e.r;++P)if(!(Q[P]||{}).hidden){var he=yte(t,l,P,p,n,s,y,u);(he.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[x++]=he.row)}return g.length=x,g}var vF=/"/g;function _te(t,e,r,n,i,s,o,a){for(var l=!0,u=[],f="",d=un(r),p=e.s.c;p<=e.e.c;++p)if(n[p]){var g=a.dense?(t[r]||[])[p]:t[n[p]+d];if(g==null)f="";else if(g.v!=null){l=!1,f=""+(a.rawNumbers&&g.t=="n"?g.v:no(g,null,a));for(var x=0,w=0;x!==f.length;++x)if((w=f.charCodeAt(x))===i||w===s||w===34||a.forceQuotes){f='"'+f.replace(vF,'""')+'"';break}f=="ID"&&(f='"ID"')}else g.f!=null&&!g.F?(l=!1,f="="+g.f,f.indexOf(",")>=0&&(f='"'+f.replace(vF,'""')+'"')):f="";u.push(f)}return a.blankrows===!1&&l?null:u.join(o)}function sS(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Gt(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],x=i.s.c;x<=i.e.c;++x)(p[x]||{}).hidden||(d[x]=vn(x));for(var w=0,y=i.s.r;y<=i.e.r;++y)(g[y]||{}).hidden||(f=_te(t,i,y,d,o,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((w++?a:"")+f)));return delete n.dense,r.join("")}function GD(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=sS(t,e);if(typeof Ht>"u"||e.type=="string")return r;var n=Ht.utils.encode(1200,r,"str");return"\xFF\xFE"+n}function Ete(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Gt(t["!ref"]),s="",o=[],a,l=[],u=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=vn(a);for(var f=i.s.r;f<=i.e.r;++f)for(s=un(f),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,r=u?(t[f]||[])[a]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function zD(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},o=0,a=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?Gr(n.origin):n.origin;o=l.r,a=l.c}var u,f={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var d=Gt(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),o==-1&&(o=d.e.r+1,f.e.r=o+e.length-1+i)}else o==-1&&(o=0,f.e.r=e.length-1+i);var p=n.header||[],g=0;e.forEach(function(w,y){fn(w).forEach(function(P){(g=p.indexOf(P))==-1&&(p[g=p.length]=P);var N=w[P],B="z",F="",Q=Dt({c:a+g,r:o+y+i});u=gf(s,Q),N&&typeof N=="object"&&!(N instanceof Date)?s[Q]=N:(typeof N=="number"?B="n":typeof N=="boolean"?B="b":typeof N=="string"?B="s":N instanceof Date?(B="d",n.cellDates||(B="n",N=zn(N)),F=n.dateNF||cr[14]):N===null&&n.nullError&&(B="e",N=0),u?(u.t=B,u.v=N,delete u.w,delete u.R,F&&(u.z=F)):s[Q]=u={t:B,v:N},F&&(u.z=F))})}),f.e.c=Math.max(f.e.c,a+p.length-1);var x=un(o);if(i)for(g=0;g<p.length;++g)s[vn(g+a)+x]={t:"s",v:p[g]};return s["!ref"]=Or(f),s}function Tte(t,e){return zD(null,t,e)}function gf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Gr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?gf(t,Dt(e)):gf(t,Dt({r:e,c:r||0}))}function bte(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Rte(){return{SheetNames:[],Sheets:{}}}function Ote(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(FD(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Ate(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=bte(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Ite(t,e){return t.z=e,t}function YD(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function kte(t,e,r){return YD(t,"#"+e,r)}function Mte(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Fte(t,e,r,n){for(var i=typeof e!="string"?e:Gt(e),s=typeof e=="string"?e:Or(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=gf(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var wm={encode_col:vn,encode_row:un,encode_cell:Dt,encode_range:Or,decode_col:$1,decode_row:q1,split_cell:$$,decode_cell:Gr,decode_range:si,format_cell:no,sheet_add_aoa:zF,sheet_add_json:zD,sheet_add_dom:LD,aoa_to_sheet:hc,json_to_sheet:Tte,table_to_sheet:BD,table_to_book:nte,sheet_to_csv:sS,sheet_to_txt:GD,sheet_to_json:lm,sheet_to_html:HD,sheet_to_formulae:Ete,sheet_to_row_object_array:lm,sheet_get_cell:gf,book_new:Rte,book_append_sheet:Ote,book_set_sheet_visibility:Ate,cell_set_number_format:Ite,cell_set_hyperlink:YD,cell_set_internal_link:kte,cell_add_comment:Mte,sheet_set_array_formula:Fte,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var f2e=uf.version;function Pte(t,e){if(!t||!e)return;let r=t.split("."),n=e;for(let i of r){if(n==null||typeof n!="object")return;n=n[i]}return n}function Nte(t,e){return t==null?!1:e?typeof t=="object"&&!Array.isArray(t):!0}function Hte(t){let e=[],r=n=>{n?.dataPath&&(n.type==="field"?e.push({path:n.dataPath,label:n.label,isTable:!1}):n.type==="table"&&e.push({path:n.dataPath,label:n.label,isTable:!0}))};t.header?.dataPath&&r(t.header),t.footer?.dataPath&&r(t.footer);for(let n of t.sections??[])r(n);return e}function qD(t){return{inputData:t.inputData??{},results:t.results??{}}}function $D(t,e){let r=Hte(t),n=[],i=[];for(let{path:s,label:o,isTable:a}of r){let l=Pte(s,e);Nte(l,a)?n.push(s):i.push({path:s,label:o})}return{matches:i.length===0,matchedPaths:n,missingPaths:i}}var XD=t=>({count:t}),Lte=t=>({index:t}),Bte=()=>({sortable:!0,resizable:!0,filter:!0}),Vte=(t,e)=>e._id,Wte=(t,e)=>e.rowIndex,KD=(t,e)=>e.sequence,Ute=(t,e)=>e.label;function jte(t,e){t&1&&(ye(0,"div",11),po(1,"mat-spinner",13),Ee())}function Gte(t,e){if(t&1){let r=Ai();ye(0,"div",18)(1,"mat-icon",33),Me(2,"description"),Ee(),ye(3,"p",34),Me(4),Ve(5,"transloco"),Ee(),ye(6,"button",35),hn("click",function(){kn(r);let i=at(2);return Mn(i.openReportBuilder(!0))}),Me(7),Ve(8,"transloco"),Ee()()}t&2&&(Ae(4),ct(" ",Ge(5,2,"smartReport.noTemplatesFound")," "),Ae(3),ct(" ",Ge(8,4,"smartReport.createTemplate")," "))}function zte(t,e){t&1&&(ye(0,"span",43)(1,"mat-icon",45),Me(2,"check_circle"),Ee(),Me(3),Ve(4,"transloco"),Ee()),t&2&&(Ae(3),ct(" ",Ge(4,1,"smartReport.templateMatchesData")," "))}function Yte(t,e){if(t&1&&(ye(0,"span",44),Ve(1,"transloco"),ye(2,"mat-icon",45),Me(3,"warning"),Ee(),Me(4),Ve(5,"transloco"),Ee()),t&2){let r=at(),n=at(4);li("matTooltip",Ge(1,2,"smartReport.paths")+": "+n.formatMissingPaths(r.missingPaths)),Ae(4),ct(" ",Hf(5,4,"smartReport.missingFields",Nf(7,XD,r.missingPaths.length))," ")}}function qte(t,e){if(t&1&&tr(0,zte,5,3,"span",43)(1,Yte,6,9,"span",44),t&2){let r=e;dr(r.matches?0:r.missingPaths.length>0?1:-1)}}function $te(t,e){if(t&1){let r=Ai();ye(0,"div",37),hn("click",function(){let i=kn(r).$implicit,s=at(3);return Mn(s.selectTemplate(i))}),ye(1,"div",38)(2,"div",39)(3,"mat-icon"),Me(4," description "),Ee()(),ye(5,"div",40)(6,"p",41),Me(7),Ee(),ye(8,"p",42),Me(9),Ve(10,"transloco"),Ee(),tr(11,qte,2,1),Ee()()()}if(t&2){let r,n,i,s,o,a=e.$implicit,l=at(3);Df("border-indigo-500",((r=l.selectedTemplate())==null?null:r._id)===a._id)("bg-indigo-50",((n=l.selectedTemplate())==null?null:n._id)===a._id)("border-gray-200",((i=l.selectedTemplate())==null?null:i._id)!==a._id)("hover:border-indigo-300",((s=l.selectedTemplate())==null?null:s._id)!==a._id),Ae(2),yc("background",(a.primaryColor||"#4F46E5")+"20"),Ae(),yc("color",a.primaryColor||"#4F46E5"),Ae(4),ct(" ",a.name," "),Ae(2),QS(" ",(a.sections==null?null:a.sections.length)||0," ",Ge(10,17,"smartReport.sections")," \u2022 ",a.pdfEngine||"puppeteer"," "),Ae(2),dr((o=((o=l.selectedTemplate())==null?null:o._id)===a._id&&l.templateMatch())?11:-1,o)}}function Xte(t,e){if(t&1&&(ye(0,"div",19),tl(1,$te,12,19,"div",36,Vte),Ee()),t&2){let r=at(2);Ae(),rl(r.templates())}}function Kte(t,e){if(t&1){let r=Ai();ye(0,"p",47)(1,"mat-icon",48),Me(2,"check_circle"),Ee(),ye(3,"span"),Me(4),Ve(5,"transloco"),Ee()(),ye(6,"button",49),hn("click",function(){kn(r);let i=at(3);return Mn(i.openReportBuilder())}),ye(7,"mat-icon",50),Me(8,"edit"),Ee(),Me(9),Ve(10,"transloco"),Ee()}t&2&&(Ae(4),ia(Ge(5,2,"smartReport.templateReadyToUse")),Ae(5),ct(" ",Ge(10,4,"smartReport.editInBuilder")," "))}function Zte(t,e){if(t&1){let r=Ai();ye(0,"p",51)(1,"mat-icon",48),Me(2,"warning"),Ee(),ye(3,"span"),Me(4),Ve(5,"transloco"),Ee()(),ye(6,"p",52),Me(7),Ve(8,"transloco"),Ee(),ye(9,"button",53),hn("click",function(){kn(r);let i=at(3);return Mn(i.openReportBuilder())}),ye(10,"mat-icon",50),Me(11,"edit"),Ee(),Me(12),Ve(13,"transloco"),Ee()}if(t&2){let r=at(),n=at(2);Ae(4),ia(Hf(5,4,"smartReport.missingFieldsEditInBuilder",Nf(11,XD,r.missingPaths.length))),Ae(3),_c(" ",Ge(8,7,"smartReport.paths"),": ",n.formatMissingPaths(r.missingPaths)," "),Ae(5),ct(" ",Ge(13,9,"smartReport.editInBuilder")," ")}}function Jte(t,e){if(t&1&&(ye(0,"div",46),tr(1,Kte,11,6)(2,Zte,14,13),Ee()),t&2){let r=e;Df("bg-emerald-50",r.matches)("bg-amber-50",!r.matches),Ae(),dr(r.matches?1:2)}}function Qte(t,e){t&1&&(ye(0,"mat-icon",57),Me(1,"refresh"),Ee(),Me(2),Ve(3,"transloco")),t&2&&(Ae(2),ct(" ",Ge(3,1,"smartReport.generating")," "))}function ere(t,e){t&1&&(Me(0),Ve(1,"transloco")),t&2&&ct(" ",Ge(1,1,"smartReport.generatePdf")," ")}function tre(t,e){t&1&&(ye(0,"mat-icon",57),Me(1,"refresh"),Ee(),Me(2),Ve(3,"transloco")),t&2&&(Ae(2),ct(" ",Ge(3,1,"smartReport.sending")," "))}function rre(t,e){t&1&&(Me(0),Ve(1,"transloco")),t&2&&ct(" ",Ge(1,1,"smartReport.sendViaEmail")," ")}function nre(t,e){if(t&1){let r=Ai();ye(0,"button",58),hn("click",function(){kn(r);let i=at(3);return Mn(i.downloadReport())}),ye(1,"mat-icon",59),Me(2,"download"),Ee(),Me(3),Ve(4,"transloco"),Ee(),ye(5,"button",60),hn("click",function(){kn(r);let i=at(3);return Mn(i.sendEmail())}),tr(6,tre,4,3)(7,rre,2,3),Ee()}if(t&2){let r=at(3);Ae(3),ct(" ",Ge(4,3,"smartReport.downloadPdf")," "),Ae(2),li("disabled",r.isSending()),Ae(),dr(r.isSending()?6:7)}}function ire(t,e){if(t&1){let r=Ai();ye(0,"div",56)(1,"p",61),Me(2),Ve(3,"transloco"),Ee(),ye(4,"div",62)(5,"button",58),hn("click",function(){kn(r);let i=at(3);return Mn(i.downloadAsCsv())}),ye(6,"mat-icon",59),Me(7,"download"),Ee(),Me(8),Ve(9,"transloco"),Ee(),ye(10,"button",58),hn("click",function(){kn(r);let i=at(3);return Mn(i.downloadAsExcel())}),ye(11,"mat-icon",59),Me(12,"table_chart"),Ee(),Me(13),Ve(14,"transloco"),Ee()()()}t&2&&(Ae(2),ia(Ge(3,3,"smartReport.exportData")),Ae(6),ct(" ",Ge(9,5,"smartReport.downloadAsCsv")," "),Ae(5),ct(" ",Ge(14,7,"smartReport.downloadAsExcel")," "))}function sre(t,e){if(t&1){let r=Ai();ye(0,"div",21)(1,"h3",17),Me(2),Ve(3,"transloco"),Ee(),ye(4,"div",54)(5,"button",55),hn("click",function(){kn(r);let i=at(2);return Mn(i.generateReport())}),tr(6,Qte,4,3)(7,ere,2,3),Ee(),tr(8,nre,8,5)(9,ire,15,9,"div",56),Ee()()}if(t&2){let r=at(2);Ae(2),ct(" ",Ge(3,5,"smartReport.actions")," "),Ae(3),li("disabled",r.isGenerating()),Ae(),dr(r.isGenerating()?6:7),Ae(2),dr(r.report()?8:-1),Ae(),dr(r.stepResultBlocks().length>0?9:-1)}}function ore(t,e){if(t&1&&(Me(0),Ve(1,"transloco")),t&2){let r=at(2);ct(" ",Hf(1,1,"smartReport.reportForRecord",Nf(4,Lte,r.selectedRowIndex()+1))," ")}}function are(t,e){t&1&&(Me(0),Ve(1,"transloco")),t&2&&ct(" ",Ge(1,1,"smartReport.dragSectionsReorder")," ")}function lre(t,e){if(t&1){let r=Ai();ye(0,"mat-button-toggle-group",63),hn("change",function(i){kn(r);let s=at(2);return Mn(s.stepResultsViewMode.set(i.value))}),ye(1,"mat-button-toggle",64),Me(2),Ve(3,"transloco"),Ee(),ye(4,"mat-button-toggle",65),Me(5),Ve(6,"transloco"),Ee(),ye(7,"mat-button-toggle",66),Me(8),Ve(9,"transloco"),Ee(),ye(10,"mat-button-toggle",67),Me(11),Ve(12,"transloco"),Ee()()}if(t&2){let r=at(2);li("value",r.stepResultsViewMode()),Ae(2),ct(" ",Ge(3,5,"smartReport.viewModeTable")," "),Ae(3),ct(" ",Ge(6,7,"smartReport.viewModeJson")," "),Ae(3),ct(" ",Ge(9,9,"smartReport.viewModeExcelAg")," "),Ae(3),ct(" ",Ge(12,11,"smartReport.viewModeExcelHt")," ")}}function cre(t,e){t&1&&(ye(0,"div",68)(1,"mat-icon",69),Me(2,"table_chart"),Ee(),ye(3,"p",70),Me(4),Ve(5,"transloco"),Ee(),ye(6,"p",71),Me(7),Ve(8,"transloco"),Ee()()),t&2&&(Ae(4),ct(" ",Ge(5,2,"smartReport.noStepResultsYet")," "),Ae(3),ct(" ",Ge(8,4,"smartReport.processBatchToSeeResults")," "))}function ure(t,e){if(t&1&&(ye(0,"div",72),po(1,"ag-grid-angular",74),Ee()),t&2){let r=at(4);Ae(),li("rowData",r.gridRowData())("columnDefs",r.gridColumnDefs())("defaultColDef",tC(7,Bte))("rowHeight",44)("headerHeight",44)("suppressRowClickSelection",!0)("domLayout","normal")}}function fre(t,e){if(t&1&&(ye(0,"div",72),po(1,"hot-table",75),Ee()),t&2){let r=at(4);Ae(),li("data",r.handsontableData())("settings",r.handsontableSettings())}}function hre(t,e){if(t&1&&(ye(0,"tr",86)(1,"td",87),Me(2),Ee(),ye(3,"td",88),Me(4),Ee()()),t&2){let r=e.$implicit;Ae(2),ct(" ",r.label," "),Ae(2),ct(" ",r.value," ")}}function dre(t,e){if(t&1&&(ye(0,"table",84)(1,"tbody"),tl(2,hre,5,2,"tr",86,Ute),Ee()()),t&2){let r=at().$implicit,n=at(7);Ae(2),rl(n.getStepResultFields(r.data))}}function mre(t,e){t&1&&(ye(0,"p",85),Me(1," \u2014 "),Ee())}function pre(t,e){if(t&1&&(ye(0,"div",81)(1,"p",82),Me(2),ye(3,"span",83),Me(4),Ve(5,"transloco"),Ee()(),tr(6,dre,4,0,"table",84)(7,mre,2,0,"p",85),Ee()),t&2){let r=e.$implicit;Ae(2),ct(" ",r.label," "),Ae(2),_c("(",Ge(5,4,"smartReport.step")," ",r.sequence,")"),Ae(2),dr(r.data!=null?6:7)}}function gre(t,e){if(t&1&&(ye(0,"div",80),tl(1,pre,8,6,"div",81,KD),Ee()),t&2){let r=at().$implicit;Ae(),rl(r.steps)}}function vre(t,e){if(t&1&&(ye(0,"div",89)(1,"p",82),Me(2),ye(3,"span",83),Me(4),Ve(5,"transloco"),Ee()(),ye(6,"pre",90),Me(7),Ee()()),t&2){let r=e.$implicit,n=at(7);Ae(2),ct(" ",r.label," "),Ae(2),_c("(",Ge(5,4,"smartReport.step")," ",r.sequence,")"),Ae(3),ia(n.formatJson(r.data))}}function wre(t,e){if(t&1&&(ye(0,"div",80),tl(1,vre,8,6,"div",89,KD),Ee()),t&2){let r=at().$implicit;Ae(),rl(r.steps)}}function xre(t,e){if(t&1&&(ye(0,"div",77)(1,"div",78)(2,"mat-icon",79),Me(3,"person"),Ee(),ye(4,"span",41),Me(5),Ve(6,"transloco"),Ee()(),tr(7,gre,3,0,"div",80)(8,wre,3,0,"div",80),Ee()),t&2){let r=e.$implicit,n=at(5);Ae(5),_c(" ",Ge(6,3,"smartReport.row")," #",r.rowIndex+1," "),Ae(2),dr(n.stepResultsViewMode()==="table"?7:8)}}function Sre(t,e){if(t&1&&(ye(0,"div",73)(1,"div",76),tl(2,xre,9,5,"div",77,Wte),Ee()()),t&2){let r=at(4);Ae(2),rl(r.recordResultBlocks())}}function Cre(t,e){if(t&1&&tr(0,ure,2,8,"div",72)(1,fre,2,2,"div",72)(2,Sre,4,0,"div",73),t&2){let r=at(3);dr(r.stepResultsViewMode()==="excel-ag"?0:r.stepResultsViewMode()==="excel-ht"?1:2)}}function yre(t,e){if(t&1&&(ye(0,"div",16),tr(1,cre,9,6,"div",68)(2,Cre,3,1),Ee()),t&2){let r=at(2);Ae(),dr(r.stepResultBlocks().length===0?1:2)}}function _re(t,e){t&1&&(ye(0,"div",32),po(1,"mat-spinner",91),ye(2,"p"),Me(3),Ve(4,"transloco"),Ee()()),t&2&&(Ae(3),ia(Ge(4,1,"smartReport.generatingPdf")))}function Ere(t,e){if(t&1){let r=Ai();ye(0,"div",93)(1,"button",94),Ve(2,"transloco"),hn("click",function(){kn(r);let i=at(3);return Mn(i.goToPreviewPage(i.previewPageIndex()-1))}),ye(3,"mat-icon"),Me(4,"chevron_left"),Ee()(),ye(5,"span",95),Me(6),Ve(7,"transloco"),Ve(8,"transloco"),Ee(),ye(9,"button",94),Ve(10,"transloco"),hn("click",function(){kn(r);let i=at(3);return Mn(i.goToPreviewPage(i.previewPageIndex()+1))}),ye(11,"mat-icon"),Me(12,"chevron_right"),Ee()()()}if(t&2){let r=at(3);Ae(),li("disabled",r.previewPageIndex()<=0)("matTooltip",Ge(2,8,"smartReport.previewPrevious")),Ae(5),eC(" ",Ge(7,10,"smartReport.previewPage")," ",r.previewPageIndex()+1," ",Ge(8,12,"smartReport.previewPageOf")," ",r.previewDataForAllRows().length," "),Ae(3),li("disabled",r.previewPageIndex()>=r.previewDataForAllRows().length-1)("matTooltip",Ge(10,14,"smartReport.previewNext"))}}function Tre(t,e){if(t&1&&(po(0,"report-preview",92),tr(1,Ere,13,16,"div",93)),t&2){let r=at(2);li("template",r.selectedTemplate())("previewData",r.previewDataForCurrentPage())("primaryColor",r.selectedTemplate().primaryColor||"#4F46E5")("orientation","portrait")("clickable",!1),Ae(),dr(r.previewDataForAllRows().length>1?1:-1)}}function bre(t,e){t&1&&(ye(0,"div",32)(1,"mat-icon",96),Me(2,"description"),Ee(),ye(3,"p",97),Me(4),Ve(5,"transloco"),Ee(),ye(6,"p",34),Me(7),Ve(8,"transloco"),Ee()()),t&2&&(Ae(4),ct(" ",Ge(5,2,"smartReport.noPreviewAvailable")," "),Ae(3),ct(" ",Ge(8,4,"smartReport.selectTemplateAndBatch")," "))}function Rre(t,e){if(t&1){let r=Ai();ye(0,"div",12)(1,"div",14)(2,"div",15)(3,"div",16)(4,"h3",17),Me(5),Ve(6,"transloco"),Ee(),tr(7,Gte,9,6,"div",18)(8,Xte,3,0,"div",19),Ee(),tr(9,Jte,3,5,"div",20),Ee(),tr(10,sre,10,7,"div",21),Ee(),ye(11,"div",22)(12,"div",15)(13,"div",23)(14,"div",24)(15,"div")(16,"h3",25),Me(17),Ve(18,"transloco"),Ee(),ye(19,"p",26),tr(20,ore,2,6)(21,are,2,3),Ee()(),ye(22,"div",27),tr(23,lre,13,13,"mat-button-toggle-group",28),ye(24,"button",29),Ve(25,"transloco"),Ve(26,"transloco"),hn("click",function(){kn(r);let i=at();return Mn(i.toggleStepResultsContent())}),ye(27,"mat-icon",30),Me(28),Ee()()()()(),tr(29,yre,3,1,"div",16),Ee(),ye(30,"div",15)(31,"div",23)(32,"h3",25),Me(33),Ve(34,"transloco"),Ee(),ye(35,"p",26),Me(36),Ve(37,"transloco"),Ee()(),ye(38,"div",31),tr(39,_re,5,3,"div",32)(40,Tre,2,6)(41,bre,9,6,"div",32),Ee()()()()}if(t&2){let r,n,i=at();Ae(5),ct(" ",Ge(6,13,"smartReport.selectTemplate")," "),Ae(2),dr(i.templates().length===0?7:8),Ae(2),dr((r=i.selectedTemplate()&&i.templateMatch())?9:-1,r),Ae(),dr(i.selectedTemplate()?10:-1),Ae(7),ct(" ",Ge(18,15,"smartReport.stepResultsLayout")," "),Ae(3),dr(i.selectedRowIndex()!=null?20:21),Ae(3),dr(i.stepResultBlocks().length>0?23:-1),Ae(),li("matTooltip",i.stepResultsContentExpanded()?Ge(25,17,"smartReport.collapseContent"):Ge(26,19,"smartReport.expandContent")),Ae(4),ia(i.stepResultsContentExpanded()?"expand_more":"expand_less"),Ae(),dr(i.stepResultsContentExpanded()?29:-1),Ae(4),ct(" ",Ge(34,21,"smartReport.preview")," "),Ae(3),ct(" ",Ge(37,23,"smartReport.previewSameAsBuilder")," "),Ae(3),dr(i.isGenerating()?39:i.selectedTemplate()&&(!((n=i.batch())==null||n.rows==null)&&n.rows.length)?40:41)}}var j2e=(()=>{class t{toggleStepResultsContent(){this.stepResultsContentExpanded.update(r=>!r)}goToPreviewPage(r){let n=this.previewDataForAllRows().length-1;this.previewPageIndex.set(Math.min(Math.max(0,r),n))}constructor(){this._route=ai(oC),this._router=ai(aC),this._snack=ai(yC),this._reportService=ai(kC),this._batchService=ai(IC),this._previewDataService=ai(DC),this._sanitizer=ai(sC),this._dialog=ai(cC),this._transloco=ai(gC),this.configId=Lr(null),this.batchId=Lr(null),this.selectedRowIndex=Lr(null),this.batch=Lr(null),this.configuration=Lr(null),this.templates=Lr([]),this.selectedTemplate=Lr(null),this.report=Lr(null),this.stepBlocksOrder=Lr([]),this.isLoading=Lr(!1),this.isGenerating=Lr(!1),this.isSending=Lr(!1),this.stepResultsViewMode=Lr("table"),this.stepResultsContentExpanded=Lr(!0),this.pdfDataUrl=Lr(null),this.pdfSafeUrl=Lr(null),this.stepResultBlocks=ci(()=>{let r=this.stepBlocksOrder(),i=this.batch()?.rows??[],s=this.selectedRowIndex();return s!=null&&(i=i.filter(o=>o.rowIndex===s)),r.map(o=>({sequence:o.sequence,label:o.label,rowResults:i.map(a=>({rowIndex:a.rowIndex,data:a.results?.[o.sequence]??null}))}))}),this.recordResultBlocks=ci(()=>{let r=this.stepBlocksOrder(),i=this.batch()?.rows??[],s=this.selectedRowIndex();return s!=null&&(i=i.filter(o=>o.rowIndex===s)),i.map(o=>({rowIndex:o.rowIndex,steps:r.map(a=>({sequence:a.sequence,label:a.label,data:o.results?.[a.sequence]??null}))}))}),this.hasStepResults=ci(()=>(this.batch()?.rows??[]).some(i=>i.results&&Object.keys(i.results).length>0)),this.previewData=ci(()=>{let r=this.batch(),n=r?.rows??[],i=this.selectedRowIndex(),s=i!=null?n.find(o=>o.rowIndex===i):n[0];return s?{batchName:r?.name??"Batch",rowIndex:s.rowIndex,inputData:s.inputData??{},results:s.results??{}}:{inputData:{},results:{}}}),this.previewDataForAllRows=ci(()=>{let r=this.batch(),n=r?.rows??[],i=this.selectedRowIndex();return(i!=null?n.filter(o=>o.rowIndex===i):n).map(o=>({batchName:r?.name??"Batch",rowIndex:o.rowIndex,inputData:o.inputData??{},results:o.results??{}}))}),this.previewPageIndex=Lr(0),this.previewDataForCurrentPage=ci(()=>{let r=this.previewDataForAllRows(),n=Math.min(Math.max(0,this.previewPageIndex()),r.length-1);return r[n]??{inputData:{},results:{}}}),this.templateMatch=ci(()=>{let r=this.selectedTemplate(),n=this.batch();if(!r?.sections?.length||!n?.rows?.length)return null;let i=n.rows,s=this.selectedRowIndex(),o=s!=null?i.find(l=>l.rowIndex===s):i[0];if(!o)return null;let a=qD(o);return $D(r,a)}),this.gridColumnDefs=ci(()=>this._buildGridColumnDefs()),this.gridRowData=ci(()=>this._buildGridRowDataByRecord()),this.handsontableData=ci(()=>this._buildHandsontableData()),this.handsontableSettings=ci(()=>({colHeaders:!0,rowHeaders:!0,readOnly:!0,licenseKey:"non-commercial-and-evaluation",height:460,width:"100%",stretchH:"all",columns:this._buildHandsontableColumns()})),nC(()=>{let r=this.previewDataForAllRows(),n=this.previewPageIndex();r.length>0&&n>=r.length&&this.previewPageIndex.set(0)})}ngOnInit(){this._route.params.subscribe(r=>{this.configId.set(r.configId),this.batchId.set(r.batchId),this._loadData()}),this._route.queryParams.subscribe(r=>{let n=r.rowIndex;if(n!=null&&n!==""){let i=parseInt(n,10);this.selectedRowIndex.set(Number.isNaN(i)?null:i)}else this.selectedRowIndex.set(null)})}_buildGridColumnDefs(){let r=this.stepResultBlocks(),n=new Set;for(let o of r)for(let a of o.rowResults)a.data!=null&&this.getStepResultFields(a.data).forEach(l=>n.add(l.label));let i=Array.from(n),s=[{field:"step",headerName:"Step",width:220,flex:0},{field:"rowNum",headerName:"Row #",width:80,flex:0}];return i.forEach(o=>{s.push({field:o,headerName:o,minWidth:130,flex:1})}),s}_buildGridRowData(){let r=this.stepResultBlocks(),n=new Set;for(let o of r)for(let a of o.rowResults)a.data!=null&&this.getStepResultFields(a.data).forEach(l=>n.add(l.label));let i=Array.from(n),s=[];for(let o of r)for(let a of o.rowResults){let l={step:o.label,rowNum:a.rowIndex+1},u=new Map;a.data!=null&&this.getStepResultFields(a.data).forEach(f=>u.set(f.label,f.value)),i.forEach(f=>l[f]=u.get(f)??""),s.push(l)}return s}_buildGridRowDataByRecord(){let r=this.recordResultBlocks(),n=new Set;for(let o of r)for(let a of o.steps)a.data!=null&&this.getStepResultFields(a.data).forEach(l=>n.add(l.label));let i=Array.from(n),s=[];for(let o of r)for(let a of o.steps){let l={step:a.label,rowNum:o.rowIndex+1},u=new Map;a.data!=null&&this.getStepResultFields(a.data).forEach(f=>u.set(f.label,f.value)),i.forEach(f=>l[f]=u.get(f)??""),s.push(l)}return s}_buildHandsontableData(){let r=this.stepResultBlocks(),n=new Set;for(let o of r)for(let a of o.rowResults)a.data!=null&&this.getStepResultFields(a.data).forEach(l=>n.add(l.label));let i=Array.from(n),s=[];for(let o of r)for(let a of o.rowResults){let l=[o.label,a.rowIndex+1],u=new Map;a.data!=null&&this.getStepResultFields(a.data).forEach(f=>u.set(f.label,f.value)),i.forEach(f=>l.push(u.get(f)??"")),s.push(l)}return s.length>0?s:[[""]]}_buildHandsontableColumns(){let r=this.stepResultBlocks(),n=new Set;for(let o of r)for(let a of o.rowResults)a.data!=null&&this.getStepResultFields(a.data).forEach(l=>n.add(l.label));let i=Array.from(n),s=[{data:0,title:"Step",width:220},{data:1,title:"Row #",width:80}];return i.forEach((o,a)=>{s.push({data:a+2,title:o,width:150})}),s}_loadData(){this.isLoading.set(!0);let r=this.configId(),n=this.batchId(),i=s=>{this._reportService.getTemplates(r||void 0).subscribe({next:o=>{if(this.templates.set(o),o.length>0){let a=s?typeof s.preferredReportTemplate=="string"?s.preferredReportTemplate:s.preferredReportTemplate?._id:null,l=a?o.find(u=>u._id===a):null;this.selectedTemplate.set(l??o[0])}this.isLoading.set(!1)},error:()=>{this.isLoading.set(!1)}})};r?this._batchService.getConfiguration(r).subscribe({next:s=>{this.configuration.set(s.data),this._initStepBlocksOrderFromConfig(s.data),n?this._batchService.getSmartBatch(n).subscribe({next:o=>{this.batch.set(o.data),i(s.data)},error:()=>i(s.data)}):i(s.data)},error:()=>{n&&this._batchService.getSmartBatch(n).subscribe({next:s=>this.batch.set(s.data),error:()=>{}}),i(null)}}):(n&&this._batchService.getSmartBatch(n).subscribe({next:s=>this.batch.set(s.data),error:()=>{}}),i(null))}_initStepBlocksOrderFromConfig(r){if(!r?.steps?.length)return;let n=r.steps.filter(i=>i.enabled).sort((i,s)=>i.sequence-s.sequence).map(i=>({sequence:i.sequence,label:this._getStepLabel(i)}));n.length>0&&this.stepBlocksOrder.set(n)}_getStepLabel(r){let n=r.appFeature;return n?.name||n?.code||`Step ${r.sequence}`}onStepBlocksDrop(r){let n=[...this.stepBlocksOrder()];MC(n,r.previousIndex,r.currentIndex),this.stepBlocksOrder.set(n)}getStepResultFields(r){if(r==null||typeof r!="object")return[{label:"Result",value:r!=null?String(r):"\u2014"}];let n=[];for(let i of Object.keys(r)){let s=i.replace(/([A-Z])/g," $1").replace(/^./,l=>l.toUpperCase()).trim(),o=r[i],a;o==null?a="\u2014":Array.isArray(o)?a=o.length===0?"\u2014":`[${o.length} item${o.length===1?"":"s"}]`:typeof o=="object"?a=typeof o=="object"&&o!==null&&Object.keys(o).length>0?`{ ${Object.keys(o).slice(0,3).join(", ")}${Object.keys(o).length>3?"\u2026":""} }`:"\u2014":a=String(o),n.push({label:s,value:a})}return n}formatJson(r){if(r==null)return"\u2014";try{return JSON.stringify(r,null,2)}catch{return String(r)}}getResultSummary(r){if(r==null)return"\u2014";if(typeof r=="string")return r.length>60?r.slice(0,60)+"\u2026":r;if(typeof r!="object")return String(r);let n=Object.keys(r);return n.length===0?"\u2014":n.slice(0,3).map(s=>`${s}: ${this._valuePreview(r[s])}`).join(" \xB7 ")+(n.length>3?" \u2026":"")}_valuePreview(r){return r==null?"\u2014":typeof r=="string"?r.length>20?r.slice(0,20)+"\u2026":r:typeof r=="object"?"\u2026":String(r)}_isPdfBlob(r){return Cc(this,null,function*(){let i=yield r.slice(0,5).arrayBuffer(),s=new Uint8Array(i);return s[0]===37&&s[1]===80&&s[2]===68&&s[3]===70})}_blobFromJsonBytes(r){return Cc(this,null,function*(){try{let n=yield r.text(),i=JSON.parse(n),s=Object.keys(i).filter(a=>/^\d+$/.test(a));if(s.length===0)return null;s.sort((a,l)=>Number(a)-Number(l));let o=new Uint8Array(s.length);return s.forEach((a,l)=>o[l]=i[a]&255),o[0]!==37||o[1]!==80||o[2]!==68||o[3]!==70?null:new Blob([o],{type:"application/pdf"})}catch{return null}})}_parseBlobError(r){return Cc(this,null,function*(){try{let n=yield r.text(),i=JSON.parse(n);return typeof i.error=="string"?i.error:typeof i.message=="string"?i.message:Object.keys(i).some(s=>/^\d+$/.test(s))?"Server returned PDF in unexpected format":n.slice(0,80)}catch{return r.type==="application/json"||r.type==="text/plain"?"Server returned an error":"Invalid PDF content"}})}formatMissingPaths(r){return r.map(n=>n.path).join(", ")}selectTemplate(r){this.selectedTemplate.set(r),this.pdfDataUrl.set(null),this.pdfSafeUrl.set(null),this.report.set(null);let n=this.configId();n&&r._id&&this._batchService.updateConfiguration(n,{preferredReportTemplate:r._id}).subscribe({next:i=>this.configuration.set(i.data),error:()=>this._snack.open(this._transloco.translate("smartReport.failedToSaveTemplatePreference"),"Close",{duration:3e3})})}generateReport(){let r=this.selectedTemplate(),n=this.batchId();if(!r||!n){this._snack.open(this._transloco.translate("smartReport.pleaseSelectTemplate"),"Close",{duration:3e3});return}this.isGenerating.set(!0),this._reportService.createReport({template:r._id,smartBatch:n,name:`Report - ${this.batch()?.name||"Batch"}`}).subscribe({next:i=>{this.report.set(i);let s=this.selectedRowIndex();this._reportService.generateReport(i._id,De({},s!=null?{rowIndex:s}:{})).subscribe({next:o=>{if(this.report.set(o.data),o.pdf?.buffer){let a=`data:application/pdf;base64,${o.pdf.buffer}`;this.pdfDataUrl.set(a),this.pdfSafeUrl.set(this._sanitizer.bypassSecurityTrustResourceUrl(a))}this.isGenerating.set(!1),this._snack.open(this._transloco.translate("smartReport.reportGenerated"),"Close",{duration:3e3})},error:o=>{console.error("Failed to generate PDF:",o),this.isGenerating.set(!1),this._snack.open(this._transloco.translate("smartReport.failedToGenerateReport"),"Close",{duration:3e3})}})},error:i=>{console.error("Failed to create report:",i),this.isGenerating.set(!1),this._snack.open(this._transloco.translate("smartReport.failedToCreateReport"),"Close",{duration:3e3})}})}sendEmail(){let r=this.report();if(!r?._id){this._snack.open(this._transloco.translate("smartReport.generateReportFirst"),"Close",{duration:3e3});return}let n=`Report - ${this.batch()?.name??"Batch"}`;this._dialog.open(NC,{panelClass:"send-sample-dialog",maxWidth:"560px",width:"95vw",disableClose:!1,autoFocus:!0,data:{defaultSubject:n,isSample:!1}}).afterClosed().subscribe(s=>{s?.recipients?.length&&(this.isSending.set(!0),this._reportService.sendReportEmail(r._id,{recipients:s.recipients,subject:s.subject,language:"es"}).subscribe({next:o=>{this.isSending.set(!1),o.success?this._snack.open(this._transloco.translate("smartReport.emailSent"),"Close",{duration:3e3}):this._snack.open(o.error||this._transloco.translate("smartReport.failedToSendEmail"),"Close",{duration:3e3})},error:()=>{this.isSending.set(!1),this._snack.open(this._transloco.translate("smartReport.failedToSendEmail"),"Close",{duration:3e3})}}))})}downloadReport(){let r=this.report();if(!r?._id){this._snack.open(this._transloco.translate("smartReport.generateReportFirst"),"Close",{duration:3e3});return}this.isSending.set(!0),this._reportService.downloadReport(r._id).subscribe({next:n=>Cc(this,null,function*(){let i=n;if(!(yield this._isPdfBlob(n))&&(i=yield this._blobFromJsonBytes(n),!i)){let l=yield this._parseBlobError(n);this._snack.open(l||this._transloco.translate("smartReport.invalidPdfReceived"),"Close",{duration:4e3});return}let o=URL.createObjectURL(i),a=document.createElement("a");a.href=o,a.download=`SmartReport_${r._id}.pdf`,a.click(),URL.revokeObjectURL(o),this._snack.open(this._transloco.translate("smartReport.pdfDownloaded"),"Close",{duration:2e3})}),error:()=>{this._snack.open(this._transloco.translate("smartReport.failedToDownloadPdf"),"Close",{duration:3e3})},complete:()=>{this.isSending.set(!1)}})}_escapeCsvRow(r){return r.map(n=>{let i=String(n??"");return i.includes(",")||i.includes('"')||i.includes(`
`)||i.includes("\r")?`"${i.replace(/"/g,'""')}"`:i}).join(",")}downloadAsCsv(){let r=this.stepResultBlocks();if(r.length===0){this._snack.open(this._transloco.translate("smartReport.noStepResultsYet"),"Close",{duration:3e3});return}let n=new Set;for(let f of r)for(let d of f.rowResults)d.data!=null&&this.getStepResultFields(d.data).forEach(p=>n.add(p.label));let i=Array.from(n),s=["Step","Row #",...i],o=[this._escapeCsvRow(s)];for(let f of r)for(let d of f.rowResults){let p=new Map;d.data!=null&&this.getStepResultFields(d.data).forEach(w=>p.set(w.label,w.value));let g=i.map(w=>p.get(w)??""),x=[f.label,String(d.rowIndex+1),...g];o.push(this._escapeCsvRow(x))}let a=new Blob(["\uFEFF"+o.join(`
`)],{type:"text/csv;charset=utf-8"}),l=URL.createObjectURL(a),u=document.createElement("a");u.href=l,u.download=`batch-records_${this.batch()?.name||"export"}.csv`.replace(/[^a-z0-9_.-]/gi,"_"),u.click(),URL.revokeObjectURL(l),this._snack.open(this._transloco.translate("smartReport.csvDownloaded"),"Close",{duration:2e3})}downloadAsExcel(){let r=this.stepResultBlocks();if(r.length===0){this._snack.open(this._transloco.translate("smartReport.noStepResultsYet"),"Close",{duration:3e3});return}let n=new Set;for(let u of r)for(let f of u.rowResults)f.data!=null&&this.getStepResultFields(f.data).forEach(d=>n.add(d.label));let i=Array.from(n),s=[];s.push(["Step","Row #",...i]);for(let u of r)for(let f of u.rowResults){let d=new Map;f.data!=null&&this.getStepResultFields(f.data).forEach(g=>d.set(g.label,g.value));let p=i.map(g=>d.get(g)??"");s.push([u.label,f.rowIndex+1,...p])}let o=wm.book_new(),a=wm.aoa_to_sheet(s);wm.book_append_sheet(o,a,"Batch Records");let l=`batch-records_${this.batch()?.name||"export"}.xlsx`.replace(/[^a-z0-9_.-]/gi,"_");jD(o,l),this._snack.open(this._transloco.translate("smartReport.excelDownloaded"),"Close",{duration:2e3})}goBack(){let r=this.configId(),n=this.batchId();r&&n?this._router.navigate(["/smart-batch",r,"batch",n]):r&&this._router.navigate(["/smart-batch",r])}openReportBuilder(r=!1){let n=this.configId();if(!n)return;let i=this.batch(),s=i?.rows??[],o=this.selectedRowIndex(),a=o!=null?s.find(p=>p.rowIndex===o):s[0],l=a?{batchName:i?.name??"Batch",rowIndex:a.rowIndex,inputData:a.inputData??{},results:a.results??{}}:null;l&&this._previewDataService.setPendingPreviewData(l);let u=l?{state:{previewData:l}}:{},f=r?null:this.selectedTemplate()?._id,d=f?["/smart-batch",n,"report-builder",f]:["/smart-batch",n,"report-builder"];this._router.navigate(d,u)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=Ds({type:t,selectors:[["report-viewer"]],decls:24,vars:13,consts:[[1,"min-h-screen","w-full","bg-gray-50"],[1,"bg-white","border-b","border-gray-200","sticky","top-0","z-10"],[1,"w-full","px-4","sm:px-6","lg:px-8","py-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],["mat-icon-button","",3,"click","matTooltip"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500"],["mat-stroked-button","",1,"!rounded-xl",3,"click"],[1,"mr-2"],[1,"w-full","px-4","sm:px-6","lg:px-8","py-6"],[1,"flex","items-center","justify-center","h-64"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],["diameter","48"],[1,"lg:col-span-1"],[1,"bg-white","rounded-2xl","border","border-gray-200","overflow-hidden"],[1,"p-6"],[1,"font-semibold","text-gray-900","mb-4"],[1,"text-center","py-8","text-gray-400"],[1,"space-y-2","max-h-[320px]","overflow-y-auto","pr-1"],[1,"border-t","border-gray-100","px-6","py-4",3,"bg-emerald-50","bg-amber-50"],[1,"bg-white","rounded-2xl","border","border-gray-200","p-6","mt-6"],[1,"lg:col-span-2","space-y-6"],[1,"bg-gray-50","border-b","border-gray-200","px-6","py-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"font-semibold","text-gray-900"],[1,"text-xs","text-gray-500","mt-0.5"],[1,"flex","items-center","gap-2"],[1,"!rounded-lg",3,"value"],["mat-icon-button","",1,"!w-8","!h-8",3,"click","matTooltip"],[1,"!text-lg"],[1,"min-h-[600px]","p-6","overflow-auto"],[1,"flex","flex-col","items-center","justify-center","h-64","text-gray-400"],[1,"!text-4xl","!w-10","!h-10","mb-2"],[1,"text-sm"],["mat-flat-button","","color","primary",1,"mt-4","!rounded-xl","!bg-indigo-600",3,"click"],[1,"p-4","rounded-xl","border","cursor-pointer","transition-all",3,"border-indigo-500","bg-indigo-50","border-gray-200","hover:border-indigo-300"],[1,"p-4","rounded-xl","border","cursor-pointer","transition-all",3,"click"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-xl","flex","items-center","justify-center","shrink-0"],[1,"flex-1","min-w-0"],[1,"font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"inline-flex","items-center","gap-1","mt-1","text-xs","text-emerald-600"],[1,"inline-flex","items-center","gap-1","mt-1","text-xs","text-amber-600",3,"matTooltip"],[1,"!text-sm","!w-3.5","!h-3.5"],[1,"border-t","border-gray-100","px-6","py-4"],[1,"text-sm","text-emerald-700","mb-3","flex","items-start","gap-2"],[1,"!text-lg","!w-5","!h-5","shrink-0","mt-0.5"],["mat-stroked-button","",1,"!rounded-xl","!text-emerald-700","!border-emerald-300","!inline-flex","!items-center","!justify-center",3,"click"],[1,"mr-2","!text-lg","!align-middle"],[1,"text-sm","text-amber-700","mb-2","flex","items-start","gap-2"],[1,"text-xs","text-amber-600/80","mb-3","pl-7"],["mat-stroked-button","",1,"!rounded-xl","!text-amber-700","!border-amber-300","!inline-flex","!items-center","!justify-center",3,"click"],[1,"space-y-3"],["mat-flat-button","","color","primary",1,"w-full","!rounded-xl","!bg-indigo-600","!inline-flex","!items-center","!justify-center",3,"click","disabled"],[1,"border-t","border-gray-100","pt-3","mt-3"],[1,"animate-spin","mr-2","!align-middle"],["mat-stroked-button","",1,"w-full","!rounded-xl","!inline-flex","!items-center","!justify-center",3,"click"],[1,"mr-2","!align-middle"],["mat-stroked-button","",1,"w-full","!rounded-xl","!inline-flex","!items-center","!justify-center",3,"click","disabled"],[1,"text-xs","text-gray-500","mb-2","uppercase","font-medium"],[1,"space-y-2"],[1,"!rounded-lg",3,"change","value"],["value","table"],["value","json"],["value","excel-ag"],["value","excel-ht"],[1,"flex","flex-col","items-center","justify-center","py-12","text-gray-400"],[1,"!text-5xl","!w-12","!h-12","mb-3"],[1,"text-sm","font-medium"],[1,"text-xs","mt-1"],[1,"excel-view-container","mx-auto","rounded-xl","overflow-hidden",2,"height","480px","width","100%"],[1,"mx-auto","bg-[#fafafa]","rounded-lg","border","border-gray-200","shadow-sm","p-6","min-h-[400px]",2,"max-width","210mm"],[1,"ag-theme-quartz",2,"width","100%","height","100%",3,"rowData","columnDefs","defaultColDef","rowHeight","headerHeight","suppressRowClickSelection","domLayout"],[3,"data","settings"],[1,"space-y-4"],[1,"bg-white","border","border-gray-200","rounded-lg","overflow-hidden","shadow-sm"],[1,"flex","items-center","gap-3","px-4","py-2.5","border-b","border-gray-100","bg-gray-50"],[1,"!text-base","text-gray-400"],[1,"px-4","py-3","bg-white","border-t","border-gray-100","overflow-x-auto"],[1,"mb-4","last:mb-0"],[1,"text-xs","font-medium","text-gray-500","mb-2"],[1,"text-gray-400"],[1,"w-full","text-sm","border-collapse"],[1,"text-sm","text-gray-400","py-2"],[1,"border-b","border-gray-100","last:border-0"],[1,"py-2","pr-4","align-top","text-gray-500",2,"min-width","140px"],[1,"py-2","break-words","text-gray-900"],[1,"border-b","border-gray-100","last:border-0","pb-3","last:pb-0","mb-3","last:mb-0"],[1,"bg-gray-50","rounded-lg","p-3","text-xs","font-mono","text-gray-800","overflow-auto","max-h-64"],["diameter","48",1,"mb-4"],[3,"template","previewData","primaryColor","orientation","clickable"],[1,"flex","items-center","justify-center","gap-4","mt-6","pt-4","border-t","border-gray-200"],["mat-icon-button","",3,"click","disabled","matTooltip"],[1,"text-sm","text-gray-600"],[1,"!text-6xl","!w-16","!h-16","mb-4"],[1,"text-lg","mb-2"]],template:function(n,i){if(n&1&&(ye(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),Ve(6,"transloco"),hn("click",function(){return i.goBack()}),ye(7,"mat-icon"),Me(8,"arrow_back"),Ee()(),ye(9,"div")(10,"h1",6),Me(11),Ve(12,"transloco"),Ee(),ye(13,"p",7),Me(14),Ve(15,"transloco"),Ee()()(),ye(16,"button",8),hn("click",function(){return i.openReportBuilder(!0)}),ye(17,"mat-icon",9),Me(18,"design_services"),Ee(),Me(19),Ve(20,"transloco"),Ee()()()(),ye(21,"div",10),tr(22,jte,2,0,"div",11)(23,Rre,42,25,"div",12),Ee()()),n&2){let s;Ae(5),li("matTooltip",Ge(6,5,"smartReport.back")),Ae(6),ct(" ",Ge(12,7,"smartReport.generateReport")," "),Ae(3),ct(" ",((s=i.batch())==null?null:s.name)||Ge(15,9,"smartReport.batchReport")," "),Ae(5),ct(" ",Ge(20,11,"smartReport.createTemplate")," "),Ae(3),dr(i.isLoading()?22:23)}},dependencies:[iC,lC,FC,dC,hC,fC,AC,RC,OC,uC,pC,mC,TC,EC,bC,SC,xC,_C,wC,vC,PC,WC,kM,IM],encapsulation:2,data:{animation:[CC]}})}}return t})();export{j2e as ReportViewerComponent};
