import{a as V,b as A}from"./chunk-7U2G2KZB.js";import{b as E,d as M}from"./chunk-46LJSX56.js";import{V as I,X as T,Z as P,_ as B}from"./chunk-P6URDTDE.js";import{Eb as e,Fb as t,Ga as u,Gb as m,Kb as v,Mb as b,Nb as c,Oc as S,Wa as s,Xb as n,Yb as y,Zb as k,ad as C,fb as _,ga as f,lb as w,qa as g,ra as h,sb as d}from"./chunk-EDXCCCUI.js";import"./chunk-MG3ERZGY.js";function j(r,p){r&1&&(e(0,"div",14)(1,"div",15),m(2,"div",16),e(3,"div",17),m(4,"mat-spinner",18),t()(),e(5,"h1",19),n(6,"Authenticating"),t(),e(7,"p",20),n(8,"Connecting your Verifik account securely..."),t()())}function W(r,p){if(r&1&&(e(0,"div",14)(1,"div",21)(2,"mat-icon",22),n(3,"check_circle"),t()(),e(4,"h1",19),n(5,"Authenticated!"),t(),e(6,"p",23),n(7," Welcome back. We're getting things ready for you. "),t(),e(8,"div",24),m(9,"mat-spinner",25),e(10,"span",26),n(11),t()()()),r&2){let i=c();s(11),k("Redirecting in ",i.countdown(),"s")}}function D(r,p){if(r&1){let i=v();e(0,"div",14)(1,"div",27)(2,"mat-icon",28),n(3,"warning_amber"),t()(),e(4,"h1",19),n(5,"Access Denied"),t(),e(6,"p",29),n(7),t(),e(8,"button",30),b("click",function(){g(i);let o=c();return h(o.goToLogin())}),n(9," Return to Login "),t()()}if(r&2){let i=c();s(7),y(i.errorMessage())}}function F(r,p){if(r&1){let i=v();e(0,"div",14)(1,"div",31)(2,"mat-icon",32),n(3,"vpn_key"),t()(),e(4,"h1",19),n(5,"Action Required"),t(),e(6,"p",29),n(7," Please start from your Verifik dashboard to access SmartCheck services. "),t(),e(8,"div",33)(9,"a",34),n(10," Open Verifik Panel "),t(),e(11,"button",35),b("click",function(){g(i);let o=c();return h(o.continueWithoutAuth())}),n(12," Continue as Guest "),t()()()}}var O=(()=>{class r{constructor(){this._route=f(E),this._router=f(M),this.status=u("loading"),this.errorMessage=u(""),this.countdown=u(3)}ngOnInit(){this.processToken()}processToken(){let i=this._route.snapshot.queryParamMap.get("token"),a=this._route.snapshot.queryParamMap.get("redirect")||"/chat",o=this._route.snapshot.queryParamMap.get("user");if(!i){this.status.set("no_token");return}try{if(!this.isValidJWT(i))throw new Error("Invalid token format");if(localStorage.setItem("accessToken",i),o)try{let l=JSON.parse(atob(o));localStorage.setItem("verifik_account",JSON.stringify(l))}catch(l){console.warn("[Bridge] Could not parse user data:",l)}this.status.set("success");let x=setInterval(()=>{this.countdown.update(l=>l-1),this.countdown()<=0&&(clearInterval(x),this._router.navigate([a]))},1e3)}catch(x){this.status.set("error"),this.errorMessage.set(x.message||"An unexpected error occurred")}}isValidJWT(i){let a=i.split(".");if(a.length!==3)return!1;try{let o=JSON.parse(atob(a[1]));if(o.exp&&o.exp*1e3<Date.now())throw new Error("Token has expired");return!0}catch{return!1}}goToLogin(){window.location.href="https://app.verifik.co/auth/sign-in"}continueWithoutAuth(){this._router.navigate(["/chat"])}static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275cmp=_({type:r,selectors:[["app-bridge"]],decls:24,vars:4,consts:[[1,"min-h-screen","bg-[#F8FAFC]","flex","items-center","justify-center","p-4","relative","overflow-hidden"],[1,"absolute","inset-0","overflow-hidden","pointer-events-none"],[1,"absolute","-top-24","-left-24","w-96","h-96","bg-indigo-500/5","rounded-full","blur-3xl"],[1,"absolute","-bottom-24","-right-24","w-96","h-96","bg-purple-500/5","rounded-full","blur-3xl"],[1,"relative","bg-white","border","border-slate-100","rounded-[2.5rem]","p-10","max-w-md","w-full","shadow-[0_20px_60px_-15px_rgba(0,0,0,0.05)]"],[1,"flex","items-center","justify-center","gap-3","mb-10"],[1,"w-12","h-12","rounded-2xl","bg-gradient-to-tr","from-indigo-600","to-purple-600","flex","items-center","justify-center","shadow-lg","shadow-indigo-100"],[1,"text-white"],[1,"text-xl","font-bold","text-slate-900","leading-tight"],[1,"text-[10px]","uppercase","font-bold","tracking-[0.1em]","text-indigo-500"],["class","text-center",4,"ngIf"],[1,"absolute","bottom-8","left-0","right-0","text-center"],[1,"text-slate-400","text-xs","font-medium","tracking-widest","uppercase"],[1,"text-indigo-500","text-[10px]","mx-1"],[1,"text-center"],[1,"relative","w-24","h-24","mx-auto","mb-8"],[1,"absolute","inset-0","rounded-3xl","bg-indigo-50","animate-pulse"],[1,"absolute","inset-0","flex","items-center","justify-center"],["diameter","40","strokeWidth","3"],[1,"text-2xl","font-bold","text-slate-900","mb-2"],[1,"text-slate-500"],[1,"w-20","h-20","mx-auto","mb-8","rounded-3xl","bg-emerald-50","flex","items-center","justify-center","animate-bounce-once"],[1,"text-emerald-600","text-4xl"],[1,"text-slate-500","mb-8"],[1,"inline-flex","items-center","gap-3","px-6","py-3","bg-slate-50","rounded-2xl"],["diameter","16","strokeWidth","2"],[1,"text-sm","font-medium","text-slate-600"],[1,"w-20","h-20","mx-auto","mb-8","rounded-3xl","bg-red-50","flex","items-center","justify-center"],[1,"text-red-500","text-4xl"],[1,"text-slate-500","mb-10"],["mat-flat-button","",1,"w-full","!rounded-2xl","!py-4","!bg-slate-900","!text-white","hover:!bg-slate-800","transition-all","font-semibold",3,"click"],[1,"w-20","h-20","mx-auto","mb-8","rounded-3xl","bg-amber-50","flex","items-center","justify-center"],[1,"text-amber-500","text-4xl"],[1,"space-y-4"],["href","https://app.verifik.co","target","_blank",1,"block","w-full","py-4","bg-gradient-to-r","from-indigo-600","to-indigo-700","hover:from-indigo-700","hover:to-indigo-800","text-white","font-bold","rounded-2xl","shadow-lg","shadow-indigo-100","transition-all","text-center"],["mat-button","",1,"w-full","!rounded-2xl","!py-4","!text-slate-500","hover:!bg-slate-50","font-medium",3,"click"]],template:function(a,o){a&1&&(e(0,"div",0)(1,"div",1),m(2,"div",2)(3,"div",3),t(),e(4,"div",4)(5,"div",5)(6,"div",6)(7,"mat-icon",7),n(8,"bolt"),t()(),e(9,"div")(10,"h2",8),n(11,"SmartCheck"),t(),e(12,"p",9),n(13," AI-Powered Platform "),t()()(),w(14,j,9,0,"div",10)(15,W,12,1,"div",10)(16,D,10,1,"div",10)(17,F,13,0,"div",10),t(),e(18,"div",11)(19,"p",12),n(20," Verifik "),e(21,"span",13),n(22,"\u25CF"),t(),n(23," SmartCheck "),t()()()),a&2&&(s(14),d("ngIf",o.status()==="loading"),s(),d("ngIf",o.status()==="success"),s(),d("ngIf",o.status()==="error"),s(),d("ngIf",o.status()==="no_token"))},dependencies:[C,S,A,V,B,P,T,I],styles:["@keyframes _ngcontent-%COMP%_bounce-once{0%,to{transform:scale(1)}50%{transform:scale(1.1)}}.animate-bounce-once[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce-once .5s ease-out}.delay-1000[_ngcontent-%COMP%]{animation-delay:1s}"]})}}return r})();var $=[{path:"",component:O}];export{$ as default};
