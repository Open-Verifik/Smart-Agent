import{D as Y,Ea as se,Gb as ge,H as Z,Q,Ra as ae,T as X,W as m,X as ee,Xa as k,Z as te,Za as oe,_a as A,aa as T,ab as ce,ba as ne,c as q,da as g,f as z,fa as p,fb as le,g as U,ga as f,gb as ue,hb as de,ib as fe,j as J,ja as L,k as $,l as R,oa as re,pa as ie,q as y,r as W,sb as he,w as M,ya as j,yc as D}from"./chunk-DCQLSIRV.js";import{a as d,b,c as G}from"./chunk-MG3ERZGY.js";function N(n){n||(re(N),n=f(j));let a=new q(e=>n.onDestroy(e.next.bind(e)));return e=>e.pipe(ee(a))}var P=class{translations;constructor(a){this.translations=a}getTranslation(a){return R(this.translations.get(a)||{})}},Le=new g("TRANSLOCO_LOADER");function x(n,a){return n&&(Object.prototype.hasOwnProperty.call(n,a)?n[a]:a.split(".").reduce((e,t)=>e?.[t],n))}function Ee(n,a,e){n=d({},n);let t=a.split("."),r=t.length-1;return t.reduce((i,s,o)=>(o===r?i[s]=e:i[s]=Array.isArray(i[s])?i[s].slice():d({},i[s]),i&&i[s]),n),n}function be(n){return n?Array.isArray(n)?n.length:E(n)?Object.keys(n).length:n?n.length:0:0}function $e(n){return be(n)===0}function ke(n){return typeof n=="function"}function O(n){return typeof n=="string"}function E(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function ye(n){return n.replace(/(?:^\w|[A-Z]|\b\w)/g,(a,e)=>e==0?a.toLowerCase():a.toUpperCase()).replace(/\s+|_|-|\//g,"")}function V(n){return n==null}function pe(n){return V(n)===!1}function me(n){return n&&typeof n.scope=="string"}function xe(n){return n&&E(n.loader)}function ve(n){let a={};function e(t,r){if(t===null)a[r]=null;else if(E(t))for(let[i,s]of Object.entries(t))e(s,r?`${r}.${i}`:i);else a[r]=t}return e(n,""),a}function _e(n){let a={};for(let[e,t]of Object.entries(n)){let r=e.split("."),i=a;r.forEach((s,o)=>{o===r.length-1?i[s]=t:(i[s]??={},i=i[s])})}return a}var w=new g("TRANSLOCO_CONFIG",{providedIn:"root",factory:()=>S}),S={defaultLang:"en",reRenderOnLangChange:!1,prodMode:!1,failedRetries:2,fallbackLang:[],availableLangs:[],missingHandler:{logMissingKey:!0,useFallbackTranslation:!1,allowEmpty:!1},flatten:{aot:!1},interpolation:["{{","}}"],scopes:{keepCasing:!1}};function Pe(n={}){return b(d(d({},S),n),{missingHandler:d(d({},S.missingHandler),n.missingHandler),flatten:d(d({},S.flatten),n.flatten),scopes:d(d({},S.scopes),n.scopes)})}var Te=new g("TRANSLOCO_TRANSPILER"),Ve=(()=>{class n{config=f(w,{optional:!0})??S;get interpolationMatcher(){return He(this.config)}transpile({value:e,params:t={},translation:r,key:i}){if(O(e)){let s,o=e;for(;(s=this.interpolationMatcher.exec(o))!==null;){let[l,c]=s;o=o.replace(l,()=>{let u=c.trim(),h=x(t,u);return pe(h)?h:pe(r[u])?this.transpile({params:t,translation:r,key:i,value:r[u]}):""})}return o}else t&&(E(e)?e=this.handleObject({value:e,params:t,translation:r,key:i}):Array.isArray(e)&&(e=this.handleArray({value:e,params:t,translation:r,key:i})));return e}handleObject({value:e,params:t={},translation:r,key:i}){let s=e;return Object.keys(t).forEach(o=>{let l=this.transpile({value:x(s,o),params:x(t,o),translation:r,key:i});s=Ee(s,o,l)}),s}handleArray(r){var i=r,{value:e}=i,t=G(i,["value"]);return e.map(s=>this.transpile(d({value:s},t)))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=T({token:n,factory:n.\u0275fac})}return n})();function He(n){let[a,e]=n.interpolation;return new RegExp(`${a}([^${a}${e}]*?)${e}`,"g")}var Se=new g("TRANSLOCO_MISSING_HANDLER"),Ke=(()=>{class n{handle(e,t){if(t.missingHandler.logMissingKey&&!t.prodMode){let r=`Missing translation for '${e}'`;console.warn(`%c ${r}`,"font-size: 12px; color: red")}return e}static \u0275fac=function(t){return new(t||n)};static \u0275prov=T({token:n,factory:n.\u0275fac})}return n})(),Oe=new g("TRANSLOCO_INTERCEPTOR"),Be=(()=>{class n{preSaveTranslation(e){return e}preSaveTranslationKey(e,t){return t}static \u0275fac=function(t){return new(t||n)};static \u0275prov=T({token:n,factory:n.\u0275fac})}return n})(),we=new g("TRANSLOCO_FALLBACK_STRATEGY"),Ge=(()=>{class n{userConfig;constructor(e){this.userConfig=e}getNextLangs(){let e=this.userConfig.fallbackLang;if(!e)throw new Error("When using the default fallback, a fallback language must be provided in the config!");return Array.isArray(e)?e:[e]}static \u0275fac=function(t){return new(t||n)(p(w))};static \u0275prov=T({token:n,factory:n.\u0275fac})}return n})();function C(n){if(!n)return"";let a=n.split("/");return a.pop(),a.join("/")}function v(n){return n?n.split("/").pop():""}function H(n,a,e="|"){if(O(n)){let t=n.split(e),r=t.pop();return r===a?[!0,t.toString()]:[!1,r]}return[!1,""]}function Ae(n,a){let[e]=H(a,"static");return e?!1:!!n.config.reRenderOnLangChange}function Ce(n){return n?a=>a:Z(1)}function qe(n,a){return Object.keys(n).reduce((e,t)=>(e[`${a}/${t}`]=n[t],e),{})}function B(n,a){return xe(n)?qe(n.loader,a):void 0}function _(n){return{scope:C(n)||null,langName:v(n)}}function Re(n){let{path:a,inlineLoader:e,mainLoader:t,data:r}=n;if(e){let i=e[a];if(ke(i)===!1)throw`You're using an inline loader but didn't provide a loader for ${a}`;return e[a]().then(s=>s.default?s.default:s)}return t.getTranslation(a,r)}function ze({mainLoader:n,path:a,data:e,fallbackPath:t,inlineLoader:r}){return(t?[a,t]:[a]).map(s=>{let o=Re({path:s,mainLoader:n,inlineLoader:r,data:e});return $(o).pipe(y(l=>({translation:l,lang:s})))})}var Ue;var Me=(()=>{class n{loader;parser;missingHandler;interceptor;fallbackStrategy;langChanges$;translations=new Map;cache=new Map;firstFallbackLang;defaultLang="";availableLangs=[];isResolvedMissingOnce=!1;lang;failedLangs=new Set;events=new z;events$=this.events.asObservable();config;constructor(e,t,r,i,s,o){this.loader=e,this.parser=t,this.missingHandler=r,this.interceptor=i,this.fallbackStrategy=o,this.loader||(this.loader=new P(this.translations)),Ue=this,this.config=JSON.parse(JSON.stringify(s)),this.setAvailableLangs(this.config.availableLangs||[]),this.setFallbackLangForMissingTranslation(this.config),this.setDefaultLang(this.config.defaultLang),this.lang=new U(this.getDefaultLang()),this.langChanges$=this.lang.asObservable(),this.events$.pipe(N()).subscribe(l=>{l.type==="translationLoadSuccess"&&l.wasFailure&&this.setActiveLang(l.payload.langName)})}getDefaultLang(){return this.defaultLang}setDefaultLang(e){this.defaultLang=e}getActiveLang(){return this.lang.getValue()}setActiveLang(e){return this.parser.onLangChanged?.(e),this.lang.next(e),this.events.next({type:"langChanged",payload:_(e)}),this}setAvailableLangs(e){this.availableLangs=e}getAvailableLangs(){return this.availableLangs}load(e,t={}){let r=this.cache.get(e);if(r)return r;let i,s=this._isLangScoped(e),o;s&&(o=C(e));let l={path:e,mainLoader:this.loader,inlineLoader:t.inlineLoader,data:s?{scope:o}:void 0};if(this.useFallbackTranslation(e)){let u=s?`${o}/${this.firstFallbackLang}`:this.firstFallbackLang,h=ze(b(d({},l),{fallbackPath:u}));i=M(h)}else{let u=Re(l);i=$(u)}let c=i.pipe(Q(this.config.failedRetries),te(u=>{if(Array.isArray(u)){u.forEach(h=>{this.handleSuccess(h.lang,h.translation),h.lang!==e&&this.cache.set(h.lang,R({}))});return}this.handleSuccess(e,u)}),Y(u=>(this.config.prodMode||console.error(`Error while trying to load "${e}"`,u),this.handleFailure(e,t))),X(1));return this.cache.set(e,c),c}translate(e,t={},r=this.getActiveLang()){if(!e)return e;let{scope:i,resolveLang:s}=this.resolveLangAndScope(r);if(Array.isArray(e))return e.map(c=>this.translate(i?`${i}.${c}`:c,t,s));e=i?`${i}.${e}`:e;let o=this.getTranslation(s),l=o[e];return l?this.parser.transpile({value:l,params:t,translation:o,key:e}):this._handleMissingKey(e,l,t)}selectTranslate(e,t,r,i=!1){let s,o=(c,u)=>this.load(c,u).pipe(y(()=>i?this.translateObject(e,t,c):this.translate(e,t,c)));if(V(r))return this.langChanges$.pipe(m(c=>o(c)));if(r=Array.isArray(r)?r[0]:r,me(r)){let c=r;r=c.scope,s=B(c,c.scope)}if(r=r,this.isLang(r)||this.isScopeWithLang(r))return o(r);let l=r;return this.langChanges$.pipe(m(c=>o(`${l}/${c}`,{inlineLoader:s})))}isScopeWithLang(e){return this.isLang(v(e))}translateObject(e,t={},r=this.getActiveLang()){if(O(e)||Array.isArray(e)){let{resolveLang:s,scope:o}=this.resolveLangAndScope(r);if(Array.isArray(e))return e.map(u=>this.translateObject(o?`${o}.${u}`:u,t,s));let l=this.getTranslation(s);e=o?`${o}.${e}`:e;let c=_e(this.getObjectByKey(l,e));return $e(c)?this.translate(e,t,r):this.parser.transpile({value:c,params:t,translation:l,key:e})}let i=[];for(let[s,o]of this.getEntries(e))i.push(this.translateObject(s,o,r));return i}selectTranslateObject(e,t,r){if(O(e)||Array.isArray(e))return this.selectTranslate(e,t,r,!0);let[[i,s],...o]=this.getEntries(e);return this.selectTranslateObject(i,s,r).pipe(y(l=>{let c=[l];for(let[u,h]of o)c.push(this.translateObject(u,h,r));return c}))}getTranslation(e){if(e){if(this.isLang(e))return this.translations.get(e)||{};{let{scope:t,resolveLang:r}=this.resolveLangAndScope(e),i=this.translations.get(r)||{};return this.getObjectByKey(i,t)}}return this.translations}selectTranslation(e){let t=this.langChanges$;if(e){let r=v(e)!==e;this.isLang(e)||r?t=R(e):t=this.langChanges$.pipe(y(i=>`${e}/${i}`))}return t.pipe(m(r=>this.load(r).pipe(y(()=>this.getTranslation(r)))))}setTranslation(e,t=this.getActiveLang(),r={}){let s=d(d({},{merge:!0,emitChange:!0}),r),o=C(t),l=e;if(o){let Fe=this.getMappedScope(o);l=ve({[Fe]:e})}let c=o?v(t):t,u=d(d({},s.merge&&this.getTranslation(c)),l),h=this.config.flatten.aot?u:ve(u),Ne=this.interceptor.preSaveTranslation(h,c);this.translations.set(c,Ne),s.emitChange&&this.setActiveLang(this.getActiveLang())}setTranslationKey(e,t,r={}){let i=r.lang||this.getActiveLang(),s=this.interceptor.preSaveTranslationKey(e,t,i),o={[e]:s};this.setTranslation(o,i,b(d({},r),{merge:!0}))}setFallbackLangForMissingTranslation({fallbackLang:e}){let t=Array.isArray(e)?e[0]:e;e&&this.useFallbackTranslation(t)&&(this.firstFallbackLang=t)}_handleMissingKey(e,t,r){if(this.config.missingHandler.allowEmpty&&t==="")return"";if(!this.isResolvedMissingOnce&&this.useFallbackTranslation()){this.isResolvedMissingOnce=!0;let i=this.translate(e,r,this.firstFallbackLang);return this.isResolvedMissingOnce=!1,i}return this.missingHandler.handle(e,this.getMissingHandlerData(),r)}_isLangScoped(e){return this.getAvailableLangsIds().indexOf(e)===-1}isLang(e){return this.getAvailableLangsIds().indexOf(e)!==-1}_loadDependencies(e,t){let r=v(e);return this._isLangScoped(e)&&!this.isLoadedTranslation(r)?W([this.load(r),this.load(e,{inlineLoader:t})]):this.load(e,{inlineLoader:t})}_completeScopeWithLang(e){return this._isLangScoped(e)&&!this.isLang(v(e))?`${e}/${this.getActiveLang()}`:e}_setScopeAlias(e,t){this.config.scopeMapping||(this.config.scopeMapping={}),this.config.scopeMapping[e]=t}ngOnDestroy(){this.cache.clear()}isLoadedTranslation(e){return be(this.getTranslation(e))}getAvailableLangsIds(){let e=this.getAvailableLangs()[0];return O(e)?this.getAvailableLangs():this.getAvailableLangs().map(t=>t.id)}getMissingHandlerData(){return b(d({},this.config),{activeLang:this.getActiveLang(),availableLangs:this.availableLangs,defaultLang:this.defaultLang})}useFallbackTranslation(e){return this.config.missingHandler.useFallbackTranslation&&e!==this.firstFallbackLang}handleSuccess(e,t){this.setTranslation(t,e,{emitChange:!1}),this.events.next({wasFailure:!!this.failedLangs.size,type:"translationLoadSuccess",payload:_(e)}),this.failedLangs.forEach(r=>this.cache.delete(r)),this.failedLangs.clear()}handleFailure(e,t){V(t.failedCounter)&&(t.failedCounter=0,t.fallbackLangs||(t.fallbackLangs=this.fallbackStrategy.getNextLangs(e)));let r=e.split("/"),s=t.fallbackLangs[t.failedCounter];if(this.failedLangs.add(e),this.cache.has(s))return this.handleSuccess(s,this.getTranslation(s)),J;let o=s===r[r.length-1];if(!s||o){let c="Unable to load translation and all the fallback languages";throw r.length>1&&(c+=", did you misspelled the scope name?"),new Error(c)}let l=s;return r.length>1&&(r[r.length-1]=s,l=r.join("/")),t.failedCounter++,this.events.next({type:"translationLoadFailure",payload:_(e)}),this.load(l,t)}getMappedScope(e){let{scopeMapping:t={},scopes:r={keepCasing:!1}}=this.config;return t[e]||(r.keepCasing?e:ye(e))}resolveLangAndScope(e){let t=e,r;if(this._isLangScoped(e)){let i=v(e),s=this.isLang(i);t=s?i:this.getActiveLang(),r=this.getMappedScope(s?C(e):e)}return{scope:r,resolveLang:t}}getObjectByKey(e,t){let r={},i=`${t}.`;for(let s in e)s.startsWith(i)&&(r[s.replace(i,"")]=e[s]);return r}getEntries(e){return e instanceof Map?e.entries():Object.entries(e)}static \u0275fac=function(t){return new(t||n)(p(Le,8),p(Te),p(Se),p(Oe),p(w),p(we))};static \u0275prov=T({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Je=(()=>{class n{html;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=le({type:n,selectors:[["ng-component"]],inputs:{html:"html"},decls:1,vars:1,consts:[[1,"transloco-loader-template",3,"innerHTML"]],template:function(t,r){t&1&&ge(0,"div",0),t&2&&he("innerHTML",r.html,ae)},encapsulation:2})}return n})(),K=class{view;vcr;constructor(a,e){this.view=a,this.vcr=e}attachView(){if(this.view instanceof k)this.vcr.createEmbeddedView(this.view);else if(O(this.view)){let a=this.vcr.createComponent(Je);a.instance.html=this.view,a.hostView.detectChanges()}else this.vcr.createComponent(this.view)}detachView(){this.vcr.clear()}},je=new g("TRANSLOCO_LANG"),We=new g("TRANSLOCO_LOADING_TEMPLATE"),De=new g("TRANSLOCO_SCOPE"),F=class{initialized=!1;resolve({inline:a,provider:e,active:t}){let r=t;if(this.initialized)return r=t,r;if(e){let[,i]=H(e,"static");r=i}if(a){let[,i]=H(a,"static");r=i}return this.initialized=!0,r}resolveLangBasedOnScope(a){return C(a)?v(a):a}resolveLangPath(a,e){return e?`${e}/${a}`:a}},I=class{service;constructor(a){this.service=a}resolve(a){let{inline:e,provider:t}=a;if(e)return e;if(t){if(me(t)){let{scope:r,alias:i=this.service.config.scopes.keepCasing?r:ye(r)}=t;return this.service._setScopeAlias(r,i),r}return t}}},Ft=(()=>{class n{destroyRef=f(j);service=f(Me);tpl=f(k,{optional:!0});providerLang=f(je,{optional:!0});providerScope=f(De,{optional:!0});providedLoadingTpl=f(We,{optional:!0});cdr=f(D);host=f(se);vcr=f(ce);renderer=f(oe);view;memo=new Map;key;params={};inlineScope;inlineRead;prefix;inlineLang;inlineTpl;currentLang;loaderTplHandler;initialized=!1;path;langResolver=new F;scopeResolver=new I(this.service);strategy=this.tpl===null?"attribute":"structural";static ngTemplateContextGuard(e,t){return!0}ngOnInit(){let e=Ae(this.service,this.providerLang||this.inlineLang);if(this.service.langChanges$.pipe(m(t=>{let r=this.langResolver.resolve({inline:this.inlineLang,provider:this.providerLang,active:t});return Array.isArray(this.providerScope)?M(this.providerScope.map(i=>this.resolveScope(r,i))):this.resolveScope(r,this.providerScope)}),Ce(e),N(this.destroyRef)).subscribe(()=>{this.currentLang=this.langResolver.resolveLangBasedOnScope(this.path),this.strategy==="attribute"?this.attributeStrategy():this.structuralStrategy(this.currentLang,this.prefix||this.inlineRead),this.cdr.markForCheck(),this.initialized=!0}),!this.initialized){let t=this.resolveLoadingContent();t&&(this.loaderTplHandler=new K(t,this.vcr),this.loaderTplHandler.attachView())}}ngOnChanges(e){this.strategy==="attribute"&&Object.keys(e).some(r=>!e[r].firstChange)&&this.attributeStrategy()}attributeStrategy(){this.detachLoader(),this.renderer.setProperty(this.host.nativeElement,"innerText",this.service.translate(this.key,this.params,this.currentLang))}structuralStrategy(e,t){this.memo.clear();let r=this.getTranslateFn(e,t);this.view?(this.view.context.$implicit=r,this.view.context.currentLang=this.currentLang):(this.detachLoader(),this.view=this.vcr.createEmbeddedView(this.tpl,{$implicit:r,currentLang:this.currentLang}))}getTranslateFn(e,t){return(r,i)=>{let s=t?`${t}.${r}`:r,o=i?`${s}${JSON.stringify(i)}`:s;return this.memo.has(o)||this.memo.set(o,this.service.translate(s,i,e)),this.memo.get(o)}}resolveLoadingContent(){return this.inlineTpl||this.providedLoadingTpl}ngOnDestroy(){this.memo.clear()}detachLoader(){this.loaderTplHandler?.detachView()}resolveScope(e,t){let r=this.scopeResolver.resolve({inline:this.inlineScope,provider:t});this.path=this.langResolver.resolveLangPath(e,r);let i=B(t,r);return this.service._loadDependencies(this.path,i)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=de({type:n,selectors:[["","transloco",""]],inputs:{key:[0,"transloco","key"],params:[0,"translocoParams","params"],inlineScope:[0,"translocoScope","inlineScope"],inlineRead:[0,"translocoRead","inlineRead"],prefix:[0,"translocoPrefix","prefix"],inlineLang:[0,"translocoLang","inlineLang"],inlineTpl:[0,"translocoLoadingTpl","inlineTpl"]},features:[ie]})}return n})(),It=(()=>{class n{service;providerScope;providerLang;cdr;subscription=null;lastValue="";lastKey;path;langResolver=new F;scopeResolver;constructor(e,t,r,i){this.service=e,this.providerScope=t,this.providerLang=r,this.cdr=i,this.scopeResolver=new I(this.service)}transform(e,t,r){if(!e)return e;let i=t?`${e}${JSON.stringify(t)}`:e;if(i===this.lastKey)return this.lastValue;this.lastKey=i,this.subscription?.unsubscribe();let s=Ae(this.service,this.providerLang||r);return this.subscription=this.service.langChanges$.pipe(m(o=>{let l=this.langResolver.resolve({inline:r,provider:this.providerLang,active:o});return Array.isArray(this.providerScope)?M(this.providerScope.map(c=>this.resolveScope(l,c))):this.resolveScope(l,this.providerScope)}),Ce(s)).subscribe(()=>this.updateValue(e,t)),this.lastValue}ngOnDestroy(){this.subscription?.unsubscribe(),this.subscription=null}updateValue(e,t){let r=this.langResolver.resolveLangBasedOnScope(this.path);this.lastValue=this.service.translate(e,t,r),this.cdr.markForCheck()}resolveScope(e,t){let r=this.scopeResolver.resolve({inline:void 0,provider:t});this.path=this.langResolver.resolveLangPath(e,r);let i=B(t,r);return this.service._loadDependencies(this.path,i)}static \u0275fac=function(t){return new(t||n)(A(Me,16),A(De,24),A(je,24),A(D,16))};static \u0275pipe=fe({name:"transloco",type:n,pure:!1})}return n})();var Et=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=ue({type:n});static \u0275inj=ne({})}return n})();function $t(n){let a=[Qe(Ve),et(Ke),tt(Be),Xe(Ge)];return n.config&&a.push(Ye(n.config)),n.loader&&a.push(Ze(n.loader)),a}function Ye(n){return L([{provide:w,useValue:Pe(n)}])}function Ze(n){return L([{provide:Le,useClass:n}])}function Qe(n){return L([{provide:Te,useClass:n,deps:[w]}])}function Xe(n){return L([{provide:we,useClass:n,deps:[w]}])}function et(n){return L([{provide:Se,useClass:n}])}function tt(n){return L([{provide:Oe,useClass:n}])}var kt=new g("TRANSLOCO_TEST_LANGS - Available testing languages"),xt=new g("TRANSLOCO_TEST_OPTIONS - Testing options");export{Me as a,Ft as b,It as c,Et as d,$t as e};
