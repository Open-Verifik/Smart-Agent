import{c as pe,d as se}from"./chunk-FX6L73G2.js";import{a as V,b as q,f as G}from"./chunk-UVXKGKGK.js";import{a as Y,c as M,d as T}from"./chunk-YTRC6VXI.js";import{d as W,e as L,f as Z,l as H,m as J}from"./chunk-CTJ3YQQD.js";import{A as ae,c as ee,h as te,i as ie,m as ne,q as oe,r as re,y as le}from"./chunk-FTPRZILN.js";import{U as X,V as K,X as Q,Z as R,_ as E}from"./chunk-KMUH6FME.js";import{Cb as F,Da as _,Db as D,Eb as r,Fb as l,Ga as $,Gb as y,Kb as z,Mb as C,Nb as c,Sa as I,Wa as i,Xb as s,Yb as h,Zb as g,aa as N,cd as P,fb as S,ga as w,hc as O,lb as v,oc as d,pc as u,qa as B,qc as U,ra as A,sb as b,tb as x,ub as k,zb as m}from"./chunk-BMVGBJ55.js";var Ue=(()=>{class t{constructor(){this._pendingPreviewData=$(null)}setPendingPreviewData(e){this._pendingPreviewData.set(e)}consumePendingPreviewData(){let e=this._pendingPreviewData();return this._pendingPreviewData.set(null),e}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var fe=t=>({path:t}),xe=(t,p)=>p.id,_e=(t,p)=>p.key;function ge(t,p){if(t&1&&(r(0,"div",7),s(1," Page 1 of 1 "),l()),t&2){let e=c();x("text-align",e.pageNumberPosition()==="top-left"?"left":e.pageNumberPosition()==="top-right"?"right":"center")}}function ve(t,p){if(t&1&&(r(0,"div",3),y(1,"img",8),l()),t&2){let e=c();i(),b("src",e.logoUrl(),I)}}function he(t,p){t&1&&(r(0,"div",4)(1,"mat-icon",9),s(2,"description"),l(),r(3,"p",10),s(4),d(5,"transloco"),l()()),t&2&&(i(4),h(u(5,1,"smartReport.noSectionsToPreview")))}function be(t,p){if(t&1&&(r(0,"div",15)(1,"h2",18),s(2),d(3,"transloco"),l()()),t&2){let e=c().$implicit,n=c();x("text-align",(e.style==null?null:e.style.textAlign)||"left"),i(),x("font-size",(e.style==null?null:e.style.fontSize)||22,"px")("font-weight",(e.style==null?null:e.style.fontWeight)||"bold")("color",(e.style==null?null:e.style.color)||n.primaryColor()),i(),g(" ",e.staticContent||e.label||u(3,9,"smartReport.untitled")," ")}}function ye(t,p){if(t&1&&(r(0,"div",13)(1,"p",19),s(2),d(3,"transloco"),l()()),t&2){let e=c().$implicit;i(),x("font-size",(e.style==null?null:e.style.fontSize)||12,"px")("font-weight",(e.style==null?null:e.style.fontWeight)||"normal")("text-align",(e.style==null?null:e.style.textAlign)||"left")("color",(e.style==null?null:e.style.color)||"#374151"),i(),g(" ",e.staticContent||u(3,9,"smartReport.textContent")," ")}}function Ce(t,p){if(t&1&&(r(0,"div",20)(1,"span",21),s(2),d(3,"transloco"),l(),r(4,"span",22),s(5),l()()),t&2){let e=c().$implicit,n=c();x("text-align",(e.style==null?null:e.style.textAlign)||"left"),i(),x("font-size",(e.style==null?null:e.style.fontSize)||12,"px"),i(),h(e.label||u(3,10,"smartReport.field")),i(2),x("font-size",(e.style==null?null:e.style.fontSize)||12,"px")("color",(e.style==null?null:e.style.color)||"#111827"),i(),h(n.resolveDataPath(e.dataPath)||"\u2014")}}function we(t,p){if(t&1&&(r(0,"h4",26),s(1),l()),t&2){let e=c(2).$implicit,n=c();x("color",n.primaryColor()),i(),g(" ",e.label," ")}}function Se(t,p){if(t&1&&(r(0,"tr",25)(1,"td",27),s(2),l(),r(3,"td",28),s(4),l()()),t&2){let e=p.$implicit;i(2),h(e.key),i(2),g(" ",e.value," ")}}function Pe(t,p){if(t&1&&(r(0,"tr")(1,"td",29),s(2),d(3,"transloco"),l()()),t&2){let e=c(2).$implicit;i(2),g(" ",U(3,1,"smartReport.noDataAtPath",O(4,fe,e.dataPath))," ")}}function Re(t,p){if(t&1&&(r(0,"div",15),v(1,we,2,3,"h4",23),r(2,"table",24)(3,"tbody"),F(4,Se,5,2,"tr",25,_e),v(6,Pe,4,6,"tr"),l()()()),t&2){let e=c().$implicit,n=c();i(),m(e.label?1:-1),i(3),D(n.resolveTableData(e.dataPath)),i(2),m(n.resolveTableData(e.dataPath).length===0?6:-1)}}function Ee(t,p){if(t&1&&(y(0,"img",30),d(1,"transloco")),t&2){let e=c(2).$implicit;b("src",e.staticContent,I)("alt",e.label||u(1,2,"smartReport.image"))}}function Me(t,p){t&1&&(r(0,"div",31)(1,"mat-icon",32),s(2,"image"),l()())}function Te(t,p){if(t&1&&(r(0,"div",15),v(1,Ee,2,4,"img",30)(2,Me,3,0,"div",31),l()),t&2){let e=c().$implicit;x("text-align",(e.style==null?null:e.style.textAlign)||"center"),i(),m(e.staticContent?1:2)}}function Ie(t,p){if(t&1&&y(0,"hr",33),t&2){let e=c().$implicit;x("border-color",(e.style==null?null:e.style.color)||"#E5E7EB")}}function ke(t,p){if(t&1&&y(0,"div"),t&2){let e=c().$implicit;x("height",(e.style==null?null:e.style.padding)||16,"px")}}function Fe(t,p){if(t&1){let e=z();r(0,"div",11),C("click",function(){let o=B(e).$implicit,a=c();return A(a.clickable()&&a.sectionClick()?a.sectionClick()(o):null)}),v(1,be,4,11,"div",12)(2,ye,4,11,"div",13)(3,Ce,6,12,"div",14)(4,Re,7,2,"div",15)(5,Te,3,3,"div",12)(6,Ie,1,2,"hr",16)(7,ke,1,2,"div",17),l()}if(t&2){let e=p.$implicit,n=c();k("cursor-pointer",n.clickable())("ring-2",n.clickable()&&n.selectedSectionId()===e.id)("ring-indigo-400",n.clickable()&&n.selectedSectionId()===e.id)("rounded-md",n.clickable()&&n.selectedSectionId()===e.id),i(),m(e.type==="header"?1:-1),i(),m(e.type==="text"?2:-1),i(),m(e.type==="field"?3:-1),i(),m(e.type==="table"?4:-1),i(),m(e.type==="image"?5:-1),i(),m(e.type==="divider"?6:-1),i(),m(e.type==="spacer"?7:-1)}}function De(t,p){if(t&1&&(r(0,"div",34)(1,"p",36),s(2),l()()),t&2){let e=c(2);i(2),g(" ",e.legend()," ")}}function je(t,p){if(t&1&&(r(0,"div",37),s(1," Page 1 of 1 "),l()),t&2){let e=c(2);x("text-align",e.pageNumberPosition()==="bottom-left"?"left":e.pageNumberPosition()==="bottom-right"?"right":"center"),k("border-t",!e.legend())("border-gray-200",!e.legend())("pt-3",!e.legend())}}function Ne(t,p){if(t&1&&(r(0,"div",6),v(1,De,3,1,"div",34)(2,je,2,8,"div",35),l()),t&2){let e=c();i(),m(e.legend()?1:-1),i(),m(e.showPageNumbers()&&e.pageNumberPosition().startsWith("bottom")?2:-1)}}var He=(()=>{class t{constructor(){this.template=_.required(),this.previewData=_.required(),this.primaryColor=_("#4F46E5"),this.orientation=_("portrait"),this.clickable=_(!1),this.selectedSectionId=_(null),this.sectionClick=_(null),this.logoUrl=_(null),this.legend=_(""),this.showPageNumbers=_(!1),this.pageNumberPosition=_("bottom-center")}resolveDataPath(e){if(!e)return"";let n=this.previewData(),o=e.split("."),a=n;for(let f of o){if(a==null||typeof a!="object")return"";a=a[f]}return a==null?"":typeof a=="object"?JSON.stringify(a):String(a)}resolveTableData(e){if(!e)return[];let n=this.previewData(),o=e.split("."),a=n;for(let f of o){if(a==null||typeof a!="object")return[];a=a[f]}return a==null||typeof a!="object"?[]:Object.entries(a).map(([f,j])=>({key:this._humanize(f),value:j!=null?String(j):""}))}_humanize(e){return e.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/^./,n=>n.toUpperCase()).trim()}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=S({type:t,selectors:[["report-preview"]],inputs:{template:[1,"template"],previewData:[1,"previewData"],primaryColor:[1,"primaryColor"],orientation:[1,"orientation"],clickable:[1,"clickable"],selectedSectionId:[1,"selectedSectionId"],sectionClick:[1,"sectionClick"],logoUrl:[1,"logoUrl"],legend:[1,"legend"],showPageNumbers:[1,"showPageNumbers"],pageNumberPosition:[1,"pageNumberPosition"]},decls:8,vars:8,consts:[[1,"bg-white","rounded-lg","shadow-lg","mx-auto","overflow-hidden","flex","flex-col",2,"border","1px solid #e5e7eb"],[1,"px-8","pt-4","text-[10px]","text-gray-400",3,"text-align"],[1,"p-8","sm:p-10","lg:p-12","flex-1"],[1,"mb-6"],[1,"flex","flex-col","items-center","justify-center","h-64","text-gray-300"],[1,"transition-all","duration-200",3,"cursor-pointer","ring-2","ring-indigo-400","rounded-md"],[1,"px-8","sm:px-10","lg:px-12","pb-6","mt-auto"],[1,"px-8","pt-4","text-[10px]","text-gray-400"],["alt","Logo",1,"h-10","max-w-[180px]","object-contain",3,"src"],[1,"!text-5xl","!w-14","!h-14","mb-3"],[1,"text-sm"],[1,"transition-all","duration-200",3,"click"],[1,"mb-4",3,"text-align"],[1,"mb-3"],[1,"flex","gap-3","py-2.5","border-b","border-gray-100",3,"text-align"],[1,"mb-4"],[1,"my-4",2,"border-width","1px",3,"border-color"],[3,"height"],[1,"leading-tight"],[1,"leading-relaxed","whitespace-pre-wrap"],[1,"flex","gap-3","py-2.5","border-b","border-gray-100"],[1,"text-gray-500","min-w-[140px]","shrink-0"],[1,"text-gray-900","font-medium"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wide","mb-2",3,"color"],[1,"w-full","text-sm"],[1,"border-b","border-gray-100"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wide","mb-2"],[1,"py-2","pr-4","text-gray-500","w-1/3"],[1,"py-2","text-gray-900","font-medium"],["colspan","2",1,"py-4","text-center","text-gray-300","text-xs"],[1,"max-h-32","inline-block","rounded",2,"max-width","100%",3,"src","alt"],[1,"inline-flex","items-center","justify-center","w-48","h-24","bg-gray-100","rounded-lg","text-gray-300"],[1,"!text-3xl"],[1,"my-4",2,"border-width","1px"],[1,"border-t","border-gray-200","pt-3","mb-2"],[1,"text-[10px]","text-gray-400",3,"border-t","border-gray-200","pt-3","text-align"],[1,"text-[10px]","text-gray-400","leading-relaxed","whitespace-pre-wrap"],[1,"text-[10px]","text-gray-400"]],template:function(n,o){if(n&1&&(r(0,"div",0),v(1,ge,2,2,"div",1),r(2,"div",2),v(3,ve,2,1,"div",3)(4,he,6,3,"div",4),F(5,Fe,8,15,"div",5,xe),l(),v(7,Ne,3,2,"div",6),l()),n&2){let a;x("max-width",o.orientation()==="landscape"?"297mm":"210mm")("min-height",o.orientation()==="landscape"?"210mm":"297mm"),i(),m(o.showPageNumbers()&&o.pageNumberPosition().startsWith("top")?1:-1),i(2),m(o.logoUrl()?3:-1),i(),m(((a=o.template().sections)==null?null:a.length)===0?4:-1),i(),D(o.template().sections),i(2),m(o.legend()||o.showPageNumbers()&&o.pageNumberPosition().startsWith("bottom")?7:-1)}},dependencies:[P,E,R,T,M],encapsulation:2})}}return t})();function Be(t,p){t&1&&(r(0,"mat-error"),s(1),d(2,"transloco"),l()),t&2&&(i(),h(u(2,1,"smartReport.atLeastOneRecipient")))}function Ae(t,p){t&1&&(r(0,"mat-error"),s(1),d(2,"transloco"),l()),t&2&&(i(),h(u(2,1,"smartReport.enterValidEmails")))}var me=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function $e(t){let p=(t.value||"").trim();if(!p)return{required:!0};let e=p.split(",").map(o=>o.trim()).filter(o=>!!o);if(e.length===0)return{required:!0};let n=e.filter(o=>!me.test(o));return n.length>0?{invalidEmails:{value:n}}:null}var ct=(()=>{class t{get isSample(){return this._data?.isSample!==!1}get subjectPlaceholder(){return this.isSample?this._transloco.translate("smartReport.subjectOptionalPlaceholder"):this._transloco.translate("smartReport.reportBatchPlaceholder")}constructor(){this._dialogRef=w(V),this._fb=w(le),this._data=w(q,{optional:!0}),this._transloco=w(Y);let e=this._data?.defaultSubject||(this._data?.isSample===!1?this._transloco.translate("smartReport.reportBatchPlaceholder"):this._transloco.translate("smartReport.subjectOptionalPlaceholder"));this.form=this._fb.group({recipients:["",[$e]],subject:[e,[]]})}onCancel(){this._dialogRef.close()}onSubmit(){let e=this.form.get("recipients");if(this.form.invalid||!e)return;let n=(e.value||"").split(",").map(f=>f.trim()).filter(f=>!!f),o=n.filter(f=>me.test(f));if(o.length===0){e.setErrors(n.length===0?{required:!0}:{invalidEmails:{value:n}}),e.markAsTouched();return}let a={recipients:o,subject:this.form.get("subject")?.value?.trim()||void 0};this._dialogRef.close(a)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=S({type:t,selectors:[["send-sample-modal"]],decls:43,vars:29,consts:[[1,"flex","flex-col","w-full","max-w-lg"],[1,"px-6","pt-6","pb-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"w-12","h-12","rounded-xl","bg-gradient-to-br","from-indigo-500","to-purple-600","flex","items-center","justify-center","shadow-lg","shadow-indigo-500/25"],[1,"!w-6","!h-6","text-white","icon-size-6"],[1,"text-lg","font-bold","text-slate-900","dark:text-white"],[1,"text-sm","text-slate-500","dark:text-slate-400"],["mat-icon-button","",1,"!-mr-2",3,"click"],[1,"px-6","pb-6","space-y-4",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","recipients","rows","3",3,"placeholder"],["matInput","","formControlName","subject",3,"placeholder"],[1,"flex","gap-3","pt-2","justify-end","border-t","border-slate-200","dark:border-slate-700"],["mat-button","","type","button",1,"!text-slate-600",3,"click"],["mat-flat-button","","color","primary","type","submit",1,"!rounded-xl","!bg-indigo-600","!text-white",3,"disabled"],[1,"!w-4","!h-4","mr-1"]],template:function(n,o){if(n&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-icon",5),s(6,"send"),l()(),r(7,"div")(8,"h2",6),s(9),d(10,"transloco"),l(),r(11,"p",7),s(12),d(13,"transloco"),l()()(),r(14,"button",8),C("click",function(){return o.onCancel()}),r(15,"mat-icon"),s(16,"close"),l()()()(),r(17,"form",9),C("ngSubmit",function(){return o.onSubmit()}),r(18,"mat-form-field",10)(19,"mat-label"),s(20),d(21,"transloco"),l(),y(22,"textarea",11),d(23,"transloco"),r(24,"mat-hint"),s(25),d(26,"transloco"),l(),v(27,Be,3,3,"mat-error")(28,Ae,3,3,"mat-error"),l(),r(29,"mat-form-field",10)(30,"mat-label"),s(31),d(32,"transloco"),l(),y(33,"input",12),l(),r(34,"div",13)(35,"button",14),C("click",function(){return o.onCancel()}),s(36),d(37,"transloco"),l(),r(38,"button",15)(39,"mat-icon",16),s(40,"send"),l(),s(41),d(42,"transloco"),l()()()()),n&2){let a,f;i(9),g(" ",u(10,13,o.isSample?"smartReport.sendSampleReport":"smartReport.sendReport")," "),i(3),g(" ",u(13,15,"smartReport.enterRecipientsAndSubject")," "),i(5),b("formGroup",o.form),i(3),h(u(21,17,"smartReport.recipientEmails")),i(2),b("placeholder",u(23,19,"smartReport.recipientsPlaceholder")),i(3),h(u(26,21,"smartReport.separateEmailsWithCommas")),i(2),m((a=o.form.get("recipients"))!=null&&a.hasError("required")&&((a=o.form.get("recipients"))!=null&&a.touched)?27:-1),i(),m((f=o.form.get("recipients"))!=null&&f.hasError("invalidEmails")&&((f=o.form.get("recipients"))!=null&&f.touched)?28:-1),i(3),h(u(32,23,"smartReport.subjectOptional")),i(2),b("placeholder",o.subjectPlaceholder),i(3),g(" ",u(37,25,"smartReport.cancel")," "),i(2),b("disabled",o.form.invalid||o.form.pending),i(3),g(" ",u(42,27,o.isSample?"smartReport.sendSample":"smartReport.sendReport")," ")}},dependencies:[P,ae,ne,ee,te,ie,oe,re,G,Q,K,X,E,R,J,H,W,Z,L,se,pe,T,M],styles:["[_nghost-%COMP%]{display:block}"]})}}return t})();export{Ue as a,He as b,ct as c};
