import{c as pe,d as se}from"./chunk-LDUENTKQ.js";import{a as q,b as G,f as L}from"./chunk-ZTINX6NI.js";import{a as Y,c as M,d as I}from"./chunk-R2OL6BAE.js";import{d as Z,e as W,f as U,l as H,m as J}from"./chunk-73HLGNEA.js";import{A as ae,c as ee,h as te,i as ie,m as ne,q as oe,r as re,y as le}from"./chunk-UUWZXEWR.js";import{U as X,V as K,X as Q,Z as R,_ as E}from"./chunk-IJNYHMLE.js";import{Cb as k,Da as v,Db as T,Eb as l,Fb as a,Ga as A,Gb as b,Kb as N,Mb as C,Nb as m,Sa as $,Wa as i,Xb as p,Yb as x,Zb as g,aa as D,ad as P,fb as w,ga as S,gc as O,lb as h,mc as c,nc as d,oc as V,qa as j,ra as B,sb as y,tb as _,ub as z,zb as f}from"./chunk-IQHBJK6X.js";var Ae=(()=>{class t{constructor(){this._pendingPreviewData=A(null)}setPendingPreviewData(e){this._pendingPreviewData.set(e)}consumePendingPreviewData(){let e=this._pendingPreviewData();return this._pendingPreviewData.set(null),e}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var fe=t=>({path:t}),xe=(t,s)=>s.id,_e=(t,s)=>s.key;function ve(t,s){t&1&&(l(0,"div",2)(1,"mat-icon",4),p(2,"description"),a(),l(3,"p",5),p(4),c(5,"transloco"),a()()),t&2&&(i(4),x(d(5,1,"smartReport.noSectionsToPreview")))}function he(t,s){if(t&1&&(l(0,"div",10)(1,"h2",13),p(2),c(3,"transloco"),a()()),t&2){let e=m().$implicit,n=m();_("text-align",(e.style==null?null:e.style.textAlign)||"left"),i(),_("font-size",(e.style==null?null:e.style.fontSize)||22,"px")("font-weight",(e.style==null?null:e.style.fontWeight)||"bold")("color",(e.style==null?null:e.style.color)||n.primaryColor()),i(),g(" ",e.staticContent||e.label||d(3,9,"smartReport.untitled")," ")}}function ge(t,s){if(t&1&&(l(0,"div",8)(1,"p",14),p(2),c(3,"transloco"),a()()),t&2){let e=m().$implicit;i(),_("font-size",(e.style==null?null:e.style.fontSize)||12,"px")("font-weight",(e.style==null?null:e.style.fontWeight)||"normal")("text-align",(e.style==null?null:e.style.textAlign)||"left")("color",(e.style==null?null:e.style.color)||"#374151"),i(),x(e.staticContent||d(3,9,"smartReport.textContent"))}}function ye(t,s){if(t&1&&(l(0,"div",15)(1,"span",16),p(2),c(3,"transloco"),a(),l(4,"span",17),p(5),a()()),t&2){let e=m().$implicit,n=m();_("text-align",(e.style==null?null:e.style.textAlign)||"left"),i(),_("font-size",(e.style==null?null:e.style.fontSize)||12,"px"),i(),x(e.label||d(3,10,"smartReport.field")),i(2),_("font-size",(e.style==null?null:e.style.fontSize)||12,"px")("color",(e.style==null?null:e.style.color)||"#111827"),i(),x(n.resolveDataPath(e.dataPath)||"\u2014")}}function be(t,s){if(t&1&&(l(0,"h4",21),p(1),a()),t&2){let e=m(2).$implicit,n=m();_("color",n.primaryColor()),i(),x(e.label)}}function Ce(t,s){if(t&1&&(l(0,"tr",20)(1,"td",22),p(2),a(),l(3,"td",23),p(4),a()()),t&2){let e=s.$implicit;i(2),x(e.key),i(2),x(e.value)}}function Se(t,s){if(t&1&&(l(0,"tr")(1,"td",24),p(2),c(3,"transloco"),a()()),t&2){let e=m(2).$implicit;i(2),g(" ",V(3,1,"smartReport.noDataAtPath",O(4,fe,e.dataPath))," ")}}function we(t,s){if(t&1&&(l(0,"div",10),h(1,be,2,3,"h4",18),l(2,"table",19)(3,"tbody"),k(4,Ce,5,2,"tr",20,_e),h(6,Se,4,6,"tr"),a()()()),t&2){let e=m().$implicit,n=m();i(),f(e.label?1:-1),i(3),T(n.resolveTableData(e.dataPath)),i(2),f(n.resolveTableData(e.dataPath).length===0?6:-1)}}function Pe(t,s){if(t&1&&(b(0,"img",25),c(1,"transloco")),t&2){let e=m(2).$implicit;y("src",e.staticContent,$)("alt",e.label||d(1,2,"smartReport.image"))}}function Re(t,s){t&1&&(l(0,"div",26)(1,"mat-icon",27),p(2,"image"),a()())}function Ee(t,s){if(t&1&&(l(0,"div",10),h(1,Pe,2,4,"img",25)(2,Re,3,0,"div",26),a()),t&2){let e=m().$implicit;_("text-align",(e.style==null?null:e.style.textAlign)||"center"),i(),f(e.staticContent?1:2)}}function Me(t,s){if(t&1&&b(0,"hr",28),t&2){let e=m().$implicit;_("border-color",(e.style==null?null:e.style.color)||"#E5E7EB")}}function Ie(t,s){if(t&1&&b(0,"div"),t&2){let e=m().$implicit;_("height",(e.style==null?null:e.style.padding)||16,"px")}}function ke(t,s){if(t&1){let e=N();l(0,"div",6),C("click",function(){let o=j(e).$implicit,r=m();return B(r.clickable()&&r.sectionClick()?r.sectionClick()(o):null)}),h(1,he,4,11,"div",7)(2,ge,4,11,"div",8)(3,ye,6,12,"div",9)(4,we,7,2,"div",10)(5,Ee,3,3,"div",7)(6,Me,1,2,"hr",11)(7,Ie,1,2,"div",12),a()}if(t&2){let e=s.$implicit,n=m();z("cursor-pointer",n.clickable())("ring-2",n.clickable()&&n.selectedSectionId()===e.id)("ring-indigo-400",n.clickable()&&n.selectedSectionId()===e.id)("rounded-md",n.clickable()&&n.selectedSectionId()===e.id),i(),f(e.type==="header"?1:-1),i(),f(e.type==="text"?2:-1),i(),f(e.type==="field"?3:-1),i(),f(e.type==="table"?4:-1),i(),f(e.type==="image"?5:-1),i(),f(e.type==="divider"?6:-1),i(),f(e.type==="spacer"?7:-1)}}var Ge=(()=>{class t{constructor(){this.template=v.required(),this.previewData=v.required(),this.primaryColor=v("#4F46E5"),this.orientation=v("portrait"),this.clickable=v(!1),this.selectedSectionId=v(null),this.sectionClick=v(null)}resolveDataPath(e){if(!e)return"";let n=this.previewData(),o=e.split("."),r=n;for(let u of o){if(r==null||typeof r!="object")return"";r=r[u]}return r==null?"":typeof r=="object"?JSON.stringify(r):String(r)}resolveTableData(e){if(!e)return[];let n=this.previewData(),o=e.split("."),r=n;for(let u of o){if(r==null||typeof r!="object")return[];r=r[u]}return r==null||typeof r!="object"?[]:Object.entries(r).map(([u,F])=>({key:this._humanize(u),value:F!=null?String(F):""}))}_humanize(e){return e.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/^./,n=>n.toUpperCase()).trim()}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=w({type:t,selectors:[["report-preview"]],inputs:{template:[1,"template"],previewData:[1,"previewData"],primaryColor:[1,"primaryColor"],orientation:[1,"orientation"],clickable:[1,"clickable"],selectedSectionId:[1,"selectedSectionId"],sectionClick:[1,"sectionClick"]},decls:5,vars:5,consts:[[1,"bg-white","rounded-lg","shadow-lg","mx-auto","overflow-hidden",2,"border","1px solid #e5e7eb"],[1,"p-8","sm:p-10","lg:p-12"],[1,"flex","flex-col","items-center","justify-center","h-64","text-gray-300"],[1,"transition-all","duration-200",3,"cursor-pointer","ring-2","ring-indigo-400","rounded-md"],[1,"!text-5xl","!w-14","!h-14","mb-3"],[1,"text-sm"],[1,"transition-all","duration-200",3,"click"],[1,"mb-4",3,"text-align"],[1,"mb-3"],[1,"flex","gap-3","py-2.5","border-b","border-gray-100",3,"text-align"],[1,"mb-4"],[1,"my-4",2,"border-width","1px",3,"border-color"],[3,"height"],[1,"leading-tight"],[1,"leading-relaxed","whitespace-pre-wrap"],[1,"flex","gap-3","py-2.5","border-b","border-gray-100"],[1,"text-gray-500","min-w-[140px]","shrink-0"],[1,"text-gray-900","font-medium"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wide","mb-2",3,"color"],[1,"w-full","text-sm"],[1,"border-b","border-gray-100"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wide","mb-2"],[1,"py-2","pr-4","text-gray-500","w-1/3"],[1,"py-2","text-gray-900","font-medium"],["colspan","2",1,"py-4","text-center","text-gray-300","text-xs"],[1,"max-h-32","inline-block","rounded",2,"max-width","100%",3,"src","alt"],[1,"inline-flex","items-center","justify-center","w-48","h-24","bg-gray-100","rounded-lg","text-gray-300"],[1,"!text-3xl"],[1,"my-4",2,"border-width","1px"]],template:function(n,o){if(n&1&&(l(0,"div",0)(1,"div",1),h(2,ve,6,3,"div",2),k(3,ke,8,15,"div",3,xe),a()()),n&2){let r;_("max-width",o.orientation()==="landscape"?"297mm":"210mm")("min-height",o.orientation()==="landscape"?"210mm":"297mm"),i(2),f(((r=o.template().sections)==null?null:r.length)===0?2:-1),i(),T(o.template().sections)}},dependencies:[P,E,R,I,M],encapsulation:2})}}return t})();function Te(t,s){t&1&&(l(0,"mat-error"),p(1),c(2,"transloco"),a()),t&2&&(i(),x(d(2,1,"smartReport.atLeastOneRecipient")))}function Fe(t,s){t&1&&(l(0,"mat-error"),p(1),c(2,"transloco"),a()),t&2&&(i(),x(d(2,1,"smartReport.enterValidEmails")))}var me=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function De(t){let s=(t.value||"").trim();if(!s)return{required:!0};let e=s.split(",").map(o=>o.trim()).filter(o=>!!o);if(e.length===0)return{required:!0};let n=e.filter(o=>!me.test(o));return n.length>0?{invalidEmails:{value:n}}:null}var rt=(()=>{class t{get isSample(){return this._data?.isSample!==!1}get subjectPlaceholder(){return this.isSample?this._transloco.translate("smartReport.subjectOptionalPlaceholder"):this._transloco.translate("smartReport.reportBatchPlaceholder")}constructor(){this._dialogRef=S(q),this._fb=S(le),this._data=S(G,{optional:!0}),this._transloco=S(Y);let e=this._data?.defaultSubject||(this._data?.isSample===!1?this._transloco.translate("smartReport.reportBatchPlaceholder"):this._transloco.translate("smartReport.subjectOptionalPlaceholder"));this.form=this._fb.group({recipients:["",[De]],subject:[e,[]]})}onCancel(){this._dialogRef.close()}onSubmit(){let e=this.form.get("recipients");if(this.form.invalid||!e)return;let n=(e.value||"").split(",").map(u=>u.trim()).filter(u=>!!u),o=n.filter(u=>me.test(u));if(o.length===0){e.setErrors(n.length===0?{required:!0}:{invalidEmails:{value:n}}),e.markAsTouched();return}let r={recipients:o,subject:this.form.get("subject")?.value?.trim()||void 0};this._dialogRef.close(r)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=w({type:t,selectors:[["send-sample-modal"]],decls:43,vars:29,consts:[[1,"flex","flex-col","w-full","max-w-lg"],[1,"px-6","pt-6","pb-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"w-12","h-12","rounded-xl","bg-gradient-to-br","from-indigo-500","to-purple-600","flex","items-center","justify-center","shadow-lg","shadow-indigo-500/25"],[1,"!w-6","!h-6","text-white","icon-size-6"],[1,"text-lg","font-bold","text-slate-900","dark:text-white"],[1,"text-sm","text-slate-500","dark:text-slate-400"],["mat-icon-button","",1,"!-mr-2",3,"click"],[1,"px-6","pb-6","space-y-4",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["matInput","","formControlName","recipients","rows","3",3,"placeholder"],["matInput","","formControlName","subject",3,"placeholder"],[1,"flex","gap-3","pt-2","justify-end","border-t","border-slate-200","dark:border-slate-700"],["mat-button","","type","button",1,"!text-slate-600",3,"click"],["mat-flat-button","","color","primary","type","submit",1,"!rounded-xl","!bg-indigo-600","!text-white",3,"disabled"],[1,"!w-4","!h-4","mr-1"]],template:function(n,o){if(n&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-icon",5),p(6,"send"),a()(),l(7,"div")(8,"h2",6),p(9),c(10,"transloco"),a(),l(11,"p",7),p(12),c(13,"transloco"),a()()(),l(14,"button",8),C("click",function(){return o.onCancel()}),l(15,"mat-icon"),p(16,"close"),a()()()(),l(17,"form",9),C("ngSubmit",function(){return o.onSubmit()}),l(18,"mat-form-field",10)(19,"mat-label"),p(20),c(21,"transloco"),a(),b(22,"textarea",11),c(23,"transloco"),l(24,"mat-hint"),p(25),c(26,"transloco"),a(),h(27,Te,3,3,"mat-error")(28,Fe,3,3,"mat-error"),a(),l(29,"mat-form-field",10)(30,"mat-label"),p(31),c(32,"transloco"),a(),b(33,"input",12),a(),l(34,"div",13)(35,"button",14),C("click",function(){return o.onCancel()}),p(36),c(37,"transloco"),a(),l(38,"button",15)(39,"mat-icon",16),p(40,"send"),a(),p(41),c(42,"transloco"),a()()()()),n&2){let r,u;i(9),g(" ",d(10,13,o.isSample?"smartReport.sendSampleReport":"smartReport.sendReport")," "),i(3),g(" ",d(13,15,"smartReport.enterRecipientsAndSubject")," "),i(5),y("formGroup",o.form),i(3),x(d(21,17,"smartReport.recipientEmails")),i(2),y("placeholder",d(23,19,"smartReport.recipientsPlaceholder")),i(3),x(d(26,21,"smartReport.separateEmailsWithCommas")),i(2),f((r=o.form.get("recipients"))!=null&&r.hasError("required")&&((r=o.form.get("recipients"))!=null&&r.touched)?27:-1),i(),f((u=o.form.get("recipients"))!=null&&u.hasError("invalidEmails")&&((u=o.form.get("recipients"))!=null&&u.touched)?28:-1),i(3),x(d(32,23,"smartReport.subjectOptional")),i(2),y("placeholder",o.subjectPlaceholder),i(3),g(" ",d(37,25,"smartReport.cancel")," "),i(2),y("disabled",o.form.invalid||o.form.pending),i(3),g(" ",d(42,27,o.isSample?"smartReport.sendSample":"smartReport.sendReport")," ")}},dependencies:[P,ae,ne,ee,te,ie,oe,re,L,Q,K,X,E,R,J,H,Z,U,W,se,pe,I,M],styles:["[_nghost-%COMP%]{display:block}"]})}}return t})();export{Ae as a,Ge as b,rt as c};
